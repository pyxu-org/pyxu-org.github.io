
<!DOCTYPE html>

<html data-theme="light" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/><meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>pyxu.opt — Pyxu Documentation</title>
<script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "light";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
<!-- Loaded before other Sphinx assets -->
<link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet"/>
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet"/>
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet"/>
<link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet"/>
<link as="font" crossorigin="" href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" rel="preload" type="font/woff2"/>
<link href="../_static/pygments.css?v=fa44fd50" rel="stylesheet" type="text/css"/>
<link href="../_static/plot_directive.css?v=7f9a90b1" rel="stylesheet" type="text/css"/>
<link href="../_static/sphinx-codeautolink.css?v=125d5c1c" rel="stylesheet" type="text/css"/>
<link href="../_static/copybutton.css?v=76b2166b" rel="stylesheet" type="text/css"/>
<link href="../_static/togglebutton.css?v=13237357" rel="stylesheet" type="text/css"/>
<link href="../_static/sg_gallery.css?v=61a4c737" rel="stylesheet" type="text/css"/>
<link href="../_static/sg_gallery-binder.css?v=f4aeca0c" rel="stylesheet" type="text/css"/>
<link href="../_static/sg_gallery-dataframe.css?v=2082cf3c" rel="stylesheet" type="text/css"/>
<link href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" rel="stylesheet" type="text/css"/>
<link href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" rel="stylesheet" type="text/css"/>
<link href="../_static/css/custom.css?v=1031a718" rel="stylesheet" type="text/css"/>
<!-- Pre-loaded scripts that we'll load fully later -->
<link as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" rel="preload"/>
<link as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" rel="preload"/>
<script src="../_static/documentation_options.js?v=e02fc88f"></script>
<script src="../_static/doctools.js?v=888ff710"></script>
<script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
<script src="../_static/clipboard.min.js?v=a7894cd8"></script>
<script src="../_static/copybutton.js?v=30646c52"></script>
<script>let toggleHintShow = 'Click to show';</script>
<script>let toggleHintHide = 'Click to hide';</script>
<script>let toggleOpenOnPrint = 'true';</script>
<script src="../_static/togglebutton.js?v=4a39c7ea"></script>
<script src="../_static/design-tabs.js?v=36754332"></script>
<script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
<script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
<script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
<script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
<script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>DOCUMENTATION_OPTIONS.pagename = 'api/opt';</script>
<link href="../_static/favicon.png" rel="icon"/>
<link href="../genindex.html" rel="index" title="Index"/>
<link href="../search.html" rel="search" title="Search"/>
<link href="operator/index.html" rel="next" title="pyxu.operator"/>
<link href="abc.html" rel="prev" title="pyxu.abc"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="en" name="docsearch:language"/>
</head>
<body data-bs-root-margin="0px 0px -60%" data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-default-mode="light" data-offset="180">
<a class="skip-link" href="#main-content">Skip to main content</a>
<input class="sidebar-toggle" id="__primary" name="__primary" type="checkbox"/>
<label class="overlay overlay-primary" for="__primary"></label>
<input class="sidebar-toggle" id="__secondary" name="__secondary" type="checkbox"/>
<label class="overlay overlay-secondary" for="__secondary"></label>
<div class="search-button__wrapper">
<div class="search-button__overlay"></div>
<div class="search-button__search-container">
<form action="../search.html" class="bd-search d-flex align-items-center" method="get">
<i class="fa-solid fa-magnifying-glass"></i>
<input aria-label="Search the docs ..." autocapitalize="off" autocomplete="off" autocorrect="off" class="form-control" id="search-input" name="q" placeholder="Search the docs ..." spellcheck="false" type="search"/>
<span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
</div>
<nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
<label class="sidebar-toggle primary-toggle" for="__primary">
<span class="fa-solid fa-bars"></span>
</label>
<div class="navbar-header-items__start">
<div class="navbar-item">
<a class="navbar-brand logo" href="../index.html">
<img alt="Logo image" class="logo__image only-light" src="../_static/logo.png"/>
<script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
</a></div>
</div>
<div class="col-lg-9 navbar-header-items">
<div class="me-auto navbar-header-items__center">
<div class="navbar-item"><nav class="navbar-nav">
<p aria-label="Site Navigation" aria-level="1" class="sidebar-header-items__title" role="heading">
    Site Navigation
  </p>
<ul class="bd-navbar-elements navbar-nav">
<li class="nav-item">
<a class="nav-link nav-internal" href="../intro/index.html">
                        Getting Started
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../guide/index.html">
                        User Guide
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../examples/index.html">
                        Example Gallery
                      </a>
</li>
<li class="nav-item current active">
<a class="nav-link nav-internal" href="index.html">
                        API Reference
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../fair/index.html">
                        Extending Pyxu
                      </a>
</li>
</ul>
</nav></div>
</div>
<div class="navbar-header-items__end">
<div class="navbar-item navbar-persistent--container">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
</div>
<div class="navbar-item"><strong> v1.0.x </strong></div>
<div class="navbar-item"><ul aria-label="Icon Links" class="navbar-icon-links navbar-nav">
<li class="nav-item">
<a class="nav-link" data-bs-placement="bottom" data-bs-toggle="tooltip" href="https://github.com/matthieumeo/pyxu" rel="noopener" target="_blank" title="GitHub"><span><i class="fa-brands fa-github"></i></span>
<label class="sr-only">GitHub</label></a>
</li>
<li class="nav-item">
<a class="nav-link" data-bs-placement="bottom" data-bs-toggle="tooltip" href="https://pypi.org/project/pyxu/" rel="noopener" target="_blank" title="PyPI"><span><i class="fa-brands fa-python"></i></span>
<label class="sr-only">PyPI</label></a>
</li>
<li class="nav-item">
<a class="nav-link" data-bs-placement="bottom" data-bs-toggle="tooltip" href="mailto: matthieu.simeoni@gmail.com" rel="noopener" target="_blank" title="Contact"><span><i class="fa-brands fa-telegram"></i></span>
<label class="sr-only">Contact</label></a>
</li>
<li class="nav-item">
<a class="nav-link" data-bs-placement="bottom" data-bs-toggle="tooltip" href="https://imaging.epfl.ch/" rel="noopener" target="_blank" title="EPFL Center for Imaging"><img alt="EPFL Center for Imaging" class="icon-link-image" src="../_static/imaging.png"/></a>
</li>
</ul></div>
</div>
</div>
<div class="navbar-persistent--mobile">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
</div>
<label class="sidebar-toggle secondary-toggle" for="__secondary">
<span class="fa-solid fa-outdent"></span>
</label>
</div>
</nav>
<div class="bd-container">
<div class="bd-container__inner bd-page-width">
<div class="bd-sidebar-primary bd-sidebar">
<div class="sidebar-header-items sidebar-primary__section">
<div class="sidebar-header-items__center">
<div class="navbar-item"><nav class="navbar-nav">
<p aria-label="Site Navigation" aria-level="1" class="sidebar-header-items__title" role="heading">
    Site Navigation
  </p>
<ul class="bd-navbar-elements navbar-nav">
<li class="nav-item">
<a class="nav-link nav-internal" href="../intro/index.html">
                        Getting Started
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../guide/index.html">
                        User Guide
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../examples/index.html">
                        Example Gallery
                      </a>
</li>
<li class="nav-item current active">
<a class="nav-link nav-internal" href="index.html">
                        API Reference
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../fair/index.html">
                        Extending Pyxu
                      </a>
</li>
</ul>
</nav></div>
</div>
<div class="sidebar-header-items__end">
<div class="navbar-item"><strong> v1.0.x </strong></div>
<div class="navbar-item"><ul aria-label="Icon Links" class="navbar-icon-links navbar-nav">
<li class="nav-item">
<a class="nav-link" data-bs-placement="bottom" data-bs-toggle="tooltip" href="https://github.com/matthieumeo/pyxu" rel="noopener" target="_blank" title="GitHub"><span><i class="fa-brands fa-github"></i></span>
<label class="sr-only">GitHub</label></a>
</li>
<li class="nav-item">
<a class="nav-link" data-bs-placement="bottom" data-bs-toggle="tooltip" href="https://pypi.org/project/pyxu/" rel="noopener" target="_blank" title="PyPI"><span><i class="fa-brands fa-python"></i></span>
<label class="sr-only">PyPI</label></a>
</li>
<li class="nav-item">
<a class="nav-link" data-bs-placement="bottom" data-bs-toggle="tooltip" href="mailto: matthieu.simeoni@gmail.com" rel="noopener" target="_blank" title="Contact"><span><i class="fa-brands fa-telegram"></i></span>
<label class="sr-only">Contact</label></a>
</li>
<li class="nav-item">
<a class="nav-link" data-bs-placement="bottom" data-bs-toggle="tooltip" href="https://imaging.epfl.ch/" rel="noopener" target="_blank" title="EPFL Center for Imaging"><img alt="EPFL Center for Imaging" class="icon-link-image" src="../_static/imaging.png"/></a>
</li>
</ul></div>
</div>
</div>
<div class="sidebar-primary-items__start sidebar-primary__section">
<div class="sidebar-primary-item"><nav aria-label="Section Navigation" class="bd-docs-nav bd-links">
<p aria-level="1" class="bd-links__title" role="heading">Section Navigation</p>
<div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="abc.html">pyxu.abc</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">pyxu.opt</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="operator/index.html">pyxu.operator</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="operator/map.html">pyxu.operator.map</a></li>
<li class="toctree-l2"><a class="reference internal" href="operator/func.html">pyxu.operator.func</a></li>
<li class="toctree-l2"><a class="reference internal" href="operator/linop.html">pyxu.operator.linop</a></li>
<li class="toctree-l2"><a class="reference internal" href="operator/blocks.html">pyxu.operator.blocks</a></li>
<li class="toctree-l2"><a class="reference internal" href="operator/interop.html">pyxu.operator.interop</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="runtime.html">pyxu.runtime</a></li>
<li class="toctree-l1"><a class="reference internal" href="util.html">pyxu.util</a></li>
<li class="toctree-l1"><a class="reference internal" href="math.html">pyxu.math</a></li>
<li class="toctree-l1"><a class="reference internal" href="info.html">pyxu.info</a></li>
<li class="toctree-l1"><a class="reference internal" href="experimental.html">pyxu.experimental</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
</ul>
</div>
</nav></div>
</div>
<div class="sidebar-primary-items__end sidebar-primary__section">
</div>
<div id="rtd-footer-container"></div>
</div>
<main class="bd-main" id="main-content">
<div class="bd-content">
<div class="bd-article-container">
<div class="bd-header-article">
<div class="header-article-items header-article__inner">
<div class="header-article-items__start">
<div class="header-article-item">
<nav aria-label="Breadcrumbs">
<ul aria-label="Breadcrumb" class="bd-breadcrumbs" role="navigation">
<li class="breadcrumb-item breadcrumb-home">
<a aria-label="Home" class="nav-link" href="../index.html">
<i class="fa-solid fa-home"></i>
</a>
</li>
<li class="breadcrumb-item"><a class="nav-link" href="index.html">API Reference</a></li>
<li aria-current="page" class="breadcrumb-item active">pyxu.opt</li>
</ul>
</nav>
</div>
</div>
</div>
</div>
<div id="searchbox"></div>
<article class="bd-article" role="main">
<section id="pyxu-opt">
<h1>pyxu.opt<a class="headerlink" href="#pyxu-opt" title="Link to this heading">#</a></h1>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#pyxu-opt-stop" id="id60">pyxu.opt.stop</a></p></li>
<li><p><a class="reference internal" href="#pyxu-opt-solver" id="id61">pyxu.opt.solver</a></p></li>
</ul>
</nav>
<section id="pyxu-opt-stop">
<h2><a class="toc-backref" href="#id60" role="doc-backlink">pyxu.opt.stop</a><a class="headerlink" href="#pyxu-opt-stop" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyxu.opt.stop.MaxIter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MaxIter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyxu/opt/stop.html#MaxIter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.opt.stop.MaxIter" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="abc.html#pyxu.abc.solver.StoppingCriterion" title="pyxu.abc.solver.StoppingCriterion"><code class="xref py py-class docutils literal notranslate"><span class="pre">StoppingCriterion</span></code></a></p>
<p>Stop iterative solver after a fixed number of iterations.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you want to add a grace period to a solver, i.e. for it to do <em>at least</em> N iterations before
stopping based on the value of another criteria, you can AND <a class="reference internal" href="#pyxu.opt.stop.MaxIter" title="pyxu.opt.stop.MaxIter"><code class="xref py py-class docutils literal notranslate"><span class="pre">MaxIter</span></code></a>
with the other criteria.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sc</span> <span class="o">=</span> <span class="n">MaxIter</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">AbsError</span><span class="p">(</span><span class="n">eps</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="c1"># If N_iter &lt; 5  -&gt; never stop.</span>
<span class="c1"># If N_iter &gt;= 5 -&gt; stop if AbsError() decides to.</span>
</pre></div>
</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.11)"><em>Integral</em></a>) – </p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.opt.stop.MaxIter.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyxu/opt/stop.html#MaxIter.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.opt.stop.MaxIter.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>n</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Integer" title="pyxu.info.ptype.Integer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Integer</span></code></a>) – Max number of iterations allowed.</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyxu.opt.stop.ManualStop">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ManualStop</span></span><a class="reference internal" href="../_modules/pyxu/opt/stop.html#ManualStop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.opt.stop.ManualStop" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="abc.html#pyxu.abc.solver.StoppingCriterion" title="pyxu.abc.solver.StoppingCriterion"><code class="xref py py-class docutils literal notranslate"><span class="pre">StoppingCriterion</span></code></a></p>
<p>Continue-forever criterion.</p>
<p>This class is useful when calling
<a class="reference internal" href="abc.html#pyxu.abc.solver.Solver.fit" title="pyxu.abc.solver.Solver.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit()</span></code></a>
with mode=MANUAL/ASYNC to defer the stopping decision to an explicit call by the user, i.e.:</p>
<ul class="simple">
<li><p>mode=MANUAL: user must stop calling <code class="docutils literal notranslate"><span class="pre">next(solver.steps())</span></code>;</p></li>
<li><p>mode=ASYNC: user must call <a class="reference internal" href="abc.html#pyxu.abc.solver.Solver.stop" title="pyxu.abc.solver.Solver.stop"><code class="xref py py-meth docutils literal notranslate"><span class="pre">stop()</span></code></a>.</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.opt.stop.ManualStop.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyxu.opt.stop.ManualStop.__init__" title="Link to this definition">#</a></dt>
<dd></dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyxu.opt.stop.MaxDuration">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MaxDuration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyxu/opt/stop.html#MaxDuration"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.opt.stop.MaxDuration" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="abc.html#pyxu.abc.solver.StoppingCriterion" title="pyxu.abc.solver.StoppingCriterion"><code class="xref py py-class docutils literal notranslate"><span class="pre">StoppingCriterion</span></code></a></p>
<p>Stop iterative solver after a specified duration has elapsed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>t</strong> (<a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta" title="(in Python v3.11)"><em>timedelta</em></a>) – </p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.opt.stop.MaxDuration.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyxu/opt/stop.html#MaxDuration.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.opt.stop.MaxDuration.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>t</strong> (<a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">timedelta</span></code></a>) – Max runtime allowed.</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyxu.opt.stop.MaxCarbon">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MaxCarbon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">co2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyxu/opt/stop.html#MaxCarbon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.opt.stop.MaxCarbon" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="abc.html#pyxu.abc.solver.StoppingCriterion" title="pyxu.abc.solver.StoppingCriterion"><code class="xref py py-class docutils literal notranslate"><span class="pre">StoppingCriterion</span></code></a></p>
<p>Stop iterative solver after a threshold amount of carbon dioxide (CO2) was produced by computing
resources used to execute the optimization.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Codecarbon is not a core dependency of Pyxu and must be installed separately.</p>
<p>On Windows and MacOS, <a class="reference external" href="https://pypi.org/project/codecarbon/">codecarbon</a> tracks power consumption of
Intel processors using the
<a class="reference external" href="https://www.intel.com/content/www/us/en/developer/articles/tool/power-gadget.html">Intel Power Gadget (IPG)</a>.
IPG must be installed independently.
(MacOS-specific: IPG must also have correct security permissions.)</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>co2</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="numbers.Real"><em>Real</em></a>) – </p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.opt.stop.MaxCarbon.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">co2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyxu/opt/stop.html#MaxCarbon.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.opt.stop.MaxCarbon.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>co2</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-class docutils literal notranslate"><span class="pre">Real</span></code></a>) – Max allowed CO2 emissions [Kg].</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyxu.opt.stop.Memorize">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Memorize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyxu/opt/stop.html#Memorize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.opt.stop.Memorize" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="abc.html#pyxu.abc.solver.StoppingCriterion" title="pyxu.abc.solver.StoppingCriterion"><code class="xref py py-class docutils literal notranslate"><span class="pre">StoppingCriterion</span></code></a></p>
<p>Memorize a variable.
(Special <a class="reference internal" href="abc.html#pyxu.abc.solver.StoppingCriterion" title="pyxu.abc.solver.StoppingCriterion"><code class="xref py py-class docutils literal notranslate"><span class="pre">StoppingCriterion</span></code></a> mostly useful for tracking objective functions in
<a class="reference internal" href="abc.html#pyxu.abc.solver.Solver" title="pyxu.abc.solver.Solver"><code class="xref py py-class docutils literal notranslate"><span class="pre">Solver</span></code></a>.)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>var</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Collection" title="(in Python v3.11)"><em>Collection</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em>]</em>) – </p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.opt.stop.Memorize.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyxu/opt/stop.html#Memorize.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.opt.stop.Memorize.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>var</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.VarName" title="pyxu.info.ptype.VarName"><code class="xref py py-class docutils literal notranslate"><span class="pre">VarName</span></code></a>) – Variable in <a class="reference internal" href="abc.html#pyxu.abc.solver.Solver._mstate" title="pyxu.abc.solver.Solver._mstate"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pyxu.abc.solver.Solver._mstate</span></code></a> to query.
Must be a scalar or NDArray (1D).</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyxu.opt.stop.AbsError">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">AbsError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'x'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">satisfy_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyxu/opt/stop.html#AbsError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.opt.stop.AbsError" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="abc.html#pyxu.abc.solver.StoppingCriterion" title="pyxu.abc.solver.StoppingCriterion"><code class="xref py py-class docutils literal notranslate"><span class="pre">StoppingCriterion</span></code></a></p>
<p>Stop iterative solver after absolute norm of a variable (or function thereof) reaches threshold.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eps</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="numbers.Real"><em>Real</em></a>) – </p></li>
<li><p><strong>var</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Collection" title="(in Python v3.11)"><em>Collection</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em>]</em>) – </p></li>
<li><p><strong>f</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.11)"><em>Callable</em></a><em>[</em><em>[</em><a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="numbers.Real"><em>Real</em></a><em>]</em><em>, </em><a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="numbers.Real"><em>Real</em></a><em>] </em><em>| </em><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.11)"><em>Callable</em></a><em>[</em><em>[</em><a class="reference internal" href="info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><em>NDArray</em></a><em>]</em><em>, </em><a class="reference internal" href="info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><em>NDArray</em></a><em>]</em>) – </p></li>
<li><p><strong>norm</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="numbers.Real"><em>Real</em></a>) – </p></li>
<li><p><strong>satisfy_all</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.opt.stop.AbsError.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'x'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">satisfy_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyxu/opt/stop.html#AbsError.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.opt.stop.AbsError.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eps</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-class docutils literal notranslate"><span class="pre">Real</span></code></a>) – Positive threshold.</p></li>
<li><p><strong>var</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.VarName" title="pyxu.info.ptype.VarName"><code class="xref py py-class docutils literal notranslate"><span class="pre">VarName</span></code></a>) – Variable in <a class="reference internal" href="abc.html#pyxu.abc.solver.Solver._mstate" title="pyxu.abc.solver.Solver._mstate"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pyxu.abc.solver.Solver._mstate</span></code></a> to query.</p></li>
<li><p><strong>f</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callable</span></code></a>) – <p>Optional function to pre-apply to <code class="docutils literal notranslate"><span class="pre">_mstate[var]</span></code> before applying the norm.
Defaults to the identity function. The callable should either:</p>
<ul>
<li><p>accept a scalar input -&gt; output a scalar, or</p></li>
<li><p>accept an NDArray input -&gt; output an NDArray, i.e same semantics as
<a class="reference internal" href="abc.html#pyxu.abc.operator.Map.apply" title="pyxu.abc.operator.Map.apply"><code class="xref py py-meth docutils literal notranslate"><span class="pre">apply()</span></code></a>.</p></li>
</ul>
</p></li>
<li><p><strong>norm</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Integer" title="pyxu.info.ptype.Integer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Integer</span></code></a>, <a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-class docutils literal notranslate"><span class="pre">Real</span></code></a>) – Ln norm to use &gt;= 0. (Default: L2.)</p></li>
<li><p><strong>satisfy_all</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – If True (default) and <code class="docutils literal notranslate"><span class="pre">_mstate[var]</span></code> is multi-dimensional, stop if all evaluation
points lie below threshold.</p></li>
</ul>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyxu.opt.stop.RelError">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">RelError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'x'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">satisfy_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyxu/opt/stop.html#RelError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.opt.stop.RelError" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="abc.html#pyxu.abc.solver.StoppingCriterion" title="pyxu.abc.solver.StoppingCriterion"><code class="xref py py-class docutils literal notranslate"><span class="pre">StoppingCriterion</span></code></a></p>
<p>Stop iterative solver after relative norm change of a variable (or function thereof) reaches
threshold.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eps</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="numbers.Real"><em>Real</em></a>) – </p></li>
<li><p><strong>var</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Collection" title="(in Python v3.11)"><em>Collection</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em>]</em>) – </p></li>
<li><p><strong>f</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.11)"><em>Callable</em></a><em>[</em><em>[</em><a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="numbers.Real"><em>Real</em></a><em>]</em><em>, </em><a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="numbers.Real"><em>Real</em></a><em>] </em><em>| </em><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.11)"><em>Callable</em></a><em>[</em><em>[</em><a class="reference internal" href="info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><em>NDArray</em></a><em>]</em><em>, </em><a class="reference internal" href="info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><em>NDArray</em></a><em>]</em>) – </p></li>
<li><p><strong>norm</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="numbers.Real"><em>Real</em></a>) – </p></li>
<li><p><strong>satisfy_all</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.opt.stop.RelError.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'x'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">satisfy_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyxu/opt/stop.html#RelError.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.opt.stop.RelError.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eps</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-class docutils literal notranslate"><span class="pre">Real</span></code></a>) – Positive threshold.</p></li>
<li><p><strong>var</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.VarName" title="pyxu.info.ptype.VarName"><code class="xref py py-class docutils literal notranslate"><span class="pre">VarName</span></code></a>) – Variable in <a class="reference internal" href="abc.html#pyxu.abc.solver.Solver._mstate" title="pyxu.abc.solver.Solver._mstate"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pyxu.abc.solver.Solver._mstate</span></code></a> to query.</p></li>
<li><p><strong>f</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callable</span></code></a>) – <p>Optional function to pre-apply to <code class="docutils literal notranslate"><span class="pre">_mstate[var]</span></code> before applying the norm.
Defaults to the identity function. The callable should either:</p>
<ul>
<li><p>accept a scalar input -&gt; output a scalar, or</p></li>
<li><p>accept an NDArray input -&gt; output an NDArray, i.e same semantics as
<a class="reference internal" href="abc.html#pyxu.abc.operator.Map.apply" title="pyxu.abc.operator.Map.apply"><code class="xref py py-meth docutils literal notranslate"><span class="pre">apply()</span></code></a>.</p></li>
</ul>
</p></li>
<li><p><strong>norm</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Integer" title="pyxu.info.ptype.Integer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Integer</span></code></a>, <a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-class docutils literal notranslate"><span class="pre">Real</span></code></a>) – Ln norm to use &gt;= 0. (Default: L2.)</p></li>
<li><p><strong>satisfy_all</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – If True (default) and <code class="docutils literal notranslate"><span class="pre">_mstate[var]</span></code> is multi-dimensional, stop if all evaluation
points lie below threshold.</p></li>
</ul>
</dd>
</dl>
</dd></dl>
</dd></dl>
</section>
<section id="pyxu-opt-solver">
<h2><a class="toc-backref" href="#id61" role="doc-backlink">pyxu.opt.solver</a><a class="headerlink" href="#pyxu-opt-solver" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyxu.opt.solver.pgd.PGD">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PGD</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyxu/opt/solver/pgd.html#PGD"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.opt.solver.pgd.PGD" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="abc.html#pyxu.abc.solver.Solver" title="pyxu.abc.solver.Solver"><code class="xref py py-class docutils literal notranslate"><span class="pre">Solver</span></code></a></p>
<p>Proximal Gradient Descent (PGD) solver.</p>
<p>PGD solves minimization problems of the form</p>
<div class="math notranslate nohighlight">
\[{\min_{\mathbf{x}\in\mathbb{R}^N} \;\mathcal{F}(\mathbf{x})\;\;+\;\;\mathcal{G}(\mathbf{x})},\]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\mathcal{F}:\mathbb{R}^N\rightarrow \mathbb{R}\)</span> is <em>convex</em> and <em>differentiable</em>, with
<span class="math notranslate nohighlight">\(\beta\)</span>-<em>Lipschitz continuous</em> gradient, for some <span class="math notranslate nohighlight">\(\beta\in[0,+\infty[\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathcal{G}:\mathbb{R}^N\rightarrow \mathbb{R}\cup\{+\infty\}\)</span> is a <em>proper</em>, <em>lower
semicontinuous</em> and <em>convex function</em> with a <em>simple proximal operator</em>.</p></li>
</ul>
<section id="remarks">
<h3>Remarks<a class="headerlink" href="#remarks" title="Link to this heading">#</a></h3>
<ul>
<li><p>The problem is <em>feasible</em> – i.e. there exists at least one solution.</p></li>
<li><p>The algorithm is still valid if either <span class="math notranslate nohighlight">\(\mathcal{F}\)</span> or <span class="math notranslate nohighlight">\(\mathcal{G}\)</span> is zero.</p></li>
<li><p>The convergence is guaranteed for step sizes <span class="math notranslate nohighlight">\(\tau\leq 1/\beta\)</span>.</p></li>
<li><p>Various acceleration schemes are described in <a class="reference internal" href="../references.html#apgd" id="id1"><span>[APGD]</span></a>.
PGD achieves the following (optimal) <em>convergence rate</em> with the implemented acceleration scheme
from Chambolle &amp; Dossal:</p>
<div class="math notranslate nohighlight">
\[\lim\limits_{n\rightarrow \infty} n^2\left\vert \mathcal{J}(\mathbf{x}^\star)- \mathcal{J}(\mathbf{x}_n)\right\vert=0
\qquad\&amp;\qquad
\lim\limits_{n\rightarrow \infty} n^2\Vert \mathbf{x}_n-\mathbf{x}_{n-1}\Vert^2_\mathcal{X}=0,\]</div>
<p>for <em>some minimiser</em> <span class="math notranslate nohighlight">\({\mathbf{x}^\star}\in\arg\min_{\mathbf{x}\in\mathbb{R}^N} \;\left\{\mathcal{J}(\mathbf{x}):=\mathcal{F}(\mathbf{x})+\mathcal{G}(\mathbf{x})\right\}\)</span>.
In other words, both the objective functional and the PGD iterates
<span class="math notranslate nohighlight">\(\{\mathbf{x}_n\}_{n\in\mathbb{N}}\)</span> converge at a rate <span class="math notranslate nohighlight">\(o(1/n^2)\)</span>.
Significant practical <em>speedup</em> can be achieved for values of <span class="math notranslate nohighlight">\(d\)</span> in the range
<span class="math notranslate nohighlight">\([50,100]\)</span> <a class="reference internal" href="../references.html#apgd" id="id2"><span>[APGD]</span></a>.</p>
</li>
<li><p>The relative norm change of the primal variable is used as the default stopping criterion.
By default, the algorithm stops when the norm of the difference between two consecutive PGD
iterates <span class="math notranslate nohighlight">\(\{\mathbf{x}_n\}_{n\in\mathbb{N}}\)</span> is smaller than 1e-4.
Different stopping criteria can be used.</p></li>
</ul>
</section>
<section id="parameters-init">
<h3>Parameters (<code class="docutils literal notranslate"><span class="pre">__init__()</span></code>)<a class="headerlink" href="#parameters-init" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>f</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.DiffFunc" title="pyxu.abc.operator.DiffFunc"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiffFunc</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
Differentiable function <span class="math notranslate nohighlight">\(\mathcal{F}\)</span>.</p></li>
<li><p><strong>g</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.ProxFunc" title="pyxu.abc.operator.ProxFunc"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProxFunc</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
Proximable function <span class="math notranslate nohighlight">\(\mathcal{G}\)</span>.</p></li>
<li><p><strong>**kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>)
–
Other keyword parameters passed on to <a class="reference internal" href="abc.html#pyxu.abc.solver.Solver.__init__" title="pyxu.abc.solver.Solver.__init__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pyxu.abc.solver.Solver.__init__()</span></code></a>.</p></li>
</ul>
</section>
<section id="parameters-fit">
<h3>Parameters (<code class="docutils literal notranslate"><span class="pre">fit()</span></code>)<a class="headerlink" href="#parameters-fit" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>x0</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-attr docutils literal notranslate"><span class="pre">NDArray</span></code></a>)
–
(…, N) initial point(s).</p></li>
<li><p><strong>tau</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Real</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
Gradient step size.
Defaults to <span class="math notranslate nohighlight">\(1 / \beta\)</span> if unspecified.</p></li>
<li><p><strong>acceleration</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code></a>)
–
If True (default), then use Chambolle &amp; Dossal acceleration scheme.</p></li>
<li><p><strong>d</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Real</span></code></a>)
–
Chambolle &amp; Dossal acceleration parameter <span class="math notranslate nohighlight">\(d\)</span>.
Should be greater than 2.
Only meaningful if <code class="code docutils literal notranslate"><span class="pre">acceleration</span></code> is True.
Defaults to 75 in unspecified.</p></li>
<li><p><strong>**kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>)
–
Other keyword parameters passed on to <a class="reference internal" href="abc.html#pyxu.abc.solver.Solver.fit" title="pyxu.abc.solver.Solver.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pyxu.abc.solver.Solver.fit()</span></code></a>.</p></li>
</ul>
</section>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.DiffFunc" title="pyxu.abc.operator.DiffFunc"><em>DiffFunc</em></a>) – </p></li>
<li><p><strong>g</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.ProxFunc" title="pyxu.abc.operator.ProxFunc"><em>ProxFunc</em></a>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyxu.opt.solver.cg.CG">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">CG</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyxu/opt/solver/cg.html#CG"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.opt.solver.cg.CG" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="abc.html#pyxu.abc.solver.Solver" title="pyxu.abc.solver.Solver"><code class="xref py py-class docutils literal notranslate"><span class="pre">Solver</span></code></a></p>
<p>Conjugate Gradient Method.</p>
<p>The Conjugate Gradient method solves the minimization problem</p>
<div class="math notranslate nohighlight">
\[\min_{x\in\mathbb{R}^{N}} \frac{1}{2} \mathbf{x}^{T} \mathbf{A} \mathbf{x} - \mathbf{x}^{T} \mathbf{b},\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{A}: \mathbb{R}^{N} \to \mathbb{R}^{N}\)</span> is a <em>symmetric</em> <em>positive definite</em>
operator, and <span class="math notranslate nohighlight">\(\mathbf{b} \in \mathbb{R}^{N}\)</span>.</p>
<p>The norm of the <a class="reference external" href="https://www.wikiwand.com/en/Conjugate_gradient_method">explicit residual</a>
<span class="math notranslate nohighlight">\(\mathbf {r}_{k+1}:=\mathbf{b}-\mathbf{Ax}_{k+1}\)</span> is used as the default stopping criterion.
This provides a guaranteed level of accuracy both in exact arithmetic and in the presence of
round-off errors.
By default, the iterations stop when the norm of the explicit residual is smaller than 1e-4.</p>
<section id="id3">
<h3>Parameters (<code class="docutils literal notranslate"><span class="pre">__init__()</span></code>)<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>A</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.PosDefOp" title="pyxu.abc.operator.PosDefOp"><code class="xref py py-class docutils literal notranslate"><span class="pre">PosDefOp</span></code></a>)
–
Positive-definite operator <span class="math notranslate nohighlight">\(\mathbf{A}: \mathbb{R}^{N} \to \mathbb{R}^{N}\)</span>.</p></li>
<li><p><strong>**kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>)
–
Other keyword parameters passed on to <a class="reference internal" href="abc.html#pyxu.abc.solver.Solver.__init__" title="pyxu.abc.solver.Solver.__init__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pyxu.abc.solver.Solver.__init__()</span></code></a>.</p></li>
</ul>
</section>
<section id="id4">
<h3>Parameters (<code class="docutils literal notranslate"><span class="pre">fit()</span></code>)<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<ul>
<li><p><strong>b</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-attr docutils literal notranslate"><span class="pre">NDArray</span></code></a>)
–
(…, N) <span class="math notranslate nohighlight">\(\mathbf{b}\)</span> terms in the CG cost function.</p>
<p>All problems are solved in parallel.</p>
</li>
<li><p><strong>x0</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-attr docutils literal notranslate"><span class="pre">NDArray</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
(…, N) initial point(s).</p>
<p>Must be broadcastable with <code class="code docutils literal notranslate"><span class="pre">b</span></code> if provided.
Defaults to 0.</p>
</li>
<li><p><strong>restart_rate</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Integer" title="pyxu.info.ptype.Integer"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Integer</span></code></a>)
–
Number of iterations after which restart is applied.</p>
<p>By default, a restart is done after ‘n’ iterations, where ‘n’ corresponds to the dimension of <span class="math notranslate nohighlight">\(\mathbf{A}\)</span>.</p>
</li>
<li><p><strong>**kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>)
–
Other keyword parameters passed on to <a class="reference internal" href="abc.html#pyxu.abc.solver.Solver.fit" title="pyxu.abc.solver.Solver.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pyxu.abc.solver.Solver.fit()</span></code></a>.</p></li>
</ul>
</section>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>A</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.PosDefOp" title="pyxu.abc.operator.PosDefOp"><em>PosDefOp</em></a>) – </p>
</dd>
</dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyxu.opt.solver.nlcg.NLCG">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">NLCG</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyxu/opt/solver/nlcg.html#NLCG"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.opt.solver.nlcg.NLCG" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="abc.html#pyxu.abc.solver.Solver" title="pyxu.abc.solver.Solver"><code class="xref py py-class docutils literal notranslate"><span class="pre">Solver</span></code></a></p>
<p>Nonlinear Conjugate Gradient Method (NLCG).</p>
<p>The Nonlinear Conjugate Gradient method finds a local minimum of the problem</p>
<div class="math notranslate nohighlight">
\[\min_{x\in\mathbb{R}^{N}} f(x),\]</div>
<p>where <span class="math notranslate nohighlight">\(f: \mathbb{R}^{N} \to \mathbb{R}\)</span> is a <em>differentiable</em> functional.
When <span class="math notranslate nohighlight">\(f\)</span> is quadratic, NLCG is equivalent to the Conjugate Gradient (CG) method.
NLCG hence has similar convergence behaviour to CG if <span class="math notranslate nohighlight">\(f\)</span> is locally-quadratic.
The converge speed may be slower however due to its line-search overhead <a class="reference internal" href="../references.html#numopt-nocwri" id="id5"><span>[NumOpt_NocWri]</span></a>.</p>
<p>The norm of the <a class="reference external" href="https://www.wikiwand.com/en/Nonlinear_conjugate_gradient_method">gradient</a>
<span class="math notranslate nohighlight">\(\nabla f_k = \nabla f(x_k)\)</span> is used as the default stopping criterion.
By default, the iterations stop when the norm of the gradient is smaller than 1e-4.</p>
<p>Multiple variants of NLCG exist.
They differ mainly in how the weights applied to conjugate directions are updated.
Two popular variants are implemented:</p>
<ul>
<li><p>The Fletcher-Reeves variant:</p>
<div class="math notranslate nohighlight">
\[\beta_k^\text{FR}
=
\frac{
  \Vert{\nabla f_{k+1}}\Vert_{2}^{2}
}{
  \Vert{\nabla f_{k}}\Vert_{2}^{2}
}.\]</div>
</li>
<li><p>The Polak-Ribière+ method:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\beta_k^\text{PR}
=
\frac{
  \nabla f_{k+1}^T\left(\nabla f_{k+1} - \nabla f_k\right)
}{
  \Vert{\nabla f_{k}}\Vert_{2}^{2}
} \\
\beta_k^\text{PR+}
=
\max\left(0, \beta_k^\text{PR}\right).\end{split}\]</div>
</li>
</ul>
<section id="id6">
<h3>Parameters (<code class="docutils literal notranslate"><span class="pre">__init__()</span></code>)<a class="headerlink" href="#id6" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>f</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.DiffFunc" title="pyxu.abc.operator.DiffFunc"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiffFunc</span></code></a>)
–
Differentiable function <span class="math notranslate nohighlight">\(\mathcal{F}\)</span>.</p></li>
<li><p><strong>**kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>)
–
Other keyword parameters passed on to <a class="reference internal" href="abc.html#pyxu.abc.solver.Solver.__init__" title="pyxu.abc.solver.Solver.__init__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pyxu.abc.solver.Solver.__init__()</span></code></a>.</p></li>
</ul>
</section>
<section id="id7">
<h3>Parameters (<code class="docutils literal notranslate"><span class="pre">fit()</span></code>)<a class="headerlink" href="#id7" title="Link to this heading">#</a></h3>
<ul>
<li><p><strong>x0</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-attr docutils literal notranslate"><span class="pre">NDArray</span></code></a>)
–
(…, N) initial point(s).</p></li>
<li><p><strong>variant</strong> (“PR”, “FR”)
–
Name of the NLCG variant to use:</p>
<ul class="simple">
<li><p>“PR”: Polak-Ribière+ variant (default).</p></li>
<li><p>“FR”: Fletcher-Reeves variant.</p></li>
</ul>
</li>
<li><p><strong>restart_rate</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Integer" title="pyxu.info.ptype.Integer"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Integer</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
Number of iterations after which restart is applied.</p>
<p>By default, restart is done after <span class="math notranslate nohighlight">\(N\)</span> iterations.</p>
</li>
<li><p><strong>**kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>)
–
Optional parameters forwarded to <a class="reference internal" href="math.html#pyxu.math.linesearch.backtracking_linesearch" title="pyxu.math.linesearch.backtracking_linesearch"><code class="xref py py-func docutils literal notranslate"><span class="pre">backtracking_linesearch()</span></code></a>.</p>
<p>If <code class="code docutils literal notranslate"><span class="pre">a0</span></code> is unspecified and <span class="math notranslate nohighlight">\(\nabla f\)</span> is <span class="math notranslate nohighlight">\(\beta\)</span>-Lipschitz continuous, then <code class="code docutils literal notranslate"><span class="pre">a0</span></code>
is auto-chosen as <span class="math notranslate nohighlight">\(\beta^{-1}\)</span>.
Users are expected to set <code class="code docutils literal notranslate"><span class="pre">a0</span></code> if its value cannot be auto-inferred.</p>
<p>Other keyword parameters are passed on to <a class="reference internal" href="abc.html#pyxu.abc.solver.Solver.fit" title="pyxu.abc.solver.Solver.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pyxu.abc.solver.Solver.fit()</span></code></a>.</p>
</li>
</ul>
<p class="rubric">Example</p>
<p>Consider the following quadratic optimization problem:</p>
<p>This problem is strictly convex, hence NLCG will converge to the optimal solution:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">import</span> <span class="nn">pyxu.operator</span> <span class="k">as</span> <span class="nn">pxo</span>
<span class="kn">import</span> <span class="nn">pyxu.opt.solver</span> <span class="k">as</span> <span class="nn">pxs</span>

<span class="n">N</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">pxo</span><span class="o">.</span><span class="n">SquaredL2Norm</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">asloss</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">argscale</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>  <span class="c1"># \norm(Ax - b)**2</span>

<span class="n">nlcg</span> <span class="o">=</span> <span class="n">pxs</span><span class="o">.</span><span class="n">NLCG</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="n">nlcg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x0</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="p">,)),</span> <span class="n">variant</span><span class="o">=</span><span class="s2">"FR"</span><span class="p">)</span>
<span class="n">x_opt</span> <span class="o">=</span> <span class="n">nlcg</span><span class="o">.</span><span class="n">solution</span><span class="p">()</span>
<span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">x_opt</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">a</span><span class="p">)</span>  <span class="c1"># True</span>
</pre></div>
</div>
<p>Note however that the CG method is preferable in this context since it omits the linesearch
overhead. The former depends on the cost of applying <span class="math notranslate nohighlight">\(A\)</span>, and may be significant.</p>
</section>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>f</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.DiffFunc" title="pyxu.abc.operator.DiffFunc"><em>DiffFunc</em></a>) – </p>
</dd>
</dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyxu.opt.solver.prox_adam.ProxAdam">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ProxAdam</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyxu/opt/solver/prox_adam.html#ProxAdam"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.opt.solver.prox_adam.ProxAdam" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="abc.html#pyxu.abc.solver.Solver" title="pyxu.abc.solver.Solver"><code class="xref py py-class docutils literal notranslate"><span class="pre">Solver</span></code></a></p>
<p>Proximal Adam solver <a class="reference internal" href="../references.html#proxadam" id="id8"><span>[ProxAdam]</span></a>.</p>
<p>ProxAdam minimizes</p>
<div class="math notranslate nohighlight">
\[{\min_{\mathbf{x}\in\mathbb{R}^N} \;\mathcal{F}(\mathbf{x})\;\;+\;\;\mathcal{G}(\mathbf{x})},\]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\mathcal{F}:\mathbb{R}^N\rightarrow \mathbb{R}\)</span> is <em>convex</em> and <em>differentiable</em>, with
<span class="math notranslate nohighlight">\(\beta\)</span>-<em>Lipschitz continuous</em> gradient, for some <span class="math notranslate nohighlight">\(\beta\in[0,+\infty[\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathcal{G}:\mathbb{R}^N\rightarrow \mathbb{R}\cup\{+\infty\}\)</span> is a <em>proper</em>, <em>lower
semicontinuous</em> and <em>convex function</em> with a <em>simple proximal operator</em>.</p></li>
</ul>
<p>ProxAdam is a suitable alternative to Proximal Gradient Descent
(<a class="reference internal" href="#pyxu.opt.solver.pgd.PGD" title="pyxu.opt.solver.pgd.PGD"><code class="xref py py-class docutils literal notranslate"><span class="pre">PGD</span></code></a>) when:</p>
<ul class="simple">
<li><p>computing <span class="math notranslate nohighlight">\(\beta\)</span> to optimally choose the step size is infeasible, and</p></li>
<li><p>line-search methods to estimate step sizes are too expensive.</p></li>
</ul>
<p>Compared to PGD, ProxAdam:</p>
<ul>
<li><p>auto-tunes gradient updates based on stochastic estimates of
<span class="math notranslate nohighlight">\(\phi_{t} = \mathbb{E}[\nabla\mathcal{F}]\)</span> and <span class="math notranslate nohighlight">\(\psi_{t} =
\mathbb{E}[\nabla\mathcal{F}^{2}]\)</span> respectively;</p></li>
<li><p>uses a modified proximity operator at each iteration to update coordinates at varying scales:</p>
<div class="math notranslate nohighlight">
\[\text{prox}_{\alpha\mathcal{G}}(\mathbf{x}_{t})
=
\min_{\mathbf{z}\in\mathbb{R}^N} \;\mathcal{G}(\mathbf{z})\;\;+\;\;\frac{1}{2\alpha}||\mathbf{z}-\mathbf{x}_t||_H^2,\]</div>
<p>where <span class="math notranslate nohighlight">\(H=\text{diag}(\psi_t)\)</span>.
The modified proximity operator is computed by solving a PGD sub-problem.</p>
</li>
</ul>
<p>ProxAdam has many named variants for particular choices of <span class="math notranslate nohighlight">\(\phi\)</span> and <span class="math notranslate nohighlight">\(\psi\)</span>:</p>
<ul>
<li><p>Adam:</p>
<div class="math notranslate nohighlight">
\[\phi_t
=
\frac{
  \mathbf{m}_t
}{
  1-\beta_1^t
}
\qquad
\psi_t
=
\sqrt{
  \frac{
    \mathbf{v}_t
  }{
    1-\beta_2^t
  }
} + \epsilon,\]</div>
</li>
<li><p>AMSGrad:</p>
<div class="math notranslate nohighlight">
\[\phi_t = \mathbf{m}_t
\qquad
\psi_t = \sqrt{\hat{\mathbf{v}}_t},\]</div>
</li>
<li><p>PAdam:</p>
<div class="math notranslate nohighlight">
\[\phi_t = \mathbf{m}_t
\qquad
\psi_t = \hat{\mathbf{v}}_t^p,\]</div>
</li>
</ul>
<p>where in all cases:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{m}_t
=
\beta_1\mathbf{m}_{t-1}
+
(1-\beta_1)\mathbf{g}_t \\
\mathbf{v}_t
=
\beta_2\mathbf{v}_{t-1}
+
(1-\beta_2)\mathbf{g}_t^2\\
\hat{\mathbf{v}}_t
=
\max(\hat{\mathbf{v}}_{t-1}, \mathbf{v}_t),\end{split}\]</div>
<p>with <span class="math notranslate nohighlight">\(\mathbf{m}_0 = \mathbf{v}_0 = \mathbf{0}\)</span>.</p>
<section id="id9">
<h3>Remarks<a class="headerlink" href="#id9" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>The algorithm is still valid if <span class="math notranslate nohighlight">\(\mathcal{G}\)</span> is zero.</p></li>
<li><p>The convergence is guaranteed for step sizes <span class="math notranslate nohighlight">\(\alpha\leq 2/\beta\)</span>.</p></li>
<li><p>The default stopping criterion is the relative norm change of the primal variable.
By default, the algorithm stops when the norm of the difference between two consecutive iterates
<span class="math notranslate nohighlight">\(\{\mathbf{x}_n\}_{n\in\mathbb{N}}\)</span> is smaller than 1e-4.
Different stopping criteria can be used.
It is recommended to change the stopping criterion when using the PAdam and AMSGrad variants to
avoid premature stops.
By default, the same stopping criterion is used for the proximal sub-problem.</p></li>
</ul>
</section>
<section id="id10">
<h3>Parameters (<code class="docutils literal notranslate"><span class="pre">__init__()</span></code>)<a class="headerlink" href="#id10" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>f</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.DiffFunc" title="pyxu.abc.operator.DiffFunc"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiffFunc</span></code></a>)
–
Differentiable function <span class="math notranslate nohighlight">\(\mathcal{F}\)</span>.</p></li>
<li><p><strong>g</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.ProxFunc" title="pyxu.abc.operator.ProxFunc"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProxFunc</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
Proximable function <span class="math notranslate nohighlight">\(\mathcal{G}\)</span>.</p></li>
<li><p><strong>**kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>)
–
Other keyword parameters passed on to <a class="reference internal" href="abc.html#pyxu.abc.solver.Solver.__init__" title="pyxu.abc.solver.Solver.__init__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pyxu.abc.solver.Solver.__init__()</span></code></a>.</p></li>
</ul>
</section>
<section id="id11">
<h3>Parameters (<code class="docutils literal notranslate"><span class="pre">fit()</span></code>)<a class="headerlink" href="#id11" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>x0</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-attr docutils literal notranslate"><span class="pre">NDArray</span></code></a>)
–
(…, N) initial point(s).</p></li>
<li><p><strong>variant</strong> (“adam”, “amsgrad”, “padam”)
–
Name of the ProxAdam variant to use.
Defaults to “adam”.</p></li>
<li><p><strong>a</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Real</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
Max normalized gradient step size.
Defaults to <span class="math notranslate nohighlight">\(1 / \beta\)</span> if unspecified.</p></li>
<li><p><strong>b1</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Real</span></code></a>)
–
1st-order gradient exponential decay <span class="math notranslate nohighlight">\(\beta_{1} \in [0, 1)\)</span>.</p></li>
<li><p><strong>b2</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Real</span></code></a>)
–
2nd-order gradient exponential decay <span class="math notranslate nohighlight">\(\beta_{2} \in [0, 1)\)</span>.</p></li>
<li><p><strong>m0</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-attr docutils literal notranslate"><span class="pre">NDArray</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
(…, N) initial 1st-order gradient estimate corresponding to each initial point.
Defaults to the null vector if unspecified.</p></li>
<li><p><strong>v0</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-attr docutils literal notranslate"><span class="pre">NDArray</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
(…, N) initial 2nd-order gradient estimate corresponding to each initial point.
Defaults to the null vector if unspecified.</p></li>
<li><p><strong>kwargs_sub</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
Keyword parameters used to initialize <a class="reference internal" href="#pyxu.opt.solver.pgd.PGD" title="pyxu.opt.solver.pgd.PGD"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PGD()</span></code></a>’s <code class="docutils literal notranslate"><span class="pre">__init__()</span></code> in
sub-problems.
This is an advanced option: use it with care.</p></li>
<li><p><strong>stop_crit_sub</strong> (<a class="reference internal" href="abc.html#pyxu.abc.solver.StoppingCriterion" title="pyxu.abc.solver.StoppingCriterion"><code class="xref py py-class docutils literal notranslate"><span class="pre">StoppingCriterion</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
Sub-problem stopping criterion.
Default: use same stopping criterion as main problem.</p></li>
<li><p><strong>p</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Real</span></code></a>)
–
PAdam power parameter <span class="math notranslate nohighlight">\(p \in (0, 0.5]\)</span>.
Must be specified for PAdam, unused otherwise.</p></li>
<li><p><strong>eps_adam</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Real</span></code></a>)
–
Adam noise parameter <span class="math notranslate nohighlight">\(\epsilon\)</span>.
This term is used exclusively if <code class="code docutils literal notranslate"><span class="pre">variant="adam"</span></code>.
Defaults to 1e-6.</p></li>
<li><p><strong>eps_var</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Real</span></code></a>)
–
Avoids division by zero if estimated gradient variance is too small.
Defaults to 1e-6.</p></li>
<li><p><strong>**kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>)
–
Other keyword parameters passed on to <a class="reference internal" href="abc.html#pyxu.abc.solver.Solver.fit" title="pyxu.abc.solver.Solver.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pyxu.abc.solver.Solver.fit()</span></code></a>.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If provided, <code class="code docutils literal notranslate"><span class="pre">m0</span></code> and <code class="code docutils literal notranslate"><span class="pre">v0</span></code> must be broadcastable with <code class="code docutils literal notranslate"><span class="pre">x0</span></code>.</p>
</div>
<p class="rubric">Example</p>
<p>Consider the following optimization problem:</p>
<div class="math notranslate nohighlight">
\[\min_{\mathbf{x}\in\mathbb{R}^N} \Vert{\mathbf{x}-\mathbf{1}}\Vert_2^2 + \Vert{\mathbf{x}-\mathbf{1}}\Vert_1\]</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">pyxu.operator.func</span> <span class="kn">import</span> <span class="n">L1Norm</span><span class="p">,</span> <span class="n">SquaredL2Norm</span>
<span class="kn">from</span> <span class="nn">pyxu.opt.solver</span> <span class="kn">import</span> <span class="n">ProxAdam</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">SquaredL2Norm</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">asloss</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">L1Norm</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">asloss</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">prox_adam</span> <span class="o">=</span> <span class="n">ProxAdam</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>
<span class="n">prox_adam</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">x0</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="p">,)),</span>
    <span class="n">variant</span><span class="o">=</span><span class="s2">"padam"</span><span class="p">,</span>
    <span class="n">p</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">x_opt</span> <span class="o">=</span> <span class="n">prox_adam</span><span class="o">.</span><span class="n">solution</span><span class="p">()</span>
<span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">x_opt</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># True</span>
</pre></div>
</div>
</section>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.DiffFunc" title="pyxu.abc.operator.DiffFunc"><em>DiffFunc</em></a>) – </p></li>
<li><p><strong>g</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.ProxFunc" title="pyxu.abc.operator.ProxFunc"><em>ProxFunc</em></a>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyxu.opt.solver.pds.CondatVu">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">CondatVu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyxu/opt/solver/pds.html#CondatVu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.opt.solver.pds.CondatVu" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">_PrimalDualSplitting</span></code></p>
<p>Condat-Vu (CV) primal-dual splitting algorithm.</p>
<p>This solver is also accessible via the alias <a class="reference internal" href="#pyxu.opt.solver.pds.CV" title="pyxu.opt.solver.pds.CV"><code class="xref py py-class docutils literal notranslate"><span class="pre">CV</span></code></a>.</p>
<p>The <em>Condat-Vu (CV)</em> primal-dual method is described in <a class="reference internal" href="../references.html#cvs" id="id12"><span>[CVS]</span></a>.
(This particular implementation is based on the pseudo-code Algorithm 7.1 provided in <a class="reference internal" href="../references.html#funcsphere" id="id13"><span>[FuncSphere]</span></a> Chapter 7, Section1.)</p>
<p>It can be used to solve problems of the form:</p>
<div class="math notranslate nohighlight">
\[{\min_{\mathbf{x}\in\mathbb{R}^N} \;\mathcal{F}(\mathbf{x})\;\;+\;\;\mathcal{G}(\mathbf{x})\;\;+\;\;\mathcal{H}(\mathcal{K} \mathbf{x})},\]</div>
<p>where:</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(\mathcal{F}:\mathbb{R}^N\rightarrow \mathbb{R}\)</span> is <em>convex</em> and <em>differentiable</em>, with <span class="math notranslate nohighlight">\(\beta\)</span>-<em>Lipschitz continuous</em> gradient,
for some <span class="math notranslate nohighlight">\(\beta\in[0,+\infty[\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathcal{G}:\mathbb{R}^N\rightarrow \mathbb{R}\cup\{+\infty\}\)</span> and <span class="math notranslate nohighlight">\(\mathcal{H}:\mathbb{R}^M\rightarrow \mathbb{R}\cup\{+\infty\}\)</span>
are <em>proper</em>, <em>lower semicontinuous</em> and <em>convex functions</em> with <em>simple proximal operators</em>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathcal{K}:\mathbb{R}^N\rightarrow \mathbb{R}^M\)</span> is a <em>differentiable map</em> (e.g. a <em>linear operator</em> <span class="math notranslate nohighlight">\(\mathbf{K}\)</span>), with <strong>operator norm</strong>:</p>
<div class="math notranslate nohighlight">
\[\Vert{\mathcal{K}}\Vert_2=\sup_{\mathbf{x}\in\mathbb{R}^N,\Vert\mathbf{x}\Vert_2=1} \Vert\mathcal{K}(\mathbf{x})\Vert_2.\]</div>
</li>
</ul>
<section id="id14">
<h3>Remarks<a class="headerlink" href="#id14" title="Link to this heading">#</a></h3>
<ul>
<li><p>The problem is <em>feasible</em>, i.e. there exists at least one solution.</p></li>
<li><p>The algorithm is still valid if one or more of the terms <span class="math notranslate nohighlight">\(\mathcal{F}\)</span>, <span class="math notranslate nohighlight">\(\mathcal{G}\)</span> or <span class="math notranslate nohighlight">\(\mathcal{H}\)</span> is zero.</p></li>
<li><p>The algorithm has convergence guarantees when <span class="math notranslate nohighlight">\(\mathcal{H}\)</span> is composed with a <em>linear operator</em> <span class="math notranslate nohighlight">\(\mathbf{K}\)</span>.
When <span class="math notranslate nohighlight">\(\mathcal{F}=0\)</span>, convergence can be proven for <em>non-linear differentiable maps</em> <span class="math notranslate nohighlight">\(\mathcal{K}\)</span> (see <a class="reference internal" href="../references.html#nlcp" id="id15"><span>[NLCP]</span></a>).
Note that <a class="reference internal" href="#pyxu.opt.solver.pds.CondatVu" title="pyxu.opt.solver.pds.CondatVu"><code class="xref py py-class docutils literal notranslate"><span class="pre">CondatVu</span></code></a> does not yet support automatic selection of hyperparameters for the case of <em>non-linear differentiable maps</em> <span class="math notranslate nohighlight">\(\mathcal{K}\)</span>.</p></li>
<li><p>Assume that either of the following holds:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\beta&gt;0\)</span> and:</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(\gamma \geq \frac{\beta}{2}\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(\frac{1}{\tau}-\sigma\Vert\mathbf{K}\Vert_{2}^2\geq \gamma\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(\rho \in ]0,\delta[\)</span>, where <span class="math notranslate nohighlight">\(\delta:=2-\frac{\beta}{2}\gamma^{-1}\in[1,2[\)</span> (<span class="math notranslate nohighlight">\(\delta=2\)</span> is possible when <span class="math notranslate nohighlight">\(\mathcal{F}\)</span> is <em>quadratic</em>
and <span class="math notranslate nohighlight">\(\gamma \geq \beta\)</span>, see <a class="reference internal" href="../references.html#psa" id="id16"><span>[PSA]</span></a>).</p></li>
</ul>
</li>
<li><p><span class="math notranslate nohighlight">\(\beta=0\)</span> and:</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(\tau\sigma\Vert\mathbf{K}\Vert_{2}^2\leq 1\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(\rho \in ]0,2[\)</span>.</p></li>
</ul>
</li>
</ul>
<p>Then there exists a pair <span class="math notranslate nohighlight">\((\mathbf{x}^\star,\mathbf{z}^\star)\in\mathbb{R}^N\times \mathbb{R}^M\)</span> solution s.t. the primal and dual sequences
of  estimates <span class="math notranslate nohighlight">\((\mathbf{x}_n)_{n\in\mathbb{N}}\)</span> and <span class="math notranslate nohighlight">\((\mathbf{z}_n)_{n\in\mathbb{N}}\)</span> <em>converge</em> towards <span class="math notranslate nohighlight">\(\mathbf{x}^\star\)</span> and
<span class="math notranslate nohighlight">\(\mathbf{z}^\star\)</span> respectively, i.e.</p>
<div class="math notranslate nohighlight">
\[\lim_{n\rightarrow +\infty}\Vert\mathbf{x}^\star-\mathbf{x}_n\Vert_2=0, \quad \text{and}
\quad
\lim_{n\rightarrow +\infty}\Vert\mathbf{z}^\star-\mathbf{z}_n\Vert_2=0.\]</div>
</li>
</ul>
</section>
<section id="id17">
<h3>Parameters (<code class="docutils literal notranslate"><span class="pre">__init__()</span></code>)<a class="headerlink" href="#id17" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>f</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.DiffFunc" title="pyxu.abc.operator.DiffFunc"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiffFunc</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
Differentiable function <span class="math notranslate nohighlight">\(\mathcal{F}\)</span>.</p></li>
<li><p><strong>g</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.ProxFunc" title="pyxu.abc.operator.ProxFunc"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProxFunc</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
Proximable function <span class="math notranslate nohighlight">\(\mathcal{G}\)</span>.</p></li>
<li><p><strong>h</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.ProxFunc" title="pyxu.abc.operator.ProxFunc"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProxFunc</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
Proximable function <span class="math notranslate nohighlight">\(\mathcal{H}\)</span>.</p></li>
<li><p><strong>K</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.DiffMap" title="pyxu.abc.operator.DiffMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiffMap</span></code></a>, <a class="reference internal" href="abc.html#pyxu.abc.operator.LinOp" title="pyxu.abc.operator.LinOp"><code class="xref py py-class docutils literal notranslate"><span class="pre">LinOp</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
Differentiable map or linear operator <span class="math notranslate nohighlight">\(\mathcal{K}\)</span>.</p></li>
<li><p><strong>beta</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Real</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
Lipschitz constant <span class="math notranslate nohighlight">\(\beta\)</span> of <span class="math notranslate nohighlight">\(\nabla\mathcal{F}\)</span>.
If not provided, it will be automatically estimated.</p></li>
<li><p><strong>**kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>)
–
Other keyword parameters passed on to <a class="reference internal" href="abc.html#pyxu.abc.solver.Solver.__init__" title="pyxu.abc.solver.Solver.__init__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pyxu.abc.solver.Solver.__init__()</span></code></a>.</p></li>
</ul>
</section>
<section id="id18">
<h3>Parameters (<code class="docutils literal notranslate"><span class="pre">fit()</span></code>)<a class="headerlink" href="#id18" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>x0</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-attr docutils literal notranslate"><span class="pre">NDArray</span></code></a>)
–
(…, N) initial point(s) for the primal variable.</p></li>
<li><p><strong>z0</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-attr docutils literal notranslate"><span class="pre">NDArray</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
(…, M) initial point(s) for the dual variable.
If <code class="docutils literal notranslate"><span class="pre">None</span></code> (default), then use <code class="docutils literal notranslate"><span class="pre">K(x0)</span></code> as the initial point for the dual variable.</p></li>
<li><p><strong>tau</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Real</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
Primal step size.</p></li>
<li><p><strong>sigma</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Real</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
Dual step size.</p></li>
<li><p><strong>rho</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Real</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
Momentum parameter.</p></li>
<li><p><strong>tuning_strategy</strong> (1, 2, 3)
–
Strategy to be employed when setting the hyperparameters (default to 1).
See section below for more details.</p></li>
<li><p><strong>**kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>)
–
Other keyword parameters passed on to <a class="reference internal" href="abc.html#pyxu.abc.solver.Solver.fit" title="pyxu.abc.solver.Solver.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pyxu.abc.solver.Solver.fit()</span></code></a>.</p></li>
</ul>
<p class="rubric">Default hyperparameter values</p>
<p>This class supports three strategies to automatically set the hyperparameters (see <a class="reference internal" href="../references.html#psa" id="id19"><span>[PSA]</span></a> for more details and numerical experiments
comparing the performance of the three strategies):</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">tuning_strategy</span> <span class="pre">==</span> <span class="pre">1</span></code>: <span class="math notranslate nohighlight">\(\gamma = \beta\)</span> (safe step sizes) and <span class="math notranslate nohighlight">\(\rho=1\)</span> (no relaxation).</p>
<p>This is the most standard way of setting the parameters in the literature.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">tuning_strategy</span> <span class="pre">==</span> <span class="pre">2</span></code>: <span class="math notranslate nohighlight">\(\gamma = \beta/1.9\)</span> (large step sizes) and <span class="math notranslate nohighlight">\(\rho=1\)</span> (no relaxation).</p>
<p>This strategy favours large step sizes forbidding the use of overrelaxation.
When <span class="math notranslate nohighlight">\(\beta=0\)</span>, coincides with the first strategy.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">tuning_strategy</span> <span class="pre">==</span> <span class="pre">3</span></code>: <span class="math notranslate nohighlight">\(\gamma = \beta\)</span> (safe step sizes) and <span class="math notranslate nohighlight">\(\rho=\delta - 0.1 &gt; 1\)</span> (overrelaxation).</p>
<p>This strategy chooses smaller step sizes, but performs overrelaxation.</p>
</li>
</ul>
<p>Once <span class="math notranslate nohighlight">\(\gamma\)</span> chosen, the convergence speed  of the algorithm is improved by choosing <span class="math notranslate nohighlight">\(\sigma\)</span> and <span class="math notranslate nohighlight">\(\tau\)</span> as
large as possible and relatively well-balanced – so that both the primal and dual variables converge at the same pace.
Whenever possible, we therefore choose perfectly balanced parameters <span class="math notranslate nohighlight">\(\sigma=\tau\)</span> saturating the convergence inequalities for a given value of <span class="math notranslate nohighlight">\(\gamma\)</span>.</p>
<ul>
<li><p>For <span class="math notranslate nohighlight">\(\beta&gt;0\)</span> and <span class="math notranslate nohighlight">\(\mathcal{H}\neq 0\)</span> this yields:</p>
<div class="math notranslate nohighlight">
\[\frac{1}{\tau}-\tau\Vert\mathbf{K}\Vert_{2}^2= \gamma \quad\Longleftrightarrow\quad -\tau^2\Vert\mathbf{K}\Vert_{2}^2-\gamma\tau+1=0,\]</div>
<p>which admits one positive root</p>
<div class="math notranslate nohighlight">
\[\tau=\sigma=\frac{1}{\Vert\mathbf{K}\Vert_{2}^2}\left(-\frac{\gamma}{2}+\sqrt{\frac{\gamma^2}{4}+\Vert\mathbf{K}\Vert_{2}^2}\right).\]</div>
</li>
<li><p>For <span class="math notranslate nohighlight">\(\beta&gt;0\)</span> and <span class="math notranslate nohighlight">\(\mathcal{H}=0\)</span> this yields: <span class="math notranslate nohighlight">\(\tau=1/\gamma.\)</span></p></li>
<li><p>For <span class="math notranslate nohighlight">\(\beta=0\)</span> this yields: <span class="math notranslate nohighlight">\(\tau=\sigma=\Vert\mathbf{K}\Vert_{2}^{-1}\)</span>.</p></li>
</ul>
<p>When <span class="math notranslate nohighlight">\(\tau\)</span> is provided (<span class="math notranslate nohighlight">\(\tau = \tau_{1}\)</span>), but not <span class="math notranslate nohighlight">\(\sigma\)</span>, the latter is chosen as:</p>
<div class="math notranslate nohighlight">
\[\frac{1}{\tau_{1}}-\sigma\Vert\mathbf{K}\Vert_{2}^2= \gamma \quad\Longleftrightarrow\quad \sigma=\left(\frac{1}{\tau_{1}}-\gamma\right)\frac{1}{\Vert\mathbf{K}\Vert_{2}^2}.\]</div>
<p>When <span class="math notranslate nohighlight">\(\sigma\)</span> is provided (<span class="math notranslate nohighlight">\(\sigma = \sigma_{1}\)</span>), but not <span class="math notranslate nohighlight">\(\tau\)</span>, the latter is chosen as:</p>
<div class="math notranslate nohighlight">
\[\frac{1}{\tau}-\sigma_{1}\Vert\mathbf{K}\Vert_{2}^2= \gamma \quad\Longleftrightarrow\quad \tau=\frac{1}{\left(\gamma+\sigma_{1}\Vert\mathbf{K}\Vert_{2}^2\right)}.\]</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When values are provided for both <span class="math notranslate nohighlight">\(\tau\)</span> and <span class="math notranslate nohighlight">\(\sigma\)</span>, it is assumed that the latter satisfy the
convergence inequalities, but no check is explicitly performed.
Automatic selection of hyperparameters for the case of non-linear differentiable maps <span class="math notranslate nohighlight">\(\mathcal{K}\)</span> is not supported yet.</p>
</div>
<p class="rubric">Example</p>
<p>Consider the following optimisation problem:</p>
<div class="math notranslate nohighlight">
\[\min_{\mathbf{x}\in\mathbb{R}_+^N}\frac{1}{2}\left\|\mathbf{y}-\mathbf{G}\mathbf{x}\right\|_2^2\quad+\quad\lambda_1 \|\mathbf{D}\mathbf{x}\|_1\quad+\quad\lambda_2 \|\mathbf{x}\|_1,\]</div>
<p>with <span class="math notranslate nohighlight">\(\mathbf{D}\in\mathbb{R}^{N\times N}\)</span> the discrete derivative operator and <span class="math notranslate nohighlight">\(\mathbf{G}\in\mathbb{R}^{L\times N}, \, \mathbf{y}\in\mathbb{R}^L, \lambda_1,\lambda_2&gt;0.\)</span>
This problem can be solved via PDS with <span class="math notranslate nohighlight">\(\mathcal{F}(\mathbf{x})= \frac{1}{2}\left\|\mathbf{y}-\mathbf{G}\mathbf{x}\right\|_2^2\)</span>, <span class="math notranslate nohighlight">\(\mathcal{G}(\mathbf{x})=\lambda_2\|\mathbf{x}\|_1,\)</span>
<span class="math notranslate nohighlight">\(\mathcal{H}(\mathbf{x})=\lambda \|\mathbf{x}\|_1\)</span> and <span class="math notranslate nohighlight">\(\mathbf{K}=\mathbf{D}\)</span>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/pyplot_summary.html#module-matplotlib.pyplot" title="matplotlib.pyplot"><span class="nn">matplotlib.pyplot</span></a> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/index.html#module-numpy" title="numpy"><span class="nn">numpy</span></a> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pyxu.operator</span> <span class="k">as</span> <span class="nn">pxo</span>
<span class="kn">from</span> <span class="nn">pyxu.experimental._dev</span> <span class="kn">import</span> <span class="n">DownSampling</span><span class="p">,</span> <span class="n">FirstDerivative</span>
<span class="kn">from</span> <span class="nn">pyxu.opt.solver</span> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../api/opt.html#pyxu.opt.solver.pds.CondatVu" title="pyxu.opt.solver.pds.CondatVu"><span class="n">CV</span></a>

<span class="n">x</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.repeat.html#numpy.repeat" title="numpy.repeat"><span class="n">np</span><span class="o">.</span><span class="n">repeat</span></a><span class="p">(</span><a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.asarray.html#numpy.asarray" title="numpy.asarray"><span class="n">np</span><span class="o">.</span><span class="n">asarray</span></a><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">N</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">size</span>

<span class="n">D</span> <span class="o">=</span> <span class="n">FirstDerivative</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">"forward"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="../api/abc.html#pyxu.abc.operator.Map.lipschitz" title="pyxu.abc.operator.Map.lipschitz"><span class="n">D</span><span class="o">.</span><span class="n">lipschitz</span></a> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../api/abc.html#pyxu.abc.operator.LinOp.estimate_lipschitz" title="pyxu.abc.operator.LinOp.estimate_lipschitz"><span class="n">D</span><span class="o">.</span><span class="n">estimate_lipschitz</span></a><span class="p">()</span>

<span class="n">downsample</span> <span class="o">=</span> <span class="n">DownSampling</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">downsampling_factor</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">downsample</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">loss</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <a class="sphinx-codeautolink-a" href="../api/operator/func.html#pyxu.operator.func.norm.SquaredL2Norm" title="pyxu.operator.func.norm.SquaredL2Norm"><span class="n">pxo</span><span class="o">.</span><span class="n">SquaredL2Norm</span></a><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">size</span><span class="p">)</span><span class="o">.</span><a class="sphinx-codeautolink-a" href="../api/abc.html#pyxu.abc.operator.Operator.argshift" title="pyxu.abc.operator.Operator.argshift"><span class="n">argshift</span></a><span class="p">(</span><span class="o">-</span><span class="n">y</span><span class="p">)</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">loss</span> <span class="o">*</span> <span class="n">downsample</span>
<span class="n">F</span><span class="o">.</span><span class="n">diff_lipschitz</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">estimate_diff_lipschitz</span><span class="p">()</span>

<a class="sphinx-codeautolink-a" href="../api/opt.html#pyxu.opt.solver.pds.CondatVu" title="pyxu.opt.solver.pds.CondatVu"><span class="n">cv</span></a> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../api/opt.html#pyxu.opt.solver.pds.CondatVu" title="pyxu.opt.solver.pds.CondatVu"><span class="n">CV</span></a><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">F</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mf">0.01</span> <span class="o">*</span> <a class="sphinx-codeautolink-a" href="../api/operator/func.html#pyxu.operator.func.norm.L1Norm" title="pyxu.operator.func.norm.L1Norm"><span class="n">pxo</span><span class="o">.</span><span class="n">L1Norm</span></a><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">h</span><span class="o">=</span><span class="mf">0.1</span> <span class="o">*</span> <a class="sphinx-codeautolink-a" href="../api/operator/func.html#pyxu.operator.func.norm.L1Norm" title="pyxu.operator.func.norm.L1Norm"><span class="n">pxo</span><span class="o">.</span><span class="n">L1Norm</span></a><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">K</span><span class="o">=</span><span class="n">D</span><span class="p">)</span>
<span class="n">x0</span><span class="p">,</span> <span class="n">z0</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="p">))</span>
<a class="sphinx-codeautolink-a" href="../api/abc.html#pyxu.abc.solver.Solver.fit" title="pyxu.abc.solver.Solver.fit"><span class="n">cv</span><span class="o">.</span><span class="n">fit</span></a><span class="p">(</span><span class="n">x0</span><span class="o">=</span><span class="n">x0</span><span class="p">,</span> <span class="n">z0</span><span class="o">=</span><span class="n">z0</span><span class="p">)</span>
<span class="n">x_recons</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../api/abc.html#pyxu.abc.solver.Solver.solution" title="pyxu.abc.solver.Solver.solution"><span class="n">cv</span><span class="o">.</span><span class="n">solution</span></a><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.stem.html#matplotlib.pyplot.stem" title="matplotlib.pyplot.stem"><span class="n">plt</span><span class="o">.</span><span class="n">stem</span></a><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">linefmt</span><span class="o">=</span><span class="s2">"C0-"</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s2">"C0o"</span><span class="p">)</span>
<span class="n">mask_ids</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.where.html#numpy.where" title="numpy.where"><span class="n">np</span><span class="o">.</span><span class="n">where</span></a><span class="p">(</span><span class="n">downsample</span><span class="o">.</span><span class="n">downsampling_mask</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">markerline</span><span class="p">,</span> <span class="n">stemlines</span><span class="p">,</span> <span class="n">baseline</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.stem.html#matplotlib.pyplot.stem" title="matplotlib.pyplot.stem"><span class="n">plt</span><span class="o">.</span><span class="n">stem</span></a><span class="p">(</span><span class="n">mask_ids</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">linefmt</span><span class="o">=</span><span class="s2">"C3-"</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s2">"C3o"</span><span class="p">)</span>
<span class="n">markerline</span><span class="o">.</span><span class="n">set_markerfacecolor</span><span class="p">(</span><span class="s2">"none"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.stem.html#matplotlib.pyplot.stem" title="matplotlib.pyplot.stem"><span class="n">plt</span><span class="o">.</span><span class="n">stem</span></a><span class="p">(</span><span class="n">x_recons</span><span class="p">,</span> <span class="n">linefmt</span><span class="o">=</span><span class="s2">"C1--"</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s2">"C1s"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.legend.html#matplotlib.pyplot.legend" title="matplotlib.pyplot.legend"><span class="n">plt</span><span class="o">.</span><span class="n">legend</span></a><span class="p">([</span><span class="s2">"Ground truth"</span><span class="p">,</span> <span class="s2">"Observation"</span><span class="p">,</span> <span class="s2">"CV Estimate"</span><span class="p">])</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../_downloads/f2dd49c204e444011bf0c8ee51349779/opt-1.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../_downloads/3e00ef9813368e3b18ae614801b6914c/opt-1.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/9db61dbdbb51645a825c3d21408069d0/opt-1.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/7a45a92466c43f54218138bd4c5bfb33/opt-1.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../_images/opt-1.png" class="plot-directive" src="../_images/opt-1.png"/>
</figure>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyxu.opt.solver.pds.CV" title="pyxu.opt.solver.pds.CV"><code class="xref py py-class docutils literal notranslate"><span class="pre">CV</span></code></a>, <a class="reference internal" href="#pyxu.opt.solver.pds.PD3O" title="pyxu.opt.solver.pds.PD3O"><code class="xref py py-class docutils literal notranslate"><span class="pre">PD3O</span></code></a>, <a class="reference internal" href="#pyxu.opt.solver.pds.ChambollePock" title="pyxu.opt.solver.pds.ChambollePock"><code class="xref py py-class docutils literal notranslate"><span class="pre">ChambollePock</span></code></a>, <a class="reference internal" href="#pyxu.opt.solver.pds.DouglasRachford" title="pyxu.opt.solver.pds.DouglasRachford"><code class="xref py py-class docutils literal notranslate"><span class="pre">DouglasRachford</span></code></a></p>
</div>
</section>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.DiffFunc" title="pyxu.abc.operator.DiffFunc"><em>DiffFunc</em></a><em> | </em><em>None</em>) – </p></li>
<li><p><strong>g</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.ProxFunc" title="pyxu.abc.operator.ProxFunc"><em>ProxFunc</em></a><em> | </em><em>None</em>) – </p></li>
<li><p><strong>h</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.ProxFunc" title="pyxu.abc.operator.ProxFunc"><em>ProxFunc</em></a><em> | </em><em>None</em>) – </p></li>
<li><p><strong>K</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.DiffMap" title="pyxu.abc.operator.DiffMap"><em>DiffMap</em></a><em> | </em><em>None</em>) – </p></li>
<li><p><strong>beta</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="numbers.Real"><em>Real</em></a><em> | </em><em>None</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyxu.opt.solver.pds.CV">
<span class="sig-name descname"><span class="pre">CV</span></span><a class="headerlink" href="#pyxu.opt.solver.pds.CV" title="Link to this definition">#</a></dt>
<dd><p>Alias of <a class="reference internal" href="#pyxu.opt.solver.pds.CondatVu" title="pyxu.opt.solver.pds.CondatVu"><code class="xref py py-class docutils literal notranslate"><span class="pre">CondatVu</span></code></a>.</p>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyxu.opt.solver.pds.PD3O">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PD3O</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyxu/opt/solver/pds.html#PD3O"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.opt.solver.pds.PD3O" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">_PrimalDualSplitting</span></code></p>
<p>Primal-Dual Three-Operator Splitting (PD3O) algorithm.</p>
<p>The <em>Primal-Dual three Operator splitting (PD3O)</em> method is described in <a class="reference internal" href="../references.html#pd3o" id="id20"><span>[PD3O]</span></a>.</p>
<p>It can be used to solve problems of the form:</p>
<div class="math notranslate nohighlight">
\[{\min_{\mathbf{x}\in\mathbb{R}^N} \;\Psi(\mathbf{x}):=\mathcal{F}(\mathbf{x})\;\;+\;\;\mathcal{G}(\mathbf{x})\;\;+\;\;\mathcal{H}(\mathcal{K} \mathbf{x}),}\]</div>
<p>where:</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(\mathcal{F}:\mathbb{R}^N\rightarrow \mathbb{R}\)</span> is <em>convex</em> and <em>differentiable</em>, with <span class="math notranslate nohighlight">\(\beta\)</span>-<em>Lipschitz continuous</em> gradient,
for some <span class="math notranslate nohighlight">\(\beta\in[0,+\infty[\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathcal{G}:\mathbb{R}^N\rightarrow \mathbb{R}\cup\{+\infty\}\)</span> and <span class="math notranslate nohighlight">\(\mathcal{H}:\mathbb{R}^M\rightarrow \mathbb{R}\cup\{+\infty\}\)</span> are <em>proper</em>, <em>lower semicontinuous</em> and <em>convex functions</em> with <em>simple proximal operators</em>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathcal{K}:\mathbb{R}^N\rightarrow \mathbb{R}^M\)</span> is a <em>differentiable map</em> (e.g. a <em>linear operator</em> <span class="math notranslate nohighlight">\(\mathbf{K}\)</span>), with <strong>operator norm</strong>:</p>
<div class="math notranslate nohighlight">
\[\Vert{\mathcal{K}}\Vert_2=\sup_{\mathbf{x}\in\mathbb{R}^N,\Vert\mathbf{x}\Vert_2=1} \Vert\mathcal{K}(\mathbf{x})\Vert_2.\]</div>
</li>
</ul>
<section id="id21">
<h3>Remarks<a class="headerlink" href="#id21" title="Link to this heading">#</a></h3>
<ul>
<li><p>The problem is <em>feasible</em> – i.e. there exists at least one solution.</p></li>
<li><p>The algorithm is still valid if one or more of the terms <span class="math notranslate nohighlight">\(\mathcal{F}\)</span>, <span class="math notranslate nohighlight">\(\mathcal{G}\)</span> or <span class="math notranslate nohighlight">\(\mathcal{H}\)</span> is zero.</p></li>
<li><p>The algorithm has convergence guarantees for the case in which <span class="math notranslate nohighlight">\(\mathcal{H}\)</span> is composed with a <em>linear operator</em> <span class="math notranslate nohighlight">\(\mathbf{K}\)</span>.
When <span class="math notranslate nohighlight">\(\mathcal{F}=0\)</span>, convergence can be proven for <em>non-linear differentiable maps</em> <span class="math notranslate nohighlight">\(\mathcal{K}\)</span>. (See <a class="reference internal" href="../references.html#nlcp" id="id22"><span>[NLCP]</span></a>.)
Note that this class does not yet support automatic selection of hyperparameters for the case of <em>non-linear differentiable maps</em> <span class="math notranslate nohighlight">\(\mathcal{K}\)</span>.</p></li>
<li><p>Assume that the following holds:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\gamma\geq\frac{\beta}{2}\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(\tau \in ]0, \frac{1}{\gamma}[\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(\tau\sigma\Vert\mathbf{K}\Vert_{2}^2 \leq 1\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(\delta = 2-\beta\tau/2 \in [1, 2[\)</span> and <span class="math notranslate nohighlight">\(\rho \in (0, \delta]\)</span>.</p></li>
</ul>
<p>Then there exists a pair <span class="math notranslate nohighlight">\((\mathbf{x}^\star,\mathbf{z}^\star)\in\mathbb{R}^N\times \mathbb{R}^M\)</span> solution
s.t. the primal and dual sequences of  estimates <span class="math notranslate nohighlight">\((\mathbf{x}_n)_{n\in\mathbb{N}}\)</span> and <span class="math notranslate nohighlight">\((\mathbf{z}_n)_{n\in\mathbb{N}}\)</span>
<em>converge</em> towards <span class="math notranslate nohighlight">\(\mathbf{x}^\star\)</span> and <span class="math notranslate nohighlight">\(\mathbf{z}^\star\)</span> respectively (Theorem 8.2 of <a class="reference internal" href="../references.html#psa" id="id23"><span>[PSA]</span></a>), i.e.</p>
<div class="math notranslate nohighlight">
\[\lim_{n\rightarrow +\infty}\Vert\mathbf{x}^\star-\mathbf{x}_n\Vert_2=0, \quad \text{and} \quad  \lim_{n\rightarrow +\infty}\Vert\mathbf{z}^\star-\mathbf{z}_n\Vert_2=0.\]</div>
<p>Futhermore, when <span class="math notranslate nohighlight">\(\rho=1\)</span>, the objective functional sequence <span class="math notranslate nohighlight">\(\left(\Psi(\mathbf{x}_n)\right)_{n\in\mathbb{N}}\)</span> can be shown to converge towards
its minimum <span class="math notranslate nohighlight">\(\Psi^\ast\)</span> with rate <span class="math notranslate nohighlight">\(o(1/\sqrt{n})\)</span> (Theorem 1 of <a class="reference internal" href="../references.html#dpsa" id="id24"><span>[dPSA]</span></a>):</p>
<div class="math notranslate nohighlight">
\[\Psi(\mathbf{x}_n) - \Psi^\ast = o(1/\sqrt{n}).\]</div>
</li>
</ul>
</section>
<section id="id25">
<h3>Parameters (<code class="docutils literal notranslate"><span class="pre">__init__()</span></code>)<a class="headerlink" href="#id25" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>f</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.DiffFunc" title="pyxu.abc.operator.DiffFunc"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiffFunc</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
Differentiable function <span class="math notranslate nohighlight">\(\mathcal{F}\)</span>.</p></li>
<li><p><strong>g</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.ProxFunc" title="pyxu.abc.operator.ProxFunc"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProxFunc</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
Proximable function <span class="math notranslate nohighlight">\(\mathcal{G}\)</span>.</p></li>
<li><p><strong>h</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.ProxFunc" title="pyxu.abc.operator.ProxFunc"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProxFunc</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
Proximable function <span class="math notranslate nohighlight">\(\mathcal{H}\)</span>.</p></li>
<li><p><strong>K</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.DiffMap" title="pyxu.abc.operator.DiffMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiffMap</span></code></a>, <a class="reference internal" href="abc.html#pyxu.abc.operator.LinOp" title="pyxu.abc.operator.LinOp"><code class="xref py py-class docutils literal notranslate"><span class="pre">LinOp</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
Differentiable map or linear operator <span class="math notranslate nohighlight">\(\mathcal{K}\)</span>.</p></li>
<li><p><strong>beta</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Real</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
Lipschitz constant <span class="math notranslate nohighlight">\(\beta\)</span> of <span class="math notranslate nohighlight">\(\nabla\mathcal{F}\)</span>.
If not provided, it will be automatically estimated.</p></li>
<li><p><strong>**kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>)
–
Other keyword parameters passed on to <a class="reference internal" href="abc.html#pyxu.abc.solver.Solver.__init__" title="pyxu.abc.solver.Solver.__init__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pyxu.abc.solver.Solver.__init__()</span></code></a>.</p></li>
</ul>
</section>
<section id="id26">
<h3>Parameters (<code class="docutils literal notranslate"><span class="pre">fit()</span></code>)<a class="headerlink" href="#id26" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>x0</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-attr docutils literal notranslate"><span class="pre">NDArray</span></code></a>)
–
(…, N) initial point(s) for the primal variable.</p></li>
<li><p><strong>z0</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-attr docutils literal notranslate"><span class="pre">NDArray</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
(…, M) initial point(s) for the dual variable.
If <code class="docutils literal notranslate"><span class="pre">None</span></code> (default), then use <code class="docutils literal notranslate"><span class="pre">K(x0)</span></code> as the initial point for the dual variable.</p></li>
<li><p><strong>tau</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Real</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
Primal step size.</p></li>
<li><p><strong>sigma</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Real</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
Dual step size.</p></li>
<li><p><strong>rho</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Real</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
Momentum parameter.</p></li>
<li><p><strong>tuning_strategy</strong> (1, 2, 3)
–
Strategy to be employed when setting the hyperparameters (default to 1).
See section below for more details.</p></li>
<li><p><strong>**kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>)
–
Other keyword parameters passed on to <a class="reference internal" href="abc.html#pyxu.abc.solver.Solver.fit" title="pyxu.abc.solver.Solver.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pyxu.abc.solver.Solver.fit()</span></code></a>.</p></li>
</ul>
<p class="rubric">Default hyperparameter values</p>
<p>This class supports three strategies to automatically set the hyperparameters (see <a class="reference internal" href="../references.html#psa" id="id27"><span>[PSA]</span></a> for more details and numerical experiments
comparing the performance of the three strategies):</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">tuning_strategy</span> <span class="pre">==</span> <span class="pre">1</span></code>: <span class="math notranslate nohighlight">\(\gamma = \beta\)</span> (safe step sizes) and <span class="math notranslate nohighlight">\(\rho=1\)</span> (no relaxation).</p>
<p>This is the most standard way of setting the parameters in the literature.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">tuning_strategy</span> <span class="pre">==</span> <span class="pre">2</span></code>: <span class="math notranslate nohighlight">\(\gamma = \beta/1.9\)</span> (large step sizes) and <span class="math notranslate nohighlight">\(\rho=1\)</span> (no relaxation).</p>
<p>This strategy favours large step sizes forbidding the use of overrelaxation.
When <span class="math notranslate nohighlight">\(\beta=0\)</span>, coincides with the first strategy.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">tuning_strategy</span> <span class="pre">==</span> <span class="pre">3</span></code>: <span class="math notranslate nohighlight">\(\gamma = \beta\)</span> (safe step sizes) and <span class="math notranslate nohighlight">\(\rho=\delta - 0.1 &gt; 1\)</span> (overrelaxation).</p>
<p>This strategy chooses smaller step sizes, but performs overrelaxation.</p>
</li>
</ul>
<p>Once <span class="math notranslate nohighlight">\(\gamma\)</span> chosen, the convergence speed  of the algorithm is improved by choosing <span class="math notranslate nohighlight">\(\sigma\)</span> and <span class="math notranslate nohighlight">\(\tau\)</span> as
large as possible and relatively well-balanced – so that both the primal and dual variables converge at the same pace.
Whenever possible, we therefore choose perfectly balanced parameters <span class="math notranslate nohighlight">\(\sigma=\tau\)</span> saturating the convergence inequalities for a given value of <span class="math notranslate nohighlight">\(\gamma\)</span>.</p>
<p>In practice, the following linear programming optimization problem is solved:</p>
<div class="math notranslate nohighlight">
\[\begin{split}(\tau, \, \sigma) = \operatorname{arg} \max_{(\tau^{*}, \,  \sigma^{*})} \quad &amp; \operatorname{log}(\tau^{*}) + \operatorname{log}(\sigma^{*})\\
\text{s.t.} \quad &amp; \operatorname{log}(\tau^{*}) + \operatorname{log}(\sigma^{*}) \leq 2\operatorname{log}(\Vert\mathbf{K}\Vert_{2})\\
&amp; \operatorname{log}(\tau^{*}) \leq -\operatorname{log}(\gamma)\\
&amp; \operatorname{log}(\tau^{*}) = \operatorname{log}(\sigma^{*}).\end{split}\]</div>
<p>When <span class="math notranslate nohighlight">\(\tau \leq 1/\gamma\)</span> is given (i.e., <span class="math notranslate nohighlight">\(\tau=\tau_{1}\)</span>), but not <span class="math notranslate nohighlight">\(\sigma\)</span>, the latter is chosen as:</p>
<div class="math notranslate nohighlight">
\[\tau_{1}\sigma\Vert\mathbf{K}\Vert_{2}^2= 1 \quad\Longleftrightarrow\quad \sigma=\frac{1}{\tau_{1}\Vert\mathbf{K}\Vert_{2}^{2}}.\]</div>
<p>When <span class="math notranslate nohighlight">\(\sigma\)</span> is given (i.e., <span class="math notranslate nohighlight">\(\sigma=\sigma_{1}\)</span>), but not <span class="math notranslate nohighlight">\(\tau\)</span>, the latter is chosen as:</p>
<div class="math notranslate nohighlight">
\[\tau = \min \left\{\frac{1}{\gamma}, \frac{1}{\sigma_{1}\Vert\mathbf{K}\Vert_{2}^{2}}\right\}.\]</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When values are provided for both <span class="math notranslate nohighlight">\(\tau\)</span> and <span class="math notranslate nohighlight">\(\sigma\)</span>, it is assumed that the latter satisfy the
convergence inequalities, but no check is explicitly performed.
Automatic selection of hyperparameters for the case of non-linear differentiable maps <span class="math notranslate nohighlight">\(\mathcal{K}\)</span> is not supported yet.</p>
</div>
<p class="rubric">Example</p>
<p>Consider the following optimisation problem:</p>
<div class="math notranslate nohighlight">
\[\min_{\mathbf{x}\in\mathbb{R}_+^N}\frac{1}{2}\left\|\mathbf{y}-\mathbf{G}\mathbf{x}\right\|_2^2\quad+\quad\lambda_1 \|\mathbf{D}\mathbf{x}\|_1\quad+\quad\lambda_2 \|\mathbf{x}\|_1,\]</div>
<p>with <span class="math notranslate nohighlight">\(\mathbf{D}\in\mathbb{R}^{N\times N}\)</span> the discrete derivative operator and <span class="math notranslate nohighlight">\(\mathbf{G}\in\mathbb{R}^{L\times N}, \, \mathbf{y}\in\mathbb{R}^L, \lambda_1,\lambda_2&gt;0.\)</span>
This problem can be solved via PD3O with <span class="math notranslate nohighlight">\(\mathcal{F}(\mathbf{x})= \frac{1}{2}\left\|\mathbf{y}-\mathbf{G}\mathbf{x}\right\|_2^2\)</span>, <span class="math notranslate nohighlight">\(\mathcal{G}(\mathbf{x})=\lambda_2\|\mathbf{x}\|_1,\)</span>
<span class="math notranslate nohighlight">\(\mathcal{H}(\mathbf{x})=\lambda \|\mathbf{x}\|_1\)</span> and <span class="math notranslate nohighlight">\(\mathbf{K}=\mathbf{D}\)</span>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/pyplot_summary.html#module-matplotlib.pyplot" title="matplotlib.pyplot"><span class="nn">matplotlib.pyplot</span></a> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/index.html#module-numpy" title="numpy"><span class="nn">numpy</span></a> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pyxu.operator</span> <span class="k">as</span> <span class="nn">pxo</span>
<span class="kn">from</span> <span class="nn">pyxu.experimental._dev</span> <span class="kn">import</span> <span class="n">DownSampling</span><span class="p">,</span> <span class="n">FirstDerivative</span>
<span class="kn">from</span> <span class="nn">pyxu.opt.solver</span> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../api/opt.html#pyxu.opt.solver.pds.PD3O" title="pyxu.opt.solver.pds.PD3O"><span class="n">PD3O</span></a>

<span class="n">x</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.repeat.html#numpy.repeat" title="numpy.repeat"><span class="n">np</span><span class="o">.</span><span class="n">repeat</span></a><span class="p">(</span><a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.asarray.html#numpy.asarray" title="numpy.asarray"><span class="n">np</span><span class="o">.</span><span class="n">asarray</span></a><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">N</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">size</span>

<span class="n">D</span> <span class="o">=</span> <span class="n">FirstDerivative</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">"forward"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="../api/abc.html#pyxu.abc.operator.Map.lipschitz" title="pyxu.abc.operator.Map.lipschitz"><span class="n">D</span><span class="o">.</span><span class="n">lipschitz</span></a> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../api/abc.html#pyxu.abc.operator.LinOp.estimate_lipschitz" title="pyxu.abc.operator.LinOp.estimate_lipschitz"><span class="n">D</span><span class="o">.</span><span class="n">estimate_lipschitz</span></a><span class="p">()</span>

<span class="n">downsample</span> <span class="o">=</span> <span class="n">DownSampling</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">downsampling_factor</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">downsample</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">loss</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <a class="sphinx-codeautolink-a" href="../api/operator/func.html#pyxu.operator.func.norm.SquaredL2Norm" title="pyxu.operator.func.norm.SquaredL2Norm"><span class="n">pxo</span><span class="o">.</span><span class="n">SquaredL2Norm</span></a><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">size</span><span class="p">)</span><span class="o">.</span><a class="sphinx-codeautolink-a" href="../api/abc.html#pyxu.abc.operator.Operator.argshift" title="pyxu.abc.operator.Operator.argshift"><span class="n">argshift</span></a><span class="p">(</span><span class="o">-</span><span class="n">y</span><span class="p">)</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">loss</span> <span class="o">*</span> <span class="n">downsample</span>
<span class="n">F</span><span class="o">.</span><span class="n">diff_lipschitz</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">estimate_diff_lipschitz</span><span class="p">()</span>

<a class="sphinx-codeautolink-a" href="../api/opt.html#pyxu.opt.solver.pds.PD3O" title="pyxu.opt.solver.pds.PD3O"><span class="n">pd3o</span></a> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../api/opt.html#pyxu.opt.solver.pds.PD3O" title="pyxu.opt.solver.pds.PD3O"><span class="n">PD3O</span></a><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">F</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mf">0.01</span> <span class="o">*</span> <a class="sphinx-codeautolink-a" href="../api/operator/func.html#pyxu.operator.func.norm.L1Norm" title="pyxu.operator.func.norm.L1Norm"><span class="n">pxo</span><span class="o">.</span><span class="n">L1Norm</span></a><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">h</span><span class="o">=</span><span class="mf">0.1</span> <span class="o">*</span> <a class="sphinx-codeautolink-a" href="../api/operator/func.html#pyxu.operator.func.norm.L1Norm" title="pyxu.operator.func.norm.L1Norm"><span class="n">pxo</span><span class="o">.</span><span class="n">L1Norm</span></a><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">K</span><span class="o">=</span><span class="n">D</span><span class="p">)</span>
<span class="n">x0</span><span class="p">,</span> <span class="n">z0</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="p">))</span>
<a class="sphinx-codeautolink-a" href="../api/abc.html#pyxu.abc.solver.Solver.fit" title="pyxu.abc.solver.Solver.fit"><span class="n">pd3o</span><span class="o">.</span><span class="n">fit</span></a><span class="p">(</span><span class="n">x0</span><span class="o">=</span><span class="n">x0</span><span class="p">,</span> <span class="n">z0</span><span class="o">=</span><span class="n">z0</span><span class="p">)</span>
<span class="n">x_recons</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../api/abc.html#pyxu.abc.solver.Solver.solution" title="pyxu.abc.solver.Solver.solution"><span class="n">pd3o</span><span class="o">.</span><span class="n">solution</span></a><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.stem.html#matplotlib.pyplot.stem" title="matplotlib.pyplot.stem"><span class="n">plt</span><span class="o">.</span><span class="n">stem</span></a><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">linefmt</span><span class="o">=</span><span class="s2">"C0-"</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s2">"C0o"</span><span class="p">)</span>
<span class="n">mask_ids</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.where.html#numpy.where" title="numpy.where"><span class="n">np</span><span class="o">.</span><span class="n">where</span></a><span class="p">(</span><span class="n">downsample</span><span class="o">.</span><span class="n">downsampling_mask</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">markerline</span><span class="p">,</span> <span class="n">stemlines</span><span class="p">,</span> <span class="n">baseline</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.stem.html#matplotlib.pyplot.stem" title="matplotlib.pyplot.stem"><span class="n">plt</span><span class="o">.</span><span class="n">stem</span></a><span class="p">(</span><span class="n">mask_ids</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">linefmt</span><span class="o">=</span><span class="s2">"C3-"</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s2">"C3o"</span><span class="p">)</span>
<span class="n">markerline</span><span class="o">.</span><span class="n">set_markerfacecolor</span><span class="p">(</span><span class="s2">"none"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.stem.html#matplotlib.pyplot.stem" title="matplotlib.pyplot.stem"><span class="n">plt</span><span class="o">.</span><span class="n">stem</span></a><span class="p">(</span><span class="n">x_recons</span><span class="p">,</span> <span class="n">linefmt</span><span class="o">=</span><span class="s2">"C1--"</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s2">"C1s"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.legend.html#matplotlib.pyplot.legend" title="matplotlib.pyplot.legend"><span class="n">plt</span><span class="o">.</span><span class="n">legend</span></a><span class="p">([</span><span class="s2">"Ground truth"</span><span class="p">,</span> <span class="s2">"Observation"</span><span class="p">,</span> <span class="s2">"PD3O Estimate"</span><span class="p">])</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../_downloads/1e56b08165a1aaab1d61109119a49a7f/opt-2.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../_downloads/5f6fc21c910212a2ec51fbd06ff28311/opt-2.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/7acbb4c520fb3c12fd8bb79d870c930d/opt-2.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/e6d7379beda9ef38f71609f23015c745/opt-2.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../_images/opt-2.png" class="plot-directive" src="../_images/opt-2.png"/>
</figure>
</section>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.DiffFunc" title="pyxu.abc.operator.DiffFunc"><em>DiffFunc</em></a><em> | </em><em>None</em>) – </p></li>
<li><p><strong>g</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.ProxFunc" title="pyxu.abc.operator.ProxFunc"><em>ProxFunc</em></a><em> | </em><em>None</em>) – </p></li>
<li><p><strong>h</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.ProxFunc" title="pyxu.abc.operator.ProxFunc"><em>ProxFunc</em></a><em> | </em><em>None</em>) – </p></li>
<li><p><strong>K</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.DiffMap" title="pyxu.abc.operator.DiffMap"><em>DiffMap</em></a><em> | </em><em>None</em>) – </p></li>
<li><p><strong>beta</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="numbers.Real"><em>Real</em></a><em> | </em><em>None</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.opt.solver.pds.ChambollePock">
<span class="sig-name descname"><span class="pre">ChambollePock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base=&lt;class</span> <span class="pre">'pyxu.opt.solver.pds.CondatVu'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyxu/opt/solver/pds.html#ChambollePock"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.opt.solver.pds.ChambollePock" title="Link to this definition">#</a></dt>
<dd><p>Chambolle-Pock primal-dual splitting method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>g</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.ProxFunc" title="pyxu.abc.operator.ProxFunc"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProxFunc</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>) – Proximable function <span class="math notranslate nohighlight">\(\mathcal{G}\)</span>.</p></li>
<li><p><strong>h</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.ProxFunc" title="pyxu.abc.operator.ProxFunc"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProxFunc</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>) – Proximable function <span class="math notranslate nohighlight">\(\mathcal{H}\)</span>.</p></li>
<li><p><strong>K</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.DiffMap" title="pyxu.abc.operator.DiffMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiffMap</span></code></a>, <a class="reference internal" href="abc.html#pyxu.abc.operator.LinOp" title="pyxu.abc.operator.LinOp"><code class="xref py py-class docutils literal notranslate"><span class="pre">LinOp</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>) – Differentiable map or linear operator <span class="math notranslate nohighlight">\(\mathcal{K}\)</span>.</p></li>
<li><p><strong>base</strong> (<a class="reference internal" href="#pyxu.opt.solver.pds.CondatVu" title="pyxu.opt.solver.pds.CondatVu"><code class="xref py py-class docutils literal notranslate"><span class="pre">CondatVu</span></code></a>, <a class="reference internal" href="#pyxu.opt.solver.pds.PD3O" title="pyxu.opt.solver.pds.PD3O"><code class="xref py py-class docutils literal notranslate"><span class="pre">PD3O</span></code></a>) – Specifies the base primal-dual algorithm.
(Default = <a class="reference internal" href="#pyxu.opt.solver.pds.CondatVu" title="pyxu.opt.solver.pds.CondatVu"><code class="xref py py-class docutils literal notranslate"><span class="pre">CondatVu</span></code></a>)</p></li>
<li><p><strong>**kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>) – Other keyword parameters passed on to <a class="reference internal" href="abc.html#pyxu.abc.solver.Solver.__init__" title="pyxu.abc.solver.Solver.__init__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pyxu.abc.solver.Solver.__init__()</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<p>The <em>Chambolle-Pock (CP) primal-dual splitting</em> method can be used to solve problems of the form:</p>
<div class="math notranslate nohighlight">
\[{\min_{\mathbf{x}\in\mathbb{R}^N} \mathcal{G}(\mathbf{x})\;\;+\;\;\mathcal{H}(\mathbf{K} \mathbf{x}),}\]</div>
<p>where:</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(\mathcal{G}:\mathbb{R}^N\rightarrow \mathbb{R}\cup\{+\infty\}\)</span> and <span class="math notranslate nohighlight">\(\mathcal{H}:\mathbb{R}^M\rightarrow \mathbb{R}\cup\{+\infty\}\)</span> are <em>proper</em>, <em>lower semicontinuous</em> and <em>convex functions</em> with <em>simple proximal operators</em>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathcal{K}:\mathbb{R}^N\rightarrow \mathbb{R}^M\)</span> is a <em>differentiable map</em> (e.g. a <em>linear operator</em> <span class="math notranslate nohighlight">\(\mathbf{K}\)</span>), with <strong>operator norm</strong>:</p>
<div class="math notranslate nohighlight">
\[\Vert{\mathcal{K}}\Vert_2=\sup_{\mathbf{x}\in\mathbb{R}^N,\Vert\mathbf{x}\Vert_2=1} \Vert\mathcal{K}(\mathbf{x})\Vert_2.\]</div>
</li>
</ul>
<section id="id28">
<h3>Remarks<a class="headerlink" href="#id28" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>The problem is <em>feasible</em>, i.e. there exists at least one solution.</p></li>
<li><p>The algorithm is still valid if one of the terms <span class="math notranslate nohighlight">\(\mathcal{G}\)</span> or <span class="math notranslate nohighlight">\(\mathcal{H}\)</span> is zero.</p></li>
<li><p>Automatic selection of parameters is not supported for <em>non-linear differentiable maps</em> <span class="math notranslate nohighlight">\(\mathcal{K}\)</span>.</p></li>
<li><p>The <em>Chambolle-Pock (CP) primal-dual splitting</em> method can be obtained by choosing <span class="math notranslate nohighlight">\(\mathcal{F}=0\)</span> in <a class="reference internal" href="#pyxu.opt.solver.pds.CondatVu" title="pyxu.opt.solver.pds.CondatVu"><code class="xref py py-class docutils literal notranslate"><span class="pre">CondatVu</span></code></a> or <a class="reference internal" href="#pyxu.opt.solver.pds.PD3O" title="pyxu.opt.solver.pds.PD3O"><code class="xref py py-class docutils literal notranslate"><span class="pre">PD3O</span></code></a>.
Chambolle and Pock originally introduced the algorithm without relaxation (<span class="math notranslate nohighlight">\(\rho=1\)</span>) <a class="reference internal" href="../references.html#cpa" id="id29"><span>[CPA]</span></a>.
Relaxed versions have been proposed afterwards <a class="reference internal" href="../references.html#psa" id="id30"><span>[PSA]</span></a>.
Chambolle-Pock’s algorithm is also known as the <em>Primal-Dual Hybrid Gradient (PDHG)</em> algorithm.
It can be seen as a preconditionned ADMM method <a class="reference internal" href="../references.html#cpa" id="id31"><span>[CPA]</span></a>.</p></li>
</ul>
</section>
<section id="id32">
<h3>Parameters (<code class="docutils literal notranslate"><span class="pre">fit()</span></code>)<a class="headerlink" href="#id32" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>x0</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-attr docutils literal notranslate"><span class="pre">NDArray</span></code></a>)
–
(…, N) initial point(s) for the primal variable.</p></li>
<li><p><strong>z0</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-attr docutils literal notranslate"><span class="pre">NDArray</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
(…, M) initial point(s) for the dual variable.
If <code class="docutils literal notranslate"><span class="pre">None</span></code> (default), then use <code class="docutils literal notranslate"><span class="pre">K(x0)</span></code> as the initial point for the dual variable.</p></li>
<li><p><strong>tau</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Real</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
Primal step size.</p></li>
<li><p><strong>sigma</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Real</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
Dual step size.</p></li>
<li><p><strong>rho</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Real</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
Momentum parameter.</p></li>
<li><p><strong>tuning_strategy</strong> (1, 2, 3)
–
Strategy to be employed when setting the hyperparameters (default to 1).
See <code class="code docutils literal notranslate"><span class="pre">base</span></code> for more details.</p></li>
<li><p><strong>**kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>)
–
Other keyword parameters passed on to <a class="reference internal" href="abc.html#pyxu.abc.solver.Solver.fit" title="pyxu.abc.solver.Solver.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pyxu.abc.solver.Solver.fit()</span></code></a>.</p></li>
</ul>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyxu.opt.solver.pds.CP" title="pyxu.opt.solver.pds.CP"><code class="xref py py-func docutils literal notranslate"><span class="pre">CP()</span></code></a>, <a class="reference internal" href="#pyxu.opt.solver.pds.CondatVu" title="pyxu.opt.solver.pds.CondatVu"><code class="xref py py-class docutils literal notranslate"><span class="pre">CondatVu</span></code></a>, <a class="reference internal" href="#pyxu.opt.solver.pds.PD3O" title="pyxu.opt.solver.pds.PD3O"><code class="xref py py-class docutils literal notranslate"><span class="pre">PD3O</span></code></a>, <a class="reference internal" href="#pyxu.opt.solver.pds.DouglasRachford" title="pyxu.opt.solver.pds.DouglasRachford"><code class="xref py py-func docutils literal notranslate"><span class="pre">DouglasRachford()</span></code></a></p>
</div>
</section>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.opt.solver.pds.CP">
<span class="sig-name descname"><span class="pre">CP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base=&lt;class</span> <span class="pre">'pyxu.opt.solver.pds.CondatVu'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyxu.opt.solver.pds.CP" title="Link to this definition">#</a></dt>
<dd><p>Alias of <a class="reference internal" href="#pyxu.opt.solver.pds.ChambollePock" title="pyxu.opt.solver.pds.ChambollePock"><code class="xref py py-func docutils literal notranslate"><span class="pre">ChambollePock()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>g</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.ProxFunc" title="pyxu.abc.operator.ProxFunc"><em>ProxFunc</em></a><em> | </em><em>None</em>) – </p></li>
<li><p><strong>h</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.ProxFunc" title="pyxu.abc.operator.ProxFunc"><em>ProxFunc</em></a><em> | </em><em>None</em>) – </p></li>
<li><p><strong>K</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.DiffMap" title="pyxu.abc.operator.DiffMap"><em>DiffMap</em></a><em> | </em><em>None</em>) – </p></li>
<li><p><strong>base</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Type" title="(in Python v3.11)"><em>Type</em></a><em>[</em><em>_PrimalDualSplitting</em><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyxu.opt.solver.pds.LorisVerhoeven">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">LorisVerhoeven</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyxu/opt/solver/pds.html#LorisVerhoeven"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.opt.solver.pds.LorisVerhoeven" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyxu.opt.solver.pds.PD3O" title="pyxu.opt.solver.pds.PD3O"><code class="xref py py-class docutils literal notranslate"><span class="pre">PD3O</span></code></a></p>
<p>Loris-Verhoeven splitting algorithm.</p>
<p>This solver is also accessible via the alias <a class="reference internal" href="#pyxu.opt.solver.pds.LV" title="pyxu.opt.solver.pds.LV"><code class="xref py py-class docutils literal notranslate"><span class="pre">LV</span></code></a>.</p>
<p>The <em>Loris-Verhoeven (LV) primal-dual splitting</em> can be used to solve problems of the form:</p>
<div class="math notranslate nohighlight">
\[{\min_{\mathbf{x}\in\mathbb{R}^N} \mathcal{F}(\mathbf{x})\;\;+\;\;\mathcal{H}(\mathbf{K} \mathbf{x}),}\]</div>
<p>where:</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(\mathcal{F}:\mathbb{R}^N\rightarrow \mathbb{R}\)</span> is <em>convex</em> and <em>differentiable</em>, with <span class="math notranslate nohighlight">\(\beta\)</span>-<em>Lipschitz continuous</em> gradient,
for some <span class="math notranslate nohighlight">\(\beta\in[0,+\infty[\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathcal{H}:\mathbb{R}^M\rightarrow \mathbb{R}\cup\{+\infty\}\)</span> is a <em>proper</em>, <em>lower semicontinuous</em> and <em>convex function</em> with <em>simple proximal operator</em>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathcal{K}:\mathbb{R}^N\rightarrow \mathbb{R}^M\)</span> is a <em>differentiable map</em> (e.g. a <em>linear operator</em> <span class="math notranslate nohighlight">\(\mathbf{K}\)</span>), with <strong>operator norm</strong>:</p>
<div class="math notranslate nohighlight">
\[\Vert{\mathcal{K}}\Vert_2=\sup_{\mathbf{x}\in\mathbb{R}^N,\Vert\mathbf{x}\Vert_2=1} \Vert\mathcal{K}(\mathbf{x})\Vert_2.\]</div>
</li>
</ul>
<section id="id33">
<h3>Remarks<a class="headerlink" href="#id33" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>The problem is <em>feasible</em>, i.e. there exists at least one solution.</p></li>
<li><p>The algorithm is still valid if one of the terms <span class="math notranslate nohighlight">\(\mathcal{F}\)</span> or <span class="math notranslate nohighlight">\(\mathcal{H}\)</span> is zero.</p></li>
<li><p>Automatic selection of parameters is not supported for <em>non-linear differentiable maps</em> <span class="math notranslate nohighlight">\(\mathcal{K}\)</span>.</p></li>
<li><p>The <em>Loris-Verhoeven (CP) primal-dual splitting</em> method can be obtained by choosing <span class="math notranslate nohighlight">\(\mathcal{G}=0\)</span> in <a class="reference internal" href="#pyxu.opt.solver.pds.PD3O" title="pyxu.opt.solver.pds.PD3O"><code class="xref py py-class docutils literal notranslate"><span class="pre">PD3O</span></code></a>.</p></li>
<li><p>In the specific case where <span class="math notranslate nohighlight">\(\mathcal{F}\)</span> is <em>quadratic</em>, then one can set <span class="math notranslate nohighlight">\(\rho \in ]0,\delta[\)</span> with
<span class="math notranslate nohighlight">\(\delta=2\)</span>. (See Theorem 4.3 in <a class="reference internal" href="../references.html#psa" id="id34"><span>[PSA]</span></a>.)</p></li>
</ul>
</section>
<section id="id35">
<h3>Parameters (<code class="docutils literal notranslate"><span class="pre">__init__()</span></code>)<a class="headerlink" href="#id35" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>f</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.DiffFunc" title="pyxu.abc.operator.DiffFunc"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiffFunc</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
Differentiable function <span class="math notranslate nohighlight">\(\mathcal{F}\)</span>.</p></li>
<li><p><strong>h</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.ProxFunc" title="pyxu.abc.operator.ProxFunc"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProxFunc</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
Proximable function <span class="math notranslate nohighlight">\(\mathcal{H}\)</span>.</p></li>
<li><p><strong>K</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.DiffMap" title="pyxu.abc.operator.DiffMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiffMap</span></code></a>, <a class="reference internal" href="abc.html#pyxu.abc.operator.LinOp" title="pyxu.abc.operator.LinOp"><code class="xref py py-class docutils literal notranslate"><span class="pre">LinOp</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
Differentiable map or linear operator <span class="math notranslate nohighlight">\(\mathcal{K}\)</span>.</p></li>
<li><p><strong>beta</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Real</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
Lipschitz constant <span class="math notranslate nohighlight">\(\beta\)</span> of <span class="math notranslate nohighlight">\(\nabla\mathcal{F}\)</span>.
If not provided, it will be automatically estimated.</p></li>
<li><p><strong>**kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>)
–
Other keyword parameters passed on to <a class="reference internal" href="abc.html#pyxu.abc.solver.Solver.__init__" title="pyxu.abc.solver.Solver.__init__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pyxu.abc.solver.Solver.__init__()</span></code></a>.</p></li>
</ul>
</section>
<section id="id36">
<h3>Parameters (<code class="docutils literal notranslate"><span class="pre">fit()</span></code>)<a class="headerlink" href="#id36" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>x0</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-attr docutils literal notranslate"><span class="pre">NDArray</span></code></a>)
–
(…, N) initial point(s) for the primal variable.</p></li>
<li><p><strong>z0</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-attr docutils literal notranslate"><span class="pre">NDArray</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
(…, M) initial point(s) for the dual variable.
If <code class="docutils literal notranslate"><span class="pre">None</span></code> (default), then use <code class="docutils literal notranslate"><span class="pre">K(x0)</span></code> as the initial point for the dual variable.</p></li>
<li><p><strong>tau</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Real</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
Primal step size.</p></li>
<li><p><strong>sigma</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Real</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
Dual step size.</p></li>
<li><p><strong>rho</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Real</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
Momentum parameter.</p></li>
<li><p><strong>tuning_strategy</strong> (1, 2, 3)
–
Strategy to be employed when setting the hyperparameters (default to 1).
See <a class="reference internal" href="#pyxu.opt.solver.pds.PD3O" title="pyxu.opt.solver.pds.PD3O"><code class="xref py py-class docutils literal notranslate"><span class="pre">PD3O</span></code></a> for more details.</p></li>
<li><p><strong>**kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>)
–
Other keyword parameters passed on to <a class="reference internal" href="abc.html#pyxu.abc.solver.Solver.fit" title="pyxu.abc.solver.Solver.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pyxu.abc.solver.Solver.fit()</span></code></a>.</p></li>
</ul>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyxu.opt.solver.pds.PD3O" title="pyxu.opt.solver.pds.PD3O"><code class="xref py py-class docutils literal notranslate"><span class="pre">PD3O</span></code></a>, <a class="reference internal" href="#pyxu.opt.solver.pds.DavisYin" title="pyxu.opt.solver.pds.DavisYin"><code class="xref py py-class docutils literal notranslate"><span class="pre">DavisYin</span></code></a>, <a class="reference internal" href="#pyxu.opt.solver.pgd.PGD" title="pyxu.opt.solver.pgd.PGD"><code class="xref py py-class docutils literal notranslate"><span class="pre">PGD</span></code></a>, <a class="reference internal" href="#pyxu.opt.solver.pds.ChambollePock" title="pyxu.opt.solver.pds.ChambollePock"><code class="xref py py-func docutils literal notranslate"><span class="pre">ChambollePock()</span></code></a>, <a class="reference internal" href="#pyxu.opt.solver.pds.DouglasRachford" title="pyxu.opt.solver.pds.DouglasRachford"><code class="xref py py-func docutils literal notranslate"><span class="pre">DouglasRachford()</span></code></a></p>
</div>
</section>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.DiffFunc" title="pyxu.abc.operator.DiffFunc"><em>DiffFunc</em></a><em> | </em><em>None</em>) – </p></li>
<li><p><strong>h</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.ProxFunc" title="pyxu.abc.operator.ProxFunc"><em>ProxFunc</em></a><em> | </em><em>None</em>) – </p></li>
<li><p><strong>K</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.DiffMap" title="pyxu.abc.operator.DiffMap"><em>DiffMap</em></a><em> | </em><em>None</em>) – </p></li>
<li><p><strong>beta</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="numbers.Real"><em>Real</em></a><em> | </em><em>None</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyxu.opt.solver.pds.LV">
<span class="sig-name descname"><span class="pre">LV</span></span><a class="headerlink" href="#pyxu.opt.solver.pds.LV" title="Link to this definition">#</a></dt>
<dd><p>Alias of <a class="reference internal" href="#pyxu.opt.solver.pds.LorisVerhoeven" title="pyxu.opt.solver.pds.LorisVerhoeven"><code class="xref py py-class docutils literal notranslate"><span class="pre">LorisVerhoeven</span></code></a>.</p>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyxu.opt.solver.pds.DavisYin">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">DavisYin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyxu/opt/solver/pds.html#DavisYin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.opt.solver.pds.DavisYin" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyxu.opt.solver.pds.PD3O" title="pyxu.opt.solver.pds.PD3O"><code class="xref py py-class docutils literal notranslate"><span class="pre">PD3O</span></code></a></p>
<p>Davis-Yin primal-dual splitting method.</p>
<p>This solver is also accessible via the alias <a class="reference internal" href="#pyxu.opt.solver.pds.DY" title="pyxu.opt.solver.pds.DY"><code class="xref py py-class docutils literal notranslate"><span class="pre">DY</span></code></a>.</p>
<p>The <em>Davis-Yin (DY) primal-dual splitting</em> method can be used to solve problems of the form:</p>
<div class="math notranslate nohighlight">
\[{\min_{\mathbf{x}\in\mathbb{R}^N} \;\mathcal{F}(\mathbf{x})\;\;+\;\;\mathcal{G}(\mathbf{x})\;\;+\;\;\mathcal{H}(\mathbf{x}),}\]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\mathcal{F}:\mathbb{R}^N\rightarrow \mathbb{R}\)</span> is <em>convex</em> and <em>differentiable</em>, with <span class="math notranslate nohighlight">\(\beta\)</span>-<em>Lipschitz continuous</em> gradient,
for some <span class="math notranslate nohighlight">\(\beta\in[0,+\infty[\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathcal{G}:\mathbb{R}^N\rightarrow \mathbb{R}\cup\{+\infty\}\)</span> and <span class="math notranslate nohighlight">\(\mathcal{H}:\mathbb{R}^N\rightarrow \mathbb{R}\cup\{+\infty\}\)</span> are <em>proper</em>, <em>lower semicontinuous</em> and <em>convex functions</em> with <em>simple proximal operators</em>.</p></li>
</ul>
<section id="id37">
<h3>Remarks<a class="headerlink" href="#id37" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>The problem is <em>feasible</em>, i.e. there exists at least one solution.</p></li>
<li><p>The algorithm is still valid if one of the terms <span class="math notranslate nohighlight">\(\mathcal{G}\)</span> or <span class="math notranslate nohighlight">\(\mathcal{H}\)</span> is zero.</p></li>
<li><p>The <em>Davis-Yin primal-dual splitting</em> method can be obtained by choosing <span class="math notranslate nohighlight">\(\mathcal{K}=\mathbf{I}\)</span>
(identity) and <span class="math notranslate nohighlight">\(\tau=1/\sigma\)</span> in <a class="reference internal" href="#pyxu.opt.solver.pds.PD3O" title="pyxu.opt.solver.pds.PD3O"><code class="xref py py-class docutils literal notranslate"><span class="pre">PD3O</span></code></a>, provided a suitable change of variable <a class="reference internal" href="../references.html#psa" id="id38"><span>[PSA]</span></a>.</p></li>
</ul>
</section>
<section id="id39">
<h3>Parameters (<code class="docutils literal notranslate"><span class="pre">__init__()</span></code>)<a class="headerlink" href="#id39" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>f</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.DiffFunc" title="pyxu.abc.operator.DiffFunc"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiffFunc</span></code></a>)
–
Differentiable function <span class="math notranslate nohighlight">\(\mathcal{F}\)</span>.</p></li>
<li><p><strong>g</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.ProxFunc" title="pyxu.abc.operator.ProxFunc"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProxFunc</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
Proximable function <span class="math notranslate nohighlight">\(\mathcal{G}\)</span>.</p></li>
<li><p><strong>h</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.ProxFunc" title="pyxu.abc.operator.ProxFunc"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProxFunc</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
Proximable function <span class="math notranslate nohighlight">\(\mathcal{H}\)</span>.</p></li>
<li><p><strong>beta</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Real</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
Lipschitz constant <span class="math notranslate nohighlight">\(\beta\)</span> of <span class="math notranslate nohighlight">\(\nabla\mathcal{F}\)</span>.
If not provided, it will be automatically estimated.</p></li>
<li><p><strong>**kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>)
–
Other keyword parameters passed on to <a class="reference internal" href="abc.html#pyxu.abc.solver.Solver.__init__" title="pyxu.abc.solver.Solver.__init__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pyxu.abc.solver.Solver.__init__()</span></code></a>.</p></li>
</ul>
</section>
<section id="id40">
<h3>Parameters (<code class="docutils literal notranslate"><span class="pre">fit()</span></code>)<a class="headerlink" href="#id40" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>x0</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-attr docutils literal notranslate"><span class="pre">NDArray</span></code></a>)
–
(…, N) initial point(s) for the primal variable.</p></li>
<li><p><strong>z0</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-attr docutils literal notranslate"><span class="pre">NDArray</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
(…, N) initial point(s) for the dual variable.
If <code class="docutils literal notranslate"><span class="pre">None</span></code> (default), then use <code class="docutils literal notranslate"><span class="pre">x0</span></code> as the initial point for the dual variable.</p></li>
<li><p><strong>tau</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Real</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
Primal step size.</p></li>
<li><p><strong>sigma</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Real</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
Dual step size.</p></li>
<li><p><strong>rho</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Real</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
Momentum parameter.</p></li>
<li><p><strong>tuning_strategy</strong> (1, 2, 3)
–
Strategy to be employed when setting the hyperparameters (default to 1).
See <a class="reference internal" href="#pyxu.opt.solver.pds.PD3O" title="pyxu.opt.solver.pds.PD3O"><code class="xref py py-class docutils literal notranslate"><span class="pre">PD3O</span></code></a> for more details.</p></li>
<li><p><strong>**kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>)
–
Other keyword parameters passed on to <a class="reference internal" href="abc.html#pyxu.abc.solver.Solver.fit" title="pyxu.abc.solver.Solver.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pyxu.abc.solver.Solver.fit()</span></code></a>.</p></li>
</ul>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyxu.opt.solver.pds.PD3O" title="pyxu.opt.solver.pds.PD3O"><code class="xref py py-class docutils literal notranslate"><span class="pre">PD3O</span></code></a>, <a class="reference internal" href="#pyxu.opt.solver.pds.LorisVerhoeven" title="pyxu.opt.solver.pds.LorisVerhoeven"><code class="xref py py-class docutils literal notranslate"><span class="pre">LorisVerhoeven</span></code></a>, <a class="reference internal" href="#pyxu.opt.solver.pgd.PGD" title="pyxu.opt.solver.pgd.PGD"><code class="xref py py-class docutils literal notranslate"><span class="pre">PGD</span></code></a>, <a class="reference internal" href="#pyxu.opt.solver.pds.ChambollePock" title="pyxu.opt.solver.pds.ChambollePock"><code class="xref py py-func docutils literal notranslate"><span class="pre">ChambollePock()</span></code></a>, <a class="reference internal" href="#pyxu.opt.solver.pds.DouglasRachford" title="pyxu.opt.solver.pds.DouglasRachford"><code class="xref py py-func docutils literal notranslate"><span class="pre">DouglasRachford()</span></code></a></p>
</div>
</section>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.DiffFunc" title="pyxu.abc.operator.DiffFunc"><em>DiffFunc</em></a><em> | </em><em>None</em>) – </p></li>
<li><p><strong>g</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.ProxFunc" title="pyxu.abc.operator.ProxFunc"><em>ProxFunc</em></a><em> | </em><em>None</em>) – </p></li>
<li><p><strong>h</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.ProxFunc" title="pyxu.abc.operator.ProxFunc"><em>ProxFunc</em></a><em> | </em><em>None</em>) – </p></li>
<li><p><strong>beta</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="numbers.Real"><em>Real</em></a><em> | </em><em>None</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyxu.opt.solver.pds.DY">
<span class="sig-name descname"><span class="pre">DY</span></span><a class="headerlink" href="#pyxu.opt.solver.pds.DY" title="Link to this definition">#</a></dt>
<dd><p>Alias of <a class="reference internal" href="#pyxu.opt.solver.pds.DavisYin" title="pyxu.opt.solver.pds.DavisYin"><code class="xref py py-class docutils literal notranslate"><span class="pre">DavisYin</span></code></a>.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.opt.solver.pds.DouglasRachford">
<span class="sig-name descname"><span class="pre">DouglasRachford</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base=&lt;class</span> <span class="pre">'pyxu.opt.solver.pds.CondatVu'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyxu/opt/solver/pds.html#DouglasRachford"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.opt.solver.pds.DouglasRachford" title="Link to this definition">#</a></dt>
<dd><p>Douglas-Rachford splitting algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>g</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.ProxFunc" title="pyxu.abc.operator.ProxFunc"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProxFunc</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>) – Proximable function <span class="math notranslate nohighlight">\(\mathcal{G}\)</span>.</p></li>
<li><p><strong>h</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.ProxFunc" title="pyxu.abc.operator.ProxFunc"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProxFunc</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>) – Proximable function <span class="math notranslate nohighlight">\(\mathcal{H}\)</span>.</p></li>
<li><p><strong>base</strong> (<a class="reference internal" href="#pyxu.opt.solver.pds.CondatVu" title="pyxu.opt.solver.pds.CondatVu"><code class="xref py py-class docutils literal notranslate"><span class="pre">CondatVu</span></code></a>, <a class="reference internal" href="#pyxu.opt.solver.pds.PD3O" title="pyxu.opt.solver.pds.PD3O"><code class="xref py py-class docutils literal notranslate"><span class="pre">PD3O</span></code></a>) – Specifies the base primal-dual algorithm.
(Default = <a class="reference internal" href="#pyxu.opt.solver.pds.CondatVu" title="pyxu.opt.solver.pds.CondatVu"><code class="xref py py-class docutils literal notranslate"><span class="pre">CondatVu</span></code></a>)</p></li>
<li><p><strong>**kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>) – Other keyword parameters passed on to <a class="reference internal" href="abc.html#pyxu.abc.solver.Solver.__init__" title="pyxu.abc.solver.Solver.__init__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pyxu.abc.solver.Solver.__init__()</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<p>The <em>Douglas-Rachford (DR) primal-dual splitting</em> method can be used to solve problems of the form:</p>
<div class="math notranslate nohighlight">
\[{\min_{\mathbf{x}\in\mathbb{R}^N} \mathcal{G}(\mathbf{x})\;\;+\;\;\mathcal{H}(\mathbf{x}),}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathcal{G}:\mathbb{R}^N\rightarrow \mathbb{R}\cup\{+\infty\}\)</span> and <span class="math notranslate nohighlight">\(\mathcal{H}:\mathbb{R}^N\rightarrow \mathbb{R}\cup\{+\infty\}\)</span> are <em>proper</em>, <em>lower semicontinuous</em> and <em>convex functions</em> with <em>simple proximal operators</em>.</p>
<section id="id41">
<h3>Remarks<a class="headerlink" href="#id41" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>The problem is <em>feasible</em>, i.e. there exists at least one solution.</p></li>
<li><p>The algorithm is still valid if one of the terms <span class="math notranslate nohighlight">\(\mathcal{G}\)</span> or <span class="math notranslate nohighlight">\(\mathcal{H}\)</span> is zero.</p></li>
<li><p>The <em>Douglas-Rachford (DR) primal-dual splitting</em> method can be obtained by choosing <span class="math notranslate nohighlight">\(\mathcal{F}=0\)</span>, <span class="math notranslate nohighlight">\(\mathbf{K}=\mathbf{Id}\)</span> and <span class="math notranslate nohighlight">\(\tau=1/\sigma\)</span> in <a class="reference internal" href="#pyxu.opt.solver.pds.CondatVu" title="pyxu.opt.solver.pds.CondatVu"><code class="xref py py-class docutils literal notranslate"><span class="pre">CondatVu</span></code></a> or <a class="reference internal" href="#pyxu.opt.solver.pds.PD3O" title="pyxu.opt.solver.pds.PD3O"><code class="xref py py-class docutils literal notranslate"><span class="pre">PD3O</span></code></a>.
Douglas and Rachford originally introduced the algorithm without relaxation (<span class="math notranslate nohighlight">\(\rho=1\)</span>), but relaxed versions have been proposed afterwards <a class="reference internal" href="../references.html#psa" id="id42"><span>[PSA]</span></a>.
When <span class="math notranslate nohighlight">\(\rho=1\)</span>, Douglas-Rachford’s algorithm is <em>functionally equivalent</em> to ADMM (up to a change of variable, see <a class="reference internal" href="../references.html#psa" id="id43"><span>[PSA]</span></a> for a derivation).</p></li>
</ul>
</section>
<section id="id44">
<h3>Parameters (<code class="docutils literal notranslate"><span class="pre">fit()</span></code>)<a class="headerlink" href="#id44" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>x0</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-attr docutils literal notranslate"><span class="pre">NDArray</span></code></a>)
–
(…, N) initial point(s) for the primal variable.</p></li>
<li><p><strong>z0</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-attr docutils literal notranslate"><span class="pre">NDArray</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
(…, N) initial point(s) for the dual variable.
If <code class="docutils literal notranslate"><span class="pre">None</span></code> (default), then use <code class="docutils literal notranslate"><span class="pre">x0</span></code> as the initial point for the dual variable.</p></li>
<li><p><strong>tau</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Real</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
Primal step size. Defaults to 1.</p></li>
<li><p><strong>**kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>)
–
Other keyword parameters passed on to <a class="reference internal" href="abc.html#pyxu.abc.solver.Solver.fit" title="pyxu.abc.solver.Solver.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pyxu.abc.solver.Solver.fit()</span></code></a>.</p></li>
</ul>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyxu.opt.solver.pds.CondatVu" title="pyxu.opt.solver.pds.CondatVu"><code class="xref py py-class docutils literal notranslate"><span class="pre">CondatVu</span></code></a>, <a class="reference internal" href="#pyxu.opt.solver.pds.PD3O" title="pyxu.opt.solver.pds.PD3O"><code class="xref py py-class docutils literal notranslate"><span class="pre">PD3O</span></code></a>, <a class="reference internal" href="#pyxu.opt.solver.pds.ChambollePock" title="pyxu.opt.solver.pds.ChambollePock"><code class="xref py py-func docutils literal notranslate"><span class="pre">ChambollePock()</span></code></a>, <a class="reference internal" href="#pyxu.opt.solver.pds.ForwardBackward" title="pyxu.opt.solver.pds.ForwardBackward"><code class="xref py py-func docutils literal notranslate"><span class="pre">ForwardBackward()</span></code></a></p>
</div>
</section>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.opt.solver.pds.DR">
<span class="sig-name descname"><span class="pre">DR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base=&lt;class</span> <span class="pre">'pyxu.opt.solver.pds.CondatVu'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyxu.opt.solver.pds.DR" title="Link to this definition">#</a></dt>
<dd><p>Alias of <a class="reference internal" href="#pyxu.opt.solver.pds.DouglasRachford" title="pyxu.opt.solver.pds.DouglasRachford"><code class="xref py py-func docutils literal notranslate"><span class="pre">DouglasRachford()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>g</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.ProxFunc" title="pyxu.abc.operator.ProxFunc"><em>ProxFunc</em></a><em> | </em><em>None</em>) – </p></li>
<li><p><strong>h</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.ProxFunc" title="pyxu.abc.operator.ProxFunc"><em>ProxFunc</em></a><em> | </em><em>None</em>) – </p></li>
<li><p><strong>base</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Type" title="(in Python v3.11)"><em>Type</em></a><em>[</em><em>_PrimalDualSplitting</em><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyxu.opt.solver.pds.ForwardBackward">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ForwardBackward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyxu/opt/solver/pds.html#ForwardBackward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.opt.solver.pds.ForwardBackward" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyxu.opt.solver.pds.CondatVu" title="pyxu.opt.solver.pds.CondatVu"><code class="xref py py-class docutils literal notranslate"><span class="pre">CondatVu</span></code></a></p>
<p>Forward-backward splitting algorithm.</p>
<p>This solver is also accessible via the alias <a class="reference internal" href="#pyxu.opt.solver.pds.FB" title="pyxu.opt.solver.pds.FB"><code class="xref py py-class docutils literal notranslate"><span class="pre">FB</span></code></a>.</p>
<p>The <em>Forward-backward (FB) splitting</em> method can be used to solve problems of the form:</p>
<div class="math notranslate nohighlight">
\[{\min_{\mathbf{x}\in\mathbb{R}^N} \;\mathcal{F}(\mathbf{x})\;\;+\;\;\mathcal{G}(\mathbf{x}),}\]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\mathcal{F}:\mathbb{R}^N\rightarrow \mathbb{R}\)</span> is <em>convex</em> and <em>differentiable</em>, with <span class="math notranslate nohighlight">\(\beta\)</span>-<em>Lipschitz continuous</em> gradient,
for some <span class="math notranslate nohighlight">\(\beta\in[0,+\infty[\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathcal{G}:\mathbb{R}^N\rightarrow \mathbb{R}\cup\{+\infty\}\)</span> is <em>proper</em>, <em>lower semicontinuous</em> and <em>convex function</em> with <em>simple proximal operator</em>.</p></li>
</ul>
<section id="id45">
<h3>Remarks<a class="headerlink" href="#id45" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>The problem is <em>feasible</em>, i.e. there exists at least one solution.</p></li>
<li><p>The algorithm is still valid if one of the terms <span class="math notranslate nohighlight">\(\mathcal{F}\)</span> or <span class="math notranslate nohighlight">\(\mathcal{G}\)</span> is zero.</p></li>
<li><p>The <em>Forward-backward (FB) primal-dual splitting</em> method can be obtained by choosing <span class="math notranslate nohighlight">\(\mathcal{H}=0\)</span> in <a class="reference internal" href="#pyxu.opt.solver.pds.CondatVu" title="pyxu.opt.solver.pds.CondatVu"><code class="xref py py-class docutils literal notranslate"><span class="pre">CondatVu</span></code></a>.
Mercier originally introduced the algorithm without relaxation (<span class="math notranslate nohighlight">\(\rho=1\)</span>) <a class="reference internal" href="../references.html#fb" id="id46"><span>[FB]</span></a>.
Relaxed versions have been proposed afterwards <a class="reference internal" href="../references.html#psa" id="id47"><span>[PSA]</span></a>.
The Forward-backward algorithm is also known as the <em>Proximal Gradient Descent (PGD)</em> algorithm.
For the accelerated version of PGD, use <a class="reference internal" href="#pyxu.opt.solver.pgd.PGD" title="pyxu.opt.solver.pgd.PGD"><code class="xref py py-class docutils literal notranslate"><span class="pre">PGD</span></code></a>.</p></li>
</ul>
</section>
<section id="id48">
<h3>Parameters (<code class="docutils literal notranslate"><span class="pre">__init__()</span></code>)<a class="headerlink" href="#id48" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>f</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.DiffFunc" title="pyxu.abc.operator.DiffFunc"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiffFunc</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
Differentiable function <span class="math notranslate nohighlight">\(\mathcal{F}\)</span>.</p></li>
<li><p><strong>g</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.ProxFunc" title="pyxu.abc.operator.ProxFunc"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProxFunc</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
Proximable function <span class="math notranslate nohighlight">\(\mathcal{G}\)</span>.</p></li>
<li><p><strong>beta</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Real</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
Lipschitz constant <span class="math notranslate nohighlight">\(\beta\)</span> of <span class="math notranslate nohighlight">\(\nabla\mathcal{F}\)</span>.
If not provided, it will be automatically estimated.</p></li>
<li><p><strong>**kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>)
–
Other keyword parameters passed on to <a class="reference internal" href="abc.html#pyxu.abc.solver.Solver.__init__" title="pyxu.abc.solver.Solver.__init__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pyxu.abc.solver.Solver.__init__()</span></code></a>.</p></li>
</ul>
</section>
<section id="id49">
<h3>Parameters (<code class="docutils literal notranslate"><span class="pre">fit()</span></code>)<a class="headerlink" href="#id49" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>x0</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-attr docutils literal notranslate"><span class="pre">NDArray</span></code></a>)
–
(…, N) initial point(s) for the primal variable.</p></li>
<li><p><strong>z0</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-attr docutils literal notranslate"><span class="pre">NDArray</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
(…, N) initial point(s) for the dual variable.
If <code class="docutils literal notranslate"><span class="pre">None</span></code> (default), then use <code class="docutils literal notranslate"><span class="pre">x0</span></code> as the initial point for the dual variable.</p></li>
<li><p><strong>tau</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Real</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
Primal step size.</p></li>
<li><p><strong>rho</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Real</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
Momentum parameter.</p></li>
<li><p><strong>tuning_strategy</strong> (1, 2, 3)
–
Strategy to be employed when setting the hyperparameters (default to 1).
See <a class="reference internal" href="#pyxu.opt.solver.pds.CondatVu" title="pyxu.opt.solver.pds.CondatVu"><code class="xref py py-class docutils literal notranslate"><span class="pre">CondatVu</span></code></a> for more details.</p></li>
<li><p><strong>**kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>)
–
Other keyword parameters passed on to <a class="reference internal" href="abc.html#pyxu.abc.solver.Solver.fit" title="pyxu.abc.solver.Solver.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pyxu.abc.solver.Solver.fit()</span></code></a>.</p></li>
</ul>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyxu.opt.solver.pds.CondatVu" title="pyxu.opt.solver.pds.CondatVu"><code class="xref py py-class docutils literal notranslate"><span class="pre">CondatVu</span></code></a>, <a class="reference internal" href="#pyxu.opt.solver.pds.PD3O" title="pyxu.opt.solver.pds.PD3O"><code class="xref py py-class docutils literal notranslate"><span class="pre">PD3O</span></code></a>, <a class="reference internal" href="#pyxu.opt.solver.pgd.PGD" title="pyxu.opt.solver.pgd.PGD"><code class="xref py py-class docutils literal notranslate"><span class="pre">PGD</span></code></a>, <a class="reference internal" href="#pyxu.opt.solver.pds.ChambollePock" title="pyxu.opt.solver.pds.ChambollePock"><code class="xref py py-func docutils literal notranslate"><span class="pre">ChambollePock()</span></code></a>, <a class="reference internal" href="#pyxu.opt.solver.pds.DouglasRachford" title="pyxu.opt.solver.pds.DouglasRachford"><code class="xref py py-func docutils literal notranslate"><span class="pre">DouglasRachford()</span></code></a></p>
</div>
</section>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.DiffFunc" title="pyxu.abc.operator.DiffFunc"><em>DiffFunc</em></a><em> | </em><em>None</em>) – </p></li>
<li><p><strong>g</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.ProxFunc" title="pyxu.abc.operator.ProxFunc"><em>ProxFunc</em></a><em> | </em><em>None</em>) – </p></li>
<li><p><strong>beta</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="numbers.Real"><em>Real</em></a><em> | </em><em>None</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyxu.opt.solver.pds.FB">
<span class="sig-name descname"><span class="pre">FB</span></span><a class="headerlink" href="#pyxu.opt.solver.pds.FB" title="Link to this definition">#</a></dt>
<dd><p>Alias of <a class="reference internal" href="#pyxu.opt.solver.pds.ForwardBackward" title="pyxu.opt.solver.pds.ForwardBackward"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardBackward</span></code></a>.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.opt.solver.pds.ProximalPoint">
<span class="sig-name descname"><span class="pre">ProximalPoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base=&lt;class</span> <span class="pre">'pyxu.opt.solver.pds.CondatVu'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyxu/opt/solver/pds.html#ProximalPoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.opt.solver.pds.ProximalPoint" title="Link to this definition">#</a></dt>
<dd><p>Proximal-point method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>g</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.ProxFunc" title="pyxu.abc.operator.ProxFunc"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProxFunc</span></code></a>) – Proximable function <span class="math notranslate nohighlight">\(\mathcal{G}\)</span>.</p></li>
<li><p><strong>base</strong> (<a class="reference internal" href="#pyxu.opt.solver.pds.CondatVu" title="pyxu.opt.solver.pds.CondatVu"><code class="xref py py-class docutils literal notranslate"><span class="pre">CondatVu</span></code></a>, <a class="reference internal" href="#pyxu.opt.solver.pds.PD3O" title="pyxu.opt.solver.pds.PD3O"><code class="xref py py-class docutils literal notranslate"><span class="pre">PD3O</span></code></a>) – Specifies the base primal-dual algorithm from which mathematical updates are inherited.
(Default = <a class="reference internal" href="#pyxu.opt.solver.pds.CondatVu" title="pyxu.opt.solver.pds.CondatVu"><code class="xref py py-class docutils literal notranslate"><span class="pre">CondatVu</span></code></a>)</p></li>
<li><p><strong>**kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>) – Other keyword parameters passed on to <a class="reference internal" href="abc.html#pyxu.abc.solver.Solver.__init__" title="pyxu.abc.solver.Solver.__init__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pyxu.abc.solver.Solver.__init__()</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<p>The <em>Proximal-point (PP)</em> method can be used to solve problems of the form:</p>
<div class="math notranslate nohighlight">
\[{\min_{\mathbf{x}\in\mathbb{R}^N} \;\mathcal{G}(\mathbf{x}),}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathcal{G}:\mathbb{R}^N\rightarrow \mathbb{R}\cup\{+\infty\}\)</span> is <em>proper</em>, <em>lower semicontinuous</em> and <em>convex function</em> with <em>simple proximal operator</em>.</p>
<section id="id50">
<h3>Remarks<a class="headerlink" href="#id50" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>The problem is <em>feasible</em>, i.e. there exists at least one solution.</p></li>
<li><p>The <em>Proximal-point</em> algorithm can be obtained by choosing <span class="math notranslate nohighlight">\(\mathcal{F}=0\)</span> and <span class="math notranslate nohighlight">\(\mathcal{H}=0\)</span> in <a class="reference internal" href="#pyxu.opt.solver.pds.CondatVu" title="pyxu.opt.solver.pds.CondatVu"><code class="xref py py-class docutils literal notranslate"><span class="pre">CondatVu</span></code></a> or <a class="reference internal" href="#pyxu.opt.solver.pds.PD3O" title="pyxu.opt.solver.pds.PD3O"><code class="xref py py-class docutils literal notranslate"><span class="pre">PD3O</span></code></a>.
The original version of the algorithm was introduced without relaxation (<span class="math notranslate nohighlight">\(\rho=1\)</span>) <a class="reference internal" href="../references.html#pp" id="id51"><span>[PP]</span></a>.
Relaxed versions have been proposed afterwards <a class="reference internal" href="../references.html#psa" id="id52"><span>[PSA]</span></a>.</p></li>
</ul>
</section>
<section id="id53">
<h3>Parameters (<code class="docutils literal notranslate"><span class="pre">fit()</span></code>)<a class="headerlink" href="#id53" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>x0</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-attr docutils literal notranslate"><span class="pre">NDArray</span></code></a>)
–
(…, N) initial point(s) for the primal variable.</p></li>
<li><p><strong>tau</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Real</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
Primal step size.</p></li>
<li><p><strong>rho</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Real</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
Momentum parameter.</p></li>
<li><p><strong>**kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>)
–
Other keyword parameters passed on to <a class="reference internal" href="abc.html#pyxu.abc.solver.Solver.fit" title="pyxu.abc.solver.Solver.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pyxu.abc.solver.Solver.fit()</span></code></a>.</p></li>
</ul>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyxu.opt.solver.pds.PP" title="pyxu.opt.solver.pds.PP"><code class="xref py py-class docutils literal notranslate"><span class="pre">PP</span></code></a>, <a class="reference internal" href="#pyxu.opt.solver.pds.CondatVu" title="pyxu.opt.solver.pds.CondatVu"><code class="xref py py-class docutils literal notranslate"><span class="pre">CondatVu</span></code></a>, <a class="reference internal" href="#pyxu.opt.solver.pds.PD3O" title="pyxu.opt.solver.pds.PD3O"><code class="xref py py-class docutils literal notranslate"><span class="pre">PD3O</span></code></a>, <a class="reference internal" href="#pyxu.opt.solver.pgd.PGD" title="pyxu.opt.solver.pgd.PGD"><code class="xref py py-class docutils literal notranslate"><span class="pre">PGD</span></code></a>, <a class="reference internal" href="#pyxu.opt.solver.pds.ChambollePock" title="pyxu.opt.solver.pds.ChambollePock"><code class="xref py py-func docutils literal notranslate"><span class="pre">ChambollePock()</span></code></a>, <a class="reference internal" href="#pyxu.opt.solver.pds.DouglasRachford" title="pyxu.opt.solver.pds.DouglasRachford"><code class="xref py py-func docutils literal notranslate"><span class="pre">DouglasRachford()</span></code></a></p>
</div>
</section>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.opt.solver.pds.PP">
<span class="sig-name descname"><span class="pre">PP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base=&lt;class</span> <span class="pre">'pyxu.opt.solver.pds.CondatVu'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyxu.opt.solver.pds.PP" title="Link to this definition">#</a></dt>
<dd><p>Alias of <a class="reference internal" href="#pyxu.opt.solver.pds.ProximalPoint" title="pyxu.opt.solver.pds.ProximalPoint"><code class="xref py py-func docutils literal notranslate"><span class="pre">ProximalPoint()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>g</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.ProxFunc" title="pyxu.abc.operator.ProxFunc"><em>ProxFunc</em></a><em> | </em><em>None</em>) – </p></li>
<li><p><strong>base</strong> (<em>_PrimalDualSplitting</em><em> | </em><em>None</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyxu.opt.solver.pds.ADMM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ADMM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyxu/opt/solver/pds.html#ADMM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.opt.solver.pds.ADMM" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">_PrimalDualSplitting</span></code></p>
<p>Alternating Direction Method of Multipliers.</p>
<p>The <em>Alternating Direction Method of Multipliers (ADMM)</em> can be used to solve problems of the form:</p>
<div class="math notranslate nohighlight">
\[\min_{\mathbf{x}\in\mathbb{R}^N} \quad \mathcal{F}(\mathbf{x})\;\;+\;\;\mathcal{H}(\mathbf{K}\mathbf{x}),\]</div>
<p>where (see below for additional details on the assumptions):</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\mathcal{F}:\mathbb{R}^N\rightarrow \mathbb{R}\cup\{+\infty\}\)</span> is a <em>proper</em>, <em>lower semicontinuous</em> and
<em>convex functional</em> potentially with <em>simple proximal operator</em> or <em>Lipschitz-differentiable</em>,</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathcal{H}:\mathbb{R}^M\rightarrow \mathbb{R}\cup\{+\infty\}\)</span> is a <em>proper</em>, <em>lower semicontinuous</em> and
<em>convex functional</em> with <em>simple proximal operator</em>,</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathbf{K}:\mathbb{R}^N\rightarrow \mathbb{R}^M\)</span> is a <em>linear operator</em> with <strong>operator norm</strong>
<span class="math notranslate nohighlight">\(\Vert{\mathbf{K}}\Vert_2\)</span>.</p></li>
</ul>
<section id="id54">
<h3>Remarks<a class="headerlink" href="#id54" title="Link to this heading">#</a></h3>
<ul>
<li><p>The problem is <em>feasible</em>, i.e. there exists at least one solution.</p></li>
<li><p>The algorithm is still valid if either <span class="math notranslate nohighlight">\(\mathcal{F}\)</span> or <span class="math notranslate nohighlight">\(\mathcal{H}\)</span> is zero.</p></li>
<li><p>When <span class="math notranslate nohighlight">\(\mathbf{K} = \mathbf{I}_{N}\)</span>, ADMM is equivalent to the <a class="reference internal" href="#pyxu.opt.solver.pds.DouglasRachford" title="pyxu.opt.solver.pds.DouglasRachford"><code class="xref py py-func docutils literal notranslate"><span class="pre">DouglasRachford()</span></code></a>
method (up to a change of variable, see <a class="reference internal" href="../references.html#psa" id="id55"><span>[PSA]</span></a> for a derivation).</p></li>
<li><p>This is an implementation of the algorithm described in Section 5.4 of <a class="reference internal" href="../references.html#psa" id="id56"><span>[PSA]</span></a>, which handles the non-smooth
composite term <span class="math notranslate nohighlight">\(\mathcal{H}(\mathbf{K}\mathbf{x})\)</span> by means of a change of variable and an infimal
postcomposition trick.
The update equation of this algorithm involves the following <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>-minimization step:</p>
<div class="math notranslate nohighlight" id="equation-eq-x-minimization">
<span class="eqno">(1)<a class="headerlink" href="#equation-eq-x-minimization" title="Link to this equation">#</a></span>\[\mathcal{V} = \operatorname*{arg\,min}_{\mathbf{x} \in \mathbb{R}^N} \quad \mathcal{F}(\mathbf{x}) + \frac1{2 \tau}
\Vert \mathbf{K} \mathbf{x} - \mathbf{a} \Vert_2^2,\]</div>
<p>where <span class="math notranslate nohighlight">\(\tau\)</span> is the primal step size and <span class="math notranslate nohighlight">\(\mathbf{a} \in \mathbb{R}^M\)</span> is an iteration-dependant vector.</p>
<p>The following cases are covered in this implementation:</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(\mathbf{K}\)</span> is <code class="docutils literal notranslate"><span class="pre">None</span></code> (i.e. the identity operator) and <span class="math notranslate nohighlight">\(\mathcal{F}\)</span> is a <a class="reference internal" href="abc.html#pyxu.abc.operator.ProxFunc" title="pyxu.abc.operator.ProxFunc"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProxFunc</span></code></a>.
Then, <a class="reference internal" href="#equation-eq-x-minimization">(1)</a> has a single solution provided by
<span class="math notranslate nohighlight">\(\operatorname*{prox}_{\tau \mathcal{F}}(\mathbf{a})\)</span>.
This yields the <em>classical ADMM algorithm</em> described in Section 5.3 of <a class="reference internal" href="../references.html#psa" id="id57"><span>[PSA]</span></a> (i.e. without the postcomposition trick).</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathcal{F}\)</span> is a <a class="reference internal" href="abc.html#pyxu.abc.operator.QuadraticFunc" title="pyxu.abc.operator.QuadraticFunc"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuadraticFunc</span></code></a>, i.e.
<span class="math notranslate nohighlight">\(\mathcal{F}(\mathbf{x})=\frac{1}{2} \langle\mathbf{x}, \mathbf{Q}\mathbf{x}\rangle + \mathbf{c}^T\mathbf{x} + t\)</span>.
Then the unique solution to <a class="reference internal" href="#equation-eq-x-minimization">(1)</a> is obtained by solving a linear system of the form:</p>
<div class="math notranslate nohighlight" id="equation-eq-linear-system">
<span class="eqno">(2)<a class="headerlink" href="#equation-eq-linear-system" title="Link to this equation">#</a></span>\[\Big( \mathbf{Q} + \frac1\tau \mathbf{K}^* \mathbf{K} \Big) \mathbf{x} =
\frac1\tau \mathbf{K}^\ast\mathbf{a}-\mathbf{c}, \qquad \mathbf{x} \in \mathbb{R}^N.\]</div>
<p>This linear system is solved via a sub-iterative <a class="reference internal" href="#pyxu.opt.solver.cg.CG" title="pyxu.opt.solver.cg.CG"><code class="xref py py-class docutils literal notranslate"><span class="pre">CG</span></code></a> algorithm involving the repeated
application of <span class="math notranslate nohighlight">\(\mathbf{Q}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{K}^{*}\mathbf{K}\)</span>.
This sub-iterative scheme may be computationally intensive if these operators do not admit fast matrix-free implementations.</p>
</li>
<li><p><span class="math notranslate nohighlight">\(\mathcal{F}\)</span> is a <a class="reference internal" href="abc.html#pyxu.abc.operator.DiffFunc" title="pyxu.abc.operator.DiffFunc"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiffFunc</span></code></a>.
Then, <a class="reference internal" href="#equation-eq-x-minimization">(1)</a> is solved via a sub-iterative <a class="reference internal" href="#pyxu.opt.solver.nlcg.NLCG" title="pyxu.opt.solver.nlcg.NLCG"><code class="xref py py-class docutils literal notranslate"><span class="pre">NLCG</span></code></a> algorithm
involving repeated evaluation of <span class="math notranslate nohighlight">\(\nabla\mathcal{F}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{K}^{*}\mathbf{K}\)</span>.
This sub-iterative scheme may be costly if these operators cannot be evaluated with fast algorithms.
In this scenario, the use of multiple initial points in <a class="reference internal" href="abc.html#pyxu.abc.solver.Solver.fit" title="pyxu.abc.solver.Solver.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit()</span></code></a> is not supported.</p></li>
</ul>
<p>The user may also provide a <em>custom</em> callable solver <span class="math notranslate nohighlight">\(s: \mathbb{R}^M \times \mathbb{R} \to \mathbb{R}^N\)</span>,
taking as input <span class="math notranslate nohighlight">\((\mathbf{a}, \tau)\)</span> and solving <a class="reference internal" href="#equation-eq-x-minimization">(1)</a>,
i.e. <span class="math notranslate nohighlight">\(s(\mathbf{a}, \tau) \in \mathcal{V}\)</span>. (See example below.)
If <a class="reference internal" href="#pyxu.opt.solver.pds.ADMM" title="pyxu.opt.solver.pds.ADMM"><code class="xref py py-class docutils literal notranslate"><span class="pre">ADMM</span></code></a> is initialized with such a solver, then the latter is used to solve
<a class="reference internal" href="#equation-eq-x-minimization">(1)</a> regardless of whether one of the above-mentioned cases is met.</p>
</li>
<li><p>Unlike traditional implementations of ADMM, <a class="reference internal" href="#pyxu.opt.solver.pds.ADMM" title="pyxu.opt.solver.pds.ADMM"><code class="xref py py-class docutils literal notranslate"><span class="pre">ADMM</span></code></a> supports relaxation, i.e. <span class="math notranslate nohighlight">\(\rho\neq 1\)</span>.</p></li>
</ul>
</section>
<section id="id58">
<h3>Parameters (<code class="docutils literal notranslate"><span class="pre">__init__()</span></code>)<a class="headerlink" href="#id58" title="Link to this heading">#</a></h3>
<ul>
<li><p><strong>f</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.DiffFunc" title="pyxu.abc.operator.DiffFunc"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiffFunc</span></code></a>, <a class="reference internal" href="abc.html#pyxu.abc.operator.ProxFunc" title="pyxu.abc.operator.ProxFunc"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProxFunc</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
Differentiable or proximable function <span class="math notranslate nohighlight">\(\mathcal{F}\)</span>.</p></li>
<li><p><strong>h</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.ProxFunc" title="pyxu.abc.operator.ProxFunc"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProxFunc</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
Proximable function <span class="math notranslate nohighlight">\(\mathcal{H}\)</span>.</p></li>
<li><p><strong>K</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.LinOp" title="pyxu.abc.operator.LinOp"><code class="xref py py-class docutils literal notranslate"><span class="pre">LinOp</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
Linear operator <span class="math notranslate nohighlight">\(\mathbf{K}\)</span>.</p></li>
<li><p><strong>solver</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callable</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
Custom callable to solve the <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>-minimization step <a class="reference internal" href="#equation-eq-x-minimization">(1)</a>.</p>
<p>If provided, <code class="code docutils literal notranslate"><span class="pre">solver</span></code> must have the <a class="reference external" href="https://numpy.org/neps/nep-0020-gufunc-signature-enhancement.html">NumPy signature</a>
<code class="docutils literal notranslate"><span class="pre">(n),</span> <span class="pre">(1)</span> <span class="pre">-&gt;</span> <span class="pre">(n)</span></code>.</p>
</li>
<li><p><strong>solver_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>)
–
Keyword parameters passed to the <code class="docutils literal notranslate"><span class="pre">__init__()</span></code> method of sub-iterative
<a class="reference internal" href="#pyxu.opt.solver.cg.CG" title="pyxu.opt.solver.cg.CG"><code class="xref py py-class docutils literal notranslate"><span class="pre">CG</span></code></a> or <a class="reference internal" href="#pyxu.opt.solver.nlcg.NLCG" title="pyxu.opt.solver.nlcg.NLCG"><code class="xref py py-class docutils literal notranslate"><span class="pre">NLCG</span></code></a> solvers.</p>
<p><code class="code docutils literal notranslate"><span class="pre">solver_kwargs</span></code> is ignored if <code class="code docutils literal notranslate"><span class="pre">solver</span></code> provided.</p>
</li>
<li><p><strong>**kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>)
–
Other keyword parameters passed on to <a class="reference internal" href="abc.html#pyxu.abc.solver.Solver.__init__" title="pyxu.abc.solver.Solver.__init__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pyxu.abc.solver.Solver.__init__()</span></code></a>.</p></li>
</ul>
</section>
<section id="id59">
<h3>Parameters (<code class="docutils literal notranslate"><span class="pre">fit()</span></code>)<a class="headerlink" href="#id59" title="Link to this heading">#</a></h3>
<ul>
<li><p><strong>x0</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-attr docutils literal notranslate"><span class="pre">NDArray</span></code></a>)
–
(…, N) initial point(s) for the primal variable.</p></li>
<li><p><strong>z0</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-attr docutils literal notranslate"><span class="pre">NDArray</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
(…, M) initial point(s) for the dual variable.
If <code class="docutils literal notranslate"><span class="pre">None</span></code> (default), then use <code class="docutils literal notranslate"><span class="pre">K(x0)</span></code> as the initial point for the dual variable.</p></li>
<li><p><strong>tau</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Real</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
Primal step size.</p></li>
<li><p><strong>rho</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Real</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)
–
Momentum parameter for relaxation.</p></li>
<li><p><strong>tuning_strategy</strong> (1, 2, 3)
–
Strategy to be employed when setting the hyperparameters (default to 1).
See base class for more details.</p></li>
<li><p><strong>solver_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>)
–
Keyword parameters passed to the <code class="docutils literal notranslate"><span class="pre">fit()</span></code> method of sub-iterative
<a class="reference internal" href="#pyxu.opt.solver.cg.CG" title="pyxu.opt.solver.cg.CG"><code class="xref py py-class docutils literal notranslate"><span class="pre">CG</span></code></a> or <a class="reference internal" href="#pyxu.opt.solver.nlcg.NLCG" title="pyxu.opt.solver.nlcg.NLCG"><code class="xref py py-class docutils literal notranslate"><span class="pre">NLCG</span></code></a> solvers.</p>
<p><code class="code docutils literal notranslate"><span class="pre">solver_kwargs</span></code> is ignored if <code class="code docutils literal notranslate"><span class="pre">solver</span></code> was provided in <code class="docutils literal notranslate"><span class="pre">__init__()</span></code>.</p>
</li>
<li><p><strong>**kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>)
–
Other keyword parameters passed on to <a class="reference internal" href="abc.html#pyxu.abc.solver.Solver.fit" title="pyxu.abc.solver.Solver.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pyxu.abc.solver.Solver.fit()</span></code></a>.</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><code class="docutils literal notranslate"><span class="pre">tuning_strategy</span></code> docstring says to look at base class for details, but nothing mentioned there!</p>
</div>
<p class="rubric">Example</p>
<p>Consider the following optimization problem:</p>
<div class="math notranslate nohighlight">
\[\min_{\mathbf{x}\in\mathbb{R}^N}\frac{1}{2}\left\|\mathbf{y}-\mathbf{G}\mathbf{x}\right\|_2^2\quad+\quad\lambda \|\mathbf{D}\mathbf{x}\|_1,\]</div>
<p>with <span class="math notranslate nohighlight">\(\mathbf{D}\in\mathbb{R}^{N\times N}\)</span> the discrete second-order derivative operator,
<span class="math notranslate nohighlight">\(\mathbf{G}\in\mathbb{R}^{M\times N}, \, \mathbf{y}\in\mathbb{R}^M, \lambda&gt;0.\)</span>
This problem can be solved via ADMM with <span class="math notranslate nohighlight">\(\mathcal{F}(\mathbf{x})= \frac{1}{2}\left\|\mathbf{y}-\mathbf{G}\mathbf{x}\right\|_2^2\)</span>,
<span class="math notranslate nohighlight">\(\mathcal{H}(\mathbf{x})=\lambda \|\mathbf{D}\mathbf{x}\|_1,\)</span> and <span class="math notranslate nohighlight">\(\mathbf{K}=\mathbf{D}\)</span>.
The functional <span class="math notranslate nohighlight">\(\mathcal{F}\)</span> being quadratic, the <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>-minimization step consists in solving a linear system of
the form <a class="reference internal" href="#equation-eq-linear-system">(2)</a>.
Here, we demonstrate how to provide a custom solver, which consists in applying a matrix inverse, for this step.
Otherwise, a sub-iterative <a class="reference internal" href="#pyxu.opt.solver.cg.CG" title="pyxu.opt.solver.cg.CG"><code class="xref py py-class docutils literal notranslate"><span class="pre">CG</span></code></a> algorithm would have been used automatically instead.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/pyplot_summary.html#module-matplotlib.pyplot" title="matplotlib.pyplot"><span class="nn">matplotlib.pyplot</span></a> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/index.html#module-numpy" title="numpy"><span class="nn">numpy</span></a> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pyxu.abc</span> <span class="k">as</span> <span class="nn">pxa</span>
<span class="kn">import</span> <span class="nn">pyxu.operator</span> <span class="k">as</span> <span class="nn">pxo</span>
<span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://docs.scipy.org/doc/scipy/index.html#module-scipy" title="scipy"><span class="nn">scipy</span></a> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">from</span> <span class="nn">pyxu.opt.solver</span> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../api/opt.html#pyxu.opt.solver.pds.ADMM" title="pyxu.opt.solver.pds.ADMM"><span class="n">ADMM</span></a>

<span class="n">N</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c1"># Dimension of the problem</span>

<span class="c1"># Generate piecewise-linear ground truth</span>
<span class="n">x_gt</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="numpy.array"><span class="n">np</span><span class="o">.</span><span class="n">array</span></a><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">90</span><span class="p">])</span>  <span class="c1"># Knot locations</span>
<span class="n">a_gt</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="numpy.array"><span class="n">np</span><span class="o">.</span><span class="n">array</span></a><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">])</span>  <span class="c1"># Amplitudes of the knots</span>
<span class="n">gt</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">(</span><span class="n">N</span><span class="p">)</span>  <span class="c1"># Ground-truth signal</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/stdtypes.html#range" title="range"><span class="nb">range</span></a><span class="p">(</span><a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#len" title="len"><span class="nb">len</span></a><span class="p">(</span><span class="n">x_gt</span><span class="p">)):</span>
    <span class="n">gt</span><span class="p">[</span><span class="n">x_gt</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="p">:]</span> <span class="o">+=</span> <span class="n">a_gt</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">*</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="n">x_gt</span><span class="p">[</span><span class="n">n</span><span class="p">])</span> <span class="o">/</span> <span class="n">N</span>

<span class="c1"># Generate data (noisy samples at random locations)</span>
<span class="n">M</span> <span class="o">=</span> <span class="mi">20</span>  <span class="c1"># Number of data points</span>
<span class="n">rng</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/random/generator.html#numpy.random.default_rng" title="numpy.random.default_rng"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span></a><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">x_samp</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="n">N</span> <span class="o">//</span> <span class="n">M</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">M</span><span class="p">)</span> <span class="o">+</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="n">N</span> <span class="o">//</span> <span class="n">M</span><span class="p">)</span>  <span class="c1"># sampling locations</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="mf">1e-2</span>  <span class="c1"># noise variance</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">gt</span><span class="p">[</span><span class="n">x_samp</span><span class="p">]</span> <span class="o">+</span> <span class="n">sigma</span> <span class="o">*</span> <span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">M</span><span class="p">)</span>  <span class="c1"># noisy data points</span>

<span class="c1"># Data-fidelity term</span>
<a class="sphinx-codeautolink-a" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.lil_matrix.html#scipy.sparse.lil_matrix" title="scipy.sparse._lil.lil_matrix"><span class="n">subsamp_mat</span></a> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.lil_matrix.html#scipy.sparse.lil_matrix" title="scipy.sparse._lil.lil_matrix"><span class="n">sp</span><span class="o">.</span><span class="n">sparse</span><span class="o">.</span><span class="n">lil_matrix</span></a><span class="p">((</span><span class="n">M</span><span class="p">,</span> <span class="n">N</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/stdtypes.html#range" title="range"><span class="nb">range</span></a><span class="p">(</span><span class="n">M</span><span class="p">):</span>
    <a class="sphinx-codeautolink-a" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.lil_matrix.html#scipy.sparse.lil_matrix" title="scipy.sparse._lil.lil_matrix"><span class="n">subsamp_mat</span></a><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">x_samp</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">G</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../api/abc.html#pyxu.abc.operator.LinOp.from_array" title="pyxu.abc.operator.LinOp.from_array"><span class="n">pxa</span><span class="o">.</span><span class="n">LinOp</span><span class="o">.</span><span class="n">from_array</span></a><span class="p">(</span><span class="n">subsamp_mat</span><span class="o">.</span><span class="n">tocsr</span><span class="p">())</span>
<span class="n">F</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <a class="sphinx-codeautolink-a" href="../api/operator/func.html#pyxu.operator.func.norm.SquaredL2Norm" title="pyxu.operator.func.norm.SquaredL2Norm"><span class="n">pxo</span><span class="o">.</span><span class="n">SquaredL2Norm</span></a><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">y</span><span class="o">.</span><span class="n">size</span><span class="p">)</span><span class="o">.</span><a class="sphinx-codeautolink-a" href="../api/abc.html#pyxu.abc.operator.Operator.argshift" title="pyxu.abc.operator.Operator.argshift"><span class="n">argshift</span></a><span class="p">(</span><span class="o">-</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="n">G</span>
<span class="n">F</span><span class="o">.</span><span class="n">diff_lipschitz</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">estimate_diff_lipschitz</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">"svd"</span><span class="p">)</span>

<span class="c1"># Regularization term (promotes sparse second derivatives)</span>
<span class="n">deriv_mat</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.diags.html#scipy.sparse.diags" title="scipy.sparse.diags"><span class="n">sp</span><span class="o">.</span><span class="n">sparse</span><span class="o">.</span><span class="n">diags</span></a><span class="p">(</span><span class="n">diagonals</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">offsets</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="p">))</span>
<span class="n">D</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../api/abc.html#pyxu.abc.operator.LinOp.from_array" title="pyxu.abc.operator.LinOp.from_array"><span class="n">pxa</span><span class="o">.</span><span class="n">LinOp</span><span class="o">.</span><span class="n">from_array</span></a><span class="p">(</span><span class="n">deriv_mat</span><span class="p">)</span>
<span class="n">_lambda</span> <span class="o">=</span> <span class="mf">1e-1</span>  <span class="c1"># regularization parameter</span>
<span class="n">H</span> <span class="o">=</span> <span class="n">_lambda</span> <span class="o">*</span> <a class="sphinx-codeautolink-a" href="../api/operator/func.html#pyxu.operator.func.norm.L1Norm" title="pyxu.operator.func.norm.L1Norm"><span class="n">pxo</span><span class="o">.</span><span class="n">L1Norm</span></a><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">D</span><span class="o">.</span><span class="n">codim</span><span class="p">)</span>

<span class="c1"># Solver for ADMM</span>
<span class="n">tau</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">_lambda</span>  <span class="c1"># internal ADMM parameter</span>
<span class="c1"># Inverse operator to solve the linear system</span>
<span class="n">A_inv</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.linalg.inv.html#scipy.linalg.inv" title="scipy.linalg.inv"><span class="n">sp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span></a><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">gram</span><span class="p">()</span><span class="o">.</span><span class="n">asarray</span><span class="p">()</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">tau</span><span class="p">)</span> <span class="o">*</span> <span class="n">D</span><span class="o">.</span><span class="n">gram</span><span class="p">()</span><span class="o">.</span><span class="n">asarray</span><span class="p">())</span>

<span class="k">def</span> <span class="nf">solver_ADMM</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">tau</span><span class="p">):</span>
    <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">tau</span><span class="p">)</span> <span class="o">*</span> <span class="n">D</span><span class="o">.</span><span class="n">adjoint</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span> <span class="o">+</span> <span class="n">G</span><span class="o">.</span><span class="n">adjoint</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">A_inv</span> <span class="o">@</span> <span class="n">b</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>


<span class="c1"># Solve optimization problem</span>
<a class="sphinx-codeautolink-a" href="../api/opt.html#pyxu.opt.solver.pds.ADMM" title="pyxu.opt.solver.pds.ADMM"><span class="n">admm</span></a> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../api/opt.html#pyxu.opt.solver.pds.ADMM" title="pyxu.opt.solver.pds.ADMM"><span class="n">ADMM</span></a><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">F</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="n">H</span><span class="p">,</span> <span class="n">K</span><span class="o">=</span><span class="n">D</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="n">solver_ADMM</span><span class="p">,</span><span class="n">show_progress</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># with solver</span>
<a class="sphinx-codeautolink-a" href="../api/abc.html#pyxu.abc.solver.Solver.fit" title="pyxu.abc.solver.Solver.fit"><span class="n">admm</span><span class="o">.</span><span class="n">fit</span></a><span class="p">(</span><span class="n">x0</span><span class="o">=</span><a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">tau</span><span class="o">=</span><span class="n">tau</span><span class="p">)</span>
<span class="n">x_opt</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../api/abc.html#pyxu.abc.solver.Solver.solution" title="pyxu.abc.solver.Solver.solution"><span class="n">admm</span><span class="o">.</span><span class="n">solution</span></a><span class="p">()</span>  <span class="c1"># reconstructed signal</span>

<span class="c1"># Plots</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">gt</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Ground truth"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">x_samp</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s2">"kx"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Noisy data points"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">x_opt</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Reconstructed signal"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.legend.html#matplotlib.pyplot.legend" title="matplotlib.pyplot.legend"><span class="n">plt</span><span class="o">.</span><span class="n">legend</span></a><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../_downloads/4769d18f8e2c0bf193e34be59a343ebb/opt-3.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../_downloads/e92a40fb9538516e44ee3d2080a0bba4/opt-3.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/aef880f23607764f0dad2e327f5d24fd/opt-3.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/2b553e753c10e27428470a2afb36677c/opt-3.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../_images/opt-3.png" class="plot-directive" src="../_images/opt-3.png"/>
</figure>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyxu.opt.solver.pds.CondatVu" title="pyxu.opt.solver.pds.CondatVu"><code class="xref py py-class docutils literal notranslate"><span class="pre">CondatVu</span></code></a>, <a class="reference internal" href="#pyxu.opt.solver.pds.PD3O" title="pyxu.opt.solver.pds.PD3O"><code class="xref py py-class docutils literal notranslate"><span class="pre">PD3O</span></code></a>, <a class="reference internal" href="#pyxu.opt.solver.pgd.PGD" title="pyxu.opt.solver.pgd.PGD"><code class="xref py py-class docutils literal notranslate"><span class="pre">PGD</span></code></a>, <a class="reference internal" href="#pyxu.opt.solver.pds.ChambollePock" title="pyxu.opt.solver.pds.ChambollePock"><code class="xref py py-func docutils literal notranslate"><span class="pre">ChambollePock()</span></code></a>, <a class="reference internal" href="#pyxu.opt.solver.pds.DouglasRachford" title="pyxu.opt.solver.pds.DouglasRachford"><code class="xref py py-func docutils literal notranslate"><span class="pre">DouglasRachford()</span></code></a></p>
</div>
</section>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.Func" title="pyxu.abc.operator.Func"><em>Func</em></a><em> | </em><em>None</em>) – </p></li>
<li><p><strong>h</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.ProxFunc" title="pyxu.abc.operator.ProxFunc"><em>ProxFunc</em></a><em> | </em><em>None</em>) – </p></li>
<li><p><strong>K</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.DiffMap" title="pyxu.abc.operator.DiffMap"><em>DiffMap</em></a><em> | </em><em>None</em>) – </p></li>
<li><p><strong>solver</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><em>Callable</em></a><em>[</em><em>[</em><a class="reference internal" href="info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><em>NDArray</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>]</em><em>, </em><a class="reference internal" href="info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><em>NDArray</em></a><em>]</em>) – </p></li>
<li><p><strong>solver_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><em>dict</em></a><em> | </em><em>None</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>
</section>
</section>
</article>
<footer class="bd-footer-article">
<div class="footer-article-items footer-article__inner">
<div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
<a class="left-prev" href="abc.html" title="previous page">
<i class="fa-solid fa-angle-left"></i>
<div class="prev-next-info">
<p class="prev-next-subtitle">previous</p>
<p class="prev-next-title">pyxu.abc</p>
</div>
</a>
<a class="right-next" href="operator/index.html" title="next page">
<div class="prev-next-info">
<p class="prev-next-subtitle">next</p>
<p class="prev-next-title">pyxu.operator</p>
</div>
<i class="fa-solid fa-angle-right"></i>
</a>
</div></div>
</div>
</footer>
</div>
<div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">
<div class="sidebar-secondary-item">
<div class="page-toc tocsection onthispage">
<i class="fa-solid fa-list"></i> On this page
  </div>
<nav class="bd-toc-nav page-toc">
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu-opt-stop">pyxu.opt.stop</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.opt.stop.MaxIter"><code class="docutils literal notranslate"><span class="pre">MaxIter</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.opt.stop.MaxIter.__init__"><code class="docutils literal notranslate"><span class="pre">MaxIter.__init__()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.opt.stop.ManualStop"><code class="docutils literal notranslate"><span class="pre">ManualStop</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.opt.stop.ManualStop.__init__"><code class="docutils literal notranslate"><span class="pre">ManualStop.__init__()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.opt.stop.MaxDuration"><code class="docutils literal notranslate"><span class="pre">MaxDuration</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.opt.stop.MaxDuration.__init__"><code class="docutils literal notranslate"><span class="pre">MaxDuration.__init__()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.opt.stop.MaxCarbon"><code class="docutils literal notranslate"><span class="pre">MaxCarbon</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.opt.stop.MaxCarbon.__init__"><code class="docutils literal notranslate"><span class="pre">MaxCarbon.__init__()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.opt.stop.Memorize"><code class="docutils literal notranslate"><span class="pre">Memorize</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.opt.stop.Memorize.__init__"><code class="docutils literal notranslate"><span class="pre">Memorize.__init__()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.opt.stop.AbsError"><code class="docutils literal notranslate"><span class="pre">AbsError</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.opt.stop.AbsError.__init__"><code class="docutils literal notranslate"><span class="pre">AbsError.__init__()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.opt.stop.RelError"><code class="docutils literal notranslate"><span class="pre">RelError</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.opt.stop.RelError.__init__"><code class="docutils literal notranslate"><span class="pre">RelError.__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu-opt-solver">pyxu.opt.solver</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.opt.solver.pgd.PGD"><code class="docutils literal notranslate"><span class="pre">PGD</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.opt.solver.cg.CG"><code class="docutils literal notranslate"><span class="pre">CG</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.opt.solver.nlcg.NLCG"><code class="docutils literal notranslate"><span class="pre">NLCG</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.opt.solver.prox_adam.ProxAdam"><code class="docutils literal notranslate"><span class="pre">ProxAdam</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.opt.solver.pds.CondatVu"><code class="docutils literal notranslate"><span class="pre">CondatVu</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.opt.solver.pds.CV"><code class="docutils literal notranslate"><span class="pre">CV</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.opt.solver.pds.PD3O"><code class="docutils literal notranslate"><span class="pre">PD3O</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.opt.solver.pds.ChambollePock"><code class="docutils literal notranslate"><span class="pre">ChambollePock()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.opt.solver.pds.CP"><code class="docutils literal notranslate"><span class="pre">CP()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.opt.solver.pds.LorisVerhoeven"><code class="docutils literal notranslate"><span class="pre">LorisVerhoeven</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.opt.solver.pds.LV"><code class="docutils literal notranslate"><span class="pre">LV</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.opt.solver.pds.DavisYin"><code class="docutils literal notranslate"><span class="pre">DavisYin</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.opt.solver.pds.DY"><code class="docutils literal notranslate"><span class="pre">DY</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.opt.solver.pds.DouglasRachford"><code class="docutils literal notranslate"><span class="pre">DouglasRachford()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.opt.solver.pds.DR"><code class="docutils literal notranslate"><span class="pre">DR()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.opt.solver.pds.ForwardBackward"><code class="docutils literal notranslate"><span class="pre">ForwardBackward</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.opt.solver.pds.FB"><code class="docutils literal notranslate"><span class="pre">FB</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.opt.solver.pds.ProximalPoint"><code class="docutils literal notranslate"><span class="pre">ProximalPoint()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.opt.solver.pds.PP"><code class="docutils literal notranslate"><span class="pre">PP()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.opt.solver.pds.ADMM"><code class="docutils literal notranslate"><span class="pre">ADMM</span></code></a></li>
</ul>
</li>
</ul>
</nav></div>
<div class="sidebar-secondary-item">
<div id="searchbox"></div></div>
<div class="sidebar-secondary-item">
<div class="tocsection editthispage">
<a href="https://github.com/matthieumeo/pyxu/edit/main/doc/api/opt.rst">
<i class="fa-solid fa-pencil"></i>
      
      
        
          Edit on GitHub
        
      
    </a>
</div>
</div>
<div class="sidebar-secondary-item">
<div class="tocsection sourcelink">
<a href="../_sources/api/opt.rst">
<i class="fa-solid fa-file-lines"></i> Show Source
    </a>
</div>
</div>
</div></div>
</div>
<footer class="bd-footer-content">
</footer>
</main>
</div>
</div>
<!-- Scripts loaded after <body> so the DOM is not blocked -->
<script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>
<footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
<div class="footer-items__start">
<div class="footer-item">
<p class="copyright">
    
      © Copyright 2023, M. Simeoni, S. Kashani, J. Rué-Queralt &amp; Pyxu Developers.
      <br/>
</p>
</div>
<div class="footer-item">
<p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.5.
    <br/>
</p>
</div>
<div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.13.3.
</p></div>
</div>
<div class="footer-items__end">
<div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.13.3.
</p></div>
</div>
</div>
</footer>
</body>
</html>