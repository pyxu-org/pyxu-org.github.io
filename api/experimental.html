
<!DOCTYPE html>

<html data-theme="light" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/><meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>pyxu.experimental — Pyxu Documentation</title>
<script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "light";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
<!-- Loaded before other Sphinx assets -->
<link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet"/>
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet"/>
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet"/>
<link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet"/>
<link as="font" crossorigin="" href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" rel="preload" type="font/woff2"/>
<link href="../_static/pygments.css?v=fa44fd50" rel="stylesheet" type="text/css"/>
<link href="../_static/plot_directive.css?v=7f9a90b1" rel="stylesheet" type="text/css"/>
<link href="../_static/sphinx-codeautolink.css?v=125d5c1c" rel="stylesheet" type="text/css"/>
<link href="../_static/copybutton.css?v=76b2166b" rel="stylesheet" type="text/css"/>
<link href="../_static/togglebutton.css?v=13237357" rel="stylesheet" type="text/css"/>
<link href="../_static/sg_gallery.css?v=61a4c737" rel="stylesheet" type="text/css"/>
<link href="../_static/sg_gallery-binder.css?v=f4aeca0c" rel="stylesheet" type="text/css"/>
<link href="../_static/sg_gallery-dataframe.css?v=2082cf3c" rel="stylesheet" type="text/css"/>
<link href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" rel="stylesheet" type="text/css"/>
<link href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" rel="stylesheet" type="text/css"/>
<link href="../_static/css/custom.css?v=1031a718" rel="stylesheet" type="text/css"/>
<!-- Pre-loaded scripts that we'll load fully later -->
<link as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" rel="preload"/>
<link as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" rel="preload"/>
<script src="../_static/documentation_options.js?v=e02fc88f"></script>
<script src="../_static/doctools.js?v=888ff710"></script>
<script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
<script src="../_static/clipboard.min.js?v=a7894cd8"></script>
<script src="../_static/copybutton.js?v=30646c52"></script>
<script>let toggleHintShow = 'Click to show';</script>
<script>let toggleHintHide = 'Click to hide';</script>
<script>let toggleOpenOnPrint = 'true';</script>
<script src="../_static/togglebutton.js?v=4a39c7ea"></script>
<script src="../_static/design-tabs.js?v=36754332"></script>
<script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
<script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
<script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
<script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
<script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>DOCUMENTATION_OPTIONS.pagename = 'api/experimental';</script>
<link href="../_static/favicon.png" rel="icon"/>
<link href="../genindex.html" rel="index" title="Index"/>
<link href="../search.html" rel="search" title="Search"/>
<link href="../references.html" rel="next" title="References"/>
<link href="info.html" rel="prev" title="pyxu.info"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="en" name="docsearch:language"/>
</head>
<body data-bs-root-margin="0px 0px -60%" data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-default-mode="light" data-offset="180">
<a class="skip-link" href="#main-content">Skip to main content</a>
<input class="sidebar-toggle" id="__primary" name="__primary" type="checkbox"/>
<label class="overlay overlay-primary" for="__primary"></label>
<input class="sidebar-toggle" id="__secondary" name="__secondary" type="checkbox"/>
<label class="overlay overlay-secondary" for="__secondary"></label>
<div class="search-button__wrapper">
<div class="search-button__overlay"></div>
<div class="search-button__search-container">
<form action="../search.html" class="bd-search d-flex align-items-center" method="get">
<i class="fa-solid fa-magnifying-glass"></i>
<input aria-label="Search the docs ..." autocapitalize="off" autocomplete="off" autocorrect="off" class="form-control" id="search-input" name="q" placeholder="Search the docs ..." spellcheck="false" type="search"/>
<span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
</div>
<nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
<label class="sidebar-toggle primary-toggle" for="__primary">
<span class="fa-solid fa-bars"></span>
</label>
<div class="navbar-header-items__start">
<div class="navbar-item">
<a class="navbar-brand logo" href="../index.html">
<img alt="Logo image" class="logo__image only-light" src="../_static/logo.png"/>
<script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
</a></div>
</div>
<div class="col-lg-9 navbar-header-items">
<div class="me-auto navbar-header-items__center">
<div class="navbar-item"><nav class="navbar-nav">
<p aria-label="Site Navigation" aria-level="1" class="sidebar-header-items__title" role="heading">
    Site Navigation
  </p>
<ul class="bd-navbar-elements navbar-nav">
<li class="nav-item">
<a class="nav-link nav-internal" href="../intro/index.html">
                        Getting Started
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../guide/index.html">
                        User Guide
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../examples/index.html">
                        Example Gallery
                      </a>
</li>
<li class="nav-item current active">
<a class="nav-link nav-internal" href="index.html">
                        API Reference
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../fair/index.html">
                        Extending Pyxu
                      </a>
</li>
</ul>
</nav></div>
</div>
<div class="navbar-header-items__end">
<div class="navbar-item navbar-persistent--container">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
</div>
<div class="navbar-item"><strong> v1.0.x </strong></div>
<div class="navbar-item"><ul aria-label="Icon Links" class="navbar-icon-links navbar-nav">
<li class="nav-item">
<a class="nav-link" data-bs-placement="bottom" data-bs-toggle="tooltip" href="https://github.com/matthieumeo/pyxu" rel="noopener" target="_blank" title="GitHub"><span><i class="fa-brands fa-github"></i></span>
<label class="sr-only">GitHub</label></a>
</li>
<li class="nav-item">
<a class="nav-link" data-bs-placement="bottom" data-bs-toggle="tooltip" href="https://pypi.org/project/pyxu/" rel="noopener" target="_blank" title="PyPI"><span><i class="fa-brands fa-python"></i></span>
<label class="sr-only">PyPI</label></a>
</li>
<li class="nav-item">
<a class="nav-link" data-bs-placement="bottom" data-bs-toggle="tooltip" href="mailto: matthieu.simeoni@gmail.com" rel="noopener" target="_blank" title="Contact"><span><i class="fa-brands fa-telegram"></i></span>
<label class="sr-only">Contact</label></a>
</li>
<li class="nav-item">
<a class="nav-link" data-bs-placement="bottom" data-bs-toggle="tooltip" href="https://imaging.epfl.ch/" rel="noopener" target="_blank" title="EPFL Center for Imaging"><img alt="EPFL Center for Imaging" class="icon-link-image" src="../_static/imaging.png"/></a>
</li>
</ul></div>
</div>
</div>
<div class="navbar-persistent--mobile">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
</div>
<label class="sidebar-toggle secondary-toggle" for="__secondary">
<span class="fa-solid fa-outdent"></span>
</label>
</div>
</nav>
<div class="bd-container">
<div class="bd-container__inner bd-page-width">
<div class="bd-sidebar-primary bd-sidebar">
<div class="sidebar-header-items sidebar-primary__section">
<div class="sidebar-header-items__center">
<div class="navbar-item"><nav class="navbar-nav">
<p aria-label="Site Navigation" aria-level="1" class="sidebar-header-items__title" role="heading">
    Site Navigation
  </p>
<ul class="bd-navbar-elements navbar-nav">
<li class="nav-item">
<a class="nav-link nav-internal" href="../intro/index.html">
                        Getting Started
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../guide/index.html">
                        User Guide
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../examples/index.html">
                        Example Gallery
                      </a>
</li>
<li class="nav-item current active">
<a class="nav-link nav-internal" href="index.html">
                        API Reference
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../fair/index.html">
                        Extending Pyxu
                      </a>
</li>
</ul>
</nav></div>
</div>
<div class="sidebar-header-items__end">
<div class="navbar-item"><strong> v1.0.x </strong></div>
<div class="navbar-item"><ul aria-label="Icon Links" class="navbar-icon-links navbar-nav">
<li class="nav-item">
<a class="nav-link" data-bs-placement="bottom" data-bs-toggle="tooltip" href="https://github.com/matthieumeo/pyxu" rel="noopener" target="_blank" title="GitHub"><span><i class="fa-brands fa-github"></i></span>
<label class="sr-only">GitHub</label></a>
</li>
<li class="nav-item">
<a class="nav-link" data-bs-placement="bottom" data-bs-toggle="tooltip" href="https://pypi.org/project/pyxu/" rel="noopener" target="_blank" title="PyPI"><span><i class="fa-brands fa-python"></i></span>
<label class="sr-only">PyPI</label></a>
</li>
<li class="nav-item">
<a class="nav-link" data-bs-placement="bottom" data-bs-toggle="tooltip" href="mailto: matthieu.simeoni@gmail.com" rel="noopener" target="_blank" title="Contact"><span><i class="fa-brands fa-telegram"></i></span>
<label class="sr-only">Contact</label></a>
</li>
<li class="nav-item">
<a class="nav-link" data-bs-placement="bottom" data-bs-toggle="tooltip" href="https://imaging.epfl.ch/" rel="noopener" target="_blank" title="EPFL Center for Imaging"><img alt="EPFL Center for Imaging" class="icon-link-image" src="../_static/imaging.png"/></a>
</li>
</ul></div>
</div>
</div>
<div class="sidebar-primary-items__start sidebar-primary__section">
<div class="sidebar-primary-item"><nav aria-label="Section Navigation" class="bd-docs-nav bd-links">
<p aria-level="1" class="bd-links__title" role="heading">Section Navigation</p>
<div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="abc.html">pyxu.abc</a></li>
<li class="toctree-l1"><a class="reference internal" href="opt.html">pyxu.opt</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="operator/index.html">pyxu.operator</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="operator/map.html">pyxu.operator.map</a></li>
<li class="toctree-l2"><a class="reference internal" href="operator/func.html">pyxu.operator.func</a></li>
<li class="toctree-l2"><a class="reference internal" href="operator/linop.html">pyxu.operator.linop</a></li>
<li class="toctree-l2"><a class="reference internal" href="operator/blocks.html">pyxu.operator.blocks</a></li>
<li class="toctree-l2"><a class="reference internal" href="operator/interop.html">pyxu.operator.interop</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="runtime.html">pyxu.runtime</a></li>
<li class="toctree-l1"><a class="reference internal" href="util.html">pyxu.util</a></li>
<li class="toctree-l1"><a class="reference internal" href="math.html">pyxu.math</a></li>
<li class="toctree-l1"><a class="reference internal" href="info.html">pyxu.info</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">pyxu.experimental</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
</ul>
</div>
</nav></div>
</div>
<div class="sidebar-primary-items__end sidebar-primary__section">
</div>
<div id="rtd-footer-container"></div>
</div>
<main class="bd-main" id="main-content">
<div class="bd-content">
<div class="bd-article-container">
<div class="bd-header-article">
<div class="header-article-items header-article__inner">
<div class="header-article-items__start">
<div class="header-article-item">
<nav aria-label="Breadcrumbs">
<ul aria-label="Breadcrumb" class="bd-breadcrumbs" role="navigation">
<li class="breadcrumb-item breadcrumb-home">
<a aria-label="Home" class="nav-link" href="../index.html">
<i class="fa-solid fa-home"></i>
</a>
</li>
<li class="breadcrumb-item"><a class="nav-link" href="index.html">API Reference</a></li>
<li aria-current="page" class="breadcrumb-item active">pyxu.experimental</li>
</ul>
</nav>
</div>
</div>
</div>
</div>
<div id="searchbox"></div>
<article class="bd-article" role="main">
<section id="module-pyxu.experimental.sampler">
<span id="pyxu-experimental"></span><h1>pyxu.experimental<a class="headerlink" href="#module-pyxu.experimental.sampler" title="Link to this heading">#</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="pyxu.experimental.sampler.MYULA">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MYULA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lamb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyxu/experimental/sampler/_sampler.html#MYULA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.experimental.sampler.MYULA" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyxu.experimental.sampler.ULA" title="pyxu.experimental.sampler._sampler.ULA"><code class="xref py py-class docutils literal notranslate"><span class="pre">ULA</span></code></a></p>
<p>Moreau-Yosida unajusted Langevin algorithm (MYULA).</p>
<p>Generates samples from the distribution</p>
<div class="math notranslate nohighlight">
\[p(\mathbf{x}) = \frac{\exp(-\mathcal{F}(\mathbf{x}) - \mathcal{G}(\mathbf{x}))}{\int_{\mathbb{R}^N}
\exp(-\mathcal{F}(\tilde{\mathbf{x}}) - \mathcal{G}(\tilde{\mathbf{x}})) \mathrm{d} \tilde{\mathbf{x}} },\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathcal{F}: \mathbb{R}^N \to \mathbb{R}\)</span> is <em>convex</em> and <em>differentiable</em> with <span class="math notranslate nohighlight">\(\beta\)</span>-
<em>Lipschitz continuous</em> gradient, and <span class="math notranslate nohighlight">\(\mathcal{G}: \mathbb{R}^N \to \mathbb{R}\)</span> is <em>proper</em>, <em>lower semi-
continuous</em> and <em>convex</em> with <em>simple proximal operator</em>.</p>
<p class="rubric">Notes</p>
<p>MYULA is an extension of <a class="reference internal" href="#pyxu.experimental.sampler.ULA" title="pyxu.experimental.sampler._sampler.ULA"><code class="xref py py-class docutils literal notranslate"><span class="pre">ULA</span></code></a> to sample from distributions whose
logarithm is nonsmooth.
It consists in applying ULA to the differentiable functional <span class="math notranslate nohighlight">\(\mathcal{U}^\lambda = \mathcal{F} + \mathcal{G}^\lambda\)</span>
for some <span class="math notranslate nohighlight">\(\lambda &gt; 0\)</span>, where</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\mathcal{G}^\lambda (\mathbf{x}) = \inf_{\tilde{\mathbf{x}} \in \mathbb{R}^N} \frac{1}{2 \lambda} \Vert
\tilde{\mathbf{x}} - \mathbf{x} \Vert_2^2 + \mathcal{G}(\tilde{\mathbf{x}})\]</div>
</div></blockquote>
<p>is the Moreau-Yosida envelope of <span class="math notranslate nohighlight">\(\mathcal{G}\)</span> with parameter <span class="math notranslate nohighlight">\(\lambda\)</span>.
We then have</p>
<div class="math notranslate nohighlight">
\[\nabla \mathcal{U}^\lambda (\mathbf{x}) = \nabla \mathcal{F}(\mathbf{x}) + \frac{1}{\lambda} (\mathbf{x} -
\mathrm{prox}_{\lambda \mathcal{G}}(\mathbf{x})),\]</div>
<p>hence <span class="math notranslate nohighlight">\(\nabla \mathcal{U}^\lambda\)</span> is <span class="math notranslate nohighlight">\((\beta + \frac{1}{\lambda})\)</span>-Lipschitz continuous, where
<span class="math notranslate nohighlight">\(\beta\)</span> is the Lipschitz constant of <span class="math notranslate nohighlight">\(\nabla \mathcal{F}\)</span>.
Note that the target distribution of the underlying ULA Markov chain is not exactly <span class="math notranslate nohighlight">\(p(\mathbf{x})\)</span>, but the distribution</p>
<div class="math notranslate nohighlight">
\[p^\lambda(\mathbf{x}) \propto \exp(-\mathcal{F}(\mathbf{x})-\mathcal{G}^\lambda(\mathbf{x})),\]</div>
<p>which introduces some additional bias on top of the bias of ULA related to the step size <span class="math notranslate nohighlight">\(\gamma\)</span> (see <code class="code docutils literal notranslate"><span class="pre">Notes</span></code>
of <a class="reference internal" href="#pyxu.experimental.sampler.ULA" title="pyxu.experimental.sampler._sampler.ULA"><code class="xref py py-class docutils literal notranslate"><span class="pre">ULA</span></code></a> documentation).
MYULA is guaranteed to converges when <span class="math notranslate nohighlight">\(\gamma \leq \frac{1}{\beta + \frac{1}{\lambda}}\)</span>, in which case it converges
toward the stationary distribution <span class="math notranslate nohighlight">\(p^\lambda_\gamma(\mathbf{x})\)</span> that satisfies</p>
<div class="math notranslate nohighlight">
\[\lim_{\gamma, \lambda \to 0} \Vert p^\lambda_\gamma - p \Vert_{\mathrm{TV}} = 0\]</div>
<p>(see <a class="reference internal" href="../references.html#myula" id="id1"><span>[MYULA]</span></a>).
The parameter <span class="math notranslate nohighlight">\(\lambda\)</span> parameter is subject to a similar bias-variance tradeoff as <span class="math notranslate nohighlight">\(\gamma\)</span>.
It is recommended to set it in the order of <span class="math notranslate nohighlight">\(\frac{1}{\beta}\)</span>, so that the contributions of <span class="math notranslate nohighlight">\(\mathcal{F}\)</span>
and <span class="math notranslate nohighlight">\(\mathcal{G}^\lambda\)</span> to the Lipschitz constant of <span class="math notranslate nohighlight">\(\nabla \mathcal{U}^\lambda\)</span> is well balanced.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.DiffFunc" title="pyxu.abc.operator.DiffFunc"><em>DiffFunc</em></a>) – </p></li>
<li><p><strong>g</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.ProxFunc" title="pyxu.abc.operator.ProxFunc"><em>ProxFunc</em></a>) – </p></li>
<li><p><strong>gamma</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="numbers.Real"><em>Real</em></a>) – </p></li>
<li><p><strong>lamb</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="numbers.Real"><em>Real</em></a>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.experimental.sampler.MYULA.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lamb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyxu/experimental/sampler/_sampler.html#MYULA.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.experimental.sampler.MYULA.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.DiffFunc" title="pyxu.abc.operator.DiffFunc"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiffFunc</span></code></a> | None) – Differentiable functional.</p></li>
<li><p><strong>g</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.ProxFunc" title="pyxu.abc.operator.ProxFunc"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProxFunc</span></code></a> | None) – Proximable functional.</p></li>
<li><p><strong>gamma</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-class docutils literal notranslate"><span class="pre">Real</span></code></a>) – Euler-Maruyama discretization step of the Langevin equation (see <code class="code docutils literal notranslate"><span class="pre">Notes</span></code> of
<a class="reference internal" href="#pyxu.experimental.sampler.ULA" title="pyxu.experimental.sampler._sampler.ULA"><code class="xref py py-class docutils literal notranslate"><span class="pre">ULA</span></code></a> documentation).</p></li>
<li><p><strong>lamb</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-class docutils literal notranslate"><span class="pre">Real</span></code></a>) – Moreau-Yosida envelope parameter for <code class="code docutils literal notranslate"><span class="pre">g</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyxu.experimental.sampler.OnlineCenteredMoment">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">OnlineCenteredMoment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyxu/experimental/sampler/statistics.html#OnlineCenteredMoment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.experimental.sampler.OnlineCenteredMoment" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">_OnlineStat</span></code></p>
<p>Pointwise online centered moment.</p>
<p>For <span class="math notranslate nohighlight">\(d \geq 2\)</span>, the <span class="math notranslate nohighlight">\(d\)</span>-th order centered moment of the <span class="math notranslate nohighlight">\(K\)</span> samples <span class="math notranslate nohighlight">\((\mathbf{x}_k)_{1 \leq
k \leq K}\)</span> is given by <span class="math notranslate nohighlight">\(\boldsymbol{\mu}_d=\frac{1}{K} \sum_{k=1}^K (\mathbf{x}_k-\boldsymbol{\mu})^d\)</span>, where
<span class="math notranslate nohighlight">\(\boldsymbol{\mu}\)</span> is the sample mean.</p>
<p class="rubric">Notes</p>
<p>This class implements the <em>Welford algorithm</em> described in <a class="reference internal" href="../references.html#welfordalg" id="id2"><span>[WelfordAlg]</span></a>, which is a numerically stable algorithm
for computing online centered moments. In particular, it avoids <a class="reference external" href="https://en.wikipedia.org/wiki/Catastrophic_cancellation">catastrophic cancellation</a> issues that may arise when naively computing online
centered moments, which would lead to a loss of numerical precision.</p>
<p>Note that this class internally stores the values of all online centered moments of order <span class="math notranslate nohighlight">\(d'\)</span> for
<span class="math notranslate nohighlight">\(2 \leq d' \leq d\)</span> in the attribute <code class="docutils literal notranslate"><span class="pre">_corrected_sums</span></code> as well as the online mean (<code class="docutils literal notranslate"><span class="pre">_mean</span></code> attribute). More
precisely, the array <code class="docutils literal notranslate"><span class="pre">_corrected_sums[i,</span> <span class="pre">:]</span></code> corresponds to the online sum <span class="math notranslate nohighlight">\(\boldsymbol{\mu}_{i+2}=
\sum_{k=1}^K (\mathbf{x}_k-\boldsymbol{\mu})^{i+2}\)</span> for <span class="math notranslate nohighlight">\(0 \leq i \leq d-2\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>order</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="numbers.Real"><em>Real</em></a>) – </p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.experimental.sampler.OnlineCenteredMoment.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyxu/experimental/sampler/statistics.html#OnlineCenteredMoment.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.experimental.sampler.OnlineCenteredMoment.update" title="Link to this definition">#</a></dt>
<dd><p>Update the online statistic based on a new sample. Should update <code class="code docutils literal notranslate"><span class="pre">_num_samples</span></code> and <code class="code docutils literal notranslate"><span class="pre">_stat</span></code> attributes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArray</span></code></a>) – New sample.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>stat</strong> – Updated statistic.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArray</span></code></a></p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.experimental.sampler.OnlineKurtosis">
<span class="sig-name descname"><span class="pre">OnlineKurtosis</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyxu/experimental/sampler/statistics.html#OnlineKurtosis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.experimental.sampler.OnlineKurtosis" title="Link to this definition">#</a></dt>
<dd><p>Pointwise online kurtosis.</p>
<p>The pointwise online variance of the <span class="math notranslate nohighlight">\(K\)</span> samples <span class="math notranslate nohighlight">\((\mathbf{x}_k)_{1 \leq k \leq K}\)</span> is given by
<span class="math notranslate nohighlight">\(\frac{1}{K}\sum_{k=1}^K \left( \frac{\mathbf{x}_k-\boldsymbol{\mu}}{\boldsymbol{\sigma}}\right)^4\)</span>, where
<span class="math notranslate nohighlight">\(\boldsymbol{\mu}\)</span> is the sample mean and <span class="math notranslate nohighlight">\(\boldsymbol{\sigma}\)</span> its standard deviation.</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Kurtosis">Kurtosis</a> is a measure of the heavy-tailedness of a distribution. In
particular, the kurtosis of a Gaussian distribution is always 3.</p>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyxu.experimental.sampler.OnlineMoment">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">OnlineMoment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyxu/experimental/sampler/statistics.html#OnlineMoment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.experimental.sampler.OnlineMoment" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">_OnlineStat</span></code></p>
<p>Pointwise online moment.</p>
<p>For <span class="math notranslate nohighlight">\(d \geq 1\)</span>, the <span class="math notranslate nohighlight">\(d\)</span>-th order centered moment of the <span class="math notranslate nohighlight">\(K\)</span> samples <span class="math notranslate nohighlight">\((\mathbf{x}_k)_{1 \leq
k \leq K}\)</span> is given by <span class="math notranslate nohighlight">\(\frac{1}{K}\sum_{k=1}^K \mathbf{x}_k^d\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>order</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="numbers.Real"><em>Real</em></a>) – </p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.experimental.sampler.OnlineMoment.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyxu/experimental/sampler/statistics.html#OnlineMoment.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.experimental.sampler.OnlineMoment.update" title="Link to this definition">#</a></dt>
<dd><p>Update the online statistic based on a new sample. Should update <code class="code docutils literal notranslate"><span class="pre">_num_samples</span></code> and <code class="code docutils literal notranslate"><span class="pre">_stat</span></code> attributes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArray</span></code></a>) – New sample.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>stat</strong> – Updated statistic.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArray</span></code></a></p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.experimental.sampler.OnlineSkewness">
<span class="sig-name descname"><span class="pre">OnlineSkewness</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyxu/experimental/sampler/statistics.html#OnlineSkewness"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.experimental.sampler.OnlineSkewness" title="Link to this definition">#</a></dt>
<dd><p>Pointwise online skewness.</p>
<p>The pointwise online skewness of the <span class="math notranslate nohighlight">\(K\)</span> samples <span class="math notranslate nohighlight">\((\mathbf{x}_k)_{1 \leq k \leq K}\)</span> is given by
<span class="math notranslate nohighlight">\(\frac{1}{K}\sum_{k=1}^K \left( \frac{\mathbf{x}_k-\boldsymbol{\mu}}{\boldsymbol{\sigma}}\right)^3\)</span>, where
<span class="math notranslate nohighlight">\(\boldsymbol{\mu}\)</span> is the sample mean and <span class="math notranslate nohighlight">\(\boldsymbol{\sigma}\)</span> its standard deviation.</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Skewness">Skewness</a> is a measure of asymmetry of a distribution around its mean.
Negative skewness indicates that the distribution has a heavier tail on the left side than on the right side,
positive skewness indicates the opposite, and values close to zero indicate a symmetric distribution.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.experimental.sampler.OnlineStd">
<span class="sig-name descname"><span class="pre">OnlineStd</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyxu/experimental/sampler/statistics.html#OnlineStd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.experimental.sampler.OnlineStd" title="Link to this definition">#</a></dt>
<dd><p>Pointwise online standard deviation.</p>
<p>The pointwise online standard deviation of the <span class="math notranslate nohighlight">\(K\)</span> samples <span class="math notranslate nohighlight">\((\mathbf{x}_k)_{1 \leq k \leq K}\)</span> is given
by <span class="math notranslate nohighlight">\(\boldsymbol{\sigma}=\sqrt{\frac{1}{K}\sum_{k=1}^K (\mathbf{x}_k - \boldsymbol{\mu})^2}\)</span>, where
<span class="math notranslate nohighlight">\(\boldsymbol{\mu}\)</span> is the sample mean.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.experimental.sampler.OnlineVariance">
<span class="sig-name descname"><span class="pre">OnlineVariance</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyxu/experimental/sampler/statistics.html#OnlineVariance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.experimental.sampler.OnlineVariance" title="Link to this definition">#</a></dt>
<dd><p>Pointwise online variance.</p>
<p>The pointwise online variance of the <span class="math notranslate nohighlight">\(K\)</span> samples <span class="math notranslate nohighlight">\((\mathbf{x}_k)_{1 \leq k \leq K}\)</span> is given by
<span class="math notranslate nohighlight">\(\boldsymbol{\sigma}^2 = \frac{1}{K}\sum_{k=1}^K (\mathbf{x}_k-\boldsymbol{\mu})^2\)</span>, where
<span class="math notranslate nohighlight">\(\boldsymbol{\mu}\)</span> is the sample mean.</p>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyxu.experimental.sampler.ULA">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ULA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyxu/experimental/sampler/_sampler.html#ULA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.experimental.sampler.ULA" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">_Sampler</span></code></p>
<p>Unajusted Langevin algorithm (ULA).</p>
<p>Generates samples from the distribution</p>
<div class="math notranslate nohighlight">
\[p(\mathbf{x})
=
\frac{\exp(-\mathcal{F}(\mathbf{x}))}{\int_{\mathbb{R}^N} \exp(-\mathcal{F}(\tilde{\mathbf{x}}))
\mathrm{d} \tilde{\mathbf{x}} },\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathcal{F}: \mathbb{R}^N \to \mathbb{R}\)</span> is <em>differentiable</em> with <span class="math notranslate nohighlight">\(\beta\)</span>-<em>Lipschitz continuous</em>
gradient.</p>
<p class="rubric">Notes</p>
<p>ULA is a Monte-Carlo Markov chain (MCMC) method that derives from the discretization of overdamped Langevin diffusions.
More specifically, it relies on the Langevin stochastic differential equation (SDE):</p>
<div class="math notranslate nohighlight">
\[\mathrm{d} \mathbf{X}_t
=
- \nabla \mathcal{F}(\mathbf{X}_t) \mathrm{d}t + \sqrt{2} \mathrm{d} \mathbf{B}_t,\]</div>
<p>where <span class="math notranslate nohighlight">\((\mathbf{B}_t)_{t \geq 0}\)</span> is a <span class="math notranslate nohighlight">\(N\)</span>-dimensional Brownian motion.
It is well known that under mild technical assumptions, this SDE has a unique strong solution whose invariant distribution
is <span class="math notranslate nohighlight">\(p(\mathbf{x}) \propto \exp(-\mathcal{F}(\mathbf{x}))\)</span>.
The discrete-time Euler-Maruyama discretization of this SDE then yields the ULA Markov chain</p>
<div class="math notranslate nohighlight">
\[\mathbf{X}_{k+1} = \mathbf{X}_{k} - \gamma \nabla \mathcal{F}(\mathbf{X}_k) + \sqrt{2 \gamma} \mathbf{Z}_{k+1}\]</div>
<p>for all <span class="math notranslate nohighlight">\(k \in \mathbb{Z}\)</span>, where <span class="math notranslate nohighlight">\(\gamma\)</span> is the discretization step size and <span class="math notranslate nohighlight">\((\mathbf{Z}_k)_{k
\in \mathbb{Z}}\)</span> is a sequence of independant and identically distributed <span class="math notranslate nohighlight">\(N\)</span>-dimensional standard Gaussian
distributions.
When <span class="math notranslate nohighlight">\(\mathcal{F}\)</span> is differentiable with <span class="math notranslate nohighlight">\(\beta\)</span>-Lipschitz continuous gradient and <span class="math notranslate nohighlight">\(\gamma \leq \frac{1}{\beta}\)</span>,
the ULA Markov chain converges (see <a class="reference internal" href="../references.html#ula" id="id3"><span>[ULA]</span></a>) to a unique stationary distribution <span class="math notranslate nohighlight">\(p_\gamma\)</span> such that</p>
<div class="math notranslate nohighlight">
\[\lim_{\gamma \to 0} \Vert p_\gamma - p \Vert_{\mathrm{TV}} = 0.\]</div>
<p>The discretization step <span class="math notranslate nohighlight">\(\gamma\)</span> is subject to the bias-variance tradeoff:
a larger step will lead to faster convergence of the Markov chain at the expense of a larger bias in the
approximation of the distribution <span class="math notranslate nohighlight">\(p\)</span>.
Setting <span class="math notranslate nohighlight">\(\gamma\)</span> as large as possible (default behavior) is recommended for large-scale problems, since
convergence speed (rather than approximation bias) is then typically the main bottelneck.
See <code class="code docutils literal notranslate"><span class="pre">Example</span></code> section below for a concrete illustration of this tradeoff.</p>
<section id="remarks">
<h2>Remarks<a class="headerlink" href="#remarks" title="Link to this heading">#</a></h2>
<p>Like all MCMC sampling methods, ULA comes with the following challenges:</p>
<ul class="simple">
<li><p>The first few samples of the chain may not be adequate for computing statistics, as they might be located in low
probability regions.
This challenge can either be alleviated by selecting a representative starting point to the chain, or by having a
<code class="code docutils literal notranslate"><span class="pre">burn-in</span></code> phase where the first few samples are discarded.</p></li>
<li><p>Consecutive samples are typically correlated, which can deteriorate the Monte-Carlo estimation of quantities of
interest.
This issue can be alleviated by <code class="code docutils literal notranslate"><span class="pre">thinning</span></code> the chain, i.e., selecting only every <span class="math notranslate nohighlight">\(k\)</span> samples, at the expense
of an increased computational cost.
Useful diagnostic tools to quantify this correlation between samples include the pixel-wise autocorrelation function
and the <a class="reference external" href="https://mc-stan.org/docs/reference-manual/effective-sample-size.html">effective sample size</a>.</p></li>
</ul>
<p class="rubric">Example</p>
<p>We illustrate ULA on a 1D example (<span class="math notranslate nohighlight">\(N = 1\)</span>) where <span class="math notranslate nohighlight">\(\mathcal{F}(x) = \frac{x^2}{2}\)</span>; the target
distribution <span class="math notranslate nohighlight">\(p(x)\)</span> is thus the 1D standard Gaussian.
In this toy example, the biased distribution <span class="math notranslate nohighlight">\(p_\gamma(x)\)</span> can be computed in closed form.
The ULA Markov chain is given by</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{X}_{k+1} &amp;= \mathbf{X}_{k} - \gamma \nabla\mathcal{F}(\mathbf{X}_k) + \sqrt{2\gamma}\mathbf{Z}_{k+1} \\
&amp;= \mathbf{X}_{k} (1 - \gamma) + \sqrt{2 \gamma} \mathbf{Z}_{k+1}.\end{split}\]</div>
<p>Assuming for simplicity that <span class="math notranslate nohighlight">\(\mathbf{X}_0\)</span> is Gaussian with mean <span class="math notranslate nohighlight">\(\mu_0\)</span> and variance
<span class="math notranslate nohighlight">\(\sigma_0^2\)</span>, <span class="math notranslate nohighlight">\(\mathbf{X}_k\)</span> is Gaussian for any <span class="math notranslate nohighlight">\(k \in \mathbb{Z}\)</span> as a linear combination of
Gaussians.
Taking the expected value of the recurrence relation yields</p>
<div class="math notranslate nohighlight">
\[\mu_k := \mathbb{E}(\mathbf{X}_{k}) = \mathbb{E}(\mathbf{X}_{k-1}) (1 - \gamma) = \mu_0 (1 - \gamma)^k\]</div>
<p>(geometric sequence).
Taking the expected value of the square of the recurrence relation yields</p>
<div class="math notranslate nohighlight">
\[\mu^{(2)}_k := \mathbb{E}(\mathbf{X}_{k}^2) = \mathbb{E}(\mathbf{X}_{k-1}^2) (1 - \gamma)^2 + 2 \gamma =
(1 - \gamma)^{2k} (\sigma_0^2 - b) + b\]</div>
<p>with <span class="math notranslate nohighlight">\(b = \frac{2 \gamma}{1 - (1 - \gamma)^{2}} = \frac{1}{1-\frac{\gamma}{2}}\)</span> (arithmetico-geometric
sequence) due to the independence of <span class="math notranslate nohighlight">\(\mathbf{X}_{k-1}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{Z}_{k}\)</span>.
Hence, <span class="math notranslate nohighlight">\(p_\gamma(x)\)</span> is a Gaussian with mean <span class="math notranslate nohighlight">\(\mu_\gamma= \lim_{k \to \infty} \mu_k = 0\)</span> and
variance <span class="math notranslate nohighlight">\(\sigma_\gamma^2 = \lim_{k \to \infty} \mu^{(2)}_k - \mu_k^2 = \frac{1}{1-\frac{\gamma}{2}}\)</span>.
As expected, we have <span class="math notranslate nohighlight">\(\lim_{\gamma \to 0} \sigma_\gamma^2 = 1\)</span>, which is the variance of the target
distribution <span class="math notranslate nohighlight">\(p(x)\)</span>.</p>
<p>We plot the distribution of the samples of ULA for one large (<span class="math notranslate nohighlight">\(\gamma_1 \approx 1\)</span>, i.e.
<span class="math notranslate nohighlight">\(\sigma_{\gamma_1}^2 \approx 2\)</span>) and one small (<span class="math notranslate nohighlight">\(\gamma_2 = 0.1\)</span>, i.e. <span class="math notranslate nohighlight">\(\sigma_{\gamma_2}^2
\approx 1.05\)</span>) step size.
As expected, the larger step size <span class="math notranslate nohighlight">\(\gamma_1\)</span> leads to a larger bias in the approximation of <span class="math notranslate nohighlight">\(p(x)\)</span>.
To quantify the speed of convergence of the Markov chains, we compute the <a class="reference external" href="https://en.wikipedia.org/wiki/Cram%C3%A9r%E2%80%93von_Mises_criterion">Cramér-von Mises</a> tests of goodness of fit of the
empirical distributions to the stationary distributions of ULA <span class="math notranslate nohighlight">\(p_{\gamma_1}(x)\)</span> and <span class="math notranslate nohighlight">\(p_{\gamma_2}(x)\)</span>.
We observe that the larger step <span class="math notranslate nohighlight">\(\gamma_1\)</span> leads to a better fit (lower Cramér-von Mises criterion), which
illustrates the aforementioned bias-variance tradeoff for the choice of the step size.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/pyplot_summary.html#module-matplotlib.pyplot" title="matplotlib.pyplot"><span class="nn">matplotlib.pyplot</span></a> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/index.html#module-numpy" title="numpy"><span class="nn">numpy</span></a> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../api/experimental.html#module-pyxu.experimental.sampler" title="pyxu.experimental.sampler"><span class="nn">pyxu.experimental.sampler</span></a> <span class="k">as</span> <span class="nn">pxes</span>
<span class="kn">import</span> <span class="nn">pyxu.operator</span> <span class="k">as</span> <span class="nn">pxo</span>
<span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://docs.scipy.org/doc/scipy/index.html#module-scipy" title="scipy"><span class="nn">scipy</span></a> <span class="k">as</span> <span class="nn">sp</span>

<span class="n">f</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../api/operator/func.html#pyxu.operator.func.norm.SquaredL2Norm" title="pyxu.operator.func.norm.SquaredL2Norm"><span class="n">pxo</span><span class="o">.</span><span class="n">SquaredL2Norm</span></a><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>  <span class="c1"># To sample 1D normal distribution (mean 0, variance 1)</span>
<a class="sphinx-codeautolink-a" href="../api/experimental.html#pyxu.experimental.sampler.ULA" title="pyxu.experimental.sampler._sampler.ULA"><span class="n">ula</span></a> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../api/experimental.html#pyxu.experimental.sampler.ULA" title="pyxu.experimental.sampler._sampler.ULA"><span class="n">pxes</span><span class="o">.</span><span class="n">ULA</span></a><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>  <span class="c1"># Sampler with maximum step size</span>
<a class="sphinx-codeautolink-a" href="../api/experimental.html#pyxu.experimental.sampler.ULA" title="pyxu.experimental.sampler._sampler.ULA"><span class="n">ula_lb</span></a> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../api/experimental.html#pyxu.experimental.sampler.ULA" title="pyxu.experimental.sampler._sampler.ULA"><span class="n">pxes</span><span class="o">.</span><span class="n">ULA</span></a><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">1e-1</span><span class="p">)</span>  <span class="c1"># Sampler with small step size</span>

<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Generator" title="collections.abc.Generator"><span class="n">gen_ula</span></a> <span class="o">=</span> <span class="n">ula</span><span class="o">.</span><span class="n">samples</span><span class="p">(</span><span class="n">x0</span><span class="o">=</span><a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Generator" title="collections.abc.Generator"><span class="n">gen_ula_lb</span></a> <span class="o">=</span> <span class="n">ula_lb</span><span class="o">.</span><span class="n">samples</span><span class="p">(</span><span class="n">x0</span><span class="o">=</span><a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="n">n_burn_in</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#int" title="int"><span class="nb">int</span></a><span class="p">(</span><span class="mf">1e3</span><span class="p">)</span>  <span class="c1"># Number of burn-in iterations</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/stdtypes.html#range" title="range"><span class="nb">range</span></a><span class="p">(</span><span class="n">n_burn_in</span><span class="p">):</span>
    <a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#next" title="next"><span class="nb">next</span></a><span class="p">(</span><a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Generator" title="collections.abc.Generator"><span class="n">gen_ula</span></a><span class="p">)</span>
    <a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#next" title="next"><span class="nb">next</span></a><span class="p">(</span><a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Generator" title="collections.abc.Generator"><span class="n">gen_ula_lb</span></a><span class="p">)</span>

<span class="c1"># Online statistics objects</span>
<a class="sphinx-codeautolink-a" href="../api/experimental.html#pyxu.experimental.sampler.OnlineMoment" title="pyxu.experimental.sampler.statistics.OnlineMoment"><span class="n">mean_ula</span></a> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../api/experimental.html#pyxu.experimental.sampler.OnlineMoment" title="pyxu.experimental.sampler.statistics.OnlineMoment"><span class="n">pxes</span><span class="o">.</span><span class="n">OnlineMoment</span></a><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="../api/experimental.html#pyxu.experimental.sampler.OnlineMoment" title="pyxu.experimental.sampler.statistics.OnlineMoment"><span class="n">mean_ula_lb</span></a> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../api/experimental.html#pyxu.experimental.sampler.OnlineMoment" title="pyxu.experimental.sampler.statistics.OnlineMoment"><span class="n">pxes</span><span class="o">.</span><span class="n">OnlineMoment</span></a><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">var_ula</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../api/experimental.html#pyxu.experimental.sampler.OnlineVariance" title="pyxu.experimental.sampler.OnlineVariance"><span class="n">pxes</span><span class="o">.</span><span class="n">OnlineVariance</span></a><span class="p">()</span>
<span class="n">var_ula_lb</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../api/experimental.html#pyxu.experimental.sampler.OnlineVariance" title="pyxu.experimental.sampler.OnlineVariance"><span class="n">pxes</span><span class="o">.</span><span class="n">OnlineVariance</span></a><span class="p">()</span>

<span class="n">n</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#int" title="int"><span class="nb">int</span></a><span class="p">(</span><span class="mf">1e4</span><span class="p">)</span>  <span class="c1"># Number of samples</span>
<span class="n">samples_ula</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">samples_ula_lb</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/stdtypes.html#range" title="range"><span class="nb">range</span></a><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">sample</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#next" title="next"><span class="nb">next</span></a><span class="p">(</span><a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Generator" title="collections.abc.Generator"><span class="n">gen_ula</span></a><span class="p">)</span>
    <span class="n">sample_lb</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#next" title="next"><span class="nb">next</span></a><span class="p">(</span><a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Generator" title="collections.abc.Generator"><span class="n">gen_ula_lb</span></a><span class="p">)</span>
    <span class="n">samples_ula</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">sample</span>
    <span class="n">samples_ula_lb</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">sample_lb</span>
    <span class="n">mean</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#float" title="float"><span class="nb">float</span></a><span class="p">(</span><span class="n">mean_ula</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">sample</span><span class="p">))</span>
    <span class="n">var</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#float" title="float"><span class="nb">float</span></a><span class="p">(</span><span class="n">var_ula</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">sample</span><span class="p">))</span>
    <span class="n">mean_lb</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#float" title="float"><span class="nb">float</span></a><span class="p">(</span><span class="n">mean_ula_lb</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">sample_lb</span><span class="p">))</span>
    <span class="n">var_lb</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#float" title="float"><span class="nb">float</span></a><span class="p">(</span><span class="n">var_ula_lb</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">sample_lb</span><span class="p">))</span>

<span class="c1"># Theoretical variances of biased stationary distributions of ULA</span>
<span class="n">biased_var</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">ula</span><span class="o">.</span><span class="n">_gamma</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">biased_var_lb</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">ula_lb</span><span class="o">.</span><span class="n">_gamma</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># Quantify goodness of fit of empirical distribution with theoretical distribution (Cramér-von Mises test)</span>
<span class="n">cvm</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.cramervonmises.html#scipy.stats.cramervonmises" title="scipy.stats.cramervonmises"><span class="n">sp</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">cramervonmises</span></a><span class="p">(</span><span class="n">samples_ula</span><span class="p">,</span> <span class="s2">"norm"</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.sqrt.html#numpy.sqrt" title="numpy.sqrt"><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span></a><span class="p">(</span><span class="n">biased_var</span><span class="p">)))</span>
<span class="n">cvm_lb</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.cramervonmises.html#scipy.stats.cramervonmises" title="scipy.stats.cramervonmises"><span class="n">sp</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">cramervonmises</span></a><span class="p">(</span><span class="n">samples_ula_lb</span><span class="p">,</span> <span class="s2">"norm"</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.sqrt.html#numpy.sqrt" title="numpy.sqrt"><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span></a><span class="p">(</span><span class="n">biased_var_lb</span><span class="p">)))</span>

<span class="c1"># Plots</span>
<span class="n">grid</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.linspace.html#numpy.linspace" title="numpy.linspace"><span class="n">np</span><span class="o">.</span><span class="n">linspace</span></a><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span>
    <span class="sa">f</span><span class="s2">"ULA samples (large step size) </span><span class="se">\n</span><span class="s2"> Empirical mean: </span><span class="si">{</span><span class="n">mean</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> (theoretical: 0) </span><span class="se">\n</span><span class="s2"> "</span>
    <span class="sa">f</span><span class="s2">"Empirical variance: </span><span class="si">{</span><span class="n">var</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> (theoretical: </span><span class="si">{</span><span class="n">biased_var</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">) </span><span class="se">\n</span><span class="s2">"</span>
    <span class="sa">f</span><span class="s2">"Cramér-von Mises goodness of fit: </span><span class="si">{</span><span class="n">cvm</span><span class="o">.</span><span class="n">statistic</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">"</span>
<span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.hist.html#matplotlib.pyplot.hist" title="matplotlib.pyplot.hist"><span class="n">plt</span><span class="o">.</span><span class="n">hist</span></a><span class="p">(</span><span class="n">samples_ula</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">(</span><a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#min" title="min"><span class="nb">min</span></a><span class="p">(</span><span class="n">grid</span><span class="p">),</span> <a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#max" title="max"><span class="nb">max</span></a><span class="p">(</span><span class="n">grid</span><span class="p">)),</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">sp</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">grid</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">"$p(x)$"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">sp</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.sqrt.html#numpy.sqrt" title="numpy.sqrt"><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span></a><span class="p">(</span><span class="n">biased_var</span><span class="p">)),</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">"$p_{\gamma_1}(x)$"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.legend.html#matplotlib.pyplot.legend" title="matplotlib.pyplot.legend"><span class="n">plt</span><span class="o">.</span><span class="n">legend</span></a><span class="p">()</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../_downloads/5e5b9b1c67e25e4482d76496b68f3b68/experimental-1.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../_downloads/e8d0761a439aeaea00dcf73a4a90445e/experimental-1_00_00.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/070f6a163480e1040e23b47cc06445ff/experimental-1_00_00.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/ad2f7e24bddbd17a6cfa96e6423ca673/experimental-1_00_00.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../_images/experimental-1_00_00.png" class="plot-directive" src="../_images/experimental-1_00_00.png"/>
</figure>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span>
    <span class="sa">f</span><span class="s2">"ULA samples (small step size) </span><span class="se">\n</span><span class="s2"> Empirical mean: </span><span class="si">{</span><span class="n">mean_lb</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> (theoretical: 0) </span><span class="se">\n</span><span class="s2"> "</span>
    <span class="sa">f</span><span class="s2">"Empirical variance: </span><span class="si">{</span><span class="n">var_lb</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> (theoretical: </span><span class="si">{</span><span class="n">biased_var_lb</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">) </span><span class="se">\n</span><span class="s2">"</span>
    <span class="sa">f</span><span class="s2">"Cramér-von Mises goodness of fit: </span><span class="si">{</span><span class="n">cvm_lb</span><span class="o">.</span><span class="n">statistic</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">"</span>
<span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.hist.html#matplotlib.pyplot.hist" title="matplotlib.pyplot.hist"><span class="n">plt</span><span class="o">.</span><span class="n">hist</span></a><span class="p">(</span><span class="n">samples_ula_lb</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">(</span><a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#min" title="min"><span class="nb">min</span></a><span class="p">(</span><span class="n">grid</span><span class="p">),</span> <a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#max" title="max"><span class="nb">max</span></a><span class="p">(</span><span class="n">grid</span><span class="p">)),</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">sp</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">grid</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">"$p(x)$"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">sp</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.sqrt.html#numpy.sqrt" title="numpy.sqrt"><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span></a><span class="p">(</span><span class="n">biased_var_lb</span><span class="p">)),</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">"$p_{\gamma_2}(x)$"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.legend.html#matplotlib.pyplot.legend" title="matplotlib.pyplot.legend"><span class="n">plt</span><span class="o">.</span><span class="n">legend</span></a><span class="p">()</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../_downloads/b36aa4a64f4a3c14b29c9ba6aa0773dd/experimental-1_01_00.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/4835132393171dc4fee6fa57fd1d6c6a/experimental-1_01_00.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/8860ae0fe6ee3c63137f67234c7ff9a8/experimental-1_01_00.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../_images/experimental-1_01_00.png" class="plot-directive" src="../_images/experimental-1_01_00.png"/>
</figure>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.experimental.sampler.ULA.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyxu/experimental/sampler/_sampler.html#ULA.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.experimental.sampler.ULA.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.DiffFunc" title="pyxu.abc.operator.DiffFunc"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiffFunc</span></code></a>) – Differentiable functional.</p></li>
<li><p><strong>gamma</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-class docutils literal notranslate"><span class="pre">Real</span></code></a>) – Euler-Maruyama discretization step of the Langevin equation (see <code class="code docutils literal notranslate"><span class="pre">Notes</span></code>).</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.experimental.sampler.ULA.objective_func">
<span class="sig-name descname"><span class="pre">objective_func</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyxu/experimental/sampler/_sampler.html#ULA.objective_func"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.experimental.sampler.ULA.objective_func" title="Link to this definition">#</a></dt>
<dd><p>Negative logarithm of the target ditribution (up to the a constant) evaluated at the current state of the
Markov chain.</p>
<p>Useful for diagnostics purposes to monitor whether the Markov chain is sufficiently warm-started.
If so, the samples should accumulate around the modes of the target distribution, i.e., toward the minimum of
<span class="math notranslate nohighlight">\(\mathcal{F}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="numbers.Real"><em>Real</em></a></p>
</dd>
</dl>
</dd></dl>
</section>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (<a class="reference internal" href="abc.html#pyxu.abc.operator.DiffFunc" title="pyxu.abc.operator.DiffFunc"><em>DiffFunc</em></a>) – </p></li>
<li><p><strong>gamma</strong> (<a class="reference internal" href="info.html#pyxu.info.ptype.Real" title="numbers.Real"><em>Real</em></a>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>
</section>
</article>
<footer class="bd-footer-article">
<div class="footer-article-items footer-article__inner">
<div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
<a class="left-prev" href="info.html" title="previous page">
<i class="fa-solid fa-angle-left"></i>
<div class="prev-next-info">
<p class="prev-next-subtitle">previous</p>
<p class="prev-next-title">pyxu.info</p>
</div>
</a>
<a class="right-next" href="../references.html" title="next page">
<div class="prev-next-info">
<p class="prev-next-subtitle">next</p>
<p class="prev-next-title">References</p>
</div>
<i class="fa-solid fa-angle-right"></i>
</a>
</div></div>
</div>
</footer>
</div>
<div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">
<div class="sidebar-secondary-item">
<div class="page-toc tocsection onthispage">
<i class="fa-solid fa-list"></i> On this page
  </div>
<nav class="bd-toc-nav page-toc">
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.experimental.sampler.MYULA"><code class="docutils literal notranslate"><span class="pre">MYULA</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.experimental.sampler.MYULA.__init__"><code class="docutils literal notranslate"><span class="pre">MYULA.__init__()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.experimental.sampler.OnlineCenteredMoment"><code class="docutils literal notranslate"><span class="pre">OnlineCenteredMoment</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.experimental.sampler.OnlineCenteredMoment.update"><code class="docutils literal notranslate"><span class="pre">OnlineCenteredMoment.update()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.experimental.sampler.OnlineKurtosis"><code class="docutils literal notranslate"><span class="pre">OnlineKurtosis()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.experimental.sampler.OnlineMoment"><code class="docutils literal notranslate"><span class="pre">OnlineMoment</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.experimental.sampler.OnlineMoment.update"><code class="docutils literal notranslate"><span class="pre">OnlineMoment.update()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.experimental.sampler.OnlineSkewness"><code class="docutils literal notranslate"><span class="pre">OnlineSkewness()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.experimental.sampler.OnlineStd"><code class="docutils literal notranslate"><span class="pre">OnlineStd()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.experimental.sampler.OnlineVariance"><code class="docutils literal notranslate"><span class="pre">OnlineVariance()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.experimental.sampler.ULA"><code class="docutils literal notranslate"><span class="pre">ULA</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.experimental.sampler.ULA.__init__"><code class="docutils literal notranslate"><span class="pre">ULA.__init__()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.experimental.sampler.ULA.objective_func"><code class="docutils literal notranslate"><span class="pre">ULA.objective_func()</span></code></a></li>
</ul>
</li>
</ul>
</nav></div>
<div class="sidebar-secondary-item">
<div id="searchbox"></div></div>
<div class="sidebar-secondary-item">
<div class="tocsection editthispage">
<a href="https://github.com/matthieumeo/pyxu/edit/main/doc/api/experimental.rst">
<i class="fa-solid fa-pencil"></i>
      
      
        
          Edit on GitHub
        
      
    </a>
</div>
</div>
<div class="sidebar-secondary-item">
<div class="tocsection sourcelink">
<a href="../_sources/api/experimental.rst">
<i class="fa-solid fa-file-lines"></i> Show Source
    </a>
</div>
</div>
</div></div>
</div>
<footer class="bd-footer-content">
</footer>
</main>
</div>
</div>
<!-- Scripts loaded after <body> so the DOM is not blocked -->
<script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>
<footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
<div class="footer-items__start">
<div class="footer-item">
<p class="copyright">
    
      © Copyright 2023, M. Simeoni, S. Kashani, J. Rué-Queralt &amp; Pyxu Developers.
      <br/>
</p>
</div>
<div class="footer-item">
<p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.5.
    <br/>
</p>
</div>
<div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.13.3.
</p></div>
</div>
<div class="footer-items__end">
<div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.13.3.
</p></div>
</div>
</div>
</footer>
</body>
</html>