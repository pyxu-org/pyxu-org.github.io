
<!DOCTYPE html>

<html data-theme="light" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/><meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>pyxu.operator.linop — Pyxu Documentation</title>
<script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "light";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
<!-- Loaded before other Sphinx assets -->
<link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet"/>
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet"/>
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet"/>
<link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet"/>
<link as="font" crossorigin="" href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" rel="preload" type="font/woff2"/>
<link href="../../_static/pygments.css?v=fa44fd50" rel="stylesheet" type="text/css"/>
<link href="../../_static/plot_directive.css?v=7f9a90b1" rel="stylesheet" type="text/css"/>
<link href="../../_static/sphinx-codeautolink.css?v=125d5c1c" rel="stylesheet" type="text/css"/>
<link href="../../_static/copybutton.css?v=76b2166b" rel="stylesheet" type="text/css"/>
<link href="../../_static/togglebutton.css?v=13237357" rel="stylesheet" type="text/css"/>
<link href="../../_static/sg_gallery.css?v=61a4c737" rel="stylesheet" type="text/css"/>
<link href="../../_static/sg_gallery-binder.css?v=f4aeca0c" rel="stylesheet" type="text/css"/>
<link href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" rel="stylesheet" type="text/css"/>
<link href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" rel="stylesheet" type="text/css"/>
<link href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" rel="stylesheet" type="text/css"/>
<link href="../../_static/css/custom.css?v=1031a718" rel="stylesheet" type="text/css"/>
<!-- Pre-loaded scripts that we'll load fully later -->
<link as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" rel="preload"/>
<link as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" rel="preload"/>
<script src="../../_static/documentation_options.js?v=e02fc88f"></script>
<script src="../../_static/doctools.js?v=888ff710"></script>
<script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
<script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
<script src="../../_static/copybutton.js?v=30646c52"></script>
<script>let toggleHintShow = 'Click to show';</script>
<script>let toggleHintHide = 'Click to hide';</script>
<script>let toggleOpenOnPrint = 'true';</script>
<script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
<script src="../../_static/design-tabs.js?v=36754332"></script>
<script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
<script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
<script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
<script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
<script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>DOCUMENTATION_OPTIONS.pagename = 'api/operator/linop';</script>
<link href="../../_static/favicon.png" rel="icon"/>
<link href="../../genindex.html" rel="index" title="Index"/>
<link href="../../search.html" rel="search" title="Search"/>
<link href="blocks.html" rel="next" title="pyxu.operator.blocks"/>
<link href="func.html" rel="prev" title="pyxu.operator.func"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="en" name="docsearch:language"/>
</head>
<body data-bs-root-margin="0px 0px -60%" data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-default-mode="light" data-offset="180">
<a class="skip-link" href="#main-content">Skip to main content</a>
<input class="sidebar-toggle" id="__primary" name="__primary" type="checkbox"/>
<label class="overlay overlay-primary" for="__primary"></label>
<input class="sidebar-toggle" id="__secondary" name="__secondary" type="checkbox"/>
<label class="overlay overlay-secondary" for="__secondary"></label>
<div class="search-button__wrapper">
<div class="search-button__overlay"></div>
<div class="search-button__search-container">
<form action="../../search.html" class="bd-search d-flex align-items-center" method="get">
<i class="fa-solid fa-magnifying-glass"></i>
<input aria-label="Search the docs ..." autocapitalize="off" autocomplete="off" autocorrect="off" class="form-control" id="search-input" name="q" placeholder="Search the docs ..." spellcheck="false" type="search"/>
<span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
</div>
<nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
<label class="sidebar-toggle primary-toggle" for="__primary">
<span class="fa-solid fa-bars"></span>
</label>
<div class="navbar-header-items__start">
<div class="navbar-item">
<a class="navbar-brand logo" href="../../index.html">
<img alt="Logo image" class="logo__image only-light" src="../../_static/logo.png"/>
<script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
</a></div>
</div>
<div class="col-lg-9 navbar-header-items">
<div class="me-auto navbar-header-items__center">
<div class="navbar-item"><nav class="navbar-nav">
<p aria-label="Site Navigation" aria-level="1" class="sidebar-header-items__title" role="heading">
    Site Navigation
  </p>
<ul class="bd-navbar-elements navbar-nav">
<li class="nav-item">
<a class="nav-link nav-internal" href="../../intro/index.html">
                        Getting Started
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../guide/index.html">
                        User Guide
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../examples/index.html">
                        Example Gallery
                      </a>
</li>
<li class="nav-item current active">
<a class="nav-link nav-internal" href="../index.html">
                        API Reference
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../fair/index.html">
                        Extending Pyxu
                      </a>
</li>
</ul>
</nav></div>
</div>
<div class="navbar-header-items__end">
<div class="navbar-item navbar-persistent--container">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
</div>
<div class="navbar-item"><strong> v1.0.x </strong></div>
<div class="navbar-item"><ul aria-label="Icon Links" class="navbar-icon-links navbar-nav">
<li class="nav-item">
<a class="nav-link" data-bs-placement="bottom" data-bs-toggle="tooltip" href="https://github.com/matthieumeo/pyxu" rel="noopener" target="_blank" title="GitHub"><span><i class="fa-brands fa-github"></i></span>
<label class="sr-only">GitHub</label></a>
</li>
<li class="nav-item">
<a class="nav-link" data-bs-placement="bottom" data-bs-toggle="tooltip" href="https://pypi.org/project/pyxu/" rel="noopener" target="_blank" title="PyPI"><span><i class="fa-brands fa-python"></i></span>
<label class="sr-only">PyPI</label></a>
</li>
<li class="nav-item">
<a class="nav-link" data-bs-placement="bottom" data-bs-toggle="tooltip" href="mailto: matthieu.simeoni@gmail.com" rel="noopener" target="_blank" title="Contact"><span><i class="fa-brands fa-telegram"></i></span>
<label class="sr-only">Contact</label></a>
</li>
<li class="nav-item">
<a class="nav-link" data-bs-placement="bottom" data-bs-toggle="tooltip" href="https://imaging.epfl.ch/" rel="noopener" target="_blank" title="EPFL Center for Imaging"><img alt="EPFL Center for Imaging" class="icon-link-image" src="../../_static/imaging.png"/></a>
</li>
</ul></div>
</div>
</div>
<div class="navbar-persistent--mobile">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
</div>
<label class="sidebar-toggle secondary-toggle" for="__secondary">
<span class="fa-solid fa-outdent"></span>
</label>
</div>
</nav>
<div class="bd-container">
<div class="bd-container__inner bd-page-width">
<div class="bd-sidebar-primary bd-sidebar">
<div class="sidebar-header-items sidebar-primary__section">
<div class="sidebar-header-items__center">
<div class="navbar-item"><nav class="navbar-nav">
<p aria-label="Site Navigation" aria-level="1" class="sidebar-header-items__title" role="heading">
    Site Navigation
  </p>
<ul class="bd-navbar-elements navbar-nav">
<li class="nav-item">
<a class="nav-link nav-internal" href="../../intro/index.html">
                        Getting Started
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../guide/index.html">
                        User Guide
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../examples/index.html">
                        Example Gallery
                      </a>
</li>
<li class="nav-item current active">
<a class="nav-link nav-internal" href="../index.html">
                        API Reference
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../fair/index.html">
                        Extending Pyxu
                      </a>
</li>
</ul>
</nav></div>
</div>
<div class="sidebar-header-items__end">
<div class="navbar-item"><strong> v1.0.x </strong></div>
<div class="navbar-item"><ul aria-label="Icon Links" class="navbar-icon-links navbar-nav">
<li class="nav-item">
<a class="nav-link" data-bs-placement="bottom" data-bs-toggle="tooltip" href="https://github.com/matthieumeo/pyxu" rel="noopener" target="_blank" title="GitHub"><span><i class="fa-brands fa-github"></i></span>
<label class="sr-only">GitHub</label></a>
</li>
<li class="nav-item">
<a class="nav-link" data-bs-placement="bottom" data-bs-toggle="tooltip" href="https://pypi.org/project/pyxu/" rel="noopener" target="_blank" title="PyPI"><span><i class="fa-brands fa-python"></i></span>
<label class="sr-only">PyPI</label></a>
</li>
<li class="nav-item">
<a class="nav-link" data-bs-placement="bottom" data-bs-toggle="tooltip" href="mailto: matthieu.simeoni@gmail.com" rel="noopener" target="_blank" title="Contact"><span><i class="fa-brands fa-telegram"></i></span>
<label class="sr-only">Contact</label></a>
</li>
<li class="nav-item">
<a class="nav-link" data-bs-placement="bottom" data-bs-toggle="tooltip" href="https://imaging.epfl.ch/" rel="noopener" target="_blank" title="EPFL Center for Imaging"><img alt="EPFL Center for Imaging" class="icon-link-image" src="../../_static/imaging.png"/></a>
</li>
</ul></div>
</div>
</div>
<div class="sidebar-primary-items__start sidebar-primary__section">
<div class="sidebar-primary-item"><nav aria-label="Section Navigation" class="bd-docs-nav bd-links">
<p aria-level="1" class="bd-links__title" role="heading">Section Navigation</p>
<div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../abc.html">pyxu.abc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../opt.html">pyxu.opt</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">pyxu.operator</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="map.html">pyxu.operator.map</a></li>
<li class="toctree-l2"><a class="reference internal" href="func.html">pyxu.operator.func</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">pyxu.operator.linop</a></li>
<li class="toctree-l2"><a class="reference internal" href="blocks.html">pyxu.operator.blocks</a></li>
<li class="toctree-l2"><a class="reference internal" href="interop.html">pyxu.operator.interop</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../runtime.html">pyxu.runtime</a></li>
<li class="toctree-l1"><a class="reference internal" href="../util.html">pyxu.util</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math.html">pyxu.math</a></li>
<li class="toctree-l1"><a class="reference internal" href="../info.html">pyxu.info</a></li>
<li class="toctree-l1"><a class="reference internal" href="../experimental.html">pyxu.experimental</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../references.html">References</a></li>
</ul>
</div>
</nav></div>
</div>
<div class="sidebar-primary-items__end sidebar-primary__section">
</div>
<div id="rtd-footer-container"></div>
</div>
<main class="bd-main" id="main-content">
<div class="bd-content">
<div class="bd-article-container">
<div class="bd-header-article">
<div class="header-article-items header-article__inner">
<div class="header-article-items__start">
<div class="header-article-item">
<nav aria-label="Breadcrumbs">
<ul aria-label="Breadcrumb" class="bd-breadcrumbs" role="navigation">
<li class="breadcrumb-item breadcrumb-home">
<a aria-label="Home" class="nav-link" href="../../index.html">
<i class="fa-solid fa-home"></i>
</a>
</li>
<li class="breadcrumb-item"><a class="nav-link" href="../index.html">API Reference</a></li>
<li class="breadcrumb-item"><a class="nav-link" href="index.html">pyxu.operator</a></li>
<li aria-current="page" class="breadcrumb-item active">pyxu.operator.linop</li>
</ul>
</nav>
</div>
</div>
</div>
</div>
<div id="searchbox"></div>
<article class="bd-article" role="main">
<section id="pyxu-operator-linop">
<h1>pyxu.operator.linop<a class="headerlink" href="#pyxu-operator-linop" title="Link to this heading">#</a></h1>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#basic-operators" id="id42">Basic operators</a></p></li>
<li><p><a class="reference internal" href="#stencils-and-convolutions" id="id43">Stencils and Convolutions</a></p></li>
<li><p><a class="reference internal" href="#transforms" id="id44">Transforms</a></p></li>
<li><p><a class="reference internal" href="#derivatives" id="id45">Derivatives</a></p></li>
<li><p><a class="reference internal" href="#filters" id="id46">Filters</a></p></li>
</ul>
</nav>
<section id="basic-operators">
<h2><a class="toc-backref" href="#id42" role="doc-backlink">Basic operators</a><a class="headerlink" href="#basic-operators" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyxu.operator.linop.select.SubSample">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SubSample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg_shape</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">indices</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/select.html#SubSample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.select.SubSample" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="../abc.html#pyxu.abc.operator.LinOp" title="pyxu.abc.operator.LinOp"><code class="xref py py-class docutils literal notranslate"><span class="pre">LinOp</span></code></a></p>
<p>Multi-dimensional sub-sampling operator.</p>
<p>This operator extracts a subset of the input matching the provided subset specifier.
Its Lipschitz constant is 1.</p>
<p class="rubric">Examples</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Extract even samples of a 1D signal.</span>
<span class="kn">import</span> <span class="nn">pyxu.operator</span> <span class="k">as</span> <span class="nn">pxo</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">pxo</span><span class="o">.</span><span class="n">SubSample</span><span class="p">(</span>
      <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
      <span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># array([0, 2, 4, 6, 8])</span>
</pre></div>
</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Extract columns[1, 3, -1] from a 2D matrix</span>
<span class="kn">import</span> <span class="nn">pyxu.operator</span> <span class="k">as</span> <span class="nn">pxo</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="mi">40</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>  <span class="c1"># the input</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">pxo</span><span class="o">.</span><span class="n">SubSample</span><span class="p">(</span>
      <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
      <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span>  <span class="c1"># take all rows</span>
      <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>   <span class="c1"># and these columns</span>
<span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  <span class="c1"># array([[  1.,   3.,  39.],</span>
                                    <span class="c1">#        [ 41.,  43.,  79.],</span>
                                    <span class="c1">#        [ 81.,  83., 119.]])</span>
</pre></div>
</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Extract all red rows of an (D,H,W) RGB image matching a boolean mask.</span>
<span class="kn">import</span> <span class="nn">pyxu.operator</span> <span class="k">as</span> <span class="nn">pxo</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">*</span> <span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">pxo</span><span class="o">.</span><span class="n">SubSample</span><span class="p">(</span>
      <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
      <span class="mi">0</span><span class="p">,</span>            <span class="c1"># red channel</span>
      <span class="n">mask</span><span class="p">,</span>         <span class="c1"># row selector</span>
      <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span>  <span class="c1"># all columns; this field can be omitted.</span>
<span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">mask</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="mi">4</span><span class="p">)</span>  <span class="c1"># array([[[ 0.,  1.,  2.,  3.],</span>
                                                <span class="c1">#         [12., 13., 14., 15.]]])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arg_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.11)"><em>Integral</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.11)"><em>Integral</em></a><em>, </em><em>...</em><em>]</em>) – </p></li>
<li><p><strong>indices</strong> (<a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.11)"><em>Integral</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.11)"><em>Sequence</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.11)"><em>Integral</em></a><em>] </em><em>| </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#slice" title="(in Python v3.11)"><em>slice</em></a><em> | </em><a class="reference internal" href="../info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><em>NDArray</em></a>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyxu.operator.linop.select.SubSample.IndexSpec">
<span class="sig-name descname"><span class="pre">IndexSpec</span></span><a class="headerlink" href="#pyxu.operator.linop.select.SubSample.IndexSpec" title="Link to this definition">#</a></dt>
<dd><p>alias of <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Integral</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Integral</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/functions.html#slice" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">slice</span></code></a>, <a class="reference internal" href="../info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NDArray</span></code></a>]</p>
</dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyxu.operator.linop.select.SubSample.TrimSpec">
<span class="sig-name descname"><span class="pre">TrimSpec</span></span><a class="headerlink" href="#pyxu.operator.linop.select.SubSample.TrimSpec" title="Link to this definition">#</a></dt>
<dd><p>alias of <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Integral</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Integral</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Integral</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Integral</span></code></a>]]]</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.operator.linop.select.SubSample.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg_shape</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">indices</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/select.html#SubSample.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.select.SubSample.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arg_shape</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.NDArrayShape" title="pyxu.info.ptype.NDArrayShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayShape</span></code></a>) – Shape of the data to be sub-sampled.</p></li>
<li><p><strong>indices</strong> (<a class="reference internal" href="#pyxu.operator.linop.select.SubSample.IndexSpec" title="pyxu.operator.linop.select.SubSample.IndexSpec"><code class="xref py py-class docutils literal notranslate"><span class="pre">IndexSpec</span></code></a>) – <p>Sub-sample specifier per dimension. (See examples.)</p>
<p>Valid specifiers are:</p>
<ul>
<li><p>integers</p></li>
<li><p>lists (or arrays) of indices</p></li>
<li><p>slices</p></li>
<li><p>1D boolean masks</p></li>
</ul>
<p>Unspecified trailing dimensions are not sub-sampled.</p>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.operator.linop.select.SubSample.apply">
<span class="sig-name descname"><span class="pre">apply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/select.html#SubSample.apply"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.select.SubSample.apply" title="Link to this definition">#</a></dt>
<dd><p>Sub-sample the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>arr</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArray</span></code></a>) – (…, arg_shape.prod()) data</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>out</strong> – (…, sub_shape.prod()) sub-sampled data points.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArray</span></code></a></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.operator.linop.select.SubSample.adjoint">
<span class="sig-name descname"><span class="pre">adjoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/select.html#SubSample.adjoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.select.SubSample.adjoint" title="Link to this definition">#</a></dt>
<dd><p>Up-sample the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>arr</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArray</span></code></a>) – (…, sub_shape.prod()) data points.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>out</strong> – (…, arg_shape.prod()) up-sampled data points. (Zero-filled.)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArray</span></code></a></p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.operator.linop.select.Trim">
<span class="sig-name descname"><span class="pre">Trim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trim_width</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/select.html#Trim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.select.Trim" title="Link to this definition">#</a></dt>
<dd><p>Multi-dimensional trimming operator.</p>
<p>This operator trims the input array in each dimension according to specified widths.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arg_shape</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.NDArrayShape" title="pyxu.info.ptype.NDArrayShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayShape</span></code></a>) – Shape of the input array.</p></li>
<li><p><strong>trim_width</strong> (<a class="reference internal" href="#pyxu.operator.linop.select.SubSample.TrimSpec" title="pyxu.operator.linop.select.SubSample.TrimSpec"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrimSpec</span></code></a>) – <p>Number of values trimmed from the edges of each axis.
Multiple forms are accepted:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">int</span></code>: trim each dimension’s head/tail by <code class="code docutils literal notranslate"><span class="pre">trim_width</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tuple[int,</span> <span class="pre">...]</span></code>: trim dimension[k]’s head/tail by <code class="code docutils literal notranslate"><span class="pre">trim_width[k]</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tuple[tuple[int,</span> <span class="pre">int],</span> <span class="pre">...]</span></code>: trim dimension[k]’s head/tail by <code class="code docutils literal notranslate"><span class="pre">trim_width[k][0]</span></code> /
<code class="code docutils literal notranslate"><span class="pre">trim_width[k][1]</span></code> respectively.</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>op</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a></p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.operator.linop.reduce.Sum">
<span class="sig-name descname"><span class="pre">Sum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/reduce.html#Sum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.reduce.Sum" title="Link to this definition">#</a></dt>
<dd><p>Multi-dimensional sum reduction.</p>
<p>This operator re-arranges the input array to a multidimensional array of shape <code class="docutils literal notranslate"><span class="pre">arg_shape</span></code>, then reduces it via
summation across one or more <code class="docutils literal notranslate"><span class="pre">axis</span></code>.</p>
<p>For example, assuming the input array <span class="math notranslate nohighlight">\(\mathbf{x} \in \mathbb{R}^{N_1 \times N_2 \times N_3}\)</span> and <code class="docutils literal notranslate"><span class="pre">axis=-1</span></code>,
then</p>
<div class="math notranslate nohighlight">
\[\mathbf{y}_{i,j} = \sum_{k}{\mathbf{x}_{i,j,k}}.\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arg_shape</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.NDArrayShape" title="pyxu.info.ptype.NDArrayShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayShape</span></code></a>) – Shape of the data to be reduced.</p></li>
<li><p><strong>axis</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.NDArrayAxis" title="pyxu.info.ptype.NDArrayAxis"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayAxis</span></code></a>) – Axis or axes along which a sum is performed.
The default, axis=None, will sum all the elements of the input array.
If axis is negative it counts from the last to the first axis.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="../info.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><em>OpT</em></a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The matrix operator of a 1D reduction applied to <span class="math notranslate nohighlight">\(\mathbf{x} \in \mathbb{R}^{N}\)</span> is given by</p>
<div class="math notranslate nohighlight">
\[\mathbf{A}(x) = \mathbf{1}^{T} \mathbf{x},\]</div>
<p>where <span class="math notranslate nohighlight">\(\sigma_{\max}(\mathbf{A}) = \sqrt{N}\)</span>.
An ND reduction is a chain of 1D reductions in orthogonal dimensions.
Hence the Lipschitz constant of an ND reduction is the product of Lipschitz constants of all 1D reductions involved,
i.e.:</p>
<div class="math notranslate nohighlight">
\[L = \sqrt{\prod_{i_{k}} N_{i_{k}}},\]</div>
<p>where <span class="math notranslate nohighlight">\(\{i_{k}\}_{k}\)</span> denotes the axes being summed over.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.operator.linop.kron.kron">
<span class="sig-name descname"><span class="pre">kron</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/kron.html#kron"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.kron.kron" title="Link to this definition">#</a></dt>
<dd><p>Kronecker product <span class="math notranslate nohighlight">\(A \otimes B\)</span> between two linear operators.</p>
<p>The Kronecker product <span class="math notranslate nohighlight">\(A \otimes B\)</span> is defined as</p>
<div class="math notranslate nohighlight">
\[\begin{split}A \otimes B
=
\left[
    \begin{array}{ccc}
        A_{11} B     &amp; \cdots &amp; A_{1N_{A}} B \\
        \vdots       &amp; \ddots &amp; \vdots   \\
        A_{M_{A}1} B &amp; \cdots &amp; A_{M_{A}N_{A}} B \\
    \end{array}
\right],\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(A : \mathbb{R}^{N_{A}} \to \mathbb{R}^{M_{A}}\)</span>, and <span class="math notranslate nohighlight">\(B : \mathbb{R}^{N_{B}} \to
\mathbb{R}^{M_{B}}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a>) – (mA, nA) linear operator</p></li>
<li><p><strong>B</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a>) – (mB, nB) linear operator</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>op</strong> – (mA*mB, nA*nB) linear operator.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This implementation is <strong>matrix-free</strong> by leveraging properties of the Kronecker product, i.e.  <span class="math notranslate nohighlight">\(A\)</span> and
<span class="math notranslate nohighlight">\(B\)</span> need not be known explicitly.
In particular <span class="math notranslate nohighlight">\((A \otimes B) x\)</span> and <span class="math notranslate nohighlight">\((A \otimes B)^{*} x\)</span> are computed implicitly via the relation:</p>
<div class="math notranslate nohighlight">
\[\text{vec}(\mathbf{A}\mathbf{B}\mathbf{C})
=
(\mathbf{C}^{T} \otimes \mathbf{A}) \text{vec}(\mathbf{B}),\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{A}\)</span>, <span class="math notranslate nohighlight">\(\mathbf{B}\)</span>, and <span class="math notranslate nohighlight">\(\mathbf{C}\)</span> are matrices.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.operator.linop.kron.khatri_rao">
<span class="sig-name descname"><span class="pre">khatri_rao</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/kron.html#khatri_rao"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.kron.khatri_rao" title="Link to this definition">#</a></dt>
<dd><p>Column-wise Khatri-Rao product <span class="math notranslate nohighlight">\(A \circ B\)</span> between two linear operators.</p>
<p>The Khatri-Rao product <span class="math notranslate nohighlight">\(A \circ B\)</span> is defined as</p>
<div class="math notranslate nohighlight">
\[A \circ B
=
\left[
    \begin{array}{ccc}
    \mathbf{a}_{1} \otimes \mathbf{b}_{1} &amp; \cdots &amp; \mathbf{a}_{N} \otimes \mathbf{b}_{N}
    \end{array}
\right],\]</div>
<p>where <span class="math notranslate nohighlight">\(A : \mathbb{R}^{N} \to \mathbb{R}^{M_{A}}\)</span>, <span class="math notranslate nohighlight">\(B : \mathbb{R}^{N} \to \mathbb{R}^{M_{B}}\)</span>, and
<span class="math notranslate nohighlight">\(\mathbf{a}_{k}\)</span> (repectively <span class="math notranslate nohighlight">\(\mathbf{b}_{k}\)</span>) denotes the <span class="math notranslate nohighlight">\(k\)</span>-th column of <span class="math notranslate nohighlight">\(A\)</span>
(respectively <span class="math notranslate nohighlight">\(B\)</span>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a>) – (mA, n) linear operator</p></li>
<li><p><strong>B</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a>) – (mB, n) linear operator</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>op</strong> – (mA*mB, n) linear operator.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This implementation is <strong>matrix-free</strong> by leveraging properties of the Khatri-Rao product, i.e.  <span class="math notranslate nohighlight">\(A\)</span> and
<span class="math notranslate nohighlight">\(B\)</span> need not be known explicitly.
In particular <span class="math notranslate nohighlight">\((A \circ B) x\)</span> and <span class="math notranslate nohighlight">\((A \circ B)^{*} x\)</span> are computed implicitly via the relation:</p>
<div class="math notranslate nohighlight">
\[\text{vec}(\mathbf{A}\text{diag}(\mathbf{b})\mathbf{C})
=
(\mathbf{C}^{T} \circ \mathbf{A}) \mathbf{b},\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{A}\)</span>, <span class="math notranslate nohighlight">\(\mathbf{C}\)</span> are matrices, and <span class="math notranslate nohighlight">\(\mathbf{b}\)</span> is a vector.</p>
<p>Note however that a matrix-free implementation of the Khatri-Rao product does not permit the same optimizations as a
matrix-based implementation.
Thus the Khatri-Rao product as implemented here is only marginally more efficient than applying
<a class="reference internal" href="#pyxu.operator.linop.kron.kron" title="pyxu.operator.linop.kron.kron"><code class="xref py py-func docutils literal notranslate"><span class="pre">kron()</span></code></a> and pruning its output.</p>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyxu.operator.linop.base.IdentityOp">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">IdentityOp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/base.html#IdentityOp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.base.IdentityOp" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="../abc.html#pyxu.abc.operator.OrthProjOp" title="pyxu.abc.operator.OrthProjOp"><code class="xref py py-class docutils literal notranslate"><span class="pre">OrthProjOp</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.11)"><em>Integral</em></a>) – </p>
</dd>
</dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyxu.operator.linop.base.NullOp">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">NullOp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/base.html#NullOp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.base.NullOp" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="../abc.html#pyxu.abc.operator.LinOp" title="pyxu.abc.operator.LinOp"><code class="xref py py-class docutils literal notranslate"><span class="pre">LinOp</span></code></a></p>
<p>Null operator.</p>
<p>This operator maps any input vector on the null vector.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.11)"><em>Integral</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.11)"><em>Integral</em></a><em>]</em>) – </p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.operator.linop.base.NullFunc">
<span class="sig-name descname"><span class="pre">NullFunc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/base.html#NullFunc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.base.NullFunc" title="Link to this definition">#</a></dt>
<dd><p>Null functional.</p>
<p>This functional maps any input vector on the null scalar.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.11)"><em>Integral</em></a>) – </p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="../info.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><em>OpT</em></a></p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.operator.linop.base.HomothetyOp">
<span class="sig-name descname"><span class="pre">HomothetyOp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cst</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/base.html#HomothetyOp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.base.HomothetyOp" title="Link to this definition">#</a></dt>
<dd><p>Scaling operator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.Integer" title="pyxu.info.ptype.Integer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Integer</span></code></a>) – Dimension of the domain.</p></li>
<li><p><strong>cst</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-class docutils literal notranslate"><span class="pre">Real</span></code></a>) – Scaling factor.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>op</strong> – (dim, dim) scaling operator.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This operator is not defined in terms of <a class="reference internal" href="#pyxu.operator.linop.base.DiagonalOp" title="pyxu.operator.linop.base.DiagonalOp"><code class="xref py py-func docutils literal notranslate"><span class="pre">DiagonalOp()</span></code></a> since it is
array-backend-agnostic.</p>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.operator.linop.base.DiagonalOp">
<span class="sig-name descname"><span class="pre">DiagonalOp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_warnings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/base.html#DiagonalOp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.base.DiagonalOp" title="Link to this definition">#</a></dt>
<dd><p>Diagonal linear operator <span class="math notranslate nohighlight">\(\mathbf{D}: \mathbf{x} \to \text{diag}(\mathbf{v}) \mathbf{x}\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#pyxu.operator.linop.base.DiagonalOp" title="pyxu.operator.linop.base.DiagonalOp"><code class="xref py py-func docutils literal notranslate"><span class="pre">DiagonalOp()</span></code></a> instances are <strong>not arraymodule-agnostic</strong>:
they will only work with NDArrays belonging to the same array module as <code class="code docutils literal notranslate"><span class="pre">vec</span></code>.
Moreover, inner computations may cast input arrays when the precision of <code class="code docutils literal notranslate"><span class="pre">vec</span></code> does not match the user-requested
precision.
If such a situation occurs, a warning is raised.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vec</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArray</span></code></a>) – (N,) diagonal scale factors.</p></li>
<li><p><strong>enable_warnings</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, emit a warning in case of precision mis-match issues.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="../info.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><em>OpT</em></a></p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.operator.linop.base._ExplicitLinOp">
<span class="sig-name descname"><span class="pre">_ExplicitLinOp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_warnings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/base.html#_ExplicitLinOp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.base._ExplicitLinOp" title="Link to this definition">#</a></dt>
<dd><p>Build a linear operator from its matrix representation.</p>
<p>Given a matrix <span class="math notranslate nohighlight">\(\mathbf{A} \in \mathbb{R}^{N \times M}\)</span>, the <em>explicit linear operator</em> associated to
<span class="math notranslate nohighlight">\(\mathbf{A}\)</span> is defined as</p>
<div class="math notranslate nohighlight">
\[f_\mathbf{A}(\mathbf{x})
=
\mathbf{A}\mathbf{x},
\qquad
\forall \mathbf{x} \in \mathbb{R}^{M},\]</div>
<p>with adjoint given by:</p>
<div class="math notranslate nohighlight">
\[f^{\ast}_{\mathbf{A}}(\mathbf{z})
=
\mathbf{A}^{T}\mathbf{z},
\qquad
\forall \mathbf{z} \in \mathbb{R}^{N}.\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cls</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.OpC" title="pyxu.info.ptype.OpC"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpC</span></code></a>) – LinOp sub-class to instantiate.</p></li>
<li><p><strong>mat</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArray</span></code></a>, <a class="reference internal" href="../info.html#pyxu.info.ptype.SparseArray" title="pyxu.info.ptype.SparseArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">SparseArray</span></code></a>) – <p>(M, N) matrix generator.
The input array can be <em>dense</em> or <em>sparse</em>.
Accepted sparse arrays are:</p>
<ul>
<li><p>CPU: COO/CSC/CSR/BSR/GCXS</p></li>
<li><p>GPU: COO/CSC/CSR</p></li>
</ul>
</p></li>
<li><p><strong>enable_warnings</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, emit a warning in case of precision mis-match issues.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="../info.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><em>OpT</em></a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p><a class="reference internal" href="#pyxu.operator.linop.base._ExplicitLinOp" title="pyxu.operator.linop.base._ExplicitLinOp"><code class="xref py py-class docutils literal notranslate"><span class="pre">_ExplicitLinOp</span></code></a> instances are <strong>not arraymodule-agnostic</strong>:
they will only work with NDArrays belonging to the same (dense) array module as <code class="code docutils literal notranslate"><span class="pre">mat</span></code>.
Moreover, inner computations may cast input arrays when the precision of <code class="code docutils literal notranslate"><span class="pre">mat</span></code> does not match the user-requested
precision.
If such a situation occurs, a warning is raised.</p></li>
<li><p>The matrix provided to <a class="reference internal" href="#pyxu.operator.linop.base._ExplicitLinOp" title="pyxu.operator.linop.base._ExplicitLinOp"><code class="xref py py-func docutils literal notranslate"><span class="pre">_ExplicitLinOp()</span></code></a> is used as-is and can be accessed via
<code class="docutils literal notranslate"><span class="pre">.mat</span></code>.</p></li>
</ul>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyxu.operator.linop.pad.Pad">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Pad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/pad.html#Pad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.pad.Pad" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="../abc.html#pyxu.abc.operator.LinOp" title="pyxu.abc.operator.LinOp"><code class="xref py py-class docutils literal notranslate"><span class="pre">LinOp</span></code></a></p>
<p>Multi-dimensional padding operator.</p>
<p>This operator pads the input array in each dimension according to specified widths.</p>
<p class="rubric">Notes</p>
<ul>
<li><p>If inputs are D-dimensional, then some of the padding of later axes are calculated from padding of previous axes.</p></li>
<li><p>The <em>adjoint</em> of the padding operator performs a cumulative summation over the original positions used to pad.
Its effect is clear from its matrix form.
For example the matrix-form of <code class="docutils literal notranslate"><span class="pre">Pad(arg_shape=(3,),</span> <span class="pre">mode="wrap",</span> <span class="pre">pad_width=(1,</span> <span class="pre">1))</span></code> is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{A}
=
\left[
   \begin{array}{ccc}
       0 &amp; 0 &amp; 1 \\
       1 &amp; 0 &amp; 0 \\
       0 &amp; 1 &amp; 0 \\
       0 &amp; 0 &amp; 1 \\
       1 &amp; 0 &amp; 0
   \end{array}
\right].\end{split}\]</div>
<p>The adjoint of <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> corresponds to its matrix transpose:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{A}^{\ast}
=
\left[
    \begin{array}{ccccc}
        0 &amp; 1 &amp; 0 &amp; 0 &amp; 1 \\
        0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\
        1 &amp; 0 &amp; 0 &amp; 1 &amp; 0
    \end{array}
\right].\end{split}\]</div>
<p>This operation can be seen as a trimming (<span class="math notranslate nohighlight">\(\mathbf{T}\)</span>) plus a cumulative summation (<span class="math notranslate nohighlight">\(\mathbf{S}\)</span>):</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{A}^{\ast}
=
\mathbf{T} + \mathbf{S}
=
\left[
   \begin{array}{ccccc}
       0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 \\
       0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\
       0 &amp; 0 &amp; 0 &amp; 1 &amp; 0
   \end{array}
\right]
+
\left[
   \begin{array}{ccccc}
       0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 \\
       0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
       1 &amp; 0 &amp; 0 &amp; 0 &amp; 0
   \end{array}
\right],\end{split}\]</div>
<p>where both <span class="math notranslate nohighlight">\(\mathbf{T}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{S}\)</span> are efficiently implemented in matrix-free form.</p>
</li>
<li><p>The Lipschitz constant of the multi-dimensional padding operator is upper-bounded by the product of Lipschitz
constants of the uni-dimensional paddings applied per dimension, i.e.:</p>
<div class="math notranslate nohighlight">
\[L \le \prod_{i} L_{i}, \qquad i \in \{0, \dots, N-1\},\]</div>
<p>where <span class="math notranslate nohighlight">\(L_{i}\)</span> depends on the boundary condition at the <span class="math notranslate nohighlight">\(i\)</span>-th axis.</p>
<p><span class="math notranslate nohighlight">\(L_{i}^{2}\)</span> corresponds to the maximum singular value of the diagonal matrix</p>
<div class="math notranslate nohighlight">
\[\mathbf{A}_{i}^{\ast} \mathbf{A}_{i}
=
\mathbf{T}_{i}^{\ast} \mathbf{T}_{i} + \mathbf{S}_{i}^{\ast} \mathbf{S}_{i}
=
\mathbf{I}_{N} + \mathbf{S}_{i}^{\ast} \mathbf{S}_{i}.\]</div>
<ul>
<li><p>In mode=”constant”, <span class="math notranslate nohighlight">\(\text{diag}(\mathbf{S}_{i}^{\ast} \mathbf{S}_{i}) = \mathbf{0}\)</span>,
hence <span class="math notranslate nohighlight">\(L_{i} = 1\)</span>.</p></li>
<li><p>In mode=”edge”,</p>
<div class="math notranslate nohighlight">
\[\text{diag}(\mathbf{S}_{i}^{\ast} \mathbf{S}_{i})
=
\left[p_{lhs}, 0, \ldots, 0, p_{rhs} \right],\]</div>
<p>hence <span class="math notranslate nohighlight">\(L_{i} = \sqrt{1 + \min(p_{lhs}, p_{rhs})}\)</span>.</p>
</li>
<li><p>In mode=”symmetric”, “wrap”, “reflect”, <span class="math notranslate nohighlight">\(\text{diag}(\mathbf{S}_{i}^{\ast}
\mathbf{S}_{i})\)</span> equals (up to a mode-dependant permutation)</p>
<div class="math notranslate nohighlight">
\[\text{diag}(\mathbf{S}_{i}^{\ast} \mathbf{S}_{i})
=
\left[1, \ldots, 1, 0, \ldots, 0\right]
+
\left[0, \ldots, 0, 1, \ldots, 1\right],\]</div>
<p>hence</p>
<div class="math notranslate nohighlight">
\[\begin{split}L^{\text{wrap, symmetric}}_{i} = \sqrt{1 + \lceil\frac{p_{lhs} + p_{rhs}}{N}\rceil}, \\
L^{\text{reflect}}_{i} = \sqrt{1 + \lceil\frac{p_{lhs} + p_{rhs}}{N-2}\rceil}.\end{split}\]</div>
</li>
</ul>
</li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arg_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.11)"><em>Integral</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.11)"><em>Integral</em></a><em>, </em><em>...</em><em>]</em>) – </p></li>
<li><p><strong>pad_width</strong> (<a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.11)"><em>Integral</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.11)"><em>Sequence</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.11)"><em>Integral</em></a><em>] </em><em>| </em><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.11)"><em>Sequence</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.11)"><em>Integral</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.11)"><em>Integral</em></a><em>]</em><em>]</em>) – </p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.11)"><em>Sequence</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyxu.operator.linop.pad.Pad.WidthSpec">
<span class="sig-name descname"><span class="pre">WidthSpec</span></span><a class="headerlink" href="#pyxu.operator.linop.pad.Pad.WidthSpec" title="Link to this definition">#</a></dt>
<dd><p>alias of <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Integral</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Integral</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Integral</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Integral</span></code></a>]]]</p>
</dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyxu.operator.linop.pad.Pad.ModeSpec">
<span class="sig-name descname"><span class="pre">ModeSpec</span></span><a class="headerlink" href="#pyxu.operator.linop.pad.Pad.ModeSpec" title="Link to this definition">#</a></dt>
<dd><p>alias of <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]]</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.operator.linop.pad.Pad.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/pad.html#Pad.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.pad.Pad.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arg_shape</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.NDArrayShape" title="pyxu.info.ptype.NDArrayShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayShape</span></code></a>) – Shape of the input array.</p></li>
<li><p><strong>pad_width</strong> (<a class="reference internal" href="#pyxu.operator.linop.pad.Pad.WidthSpec" title="pyxu.operator.linop.pad.Pad.WidthSpec"><code class="xref py py-class docutils literal notranslate"><span class="pre">WidthSpec</span></code></a>) – <p>Number of values padded to the edges of each axis.
Multiple forms are accepted:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">int</span></code>: pad each dimension’s head/tail by <code class="code docutils literal notranslate"><span class="pre">pad_width</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tuple[int,</span> <span class="pre">...]</span></code>: pad dimension[k]’s head/tail by <code class="code docutils literal notranslate"><span class="pre">pad_width[k]</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tuple[tuple[int,</span> <span class="pre">int],</span> <span class="pre">...]</span></code>: pad dimension[k]’s head/tail by <code class="code docutils literal notranslate"><span class="pre">pad_width[k][0]</span></code> /
<code class="code docutils literal notranslate"><span class="pre">pad_width[k][1]</span></code> respectively.</p></li>
</ul>
</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> ( str )) – <p>Padding mode.
Multiple forms are accepted:</p>
<ul>
<li><p>str: unique mode shared amongst dimensions.
Must be one of:</p>
<ul>
<li><p>’constant’ (zero-padding)</p></li>
<li><p>’wrap’</p></li>
<li><p>’reflect’</p></li>
<li><p>’symmetric’</p></li>
<li><p>’edge’</p></li>
</ul>
</li>
<li><p>tuple[str, …]: pad dimension[k] using <code class="code docutils literal notranslate"><span class="pre">mode[k]</span></code>.</p></li>
</ul>
<p>(See <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.pad.html#numpy.pad" title="(in NumPy v1.25)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.pad()</span></code></a> for details.)</p>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>
</dd></dl>
</section>
<section id="stencils-and-convolutions">
<h2><a class="toc-backref" href="#id43" role="doc-backlink">Stencils and Convolutions</a><a class="headerlink" href="#stencils-and-convolutions" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyxu.operator.linop.stencil._stencil._Stencil">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_Stencil</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kernel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/stencil/_stencil.html#_Stencil"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.stencil._stencil._Stencil" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Multi-dimensional JIT-compiled stencil.</p>
<p>This low-level class creates a gu-vectorized stencil applicable on multiple inputs simultaneously.</p>
<p>Create instances via factory method <a class="reference internal" href="#pyxu.operator.linop.stencil._stencil._Stencil.init" title="pyxu.operator.linop.stencil._stencil._Stencil.init"><code class="xref py py-meth docutils literal notranslate"><span class="pre">init()</span></code></a>.</p>
<p class="rubric">Example</p>
<p>Correlate a stack of images <code class="code docutils literal notranslate"><span class="pre">A</span></code> with a (3, 3) kernel such that:</p>
<div class="math notranslate nohighlight">
\[B[n, m] = A[n-1, m] + A[n, m-1] + A[n, m+1] + A[n+1, m]\]</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pyxu.operator.linop.stencil._stencil</span> <span class="kn">import</span> <span class="n">_Stencil</span>

<span class="c1"># create the stencil</span>
<span class="n">kernel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                   <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                   <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="n">center</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">stencil</span> <span class="o">=</span> <span class="n">_Stencil</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">kernel</span><span class="p">,</span> <span class="n">center</span><span class="p">)</span>

<span class="c1"># apply it to the data</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span>  <span class="c1"># 24 images of size (30, 30)</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">stencil</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>  <span class="c1"># (2, 3, 4, 30, 30)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kernel</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><em>NDArray</em></a>) – </p></li>
<li><p><strong>center</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><em>NDArray</em></a>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyxu.operator.linop.stencil._stencil._Stencil.IndexSpec">
<span class="sig-name descname"><span class="pre">IndexSpec</span></span><a class="headerlink" href="#pyxu.operator.linop.stencil._stencil._Stencil.IndexSpec" title="Link to this definition">#</a></dt>
<dd><p>alias of <a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Integral</span></code></a>]</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.operator.linop.stencil._stencil._Stencil.init">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kernel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/stencil/_stencil.html#_Stencil.init"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.stencil._stencil._Stencil.init" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kernel</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArray</span></code></a>) – <p>(k_1, …, k_D) kernel coefficients.</p>
<p>Only float32/64 kernels are supported.</p>
</p></li>
<li><p><strong>center</strong> (<a class="reference internal" href="#pyxu.operator.linop.stencil._stencil._Stencil.IndexSpec" title="pyxu.operator.linop.stencil._stencil._Stencil.IndexSpec"><code class="xref py py-class docutils literal notranslate"><span class="pre">IndexSpec</span></code></a>) – (D,) index of the kernel’s center.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>st</strong> – Rank-D stencil.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#pyxu.operator.linop.stencil._stencil._Stencil" title="pyxu.operator.linop.stencil._stencil._Stencil"><code class="xref py py-class docutils literal notranslate"><span class="pre">_Stencil</span></code></a></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.operator.linop.stencil._stencil._Stencil.apply">
<span class="sig-name descname"><span class="pre">apply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/stencil/_stencil.html#_Stencil.apply"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.stencil._stencil._Stencil.apply" title="Link to this definition">#</a></dt>
<dd><p>Evaluate stencil on multiple inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArray</span></code></a>) – (…, N_1, …, N_D) data to process.</p></li>
<li><p><strong>out</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArray</span></code></a>) – (…, N_1, …, N_D) array to which outputs are written.</p></li>
<li><p><strong>kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>) – <p>Extra kwargs to configure <code class="code docutils literal notranslate"><span class="pre">f_jit()</span></code>, the Dispatcher instance created by Numba.</p>
<p>Only relevant for GPU stencils, with values:</p>
<ul>
<li><p>blockspergrid: int</p></li>
<li><p>threadsperblock: int</p></li>
</ul>
<p>Default values are chosen if unspecified.</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>out</strong> – (…, N_1, …, N_D) outputs.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArray</span></code></a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul>
<li><p><code class="code docutils literal notranslate"><span class="pre">arr</span></code> and <code class="code docutils literal notranslate"><span class="pre">out</span></code> must have the same type/dtype as the kernel used during instantiation.</p></li>
<li><p>Index regions in <code class="code docutils literal notranslate"><span class="pre">out</span></code> where the stencil is not fully supported are set to 0.</p></li>
<li><p><a class="reference internal" href="#pyxu.operator.linop.stencil._stencil._Stencil.apply" title="pyxu.operator.linop.stencil._stencil._Stencil.apply"><code class="xref py py-meth docutils literal notranslate"><span class="pre">apply()</span></code></a> may raise
<code class="docutils literal notranslate"><span class="pre">CUDA_ERROR_LAUNCH_OUT_OF_RESOURCES</span></code> when the number of GPU registers required exceeds resource limits.
There are 2 solutions to this problem:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Pass the <code class="code docutils literal notranslate"><span class="pre">max_registers</span></code> kwarg to f_jit()’s decorator; or</p></li>
<li><p><a class="reference external" href="https://stackoverflow.com/a/68659008">Limit the number of threads per block</a>.</p></li>
</ol>
</div></blockquote>
<ol class="arabic simple">
<li><p>must be set at compile time; it is thus left unbounded.</p></li>
<li><p>is accessible through .apply(**kwargs).</p></li>
</ol>
</li>
</ul>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyxu.operator.linop.stencil.stencil.Stencil">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Stencil</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_warnings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/stencil/stencil.html#Stencil"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.stencil.stencil.Stencil" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="../abc.html#pyxu.abc.operator.SquareOp" title="pyxu.abc.operator.SquareOp"><code class="xref py py-class docutils literal notranslate"><span class="pre">SquareOp</span></code></a></p>
<p>Multi-dimensional JIT-compiled stencil.</p>
<p>Stencils are a common computational pattern in which array elements are updated according to some fixed pattern
called the <em>stencil kernel</em>.
Notable examples include multi-dimensional convolutions, correlations and finite differences.  (See Notes for a
definition.)</p>
<p>Stencils can be evaluated efficiently on CPU/GPU architectures.</p>
<p>Several boundary conditions are supported.
Moreover boundary conditions may differ per axis.</p>
<p class="rubric">Implementation Notes</p>
<ul class="simple">
<li><p>Numba (and its <code class="docutils literal notranslate"><span class="pre">@stencil</span></code> decorator) is used behind the scenes to compile efficient machine code from a stencil
kernel specification.  This has 2 consequences:</p>
<ul>
<li><p><a class="reference internal" href="#pyxu.operator.linop.stencil.stencil.Stencil" title="pyxu.operator.linop.stencil.stencil.Stencil"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stencil</span></code></a> instances are <strong>not arraymodule-agnostic</strong>: they will
only work with NDArrays belonging to the same array module as <code class="code docutils literal notranslate"><span class="pre">kernel</span></code>.</p></li>
<li><p>Compiled stencils are not <strong>precision-agnostic</strong>: they will only work on NDArrays with the same dtype as
<code class="code docutils literal notranslate"><span class="pre">kernel</span></code>.
A warning is emitted if inputs must be cast to the kernel dtype.</p></li>
</ul>
</li>
<li><p>Stencil kernels can be specified in two forms:
(See <a class="reference internal" href="#pyxu.operator.linop.stencil.stencil.Stencil.__init__" title="pyxu.operator.linop.stencil.stencil.Stencil.__init__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__init__()</span></code></a> for details.)</p>
<ul>
<li><p>A single non-separable <span class="math notranslate nohighlight">\(D\)</span>-dimensional kernel <span class="math notranslate nohighlight">\(k[i_{1},\ldots,i_{D}]\)</span> of shape
<span class="math notranslate nohighlight">\((K_{1},\ldots,K_{D})\)</span>.</p></li>
<li><p>A sequence of separable <span class="math notranslate nohighlight">\(1\)</span>-dimensional kernel(s) <span class="math notranslate nohighlight">\(k_{d}[i]\)</span> of shapes
<span class="math notranslate nohighlight">\((K_{1},),\ldots,(K_{D},)\)</span> such that <span class="math notranslate nohighlight">\(k[i_{1},\ldots,i_{D}] = \Pi_{d=1}^{D} k_{d}[i_{d}]\)</span>.</p></li>
</ul>
</li>
</ul>
<p class="rubric">Mathematical Notes</p>
<p>Given a <span class="math notranslate nohighlight">\(D\)</span>-dimensional array <span class="math notranslate nohighlight">\(x\in\mathbb{R}^{N_1\times\cdots\times N_D}\)</span> and kernel
<span class="math notranslate nohighlight">\(k\in\mathbb{R}^{K_1\times\cdots\times K_D}\)</span> with center <span class="math notranslate nohighlight">\((c_1, \ldots, c_D)\)</span>, the output of the stencil
operator is an array <span class="math notranslate nohighlight">\(y\in\mathbb{R}^{N_1\times\cdots\times N_D}\)</span> given by:</p>
<div class="math notranslate nohighlight">
\[y[i_{1},\ldots,i_{D}]
=
\sum_{q_{1},\ldots,q_{D}=0}^{K_{1},\ldots,K_{D}}
x[i_{1} - c_{1} + q_{1},\ldots,i_{D} - c_{D} + q_{D}]
\,\cdot\,
k[q_{1},\ldots,q_{D}].\]</div>
<p>This corresponds to a <em>correlation</em> with a shifted version of the kernel <span class="math notranslate nohighlight">\(k\)</span>.</p>
<p>Numba stencils assume summation terms involving out-of-bound indices of <span class="math notranslate nohighlight">\(x\)</span> are set to zero.
<a class="reference internal" href="#pyxu.operator.linop.stencil.stencil.Stencil" title="pyxu.operator.linop.stencil.stencil.Stencil"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stencil</span></code></a> lifts this constraint by extending the stencil to boundary
values via pre-padding and post-trimming.
Concretely, any stencil operator <span class="math notranslate nohighlight">\(S\)</span> instantiated with
<a class="reference internal" href="#pyxu.operator.linop.stencil.stencil.Stencil" title="pyxu.operator.linop.stencil.stencil.Stencil"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stencil</span></code></a> can be written as the composition <span class="math notranslate nohighlight">\(S = TS_0P\)</span>, where
<span class="math notranslate nohighlight">\((T, S_0, P)\)</span> are trimming, stencil with zero-padding conditions, and padding operators respectively.
This construct allows <a class="reference internal" href="#pyxu.operator.linop.stencil.stencil.Stencil" title="pyxu.operator.linop.stencil.stencil.Stencil"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stencil</span></code></a> to handle complex boundary conditions
under which <span class="math notranslate nohighlight">\(S\)</span> <em>may not be a proper stencil</em> (i.e., varying kernel) but can still be implemented efficiently
via a proper stencil upon appropriate trimming/padding.</p>
<p>For example consider the decomposition of the following (improper) stencil operator:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">S</span> <span class="o">=</span> <span class="n">Stencil</span><span class="p">(</span>
<span class="gp">... </span>     <span class="n">arg_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,),</span>
<span class="gp">... </span>     <span class="n">kernel</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">],</span>
<span class="gp">... </span>     <span class="n">center</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,),</span>
<span class="gp">... </span>     <span class="n">mode</span><span class="o">=</span><span class="s2">"reflect"</span><span class="p">,</span>
<span class="gp">... </span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">S</span><span class="o">.</span><span class="n">asarray</span><span class="p">()</span>
<span class="go">[[-3   2   1   0   0]</span>
<span class="go"> [ 2  -2   0   0   0]</span>
<span class="go"> [ 1   2  -3   0   0]</span>
<span class="go"> [ 0   1   2  -3   0]</span>
<span class="go"> [ 0   0   1   2  -3]] # Improper stencil (kernel varies across rows)</span>
<span class="go">=</span>
<span class="go">[[0  0  1  0  0  0  0  0  0]</span>
<span class="go"> [0  0  0  1  0  0  0  0  0]</span>
<span class="go"> [0  0  0  0  1  0  0  0  0]</span>
<span class="go"> [0  0  0  0  0  1  0  0  0]</span>
<span class="go"> [0  0  0  0  0  0  1  0  0]]  # Trimming</span>
<span class="go">@</span>
<span class="go">[[-3   0   0   0   0   0   0   0   0]</span>
<span class="go"> [ 2  -3   0   0   0   0   0   0   0]</span>
<span class="go"> [ 1   2  -3   0   0   0   0   0   0]</span>
<span class="go"> [ 0   1   2  -3   0   0   0   0   0]</span>
<span class="go"> [ 0   0   1   2  -3   0   0   0   0]</span>
<span class="go"> [ 0   0   0   1   2  -3   0   0   0]</span>
<span class="go"> [ 0   0   0   0   1   2  -3   0   0]</span>
<span class="go"> [ 0   0   0   0   0   1   2  -3   0]</span>
<span class="go"> [ 0   0   0   0   0   0   1   2  -3]]  # Proper stencil (Toeplitz structure)</span>
<span class="go">@</span>
<span class="go">[[0  0  1  0  0]</span>
<span class="go"> [0  1  0  0  0]</span>
<span class="go"> [1  0  0  0  0]</span>
<span class="go"> [0  1  0  0  0]</span>
<span class="go"> [0  0  1  0  0]</span>
<span class="go"> [0  0  0  1  0]</span>
<span class="go"> [0  0  0  0  1]</span>
<span class="go"> [0  0  0  1  0]</span>
<span class="go"> [0  0  1  0  0]]  # Padding with reflect mode.</span>
</pre></div>
</div>
<p>Note that the adjoint of a stencil operator may not necessarily be a stencil operator, or the associated center and
boundary conditions may be hard to predict.
For example, the adjoint of the stencil operator defined above is given by:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">S</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">asarray</span><span class="p">()</span>
<span class="go">[[-3   2   1   0   0],</span>
<span class="go"> [ 2  -2   2   1   0],</span>
<span class="go"> [ 1   0  -3   2   1],</span>
<span class="go"> [ 0   0   0  -3   2],</span>
<span class="go"> [ 0   0   0   0  -3]]</span>
</pre></div>
</div>
<p>which resembles a stencil with time-reversed kernel, but with weird (if not improper) boundary conditions.
This can also be seen from the fact that <span class="math notranslate nohighlight">\(S^\ast = P^\ast S_0^\ast T^\ast = P^\ast S_0^\ast P_0,\)</span> and
<span class="math notranslate nohighlight">\(P^\ast\)</span> is in general not a trimming operator.  (See <a class="reference internal" href="#pyxu.operator.linop.pad.Pad" title="pyxu.operator.linop.pad.Pad"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pad</span></code></a>.)</p>
<p>The same holds for gram/cogram operators.
Consider indeed the following order-1 backward finite-difference operator with zero-padding:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">S</span> <span class="o">=</span> <span class="n">Stencil</span><span class="p">(</span>
<span class="gp">... </span>     <span class="n">arg_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,),</span>
<span class="gp">... </span>     <span class="n">kernel</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>     <span class="n">center</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,),</span>
<span class="gp">... </span>     <span class="n">mode</span><span class="o">=</span><span class="s1">'constant'</span><span class="p">,</span>
<span class="gp">... </span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">S</span><span class="o">.</span><span class="n">gram</span><span class="p">()</span><span class="o">.</span><span class="n">asarray</span><span class="p">()</span>
<span class="go">[[ 1  -1   0   0   0]</span>
<span class="go"> [-1   2  -1   0   0]</span>
<span class="go"> [ 0  -1   2  -1   0]</span>
<span class="go"> [ 0   0  -1   2  -1]</span>
<span class="go"> [ 0   0   0  -1   2]]</span>
</pre></div>
</div>
<p>We observe that the Gram differs from the order 2 centered finite-difference operator.  (Reduced-order derivative on
one side.)</p>
<p class="rubric">Example</p>
<ul>
<li><p><strong>Moving average of a 1D signal</strong></p>
<p>Let <span class="math notranslate nohighlight">\(x[n]\)</span> denote a 1D signal.
The weighted moving average</p>
<div class="math notranslate nohighlight">
\[y[n] = x[n-2] + 2 x[n-1] + 3 x[n]\]</div>
<p>can be viewed as the output of the 3-point stencil of kernel <span class="math notranslate nohighlight">\(k = [1, 2, 3]\)</span>.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pyxu.operator</span> <span class="kn">import</span> <span class="n">Stencil</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>  <span class="c1"># [0  1  2  3  4  5  6  7  8  9]</span>

<span class="n">op</span> <span class="o">=</span> <span class="n">Stencil</span><span class="p">(</span>
    <span class="n">arg_shape</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
    <span class="n">kernel</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span>
    <span class="n">center</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,),</span>  <span class="c1"># k[2] applies on x[n]</span>
<span class="p">)</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># [0  3  8  14  20  26  32  38  44  50]</span>
</pre></div>
</div>
</li>
<li><p><strong>Non-seperable image filtering</strong></p>
<p>Let <span class="math notranslate nohighlight">\(x[n, m]\)</span> denote a 2D image.
The blurred image</p>
<div class="math notranslate nohighlight">
\[y[n, m] = 2 x[n-1,m-1] + 3 x[n-1,m+1] + 4 x[n+1,m-1] + 5 x[n+1,m+1]\]</div>
<p>can be viewed as the output of the 9-point stencil</p>
<div class="math notranslate nohighlight">
\[\begin{split}k =
\left[
\begin{array}{ccc}
   2 &amp; 0 &amp; 3 \\
   0 &amp; 0 &amp; 0 \\
   4 &amp; 0 &amp; 5
\end{array}
\right].\end{split}\]</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pyxu.operator</span> <span class="kn">import</span> <span class="n">Stencil</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>  <span class="c1"># square image</span>
<span class="c1"># [[ 0   1   2   3   4   5   6   7]</span>
<span class="c1">#  [ 8   9  10  11  12  13  14  15]</span>
<span class="c1">#  [16  17  18  19  20  21  22  23]</span>
<span class="c1">#  [24  25  26  27  28  29  30  31]</span>
<span class="c1">#  [32  33  34  35  36  37  38  39]</span>
<span class="c1">#  [40  41  42  43  44  45  46  47]</span>
<span class="c1">#  [48  49  50  51  52  53  54  55]</span>
<span class="c1">#  [56  57  58  59  60  61  62  63]]</span>

<span class="n">op</span> <span class="o">=</span> <span class="n">Stencil</span><span class="p">(</span>
    <span class="n">arg_shape</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
    <span class="n">kernel</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
        <span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
         <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
         <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">]]),</span>
    <span class="n">center</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>  <span class="c1"># k[1, 1] applies on x[n, m]</span>
<span class="p">)</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="c1"># [[ 45   82   91  100  109  118  127   56 ]</span>
<span class="c1">#  [ 88  160  174  188  202  216  230  100 ]</span>
<span class="c1">#  [152  272  286  300  314  328  342  148 ]</span>
<span class="c1">#  [216  384  398  412  426  440  454  196 ]</span>
<span class="c1">#  [280  496  510  524  538  552  566  244 ]</span>
<span class="c1">#  [344  608  622  636  650  664  678  292 ]</span>
<span class="c1">#  [408  720  734  748  762  776  790  340 ]</span>
<span class="c1">#  [147  246  251  256  261  266  271  108 ]]</span>
</pre></div>
</div>
</li>
<li><p><strong>Seperable image filtering</strong></p>
<p>Let <span class="math notranslate nohighlight">\(x[n, m]\)</span> denote a 2D image.
The warped image</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
    y[n, m] = &amp; +  4 x[n-1,m-1] +  5 x[n-1,m] +  6 x[n-1,m+1] \\
              &amp; +  8 x[n  ,m-1] + 10 x[n  ,m] + 12 x[n  ,m+1] \\
              &amp; + 12 x[n+1,m-1] + 15 x[n+1,m] + 18 x[n+1,m+1]
\end{align*}\end{split}\]</div>
<p>can be viewed as the output of the 9-point stencil</p>
<div class="math notranslate nohighlight">
\[\begin{split}k_{2D} =
\left[
\begin{array}{ccc}
    4 &amp;  5 &amp;  6 \\
    8 &amp; 10 &amp; 12 \\
   12 &amp; 15 &amp; 18 \\
\end{array}
\right].\end{split}\]</div>
<p>Notice however that <span class="math notranslate nohighlight">\(y[n, m]\)</span> can be implemented more efficiently by factoring the 9-point stencil as a
cascade of two 3-point stencils:</p>
<div class="math notranslate nohighlight">
\[\begin{split}k_{2D}
= k_{1} k_{2}^{T}
= \left[
\begin{array}{c}
   1 \\ 2 \\ 3
\end{array}
\right]
\left[
\begin{array}{c}
   4 &amp; 5 &amp; 6
\end{array}
\right].\end{split}\]</div>
<p>Seperable stencils are supported and should be preferred when applicable.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pyxu.operator</span> <span class="kn">import</span> <span class="n">Stencil</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>  <span class="c1"># square image</span>
<span class="c1"># [[ 0   1   2   3   4   5   6   7]</span>
<span class="c1">#  [ 8   9  10  11  12  13  14  15]</span>
<span class="c1">#  [16  17  18  19  20  21  22  23]</span>
<span class="c1">#  [24  25  26  27  28  29  30  31]</span>
<span class="c1">#  [32  33  34  35  36  37  38  39]</span>
<span class="c1">#  [40  41  42  43  44  45  46  47]</span>
<span class="c1">#  [48  49  50  51  52  53  54  55]</span>
<span class="c1">#  [56  57  58  59  60  61  62  63]]</span>

<span class="n">op_2D</span> <span class="o">=</span> <span class="n">Stencil</span><span class="p">(</span>  <span class="c1"># using non-seperable kernel</span>
    <span class="n">arg_shape</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
    <span class="n">kernel</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
        <span class="p">[[</span> <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">],</span>
         <span class="p">[</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span>
         <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">18</span><span class="p">]]),</span>
    <span class="n">center</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>  <span class="c1"># k[1, 1] applies on x[n, m]</span>
<span class="p">)</span>
<span class="n">op_sep</span> <span class="o">=</span> <span class="n">Stencil</span><span class="p">(</span>  <span class="c1"># using seperable kernels</span>
    <span class="n">arg_shape</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
    <span class="n">kernel</span><span class="o">=</span><span class="p">[</span>
        <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span>  <span class="c1"># k1: stencil along 1st axis</span>
        <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]),</span>  <span class="c1"># k2: stencil along 2nd axis</span>
    <span class="p">],</span>
    <span class="n">center</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>  <span class="c1"># k1[1] * k2[1] applies on x[n, m]</span>
<span class="p">)</span>

<span class="n">y_2D</span> <span class="o">=</span> <span class="n">op_2D</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">y_sep</span> <span class="o">=</span> <span class="n">op_sep</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>  <span class="c1"># np.allclose(y_2D, y_sep) -&gt; True</span>
<span class="c1"># [[ 294   445   520   595   670   745   820   511 ]</span>
<span class="c1">#  [ 740  1062  1152  1242  1332  1422  1512   930 ]</span>
<span class="c1">#  [1268  1782  1872  1962  2052  2142  2232  1362 ]</span>
<span class="c1">#  [1796  2502  2592  2682  2772  2862  2952  1794 ]</span>
<span class="c1">#  [2324  3222  3312  3402  3492  3582  3672  2226 ]</span>
<span class="c1">#  [2852  3942  4032  4122  4212  4302  4392  2658 ]</span>
<span class="c1">#  [3380  4662  4752  4842  4932  5022  5112  3090 ]</span>
<span class="c1">#  [1778  2451  2496  2541  2586  2631  2676  1617 ]]</span>
</pre></div>
</div>
</li>
</ul>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyxu.operator.linop.stencil.stencil.Convolve" title="pyxu.operator.linop.stencil.stencil.Convolve"><code class="xref py py-class docutils literal notranslate"><span class="pre">Convolve</span></code></a>, <a class="reference internal" href="#pyxu.operator.linop.stencil._stencil._Stencil" title="pyxu.operator.linop.stencil._stencil._Stencil"><code class="xref py py-class docutils literal notranslate"><span class="pre">_Stencil</span></code></a></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arg_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.11)"><em>Integral</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.11)"><em>Integral</em></a><em>, </em><em>...</em><em>]</em>) – </p></li>
<li><p><strong>kernel</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><em>NDArray</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.11)"><em>Sequence</em></a><em>[</em><a class="reference internal" href="../info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><em>NDArray</em></a><em>]</em>) – </p></li>
<li><p><strong>center</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.11)"><em>Sequence</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.11)"><em>Integral</em></a><em>]</em>) – </p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.11)"><em>Sequence</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em>]</em>) – </p></li>
<li><p><strong>enable_warnings</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyxu.operator.linop.stencil.stencil.Stencil.KernelSpec">
<span class="sig-name descname"><span class="pre">KernelSpec</span></span><a class="headerlink" href="#pyxu.operator.linop.stencil.stencil.Stencil.KernelSpec" title="Link to this definition">#</a></dt>
<dd><p>alias of <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference internal" href="../info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NDArray</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<a class="reference internal" href="../info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NDArray</span></code></a>]]</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.operator.linop.stencil.stencil.Stencil.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_warnings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/stencil/stencil.html#Stencil.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.stencil.stencil.Stencil.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arg_shape</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.NDArrayShape" title="pyxu.info.ptype.NDArrayShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayShape</span></code></a>) – Shape of the rank-<span class="math notranslate nohighlight">\(D\)</span> input array.</p></li>
<li><p><strong>kernel</strong> (<a class="reference internal" href="#pyxu.operator.linop.stencil.stencil.Stencil.KernelSpec" title="pyxu.operator.linop.stencil.stencil.Stencil.KernelSpec"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelSpec</span></code></a>) – <p>Stencil coefficients.
Two forms are accepted:</p>
<ul>
<li><p>NDArray of rank-<span class="math notranslate nohighlight">\(D\)</span>: denotes a non-seperable stencil.</p></li>
<li><p>tuple[NDArray_1, …, NDArray_D]: a sequence of 1D stencils such that dimension[k]
is filtered by stencil <code class="code docutils literal notranslate"><span class="pre">kernel[k]</span></code>, that is:</p>
<div class="math notranslate nohighlight">
\[k = k_1\otimes \cdots\otimes k_D,\]</div>
<p>or in Python: <code class="docutils literal notranslate"><span class="pre">k</span> <span class="pre">=</span> <span class="pre">functools.reduce(numpy.multiply.outer,</span> <span class="pre">kernel)</span></code>.</p>
</li>
</ul>
</p></li>
<li><p><strong>center</strong> (<a class="reference internal" href="#pyxu.operator.linop.stencil._stencil._Stencil.IndexSpec" title="pyxu.operator.linop.stencil._stencil._Stencil.IndexSpec"><code class="xref py py-class docutils literal notranslate"><span class="pre">IndexSpec</span></code></a>) – <p>(i_1, …, i_D) index of the stencil’s center.</p>
<p><code class="code docutils literal notranslate"><span class="pre">center</span></code> defines how a kernel is overlaid on inputs to produce outputs.</p>
</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> ( str )) – <p>Boundary conditions.
Multiple forms are accepted:</p>
<ul>
<li><p>str: unique mode shared amongst dimensions.
Must be one of:</p>
<ul>
<li><p>’constant’ (zero-padding)</p></li>
<li><p>’wrap’</p></li>
<li><p>’reflect’</p></li>
<li><p>’symmetric’</p></li>
<li><p>’edge’</p></li>
</ul>
</li>
<li><p>tuple[str, …]: dimension[k] uses <code class="code docutils literal notranslate"><span class="pre">mode[k]</span></code> as boundary condition.</p></li>
</ul>
<p>(See <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.pad.html#numpy.pad" title="(in NumPy v1.25)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.pad()</span></code></a> for details.)</p>
</p></li>
<li><p><strong>enable_warnings</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, emit a warning in case of precision mis-match issues.</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.operator.linop.stencil.stencil.Stencil.configure_dispatcher">
<span class="sig-name descname"><span class="pre">configure_dispatcher</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/stencil/stencil.html#Stencil.configure_dispatcher"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.stencil.stencil.Stencil.configure_dispatcher" title="Link to this definition">#</a></dt>
<dd><p>(Only applies if <code class="code docutils literal notranslate"><span class="pre">kernel</span></code> is a CuPy array.)</p>
<p>Configure stencil Dispatcher.</p>
<p>See <a class="reference internal" href="#pyxu.operator.linop.stencil._stencil._Stencil.apply" title="pyxu.operator.linop.stencil._stencil._Stencil.apply"><code class="xref py py-meth docutils literal notranslate"><span class="pre">apply()</span></code></a> for accepted options.</p>
<p class="rubric">Example</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cupy</span> <span class="k">as</span> <span class="nn">cp</span>
<span class="kn">from</span> <span class="nn">pyxu.operator</span> <span class="kn">import</span> <span class="n">Stencil</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

<span class="n">op</span> <span class="o">=</span> <span class="n">Stencil</span><span class="p">(</span>
    <span class="n">arg_shape</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
    <span class="n">kernel</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span>
    <span class="n">center</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span>
<span class="p">)</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># uses default threadsperblock/blockspergrid values</span>

<span class="n">op</span><span class="o">.</span><span class="n">configure_dispatcher</span><span class="p">(</span>
    <span class="n">threadsperblock</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
    <span class="n">blockspergrid</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># supplied values used instead</span>
</pre></div>
</div>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyxu.operator.linop.stencil.stencil.Stencil.kernel">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">kernel</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="../info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><span class="pre">NDArray</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.11)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><span class="pre">NDArray</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#pyxu.operator.linop.stencil.stencil.Stencil.kernel" title="Link to this definition">#</a></dt>
<dd><p>Stencil kernel coefficients.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p><strong>kern</strong> – Stencil coefficients.</p>
<p>If the kernel is non-seperable, a single array is returned.
Otherwise <span class="math notranslate nohighlight">\(D\)</span> arrays are returned, one per axis.</p>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#pyxu.operator.linop.stencil.stencil.Stencil.KernelSpec" title="pyxu.operator.linop.stencil.stencil.Stencil.KernelSpec"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelSpec</span></code></a></p>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyxu.operator.linop.stencil.stencil.Stencil.center">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">center</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.11)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.11)"><span class="pre">Integral</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#pyxu.operator.linop.stencil.stencil.Stencil.center" title="Link to this definition">#</a></dt>
<dd><p>Stencil central position.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ctr</strong> – Stencil central position.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#pyxu.operator.linop.stencil._stencil._Stencil.IndexSpec" title="pyxu.operator.linop.stencil._stencil._Stencil.IndexSpec"><code class="xref py py-class docutils literal notranslate"><span class="pre">IndexSpec</span></code></a></p>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyxu.operator.linop.stencil.stencil.Stencil.relative_indices">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">relative_indices</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.11)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><span class="pre">NDArray</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#pyxu.operator.linop.stencil.stencil.Stencil.relative_indices" title="Link to this definition">#</a></dt>
<dd><p>Relative indices of the stencil.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>r_idx</strong> – Relative indices of the stencil’s kernel in each dimension.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> ( <a class="reference internal" href="../info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-attr docutils literal notranslate"><span class="pre">NDArray</span></code></a> )</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">S</span> <span class="o">=</span> <span class="n">Stencil</span><span class="p">(</span>
    <span class="n">arg_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span>
    <span class="n">kernel</span><span class="o">=</span><span class="p">[</span>
        <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
        <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="p">],</span>
    <span class="n">center</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">S</span><span class="o">.</span><span class="n">relative_indices</span>  <span class="c1"># [array([-1,  0]), array([0, 1, 2]), array([-3, -2, -1,  0])]</span>
</pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.operator.linop.stencil.stencil.Stencil.visualize">
<span class="sig-name descname"><span class="pre">visualize</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/stencil/stencil.html#Stencil.visualize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.stencil.stencil.Stencil.visualize" title="Link to this definition">#</a></dt>
<dd><p>Show the <span class="math notranslate nohighlight">\(D\)</span>-dimensional stencil kernel.</p>
<p>The stencil’s center is identified by surrounding parentheses.</p>
<p class="rubric">Example</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyxu.operator</span> <span class="kn">import</span> <span class="n">Stencil</span>

<span class="n">S</span> <span class="o">=</span> <span class="n">Stencil</span><span class="p">(</span>
    <span class="n">arg_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
    <span class="n">kernel</span><span class="o">=</span><span class="p">[</span>
        <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="p">],</span>
    <span class="n">center</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">visualize</span><span class="p">())</span>  <span class="c1"># [[6.0 -3.0  9.0  3.0]</span>
                      <span class="c1">#  [4.0 -2.0 (6.0) 2.0]</span>
                      <span class="c1">#  [2.0 -1.0  3.0 1.0]]</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)">str</a></p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyxu.operator.linop.stencil.stencil.Correlate">
<span class="sig-name descname"><span class="pre">Correlate</span></span><a class="headerlink" href="#pyxu.operator.linop.stencil.stencil.Correlate" title="Link to this definition">#</a></dt>
<dd><p>Alias of <a class="reference internal" href="#pyxu.operator.linop.stencil.stencil.Stencil" title="pyxu.operator.linop.stencil.stencil.Stencil"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stencil</span></code></a>.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.operator.linop.stencil.stencil.Convolve">
<span class="sig-name descname"><span class="pre">Convolve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_warnings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/stencil/stencil.html#Convolve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.stencil.stencil.Convolve" title="Link to this definition">#</a></dt>
<dd><p>Multi-dimensional JIT-compiled convolution.</p>
<p>Inputs are convolved with the given kernel.</p>
<p class="rubric">Notes</p>
<p>Given a <span class="math notranslate nohighlight">\(D\)</span>-dimensional array <span class="math notranslate nohighlight">\(x\in\mathbb{R}^{N_1\times\cdots\times N_D}\)</span> and kernel
<span class="math notranslate nohighlight">\(k\in\mathbb{R}^{K_1\times\cdots\times K_D}\)</span> with center <span class="math notranslate nohighlight">\((c_1, \ldots, c_D)\)</span>, the output of the
convolution operator is an array <span class="math notranslate nohighlight">\(y\in\mathbb{R}^{N_1\times\cdots\times N_D}\)</span> given by:</p>
<div class="math notranslate nohighlight">
\[y[i_{1},\ldots,i_{D}]
=
\sum_{q_{1},\ldots,q_{D}=0}^{K_{1},\ldots,K_{D}}
x[i_{1} - q_{1} + c_{1},\ldots,i_{D} - q_{D} + c_{D}]
\,\cdot\,
k[q_{1},\ldots,q_{D}].\]</div>
<p>The convolution is implemented via <a class="reference internal" href="#pyxu.operator.linop.stencil.stencil.Stencil" title="pyxu.operator.linop.stencil.stencil.Stencil"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stencil</span></code></a>.
To do so, the convolution kernel is transformed to the equivalent correlation kernel:</p>
<div class="math notranslate nohighlight">
\[\begin{split}y[i_{1},\ldots,i_{D}]
=
\sum_{q_{1},\ldots,q_{D}=0}^{K_{1},\ldots,K_{D}}
&amp;x[i_{1} + q_{1} - (K_{1} - c_{1}),\ldots,i_{D} + q_{D} - (K_{D} - c_{D})] \\
&amp;\cdot\,
k[K_{1}-q_{1},\ldots,K_{D}-q_{D}].\end{split}\]</div>
<p>This corresponds to a correlation with a flipped kernel and center.</p>
<p class="rubric">Examples</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.ndimage</span> <span class="kn">import</span> <span class="n">convolve</span>
<span class="kn">from</span> <span class="nn">pyxu.operator</span> <span class="kn">import</span> <span class="n">Convolve</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
     <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
     <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
     <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
     <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="p">])</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
     <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
     <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
     <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="p">])</span>
<span class="n">op</span> <span class="o">=</span> <span class="n">Convolve</span><span class="p">(</span>
    <span class="n">arg_shape</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
    <span class="n">kernel</span><span class="o">=</span><span class="n">k</span><span class="p">,</span>
    <span class="n">center</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">mode</span><span class="o">=</span><span class="s2">"constant"</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">y_op</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">y_sp</span> <span class="o">=</span> <span class="n">convolve</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">"constant"</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># np.allclose(y_op, y_sp) -&gt; True</span>
<span class="c1"># [[11  10   7   4],</span>
<span class="c1">#  [10   3  11  11],</span>
<span class="c1">#  [15  12  14   7],</span>
<span class="c1">#  [12   3   7   0]]</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyxu.operator.linop.stencil.stencil.Stencil" title="pyxu.operator.linop.stencil.stencil.Stencil"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stencil</span></code></a></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arg_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.11)"><em>Integral</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.11)"><em>Integral</em></a><em>, </em><em>...</em><em>]</em>) – </p></li>
<li><p><strong>kernel</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><em>NDArray</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.11)"><em>Sequence</em></a><em>[</em><a class="reference internal" href="../info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><em>NDArray</em></a><em>]</em>) – </p></li>
<li><p><strong>center</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.11)"><em>Sequence</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.11)"><em>Integral</em></a><em>]</em>) – </p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.11)"><em>Sequence</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em>]</em>) – </p></li>
<li><p><strong>enable_warnings</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>
</section>
<section id="transforms">
<h2><a class="toc-backref" href="#id44" role="doc-backlink">Transforms</a><a class="headerlink" href="#transforms" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyxu.operator.linop.fft.fft.FFT">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">FFT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">real</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/fft/fft.html#FFT"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.fft.fft.FFT" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="../abc.html#pyxu.abc.operator.LinOp" title="pyxu.abc.operator.LinOp"><code class="xref py py-class docutils literal notranslate"><span class="pre">LinOp</span></code></a></p>
<p>Multi-dimensional Discrete Fourier Transform (DFT) <span class="math notranslate nohighlight">\(A: \mathbb{C}^{N_{1} \times \cdots
\times N_{D}} \to \mathbb{C}^{N_{1} \times \cdots \times N_{D}}\)</span>:</p>
<div class="math notranslate nohighlight">
\[(A \, \mathbf{x})[\mathbf{k}]
=
\sum_{\mathbf{n}} \mathbf{x}[\mathbf{n}]
\exp\left[-j 2 \pi \langle \frac{\mathbf{n}}{\mathbf{N}}, \mathbf{k} \rangle \right],\]</div>
<div class="math notranslate nohighlight">
\[(A^{*} \, \hat{\mathbf{x}})[\mathbf{n}]
=
\sum_{\mathbf{k}} \hat{\mathbf{x}}[\mathbf{k}]
\exp\left[j 2 \pi \langle \frac{\mathbf{n}}{\mathbf{N}}, \mathbf{k} \rangle \right],\]</div>
<div class="math notranslate nohighlight">
\[(\mathbf{x}, \, \hat{\mathbf{x}}) \in \mathbb{C}^{N_{1} \times \cdots \times N_{D}},
\quad
(\mathbf{n}, \, \mathbf{k}) \in \{0, \ldots, N_{1}-1\} \times \cdots \times \{0, \ldots, N_{D}-1\}.\]</div>
<p>The DFT is taken over any number of axes by means of the Fast Fourier Transform algorithm (FFT).</p>
<p class="rubric">Implementation Notes</p>
<ul class="simple">
<li><p>The CPU implementation uses <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/fft.html">SciPy’s FFT implementation</a>.</p></li>
<li><p>The GPU implementation uses cuFFT via <a class="reference external" href="https://docs.cupy.dev/en/latest/reference/scipy_fft.html">CuPy</a>.</p></li>
</ul>
<p class="rubric">Examples</p>
<ul>
<li><p>1D DFT of a cosine pulse.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyxu.operator.linop</span> <span class="kn">import</span> <span class="n">FFT</span>
<span class="kn">import</span> <span class="nn">pyxu.util</span> <span class="k">as</span> <span class="nn">pxu</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">op</span> <span class="o">=</span> <span class="n">FFT</span><span class="p">(</span>
    <span class="n">arg_shape</span><span class="o">=</span><span class="p">(</span><span class="n">N</span><span class="p">,),</span>
    <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">N</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">pxu</span><span class="o">.</span><span class="n">view_as_complex</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="c1"># [0, N/2, 0, 0, 0, 0, 0, 0, 0, N/2]</span>

<span class="n">z</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">adjoint</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="c1"># np.allclose(z, N * x) -&gt; True</span>
</pre></div>
</div>
</li>
<li><p>1D DFT of a complex exponential pulse.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyxu.operator.linop</span> <span class="kn">import</span> <span class="n">FFT</span>
<span class="kn">import</span> <span class="nn">pyxu.util</span> <span class="k">as</span> <span class="nn">pxu</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">op</span> <span class="o">=</span> <span class="n">FFT</span><span class="p">(</span>
    <span class="n">arg_shape</span><span class="o">=</span><span class="p">(</span><span class="n">N</span><span class="p">,),</span>
    <span class="n">real</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># complex-valued inputs</span>
<span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">N</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">pxu</span><span class="o">.</span><span class="n">view_as_complex</span><span class="p">(</span>
        <span class="n">op</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
            <span class="n">pxu</span><span class="o">.</span><span class="n">view_as_real</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="c1"># [0, N, 0, 0, 0, 0, 0, 0, 0, 0]</span>

<span class="n">z</span> <span class="o">=</span> <span class="n">pxu</span><span class="o">.</span><span class="n">view_as_complex</span><span class="p">(</span>
        <span class="n">op</span><span class="o">.</span><span class="n">adjoint</span><span class="p">(</span>
            <span class="n">op</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                <span class="n">pxu</span><span class="o">.</span><span class="n">view_as_real</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="c1"># np.allclose(z, N * x) -&gt; True</span>
</pre></div>
</div>
</li>
<li><p>2D DFT of an image</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyxu.operator.linop</span> <span class="kn">import</span> <span class="n">FFT</span>
<span class="kn">import</span> <span class="nn">pyxu.util</span> <span class="k">as</span> <span class="nn">pxu</span>

<span class="n">N_h</span><span class="p">,</span> <span class="n">N_w</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">8</span>
<span class="n">op</span> <span class="o">=</span> <span class="n">FFT</span><span class="p">(</span>
    <span class="n">arg_shape</span><span class="o">=</span><span class="p">(</span><span class="n">N_h</span><span class="p">,</span> <span class="n">N_w</span><span class="p">),</span>
    <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span>  <span class="c1"># an image</span>
    <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">N_h</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span> <span class="n">N_w</span><span class="o">//</span><span class="mi">2</span><span class="p">)),</span>
    <span class="n">pad_width</span><span class="o">=</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="n">N_h</span><span class="o">//</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">N_w</span><span class="o">//</span><span class="mi">2</span><span class="p">)),</span>
<span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">pxu</span><span class="o">.</span><span class="n">view_as_complex</span><span class="p">(</span>  <span class="c1"># sinc</span>
        <span class="n">op</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">N_h</span><span class="p">,</span> <span class="n">N_w</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">adjoint</span><span class="p">(</span>
        <span class="n">op</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">N_h</span><span class="p">,</span> <span class="n">N_w</span><span class="p">)</span>
<span class="c1"># np.allclose(z, (N_h * N_w) * x) -&gt; True</span>
</pre></div>
</div>
</li>
<li><p>1D DFT of an image’s rows</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyxu.operator.linop</span> <span class="kn">import</span> <span class="n">FFT</span>
<span class="kn">import</span> <span class="nn">pyxu.util</span> <span class="k">as</span> <span class="nn">pxu</span>

<span class="n">N_h</span><span class="p">,</span> <span class="n">N_w</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">8</span>
<span class="n">op</span> <span class="o">=</span> <span class="n">FFT</span><span class="p">(</span>
    <span class="n">arg_shape</span><span class="o">=</span><span class="p">(</span><span class="n">N_h</span><span class="p">,</span> <span class="n">N_w</span><span class="p">),</span>
    <span class="n">axes</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span>  <span class="c1"># an image</span>
    <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">N_h</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span> <span class="n">N_w</span><span class="o">//</span><span class="mi">2</span><span class="p">)),</span>
    <span class="n">pad_width</span><span class="o">=</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="n">N_h</span><span class="o">//</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">N_w</span><span class="o">//</span><span class="mi">2</span><span class="p">)),</span>
<span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">pxu</span><span class="o">.</span><span class="n">view_as_complex</span><span class="p">(</span>  <span class="c1"># sinc</span>
        <span class="n">op</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">N_h</span><span class="p">,</span> <span class="n">N_w</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">adjoint</span><span class="p">(</span>
        <span class="n">op</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">N_h</span><span class="p">,</span> <span class="n">N_w</span><span class="p">)</span>
<span class="c1"># np.allclose(z, N_w * x) -&gt; True</span>
</pre></div>
</div>
</li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arg_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.11)"><em>Integral</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.11)"><em>Integral</em></a><em>, </em><em>...</em><em>]</em>) – </p></li>
<li><p><strong>axes</strong> (<a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.11)"><em>Integral</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.11)"><em>Integral</em></a><em>, </em><em>...</em><em>]</em>) – </p></li>
<li><p><strong>real</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.operator.linop.fft.fft.FFT.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">real</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/fft/fft.html#FFT.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.fft.fft.FFT.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arg_shape</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.NDArrayShape" title="pyxu.info.ptype.NDArrayShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayShape</span></code></a>) – (N_1, …, N_D) shape of the input array <span class="math notranslate nohighlight">\(\mathbf{x} \in \mathbb{R}^{N_{1} \times \cdots \times
N_{D}}\)</span> or <span class="math notranslate nohighlight">\(\mathbb{C}^{N_{1} \times \cdots \times N_{D}}\)</span>.</p></li>
<li><p><strong>axes</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.NDArrayAxis" title="pyxu.info.ptype.NDArrayAxis"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayAxis</span></code></a>) – Axis or axes along which the DFT is performed.
The default, axes=None, will transform all dimensions of the input array.</p></li>
<li><p><strong>real</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – <p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, assumes <a class="reference internal" href="#pyxu.operator.linop.fft.fft.FFT.apply" title="pyxu.operator.linop.fft.fft.FFT.apply"><code class="xref py py-func docutils literal notranslate"><span class="pre">apply()</span></code></a> takes (…, N.prod()) inputs in
<span class="math notranslate nohighlight">\(\mathbb{R}^{N}\)</span>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">False</span></code>, then <a class="reference internal" href="#pyxu.operator.linop.fft.fft.FFT.apply" title="pyxu.operator.linop.fft.fft.FFT.apply"><code class="xref py py-func docutils literal notranslate"><span class="pre">apply()</span></code></a> takes (…, 2N.prod()) inputs, i.e.
<span class="math notranslate nohighlight">\(\mathbb{C}^{N}\)</span> vectors viewed as bijections with <span class="math notranslate nohighlight">\(\mathbb{R}^{2N}\)</span>.</p>
</p></li>
<li><p><strong>kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>) – <p>Extra kwargs passed to <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.fft.fftn.html#scipy.fft.fftn" title="(in SciPy v1.11.2)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.fft.fftn()</span></code></a> or <a class="reference external" href="https://docs.cupy.dev/en/latest/reference/generated/cupyx.scipy.fft.fftn.html#cupyx.scipy.fft.fftn" title="(in CuPy v13.0.0b1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">cupyx.scipy.fft.fftn()</span></code></a>.</p>
<p>Supported parameters for <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.fft.fftn.html#scipy.fft.fftn" title="(in SciPy v1.11.2)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.fft.fftn()</span></code></a> are:</p>
<blockquote>
<div><ul>
<li><p>workers: int = 1</p></li>
</ul>
</div></blockquote>
<p>Supported parameters for <a class="reference external" href="https://docs.cupy.dev/en/latest/reference/generated/cupyx.scipy.fft.fftn.html#cupyx.scipy.fft.fftn" title="(in CuPy v13.0.0b1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">cupyx.scipy.fft.fftn()</span></code></a> are:</p>
<blockquote>
<div><ul>
<li><p>NOT SUPPORTED FOR NOW</p></li>
</ul>
</div></blockquote>
<p>Default values are chosen if unspecified.</p>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.operator.linop.fft.fft.FFT.apply">
<span class="sig-name descname"><span class="pre">apply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/fft/fft.html#FFT.apply"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.fft.fft.FFT.apply" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>arr</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArray</span></code></a>) – <ul class="simple">
<li><p>(…,  N.prod()) inputs <span class="math notranslate nohighlight">\(\mathbf{x} \in \mathbb{R}^{N_{1} \times \cdots \times N_{D}}\)</span>
(<code class="docutils literal notranslate"><span class="pre">real=True</span></code>.)</p></li>
<li><p>(…, 2N.prod()) inputs <span class="math notranslate nohighlight">\(\mathbf{x} \in \mathbb{C}^{N_{1} \times \cdots \times N_{D}}\)</span> viewed as a
real array. (See <a class="reference internal" href="../util.html#pyxu.util.complex.view_as_real" title="pyxu.util.complex.view_as_real"><code class="xref py py-func docutils literal notranslate"><span class="pre">view_as_real()</span></code></a>.)</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>out</strong> – (…, 2N.prod()) outputs <span class="math notranslate nohighlight">\(\hat{\mathbf{x}} \in \mathbb{C}^{N_{1} \times \cdots \times N_{D}}\)</span> viewed
as a real array. (See <a class="reference internal" href="../util.html#pyxu.util.complex.view_as_real" title="pyxu.util.complex.view_as_real"><code class="xref py py-func docutils literal notranslate"><span class="pre">view_as_real()</span></code></a>.)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArray</span></code></a></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.operator.linop.fft.fft.FFT.adjoint">
<span class="sig-name descname"><span class="pre">adjoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/fft/fft.html#FFT.adjoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.fft.fft.FFT.adjoint" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>arr</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArray</span></code></a>) – (…, 2N.prod()) outputs <span class="math notranslate nohighlight">\(\hat{\mathbf{x}} \in \mathbb{C}^{N_{1} \times \cdots \times N_{D}}\)</span> viewed
as a real array. (See <a class="reference internal" href="../util.html#pyxu.util.complex.view_as_real" title="pyxu.util.complex.view_as_real"><code class="xref py py-func docutils literal notranslate"><span class="pre">view_as_real()</span></code></a>.)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><strong>out</strong> –</p>
<ul class="simple">
<li><p>(…,  N.prod()) inputs <span class="math notranslate nohighlight">\(\mathbf{x} \in \mathbb{R}^{N_{1} \times \cdots \times N_{D}}\)</span>
(<code class="docutils literal notranslate"><span class="pre">real=True</span></code>.)</p></li>
<li><p>(…, 2N.prod()) inputs <span class="math notranslate nohighlight">\(\mathbf{x} \in \mathbb{C}^{N_{1} \times \cdots \times N_{D}}\)</span> viewed as a
real array. (See <a class="reference internal" href="../util.html#pyxu.util.complex.view_as_real" title="pyxu.util.complex.view_as_real"><code class="xref py py-func docutils literal notranslate"><span class="pre">view_as_real()</span></code></a>.)</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArray</span></code></a></p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyxu.operator.linop.fft.nufft.NUFFT">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">NUFFT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/fft/nufft.html#NUFFT"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.fft.nufft.NUFFT" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="../abc.html#pyxu.abc.operator.LinOp" title="pyxu.abc.operator.LinOp"><code class="xref py py-class docutils literal notranslate"><span class="pre">LinOp</span></code></a></p>
<p>Non-Uniform Fast Fourier Transform (NUFFT) of Type 1/2/3 (for <span class="math notranslate nohighlight">\(d=\{1,2,3\}\)</span>).</p>
<p>The <em>Non-Uniform Fast Fourier Transform (NUFFT)</em> generalizes the FFT to off-grid data.
There are three types of NUFFTs proposed in the literature:</p>
<ul class="simple">
<li><p>Type 1 (<em>non-uniform to uniform</em>),</p></li>
<li><p>Type 2 (<em>uniform to non-uniform</em>),</p></li>
<li><p>Type 3 (<em>non-uniform to non-uniform</em>).</p></li>
</ul>
<p>See the notes below, including <a class="reference internal" href="../../references.html#finufft" id="id1"><span>[FINUFFT]</span></a>, for definitions of the various transforms and algorithmic details.</p>
<p>The transforms should be instantiated via
<a class="reference internal" href="#pyxu.operator.linop.fft.nufft.NUFFT.type1" title="pyxu.operator.linop.fft.nufft.NUFFT.type1"><code class="xref py py-meth docutils literal notranslate"><span class="pre">type1()</span></code></a>,
<a class="reference internal" href="#pyxu.operator.linop.fft.nufft.NUFFT.type2" title="pyxu.operator.linop.fft.nufft.NUFFT.type2"><code class="xref py py-meth docutils literal notranslate"><span class="pre">type2()</span></code></a>, and
<a class="reference internal" href="#pyxu.operator.linop.fft.nufft.NUFFT.type3" title="pyxu.operator.linop.fft.nufft.NUFFT.type3"><code class="xref py py-meth docutils literal notranslate"><span class="pre">type3()</span></code></a> respectively.
(See each method for usage examples.)</p>
<p>The dimension of each transform is inferred from the dimensions of the input arguments, with support for
<span class="math notranslate nohighlight">\(d=\{1,2,3\}\)</span>.</p>
<p class="rubric">Notes</p>
<p>We adopt here the same notational conventions as in <a class="reference internal" href="../../references.html#finufft" id="id2"><span>[FINUFFT]</span></a>.</p>
<ul>
<li><p><strong>Mathematical Definition.</strong>
Let <span class="math notranslate nohighlight">\(d\in\{1,2,3\}\)</span> and consider the mesh</p>
<div class="math notranslate nohighlight">
\[\mathcal{I}_{N_1,\ldots,N_d}
=
\mathcal{I}_{N_1} \times \cdots \times \mathcal{I}_{N_d}
\subset \mathbb{Z}^d,\]</div>
<p>where the mesh indices <span class="math notranslate nohighlight">\(\mathcal{I}_{N_i}\subset\mathbb{Z}\)</span> are given for each dimension <span class="math notranslate nohighlight">\(i=1,\dots, d\)</span>
by:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathcal{I}_{N_i}
=
\begin{cases}
    [[-N_i/2, N_i/2-1]], &amp; N_i\in 2\mathbb{N} \text{ (even)}, \\
    [[-(N_i-1)/2, (N_i-1)/2]], &amp; N_i\in 2\mathbb{N}+1 \text{ (odd)}.
\end{cases}\end{split}\]</div>
<p>Then the NUFFT operators approximate, up to a requested relative accuracy <span class="math notranslate nohighlight">\(\varepsilon \geq 0\)</span>, <a class="footnote-reference brackets" href="#id9" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> the
following exponential sums:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
    (1)\; &amp;u_{\mathbf{n}} = \sum_{j=1}^{M} w_{j} e^{\sigma i\langle \mathbf{n}, \mathbf{x}_{j} \rangle}, \quad &amp;\mathbf{n}\in \mathcal{I}_{N_1,\ldots, N_d},\qquad &amp;\text{Type 1 (non-uniform to uniform)}\\
    (2)\; &amp;w_{j} = \sum_{\mathbf{n}\in\mathcal{I}_{N_1,\ldots, N_d}} u_{\mathbf{n}} e^{\sigma i\langle \mathbf{n}, \mathbf{x}_{j} \rangle }, \quad &amp;j=1,\ldots, M,\qquad  &amp;\text{Type 2 (uniform to non-uniform)}\\
    (3)\; &amp;v_{k} = \sum_{j=1}^{M} w_{j} e^{\sigma i\langle \mathbf{z}_k, \mathbf{x}_{j} \rangle }, \quad &amp;k=1,\ldots, N, \qquad &amp;\text{Type 3 (non-uniform to non-uniform)}
\end{align}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\sigma \in \{+1, -1\}\)</span> defines the sign of the transform and <span class="math notranslate nohighlight">\(u_{\mathbf{n}}, v_{k}, w_{j}\in
\mathbb{C}\)</span>.
For the type-1 and type-2 NUFFTs, the non-uniform samples <span class="math notranslate nohighlight">\(\mathbf{x}_{j}\)</span> are assumed to lie in
<span class="math notranslate nohighlight">\([-\pi,\pi)^{d}\)</span>.
For the type-3 NUFFT, the non-uniform samples <span class="math notranslate nohighlight">\(\mathbf{x}_{j}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{z}_{k}\)</span> are arbitrary points
in <span class="math notranslate nohighlight">\(\mathbb{R}^{d}\)</span>.</p>
</li>
<li><p><strong>Adjoint NUFFTs.</strong>
The type-1 and type-2 NUFFTs with opposite signs form an <em>adjoint pair</em>.
The adjoint of the type-3 NUFFT is obtained by flipping the transform’s sign and switching the roles of
<span class="math notranslate nohighlight">\(\mathbf{z}_k\)</span> and <span class="math notranslate nohighlight">\(\mathbf{x}_{j}\)</span> in (3).</p></li>
<li><p><strong>Lipschitz Constants.</strong>
We bound the Lipschitz constant by the Frobenius norm of the operators, which yields <span class="math notranslate nohighlight">\(L \leq \sqrt{NM}\)</span>.
Note that these Lipschitz constants are cheap to compute but may be pessimistic.
Tighter Lipschitz constants can be computed by calling <a class="reference internal" href="../abc.html#pyxu.abc.operator.Map.estimate_lipschitz" title="pyxu.abc.operator.Map.estimate_lipschitz"><code class="xref py py-meth docutils literal notranslate"><span class="pre">estimate_lipschitz()</span></code></a>.</p></li>
<li><p><strong>Error Analysis.</strong>
Let <span class="math notranslate nohighlight">\(\tilde{\mathbf{u}}\in\mathbb{C}^{\mathcal{I}_{N_1,\ldots, N_d}}\)</span> and
<span class="math notranslate nohighlight">\(\tilde{\mathbf{w}}\in\mathbb{C}^{M}\)</span> be the outputs of the type-1 and type-2 NUFFT algorithms which
approximate the sequences <span class="math notranslate nohighlight">\({\mathbf{u}}\in\mathbb{C}^{\mathcal{I}_{N_1,\ldots, N_d}}\)</span> and
<span class="math notranslate nohighlight">\({\mathbf{w}}\in\mathbb{C}^{M}\)</span> defined in (1) and (2) respectively.
Then <a class="reference internal" href="../../references.html#finufft" id="id4"><span>[FINUFFT]</span></a> shows that the relative errors <span class="math notranslate nohighlight">\(\|\tilde{\mathbf{u}}-{\mathbf{u}}\|_2/\|{\mathbf{u}}\|_2\)</span> and
<span class="math notranslate nohighlight">\(\|\tilde{\mathbf{w}}-{\mathbf{w}}\|_2/\|{\mathbf{w}}\|_2\)</span> are <em>almost always similar to the user-requested
tolerance</em> <span class="math notranslate nohighlight">\(\varepsilon\)</span>, except when round-off error dominates (i.e. very small user-requested tolerances).
The same holds approximately for the type-3 NUFFT.
Note however that this is a <em>typical error analysis</em>: some degenerate (but rare) worst-case scenarios can result in
higher errors.</p></li>
<li><p><strong>Complexity.</strong>
Naive evaluation of the exponential sums (1), (2) and (3) above costs <span class="math notranslate nohighlight">\(O(NM)\)</span>, where <span class="math notranslate nohighlight">\(N=N_{1}\ldots
N_{d}\)</span> for the type-1 and type-2 NUFFTs.
NUFFT algorithms approximate these sums to a user-specified relative tolerance <span class="math notranslate nohighlight">\(\varepsilon\)</span> in log-linear
complexity in <span class="math notranslate nohighlight">\(N\)</span> and <span class="math notranslate nohighlight">\(M\)</span>.
The complexity of the various NUFFTs are given by (see <a class="reference internal" href="../../references.html#finufft" id="id5"><span>[FINUFFT]</span></a>):</p>
<div class="math notranslate nohighlight">
\[\begin{split}&amp;\mathcal{O}\left(N \log(N) + M|\log(\varepsilon)|^d\right)\qquad &amp;\text{(Type 1 and 2)}\\
&amp;\mathcal{O}\left(\Pi_{i=1}^dX_iZ_i\sum_{i=1}^d\log(X_iZ_i) + (M + N)|\log(\varepsilon)|^d\right)\qquad &amp;\text{(Type 3)}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(X_i = \max_{j=1,\ldots,M}|(\mathbf{x}_{j})_i|\)</span> and <span class="math notranslate nohighlight">\(Z_i = \max_{k=1,\ldots,N}|(\mathbf{z}_k)_i|\)</span>
for <span class="math notranslate nohighlight">\(i=1,\ldots,d\)</span>.
The terms above correspond to the complexities of the FFT and spreading/interpolation steps respectively.</p>
</li>
<li><p><strong>Memory footprint.</strong>
The complexity and memory footprint of the type-3 NUFFT can be arbitrarily large for poorly-centered data, or for
data with a large spread.
An easy fix consists in centering the data before/after the NUFFT via pre/post-phasing operations, as described in
equation (3.24) of <a class="reference internal" href="../../references.html#finufft" id="id6"><span>[FINUFFT]</span></a>.
This optimization is automatically carried out by FINUFFT if the compute/memory gains are non-negligible.</p>
<p>Additionally the type-3 summation (eq. 3) can be evaluated block-wise by partitioning the non-uniform samples
<span class="math notranslate nohighlight">\((x_{j}, z_{k})\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{align}
    (4)\;\; &amp;v_{k}
    =
    \sum_{p=1}^{P}
    \sum_{j\in \mathcal{M}_{p}} w_{j}
    e^{\sigma i\langle \mathbf{z}_{k}, \mathbf{x}_{j} \rangle },
    \quad &amp;
    k\in \mathcal{N}_{q}, \quad q=1,\ldots, Q, \quad &amp; \text{Type 3 (chunked)}
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\{\mathcal{M}_1, \ldots, \mathcal{M}_P\}\)</span> and <span class="math notranslate nohighlight">\(\{\mathcal{N}_1, \ldots, \mathcal{N}_Q\}\)</span> are
<em>partitions</em> of the sets <span class="math notranslate nohighlight">\(\{1, \ldots, M\}\)</span> and  <span class="math notranslate nohighlight">\(\{1, \ldots, N\}\)</span> respectively.
In the chunked setting, the partial sums in (4)</p>
<div class="math notranslate nohighlight">
\[\left\{\sum_{j\in \mathcal{M}_p} w_{j} e^{\sigma i\langle \mathbf{z}_k, \mathbf{x}_{j} \rangle }, \, k\in \mathcal{N}_q\right\}_{p,q}\]</div>
<p>are each evaluated via a type-3 NUFFT involving a subset of the non-uniform samples.
Sub-problems can be evaluated in parallel.
Moreover, for wisely chosen data partitions, the memory budget of each NUFFT can be explicitly controlled and capped
to a maximal value.
This allows one to perform out-of-core NUFFTs with (theoretically) no complexity overhead w.r.t a single large
NUFFT. (See note below however.)</p>
<p>Chunking of the type-3 NUFFT is activated by passing <code class="docutils literal notranslate"><span class="pre">chunked=True</span></code> to
<a class="reference internal" href="#pyxu.operator.linop.fft.nufft.NUFFT.type3" title="pyxu.operator.linop.fft.nufft.NUFFT.type3"><code class="xref py py-meth docutils literal notranslate"><span class="pre">type3()</span></code></a> (together with <code class="docutils literal notranslate"><span class="pre">parallel=True</span></code> for parallel computations).
Finally, <a class="reference internal" href="#pyxu.operator.linop.fft.nufft.NUFFT.auto_chunk" title="pyxu.operator.linop.fft.nufft.NUFFT.auto_chunk"><code class="xref py py-meth docutils literal notranslate"><span class="pre">auto_chunk()</span></code></a> can be used to compute a good partition of the
X/Z-domains.</p>
<div class="admonition-hint admonition">
<p class="admonition-title">Hint</p>
<p>The current implementation of the chunked type-3 NUFFT has computational complexity:</p>
<div class="math notranslate nohighlight">
\[\mathcal{O}\left(
    \sum_{p,q=1}^{P}\Pi_{i=1}^{d} X^{(p)}_{i}Z^{(q)}_{i}
    \sum_{i=1}^{d} \log(X^{(p)}_{i} Z^{(q)}_{i})
    +
    (M_p + N_q)|\log(\varepsilon)|^{d}
\right),\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
    X^{(p)}_{i} &amp; = \max_{j\in \mathcal{M}_{p}}|(\mathbf{x}_{j})_{i}|, \quad i = \{1,\ldots,d\} \\
    Z^{(p)}_{i} &amp; = \max_{k\in \mathcal{N}_{q}}|(\mathbf{z}_k)_{i}|, \quad i = \{1,\ldots,d\}
\end{align*}\end{split}\]</div>
<p>and <span class="math notranslate nohighlight">\(M_{p}, N_{q}\)</span> denote the number of elements in the sets <span class="math notranslate nohighlight">\(\mathcal{M}_{p},
\mathcal{N}_{q}\)</span>, respectively.</p>
<p>For perfectly balanced and uniform chunks (i.e. <span class="math notranslate nohighlight">\(M_{p}=M/P\)</span>, <span class="math notranslate nohighlight">\(N_{q}=N/Q\)</span>, <span class="math notranslate nohighlight">\(X^{(p)}_{i} =
X_{i}/P\)</span>, <span class="math notranslate nohighlight">\(Z^{(q)}_{i} = Z_{i}/Q\)</span> and <span class="math notranslate nohighlight">\(P=Q\)</span>) the complexity reduces to</p>
<div class="math notranslate nohighlight">
\[\mathcal{O}\left(
    \Pi_{i=1}^{d} X_{i}Z_{i}\sum_{i=1}^{d}\log(X_{i}Z_{i})
    +
    P(M + N)|\log(\varepsilon)|^{d}
\right).\]</div>
<p>This shows that the spreading/interpolation is <span class="math notranslate nohighlight">\(P\)</span> times more expensive than in the non-chunked case.
This overhead is usually acceptable if the number of chunks remains small.
With explicit control on the spreading/interpolation steps (which the Python interface to the FINUFFT backend
does not currently offer), the spreading/interpolation overhead can be removed so as to obtain a computational
complexity on par to that of the non-chunked type-3 NUFFT.
This will be implemented in a future release.</p>
</div>
</li>
<li><p><strong>Backend.</strong>
The NUFFT transforms are computed via Python wrappers to <a class="reference external" href="https://github.com/flatironinstitute/finufft">FINUFFT</a>
and <a class="reference external" href="https://github.com/flatironinstitute/cufinufft">cuFINUFFT</a>.  (See also <a class="reference internal" href="../../references.html#finufft" id="id7"><span>[FINUFFT]</span></a> and <a class="reference internal" href="../../references.html#cufinufft" id="id8"><span>[cuFINUFFT]</span></a>.)
These librairies perform the expensive spreading/interpolation between nonuniform points and the fine grid via the
“exponential of semicircle” kernel.</p></li>
<li><p><strong>Optional Parameters.</strong>
[cu]FINUFFT exposes many optional parameters to adjust the performance of the algorithms, change the output format,
or provide debug/timing information.
While the default options are sensible for most setups, advanced users may overwrite them via the <code class="docutils literal notranslate"><span class="pre">kwargs</span></code>
parameter of
<a class="reference internal" href="#pyxu.operator.linop.fft.nufft.NUFFT.type1" title="pyxu.operator.linop.fft.nufft.NUFFT.type1"><code class="xref py py-meth docutils literal notranslate"><span class="pre">type1()</span></code></a>,
<a class="reference internal" href="#pyxu.operator.linop.fft.nufft.NUFFT.type2" title="pyxu.operator.linop.fft.nufft.NUFFT.type2"><code class="xref py py-meth docutils literal notranslate"><span class="pre">type2()</span></code></a>, and
<a class="reference internal" href="#pyxu.operator.linop.fft.nufft.NUFFT.type3" title="pyxu.operator.linop.fft.nufft.NUFFT.type3"><code class="xref py py-meth docutils literal notranslate"><span class="pre">type3()</span></code></a>.
See the <a class="reference external" href="https://finufft.readthedocs.io/en/latest/python.html#finufft.Plan">guru interface</a> from FINUFFT and its
<a class="reference external" href="https://finufft.readthedocs.io/en/latest/opts.html#options-parameters">companion page</a> for details.</p>
<div class="admonition-hint admonition">
<p class="admonition-title">Hint</p>
<p>FINUFFT exposes a <code class="docutils literal notranslate"><span class="pre">dtype</span></code> keyword to control the precision (single or double) at which transforms are
performed.
This parameter is ignored by <a class="reference internal" href="#pyxu.operator.linop.fft.nufft.NUFFT" title="pyxu.operator.linop.fft.nufft.NUFFT"><code class="xref py py-class docutils literal notranslate"><span class="pre">NUFFT</span></code></a>: use the context manager
<a class="reference internal" href="../runtime.html#pyxu.runtime.Precision" title="pyxu.runtime.Precision"><code class="xref py py-class docutils literal notranslate"><span class="pre">Precision</span></code></a> to control floating point precision.</p>
</div>
<div class="admonition-hint admonition">
<p class="admonition-title">Hint</p>
<p>The NUFFT is performed in <strong>batches of (n_trans,)</strong>, where <code class="code docutils literal notranslate"><span class="pre">n_trans</span></code> denotes the number of simultaneous
transforms requested.
(See the <code class="docutils literal notranslate"><span class="pre">n_trans</span></code> parameter of <a class="reference external" href="https://finufft.readthedocs.io/en/latest/python.html#finufft.Plan">finufft.Plan</a>.)</p>
<p>Good performance is obtained when each batch fits easily in memory. This recommendation also applies to Dask
inputs which are re-chunked internally to be <code class="code docutils literal notranslate"><span class="pre">n_trans</span></code>-compliant.</p>
<p>This parameter also affects performance of the <code class="docutils literal notranslate"><span class="pre">eps=0</span></code> case: increasing <code class="docutils literal notranslate"><span class="pre">n_trans</span></code> may improve performance
when doing several transforms in parallel.</p>
</div>
</li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Since FINUFFT plans cannot be shared among different processes, this class is <strong>only compatible</strong> with Dask’s
thread-based schedulers, i.e.:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">scheduler='thread'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scheduler='synchronous'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">distributed.Client(processes=False)</span></code></p></li>
</ul>
<p>Batches are hence processed serially.
(Each batch is multi-threaded however.)</p>
</div>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id9" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a href="#id3" role="doc-backlink">1</a><span class="fn-bracket">]</span></span>
<p><span class="math notranslate nohighlight">\(\varepsilon= 0\)</span> means that no approximation is performed: the exponential sums
are naively computed by direct evaluation.</p>
</aside>
</aside>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyxu.operator.linop.fft.fft.FFT" title="pyxu.operator.linop.fft.fft.FFT"><code class="xref py py-class docutils literal notranslate"><span class="pre">FFT</span></code></a></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.11)"><em>Integral</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.11)"><em>Integral</em></a><em>]</em>) – </p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.operator.linop.fft.nufft.NUFFT.type1">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">type1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">isign</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">real</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plan_fw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plan_bw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_warnings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/fft/nufft.html#NUFFT.type1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.fft.nufft.NUFFT.type1" title="Link to this definition">#</a></dt>
<dd><p>Type-1 NUFFT (non-uniform to uniform).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArray</span></code></a>) – (M, [d]) d-dimensional sample points <span class="math notranslate nohighlight">\(\mathbf{x}_{j} \in [-\pi,\pi)^{d}\)</span>.</p></li>
<li><p><strong>N</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.Integer" title="pyxu.info.ptype.Integer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Integer</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a> ( Integer )) – <p>([d],) mesh size in each dimension <span class="math notranslate nohighlight">\((N_1, \ldots, N_d)\)</span>.</p>
<p>If <code class="code docutils literal notranslate"><span class="pre">N</span></code> is an integer, then the mesh is assumed to have the same size in each dimension.</p>
</p></li>
<li><p><strong>isign</strong> (<code class="docutils literal notranslate"><span class="pre">1</span></code>, <code class="docutils literal notranslate"><span class="pre">-1</span></code>) – Sign <span class="math notranslate nohighlight">\(\sigma\)</span> of the transform.</p></li>
<li><p><strong>eps</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-class docutils literal notranslate"><span class="pre">Real</span></code></a>) – <p>Requested relative accuracy <span class="math notranslate nohighlight">\(\varepsilon \geq 0\)</span>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">eps=0</span></code>, the transform is computed exactly via direct evaluation of the exponential sum using a Numba
JIT-compiled kernel.</p>
</p></li>
<li><p><strong>real</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – <p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, assumes <a class="reference internal" href="#pyxu.operator.linop.fft.nufft.NUFFT.apply" title="pyxu.operator.linop.fft.nufft.NUFFT.apply"><code class="xref py py-func docutils literal notranslate"><span class="pre">apply()</span></code></a> takes (…, M) inputs in
<span class="math notranslate nohighlight">\(\mathbb{R}^{M}\)</span>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">False</span></code>, then <a class="reference internal" href="#pyxu.operator.linop.fft.nufft.NUFFT.apply" title="pyxu.operator.linop.fft.nufft.NUFFT.apply"><code class="xref py py-func docutils literal notranslate"><span class="pre">apply()</span></code></a> takes (…, 2M) inputs, i.e.
<span class="math notranslate nohighlight">\(\mathbb{C}^{M}\)</span> vectors viewed as bijections with <span class="math notranslate nohighlight">\(\mathbb{R}^{2M}\)</span>.</p>
</p></li>
<li><p><strong>plan_fw/bw</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, allocate FINUFFT resources to do the forward (fw) and/or backward (bw) transform.
These are advanced options: use them with care.
Some public methods in the <a class="reference internal" href="../abc.html#pyxu.abc.operator.LinOp" title="pyxu.abc.operator.LinOp"><code class="xref py py-class docutils literal notranslate"><span class="pre">LinOp</span></code></a> interface may not work if fw/bw transforms
are disabled.
These options only take effect if <code class="docutils literal notranslate"><span class="pre">eps</span> <span class="pre">&gt;</span> <span class="pre">0</span></code>.</p></li>
<li><p><strong>enable_warnings</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, emit a warning in case of precision mis-match issues.</p></li>
<li><p><strong>**kwargs</strong> – <p>Extra kwargs to <a class="reference external" href="https://finufft.readthedocs.io/en/latest/python.html#finufft.Plan">finufft.Plan</a>.
(Illegal keywords are dropped silently.) Most useful are <code class="docutils literal notranslate"><span class="pre">n_trans</span></code>, <code class="docutils literal notranslate"><span class="pre">nthreads</span></code> and <code class="docutils literal notranslate"><span class="pre">debug</span></code>.</p>
</p></li>
<li><p><strong>plan_fw</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – </p></li>
<li><p><strong>plan_bw</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>op</strong> – (2N.prod(), M) or (2N.prod(), 2M) type-1 NUFFT.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pyxu.operator</span> <span class="k">as</span> <span class="nn">pxo</span>
<span class="kn">import</span> <span class="nn">pyxu.runtime</span> <span class="k">as</span> <span class="nn">pxrt</span>
<span class="kn">import</span> <span class="nn">pyxu.util</span> <span class="k">as</span> <span class="nn">pxu</span>

<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">D</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">5</span>  <span class="c1"># D denotes the dimension of the data</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fmod</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">D</span><span class="p">)),</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>

<span class="k">with</span> <span class="n">pxrt</span><span class="o">.</span><span class="n">Precision</span><span class="p">(</span><span class="n">pxrt</span><span class="o">.</span><span class="n">Width</span><span class="o">.</span><span class="n">SINGLE</span><span class="p">):</span>
    <span class="c1"># The NUFFT dimension (1/2/3) is inferred from the trailing dimension of x.</span>
    <span class="c1"># Its precision is controlled by the context manager.</span>
    <span class="n">N_trans</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">pxo</span><span class="o">.</span><span class="n">NUFFT</span><span class="o">.</span><span class="n">type1</span><span class="p">(</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span>
            <span class="n">n_trans</span><span class="o">=</span><span class="n">N_trans</span><span class="p">,</span>
            <span class="n">isign</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">eps</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1"># Pyxu operators only support real inputs/outputs, so we use the functions</span>
    <span class="c1"># pxu.view_as_[complex/real] to interpret complex arrays as real arrays (and</span>
    <span class="c1"># vice-versa).</span>
    <span class="n">arr</span> <span class="o">=</span>        <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">N_trans</span><span class="p">,</span> <span class="n">M</span><span class="p">))</span> \
          <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">N_trans</span><span class="p">,</span> <span class="n">M</span><span class="p">))</span>
    <span class="n">A_out_fw</span> <span class="o">=</span> <span class="n">pxu</span><span class="o">.</span><span class="n">view_as_complex</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pxu</span><span class="o">.</span><span class="n">view_as_real</span><span class="p">(</span><span class="n">arr</span><span class="p">)))</span>
    <span class="n">A_out_bw</span> <span class="o">=</span> <span class="n">pxu</span><span class="o">.</span><span class="n">view_as_complex</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">adjoint</span><span class="p">(</span><span class="n">pxu</span><span class="o">.</span><span class="n">view_as_real</span><span class="p">(</span><span class="n">A_out_fw</span><span class="p">)))</span>
</pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.operator.linop.fft.nufft.NUFFT.type2">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">type2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">isign</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">real</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plan_fw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plan_bw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_warnings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/fft/nufft.html#NUFFT.type2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.fft.nufft.NUFFT.type2" title="Link to this definition">#</a></dt>
<dd><p>Type-2 NUFFT (uniform to non-uniform).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArray</span></code></a>) – (M, [d]) d-dimensional sample points <span class="math notranslate nohighlight">\(\mathbf{x}_{j} \in [-\pi,\pi]^{d}\)</span>.</p></li>
<li><p><strong>N</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.Integer" title="pyxu.info.ptype.Integer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Integer</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a> ( Integer )) – <p>([d],) mesh size in each dimension <span class="math notranslate nohighlight">\((N_1, \ldots, N_d)\)</span>.</p>
<p>If <code class="code docutils literal notranslate"><span class="pre">N</span></code> is an integer, then the mesh is assumed to have the same size in each dimension.</p>
</p></li>
<li><p><strong>isign</strong> (<code class="docutils literal notranslate"><span class="pre">1</span></code>, <code class="docutils literal notranslate"><span class="pre">-1</span></code>) – Sign <span class="math notranslate nohighlight">\(\sigma\)</span> of the transform.</p></li>
<li><p><strong>eps</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-class docutils literal notranslate"><span class="pre">Real</span></code></a>) – <p>Requested relative accuracy <span class="math notranslate nohighlight">\(\varepsilon \geq 0\)</span>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">eps=0</span></code>, the transform is computed exactly via direct evaluation of the exponential sum using a Numba
JIT-compiled kernel.</p>
</p></li>
<li><p><strong>real</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – <p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, assumes <a class="reference internal" href="#pyxu.operator.linop.fft.nufft.NUFFT.apply" title="pyxu.operator.linop.fft.nufft.NUFFT.apply"><code class="xref py py-func docutils literal notranslate"><span class="pre">apply()</span></code></a> takes (…, N.prod()) inputs in
<span class="math notranslate nohighlight">\(\mathbb{R}^{N}\)</span>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">False</span></code>, then <a class="reference internal" href="#pyxu.operator.linop.fft.nufft.NUFFT.apply" title="pyxu.operator.linop.fft.nufft.NUFFT.apply"><code class="xref py py-func docutils literal notranslate"><span class="pre">apply()</span></code></a> takes (…, 2N.prod()) inputs, i.e.
<span class="math notranslate nohighlight">\(\mathbb{C}^{N}\)</span> vectors viewed as bijections with <span class="math notranslate nohighlight">\(\mathbb{R}^{2N}\)</span>.</p>
</p></li>
<li><p><strong>plan_fw/bw</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, allocate FINUFFT resources to do the forward (fw) and/or backward (bw) transform.
These are advanced options: use them with care.
Some public methods in the <a class="reference internal" href="../abc.html#pyxu.abc.operator.LinOp" title="pyxu.abc.operator.LinOp"><code class="xref py py-class docutils literal notranslate"><span class="pre">LinOp</span></code></a> interface may not work if fw/bw transforms
are disabled.
These options only take effect if <code class="docutils literal notranslate"><span class="pre">eps</span> <span class="pre">&gt;</span> <span class="pre">0</span></code>.</p></li>
<li><p><strong>enable_warnings</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, emit a warning in case of precision mis-match issues.</p></li>
<li><p><strong>**kwargs</strong> – <p>Extra kwargs to <a class="reference external" href="https://finufft.readthedocs.io/en/latest/python.html#finufft.Plan">finufft.Plan</a>.
(Illegal keywords are dropped silently.) Most useful are <code class="docutils literal notranslate"><span class="pre">n_trans</span></code>, <code class="docutils literal notranslate"><span class="pre">nthreads</span></code> and <code class="docutils literal notranslate"><span class="pre">debug</span></code>.</p>
</p></li>
<li><p><strong>plan_fw</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – </p></li>
<li><p><strong>plan_bw</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>op</strong> – (2M, N.prod()) or (2M, 2N.prod()) type-2 NUFFT.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pyxu.operator</span> <span class="k">as</span> <span class="nn">pxo</span>
<span class="kn">import</span> <span class="nn">pyxu.runtime</span> <span class="k">as</span> <span class="nn">pxrt</span>
<span class="kn">import</span> <span class="nn">pyxu.util</span> <span class="k">as</span> <span class="nn">pxu</span>

<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">D</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">5</span>  <span class="c1"># D denotes the dimension of the data</span>
<span class="n">N_full</span> <span class="o">=</span> <span class="p">(</span><span class="n">N</span><span class="p">,)</span> <span class="o">*</span> <span class="n">D</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fmod</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">D</span><span class="p">)),</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>

<span class="k">with</span> <span class="n">pxrt</span><span class="o">.</span><span class="n">Precision</span><span class="p">(</span><span class="n">pxrt</span><span class="o">.</span><span class="n">Width</span><span class="o">.</span><span class="n">SINGLE</span><span class="p">):</span>
    <span class="c1"># The NUFFT dimension (1/2/3) is inferred from the trailing dimension of x.</span>
    <span class="c1"># Its precision is controlled by the context manager.</span>
    <span class="n">N_trans</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">pxo</span><span class="o">.</span><span class="n">NUFFT</span><span class="o">.</span><span class="n">type2</span><span class="p">(</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span>
            <span class="n">n_trans</span><span class="o">=</span><span class="n">N_trans</span><span class="p">,</span>
            <span class="n">isign</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">eps</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1"># Pyxu operators only support real inputs/outputs, so we use the functions</span>
    <span class="c1"># pxu.view_as_[complex/real] to interpret complex arrays as real arrays (and</span>
    <span class="c1"># vice-versa).</span>
    <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
               <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">N_trans</span><span class="p">,</span> <span class="o">*</span><span class="n">N_full</span><span class="p">))</span>
        <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">N_trans</span><span class="p">,</span> <span class="o">*</span><span class="n">N_full</span><span class="p">)),</span>
        <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">N_trans</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="n">A_out_fw</span> <span class="o">=</span> <span class="n">pxu</span><span class="o">.</span><span class="n">view_as_complex</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pxu</span><span class="o">.</span><span class="n">view_as_real</span><span class="p">(</span><span class="n">arr</span><span class="p">)))</span>
    <span class="n">A_out_bw</span> <span class="o">=</span> <span class="n">pxu</span><span class="o">.</span><span class="n">view_as_complex</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">adjoint</span><span class="p">(</span><span class="n">pxu</span><span class="o">.</span><span class="n">view_as_real</span><span class="p">(</span><span class="n">A_out_fw</span><span class="p">)))</span>
</pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.operator.linop.fft.nufft.NUFFT.type3">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">type3</span></span><span class="sig-paren">(</span>
<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">z</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">isign</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">real</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">plan_fw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">plan_bw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">enable_warnings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">chunked</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em>,</dd>
</dl>
<span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/fft/nufft.html#NUFFT.type3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.fft.nufft.NUFFT.type3" title="Link to this definition">#</a></dt>
<dd><p>Type-3 NUFFT (non-uniform to non-uniform).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArray</span></code></a>) – (M, [d]) d-dimensional sample points <span class="math notranslate nohighlight">\(\mathbf{x}_{j} \in \mathbb{R}^{d}\)</span>.</p></li>
<li><p><strong>z</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArray</span></code></a>) – (N, [d]) d-dimensional query points <span class="math notranslate nohighlight">\(\mathbf{z}_{k} \in \mathbb{R}^{d}\)</span>.</p></li>
<li><p><strong>isign</strong> (<code class="docutils literal notranslate"><span class="pre">1</span></code>, <code class="docutils literal notranslate"><span class="pre">-1</span></code>) – Sign <span class="math notranslate nohighlight">\(\sigma\)</span> of the transform.</p></li>
<li><p><strong>eps</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-class docutils literal notranslate"><span class="pre">Real</span></code></a>) – <p>Requested relative accuracy <span class="math notranslate nohighlight">\(\varepsilon \geq 0\)</span>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">eps=0</span></code>, the transform is computed exactly via direct evaluation of the exponential
sum using a Numba JIT-compiled kernel.</p>
</p></li>
<li><p><strong>real</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – <p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, assumes <a class="reference internal" href="#pyxu.operator.linop.fft.nufft.NUFFT.apply" title="pyxu.operator.linop.fft.nufft.NUFFT.apply"><code class="xref py py-func docutils literal notranslate"><span class="pre">apply()</span></code></a> takes (…, M) inputs in
<span class="math notranslate nohighlight">\(\mathbb{R}^{M}\)</span>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">False</span></code>, then <a class="reference internal" href="#pyxu.operator.linop.fft.nufft.NUFFT.apply" title="pyxu.operator.linop.fft.nufft.NUFFT.apply"><code class="xref py py-func docutils literal notranslate"><span class="pre">apply()</span></code></a> takes (…, 2M) inputs, i.e.
<span class="math notranslate nohighlight">\(\mathbb{C}^{M}\)</span> vectors viewed as bijections with <span class="math notranslate nohighlight">\(\mathbb{R}^{2M}\)</span>.</p>
</p></li>
<li><p><strong>plan_fw/bw</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, allocate FINUFFT resources to do the forward (fw) and/or backward (bw) transform.
These are advanced options: use them with care.
Some public methods in the <a class="reference internal" href="../abc.html#pyxu.abc.operator.LinOp" title="pyxu.abc.operator.LinOp"><code class="xref py py-class docutils literal notranslate"><span class="pre">LinOp</span></code></a> interface may not work if fw/bw transforms
are disabled.
These options only take effect if <code class="docutils literal notranslate"><span class="pre">eps</span> <span class="pre">&gt;</span> <span class="pre">0</span></code>.</p></li>
<li><p><strong>enable_warnings</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, emit a warning in case of precision mis-match issues.</p></li>
<li><p><strong>chunked</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the transform is performed in small chunks. (See Notes for details.)</p></li>
<li><p><strong>parallel</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – This option only applies to chunked transforms.
If <code class="docutils literal notranslate"><span class="pre">True</span></code>, evaluate chunks in parallel.</p></li>
<li><p><strong>**kwargs</strong> – <p>Extra kwargs to <a class="reference external" href="https://finufft.readthedocs.io/en/latest/python.html#finufft.Plan">finufft.Plan</a>.
(Illegal keywords are dropped silently.) Most useful are <code class="docutils literal notranslate"><span class="pre">n_trans</span></code>, <code class="docutils literal notranslate"><span class="pre">nthreads</span></code> and <code class="docutils literal notranslate"><span class="pre">debug</span></code>.</p>
</p></li>
<li><p><strong>plan_fw</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – </p></li>
<li><p><strong>plan_bw</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>op</strong> – (2N, M) or (2N, 2M) type-3 NUFFT.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pyxu.operator</span> <span class="k">as</span> <span class="nn">pxo</span>
<span class="kn">import</span> <span class="nn">pyxu.runtime</span> <span class="k">as</span> <span class="nn">pxrt</span>
<span class="kn">import</span> <span class="nn">pyxu.util</span> <span class="k">as</span> <span class="nn">pxu</span>

<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">D</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">5</span>  <span class="c1"># D denotes the dimension of the data</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">D</span><span class="p">))</span> <span class="o">+</span> <span class="mi">2000</span>  <span class="c1"># Poorly-centered data</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">D</span><span class="p">))</span>
<span class="k">with</span> <span class="n">pxrt</span><span class="o">.</span><span class="n">Precision</span><span class="p">(</span><span class="n">pxrt</span><span class="o">.</span><span class="n">Width</span><span class="o">.</span><span class="n">SINGLE</span><span class="p">):</span>
    <span class="c1"># The NUFFT dimension (1/2/3) is inferred from the trailing dimension of x/z.</span>
    <span class="c1"># Its precision is controlled by the context manager.</span>
    <span class="n">N_trans</span> <span class="o">=</span> <span class="mi">20</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">pxo</span><span class="o">.</span><span class="n">NUFFT</span><span class="o">.</span><span class="n">type3</span><span class="p">(</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span>
            <span class="n">n_trans</span><span class="o">=</span><span class="n">N_trans</span><span class="p">,</span>
            <span class="n">isign</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">eps</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span>
         <span class="p">)</span>

    <span class="c1"># Pyxu operators only support real inputs/outputs, so we use the functions</span>
    <span class="c1"># pxu.view_as_[complex/real] to interpret complex arrays as real arrays (and</span>
    <span class="c1"># vice-versa).</span>
    <span class="n">arr</span> <span class="o">=</span>        <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">N_trans</span><span class="p">,</span> <span class="n">M</span><span class="p">))</span> \
          <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">N_trans</span><span class="p">,</span> <span class="n">M</span><span class="p">))</span>
    <span class="n">A_out_fw</span> <span class="o">=</span> <span class="n">pxu</span><span class="o">.</span><span class="n">view_as_complex</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pxu</span><span class="o">.</span><span class="n">view_as_real</span><span class="p">(</span><span class="n">arr</span><span class="p">)))</span>
    <span class="n">A_out_bw</span> <span class="o">=</span> <span class="n">pxu</span><span class="o">.</span><span class="n">view_as_complex</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">adjoint</span><span class="p">(</span><span class="n">pxu</span><span class="o">.</span><span class="n">view_as_real</span><span class="p">(</span><span class="n">A_out_fw</span><span class="p">)))</span>
</pre></div>
</div>
<p class="rubric">Notes (chunked-transform)</p>
<ul>
<li><p>An extra initialization step is required before using a chunked-transform:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">pxl</span><span class="o">.</span><span class="n">NUFFT</span><span class="o">.</span><span class="n">type3</span><span class="p">(</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">z</span>
        <span class="n">isign</span>
        <span class="n">chunked</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>   <span class="c1"># with chunk specified</span>
        <span class="n">parallel</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># for extra speed (chunked-only)</span>
        <span class="o">**</span><span class="n">finufft_kwargs</span><span class="p">,</span>
     <span class="p">)</span>
<span class="n">x_chunks</span><span class="p">,</span> <span class="n">z_chunks</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">auto_chunk</span><span class="p">()</span>  <span class="c1"># auto-determine a good x/z chunking strategy</span>
<span class="n">A</span><span class="o">.</span><span class="n">allocate</span><span class="p">(</span><span class="n">x_chunks</span><span class="p">,</span> <span class="n">z_chunks</span><span class="p">)</span>  <span class="c1"># apply the chunking strategy.</span>
</pre></div>
</div>
<p><a class="reference internal" href="#pyxu.operator.linop.fft.nufft.NUFFT.auto_chunk" title="pyxu.operator.linop.fft.nufft.NUFFT.auto_chunk"><code class="xref py py-meth docutils literal notranslate"><span class="pre">auto_chunk()</span></code></a> is a helper method to auto-determine a good
chunking strategy.</p>
<p>Its runtime is significant when the number of sub-problems grows large. (1000+)
In these contexts, assuming a good-enough x/z-split is known in advance, users can directly supply them to
<a class="reference internal" href="#pyxu.operator.linop.fft.nufft.NUFFT.allocate" title="pyxu.operator.linop.fft.nufft.NUFFT.allocate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">allocate()</span></code></a>.</p>
</li>
<li><p><a class="reference internal" href="#pyxu.operator.linop.fft.nufft.NUFFT.apply" title="pyxu.operator.linop.fft.nufft.NUFFT.apply"><code class="xref py py-func docutils literal notranslate"><span class="pre">apply()</span></code></a> /
<a class="reference internal" href="#pyxu.operator.linop.fft.nufft.NUFFT.adjoint" title="pyxu.operator.linop.fft.nufft.NUFFT.adjoint"><code class="xref py py-func docutils literal notranslate"><span class="pre">adjoint()</span></code></a> runtime is minimized when x/z are well-ordered, i.e.
when sub-problems can sub-sample inputs to <a class="reference internal" href="#pyxu.operator.linop.fft.nufft.NUFFT.apply" title="pyxu.operator.linop.fft.nufft.NUFFT.apply"><code class="xref py py-func docutils literal notranslate"><span class="pre">apply()</span></code></a> /
<a class="reference internal" href="#pyxu.operator.linop.fft.nufft.NUFFT.adjoint" title="pyxu.operator.linop.fft.nufft.NUFFT.adjoint"><code class="xref py py-func docutils literal notranslate"><span class="pre">adjoint()</span></code></a> via slice operators.</p>
<p>To reduce runtime of chunked transforms, <a class="reference internal" href="#pyxu.operator.linop.fft.nufft.NUFFT.allocate" title="pyxu.operator.linop.fft.nufft.NUFFT.allocate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">allocate()</span></code></a>
automatically re-orders x/z when appropriate.</p>
<p>The side-effect is the cost of a permutation before/after calls to
<a class="reference internal" href="#pyxu.operator.linop.fft.nufft.NUFFT.apply" title="pyxu.operator.linop.fft.nufft.NUFFT.apply"><code class="xref py py-func docutils literal notranslate"><span class="pre">apply()</span></code></a> /
<a class="reference internal" href="#pyxu.operator.linop.fft.nufft.NUFFT.adjoint" title="pyxu.operator.linop.fft.nufft.NUFFT.adjoint"><code class="xref py py-func docutils literal notranslate"><span class="pre">adjoint()</span></code></a>.
This cost becomes significant when the number of non-uniform points x/z is large. (&gt; 1e6)</p>
<p>To avoid paying the re-ordering cost at each transform, it is recommended to supply x/z and apply/adjoint
inputs in the “correct” order from the start.</p>
<p>A good re-ordering is computed automatically by <a class="reference internal" href="#pyxu.operator.linop.fft.nufft.NUFFT.allocate" title="pyxu.operator.linop.fft.nufft.NUFFT.allocate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">allocate()</span></code></a> and
can be used to initialize a new chunked-transform with better runtime properties as such:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Initialize a chunked transform (1st try; as above)</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">pxl</span><span class="o">.</span><span class="n">NUFFT</span><span class="o">.</span><span class="n">type3</span><span class="p">(</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">z</span>
        <span class="n">isign</span>
        <span class="n">chunked</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">parallel</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="o">**</span><span class="n">finufft_kwargs</span><span class="p">,</span>
     <span class="p">)</span>
<span class="n">x_chunks</span><span class="p">,</span> <span class="n">z_chunks</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">auto_chunk</span><span class="p">()</span>  <span class="c1"># auto-determine a good x/z chunking strategy</span>
<span class="n">A</span><span class="o">.</span><span class="n">allocate</span><span class="p">(</span><span class="n">x_chunks</span><span class="p">,</span> <span class="n">z_chunks</span><span class="p">)</span>  <span class="c1"># will raise warning if bad x/z-order detected</span>

<span class="c1">### Now initialize a better transform (2nd try)</span>
<span class="n">x_idx</span><span class="p">,</span> <span class="n">x_chunks</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">order</span><span class="p">(</span><span class="s2">"x"</span><span class="p">)</span>  <span class="c1"># get a good x-ordering</span>
<span class="n">z_idx</span><span class="p">,</span> <span class="n">z_chunks</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">order</span><span class="p">(</span><span class="s2">"z"</span><span class="p">)</span>  <span class="c1"># get a good z-ordering</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">pxl</span><span class="o">.</span><span class="n">NUFFT</span><span class="o">.</span><span class="n">type3</span><span class="p">(</span>
        <span class="n">x</span><span class="p">[</span><span class="n">x_idx</span><span class="p">],</span> <span class="n">z</span><span class="p">[</span><span class="n">z_idx</span><span class="p">]</span>  <span class="c1"># re-order x/z accordingly</span>
        <span class="o">...</span>                 <span class="c1"># same as before</span>
     <span class="p">)</span>
<span class="n">A</span><span class="o">.</span><span class="n">allocate</span><span class="p">(</span><span class="n">x_chunks</span><span class="p">,</span> <span class="n">z_chunks</span><span class="p">)</span>  <span class="c1"># skip auto-chunking and apply</span>
                                <span class="c1"># optimal x/z_chunks provided.</span>
</pre></div>
</div>
</li>
</ul>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyxu.operator.linop.fft.nufft.NUFFT.auto_chunk" title="pyxu.operator.linop.fft.nufft.NUFFT.auto_chunk"><code class="xref py py-meth docutils literal notranslate"><span class="pre">auto_chunk()</span></code></a>, <a class="reference internal" href="#pyxu.operator.linop.fft.nufft.NUFFT.allocate" title="pyxu.operator.linop.fft.nufft.NUFFT.allocate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">allocate()</span></code></a>, <a class="reference internal" href="#pyxu.operator.linop.fft.nufft.NUFFT.diagnostic_plot" title="pyxu.operator.linop.fft.nufft.NUFFT.diagnostic_plot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">diagnostic_plot()</span></code></a>, <a class="reference internal" href="#pyxu.operator.linop.fft.nufft.NUFFT.stats" title="pyxu.operator.linop.fft.nufft.NUFFT.stats"><code class="xref py py-meth docutils literal notranslate"><span class="pre">stats()</span></code></a></p>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.operator.linop.fft.nufft.NUFFT.apply">
<span class="sig-name descname"><span class="pre">apply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/fft/nufft.html#NUFFT.apply"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.fft.nufft.NUFFT.apply" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>arr</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArray</span></code></a>) – <ul class="simple">
<li><dl class="simple">
<dt><strong>Type 1 and 3:</strong></dt><dd><ul>
<li><p>(…,  M) input weights <span class="math notranslate nohighlight">\(\mathbf{w} \in \mathbb{R}^{M}\)</span> (real transform).</p></li>
<li><p>(…, 2M) input weights <span class="math notranslate nohighlight">\(\mathbf{w} \in \mathbb{C}^{M}\)</span> viewed as a real array.
(See <a class="reference internal" href="../util.html#pyxu.util.complex.view_as_real" title="pyxu.util.complex.view_as_real"><code class="xref py py-func docutils literal notranslate"><span class="pre">view_as_real()</span></code></a>.)</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>Type 2:</strong></dt><dd><ul>
<li><p>(…,  N.prod()) input weights <span class="math notranslate nohighlight">\(\mathbf{u} \in
\mathbb{R}^{\mathcal{I}_{N_1, \ldots, N_d}}\)</span> (real transform).</p></li>
<li><p>(…, 2N.prod()) input weights <span class="math notranslate nohighlight">\(\mathbf{u} \in
\mathbb{C}^{\mathcal{I}_{N_1, \ldots, N_d}}\)</span> viewed as a real array.
(See <a class="reference internal" href="../util.html#pyxu.util.complex.view_as_real" title="pyxu.util.complex.view_as_real"><code class="xref py py-func docutils literal notranslate"><span class="pre">view_as_real()</span></code></a>.)</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><strong>out</strong> –</p>
<ul class="simple">
<li><dl class="simple">
<dt><strong>Type 1:</strong></dt><dd><p>(…, 2N.prod()) output weights <span class="math notranslate nohighlight">\(\mathbf{u} \in
\mathbb{C}^{\mathcal{I}_{N_1, \ldots, N_d}}\)</span> viewed as a real array.
(See <a class="reference internal" href="../util.html#pyxu.util.complex.view_as_real" title="pyxu.util.complex.view_as_real"><code class="xref py py-func docutils literal notranslate"><span class="pre">view_as_real()</span></code></a>.)</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>Type 2:</strong></dt><dd><p>(…, 2M) output weights <span class="math notranslate nohighlight">\(\mathbf{w} \in \mathbb{C}^{M}\)</span> viewed as a real array.
(See <a class="reference internal" href="../util.html#pyxu.util.complex.view_as_real" title="pyxu.util.complex.view_as_real"><code class="xref py py-func docutils literal notranslate"><span class="pre">view_as_real()</span></code></a>.)</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>Type 3:</strong></dt><dd><p>(…, 2N) output weights <span class="math notranslate nohighlight">\(\mathbf{v} \in \mathbb{C}^{N}\)</span> viewed as a real array.
(See <a class="reference internal" href="../util.html#pyxu.util.complex.view_as_real" title="pyxu.util.complex.view_as_real"><code class="xref py py-func docutils literal notranslate"><span class="pre">view_as_real()</span></code></a>.)</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArray</span></code></a></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.operator.linop.fft.nufft.NUFFT.adjoint">
<span class="sig-name descname"><span class="pre">adjoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/fft/nufft.html#NUFFT.adjoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.fft.nufft.NUFFT.adjoint" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>arr</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArray</span></code></a>) – <ul class="simple">
<li><dl class="simple">
<dt><strong>Type 1:</strong></dt><dd><p>(…, 2N.prod()) output weights <span class="math notranslate nohighlight">\(\mathbf{u} \in
\mathbb{C}^{\mathcal{I}_{N_1, \ldots, N_d}}\)</span> viewed as a real array.
(See <a class="reference internal" href="../util.html#pyxu.util.complex.view_as_real" title="pyxu.util.complex.view_as_real"><code class="xref py py-func docutils literal notranslate"><span class="pre">view_as_real()</span></code></a>.)</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>Type 2:</strong></dt><dd><p>(…, 2M) output weights <span class="math notranslate nohighlight">\(\mathbf{w} \in \mathbb{C}^{M}\)</span> viewed as a real array.
(See <a class="reference internal" href="../util.html#pyxu.util.complex.view_as_real" title="pyxu.util.complex.view_as_real"><code class="xref py py-func docutils literal notranslate"><span class="pre">view_as_real()</span></code></a>.)</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>Type 3:</strong></dt><dd><p>(…, 2N) output weights <span class="math notranslate nohighlight">\(\mathbf{v} \in \mathbb{C}^{N}\)</span> viewed as a real array.
(See <a class="reference internal" href="../util.html#pyxu.util.complex.view_as_real" title="pyxu.util.complex.view_as_real"><code class="xref py py-func docutils literal notranslate"><span class="pre">view_as_real()</span></code></a>.)</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><strong>out</strong> –</p>
<ul class="simple">
<li><dl class="simple">
<dt><strong>Type 1 and 3:</strong></dt><dd><ul>
<li><p>(…,  M) input weights <span class="math notranslate nohighlight">\(\mathbf{w} \in \mathbb{R}^{M}\)</span> (real transform).</p></li>
<li><p>(…, 2M) input weights <span class="math notranslate nohighlight">\(\mathbf{w} \in \mathbb{C}^{M}\)</span> viewed as a real array.
(See <a class="reference internal" href="../util.html#pyxu.util.complex.view_as_real" title="pyxu.util.complex.view_as_real"><code class="xref py py-func docutils literal notranslate"><span class="pre">view_as_real()</span></code></a>.)</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>Type 2:</strong></dt><dd><ul>
<li><p>(…,  N.prod()) input weights <span class="math notranslate nohighlight">\(\mathbf{u} \in
\mathbb{R}^{\mathcal{I}_{N_1, \ldots, N_d}}\)</span> (real transform).</p></li>
<li><p>(…, 2N.prod()) input weights <span class="math notranslate nohighlight">\(\mathbf{u} \in
\mathbb{C}^{\mathcal{I}_{N_1, \ldots, N_d}}\)</span> viewed as a real array.
(See <a class="reference internal" href="../util.html#pyxu.util.complex.view_as_real" title="pyxu.util.complex.view_as_real"><code class="xref py py-func docutils literal notranslate"><span class="pre">view_as_real()</span></code></a>.)</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArray</span></code></a></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.operator.linop.fft.nufft.NUFFT.ascomplexarray">
<span class="sig-name descname"><span class="pre">ascomplexarray</span></span><span class="sig-paren">(</span>
<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">xp=&lt;module</span> <span class="pre">'numpy'</span> <span class="pre">from</span> <span class="pre">'/Users/mmjasime/miniconda3/envs/pyxu/lib/python3.11/site-packages/numpy/__init__.py'&gt;</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">dtype=None</span></span></em>,</dd>
</dl>
<span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/fft/nufft.html#NUFFT.ascomplexarray"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.fft.nufft.NUFFT.ascomplexarray" title="Link to this definition">#</a></dt>
<dd><p>Matrix representation (complex-valued) of the linear operator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xp</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.ArrayModule" title="pyxu.info.ptype.ArrayModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">ArrayModule</span></code></a>) – Which array module to use to represent the output.</p></li>
<li><p><strong>dtype</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.DType" title="pyxu.info.ptype.DType"><code class="xref py py-class docutils literal notranslate"><span class="pre">DType</span></code></a>) – Optional (complex-valued) type of the array.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><strong>A</strong> – Array representation of the operator (NUFFT type-dependant).</p>
<ul class="simple">
<li><p><strong>Type 1:</strong> (N.prod(), M)</p></li>
<li><p><strong>Type 2:</strong> (M, N.prod())</p></li>
<li><p><strong>Type 3:</strong> (N, M)</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArray</span></code></a></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.operator.linop.fft.nufft.NUFFT.mesh">
<span class="sig-name descname"><span class="pre">mesh</span></span><span class="sig-paren">(</span>
<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">xp=&lt;module</span> <span class="pre">'numpy'</span> <span class="pre">from</span> <span class="pre">'/Users/mmjasime/miniconda3/envs/pyxu/lib/python3.11/site-packages/numpy/__init__.py'&gt;</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">dtype=None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">scale='unit'</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">upsampled=False</span></span></em>,</dd>
</dl>
<span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/fft/nufft.html#NUFFT.mesh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.fft.nufft.NUFFT.mesh" title="Link to this definition">#</a></dt>
<dd><p>For type-1/2 NUFFT: compute the transform’s meshgrid <span class="math notranslate nohighlight">\(\mathcal{I}_{N_{1} \times \cdots \times N_{d}} =
\mathcal{I}_{N_{1}} \times \cdots \times \mathcal{I}_{N_{d}}\)</span>.</p>
<p>For type-3 NUFFT: compute the (shifted) meshgrid used for internal FFT computations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xp</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.ArrayModule" title="pyxu.info.ptype.ArrayModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">ArrayModule</span></code></a>) – Which array module to use to represent the output.</p></li>
<li><p><strong>dtype</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.DType" title="pyxu.info.ptype.DType"><code class="xref py py-class docutils literal notranslate"><span class="pre">DType</span></code></a>) – Optional type of the array.</p></li>
<li><p><strong>scale</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – <p>Grid scale. Options are:</p>
<ul>
<li><dl class="simple">
<dt><strong>Type1 and 2:</strong></dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">unit</span></code>, i.e. <span class="math notranslate nohighlight">\(\mathcal{I} = [[-N_{d}//2, \ldots, (N_{d}-1)//2 + 1))^{d}\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">source</span></code>, i.e. <span class="math notranslate nohighlight">\(\mathcal{I} \subset [-\pi, \pi)^{d}\)</span></p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>Type 3:</strong></dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">unit</span></code>, i.e. <span class="math notranslate nohighlight">\(\mathcal{I} = [[-N_{d}//2, \ldots, (N_{d}-1)//2 + 1))^{d}\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">source</span></code>, i.e. <span class="math notranslate nohighlight">\(\mathcal{I}_{\text{source}} \subset x^{c} + [-X_{d}, X_{d})^{d}\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">target</span></code>, i.e. <span class="math notranslate nohighlight">\(\mathcal{I}_{\text{target}} \subset z^{c} + [-Z_{d}, Z_{d})^{d}\)</span>,</p></li>
</ul>
</dd>
</dl>
<p>where <span class="math notranslate nohighlight">\(x^{c}\)</span>, <span class="math notranslate nohighlight">\(z^{c}\)</span> denote the source/target centroids, and <span class="math notranslate nohighlight">\(X\)</span>,
<span class="math notranslate nohighlight">\(Z\)</span> the source/target half-widths.</p>
</li>
</ul>
</p></li>
<li><p><strong>upsampled</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Use the upsampled meshgrid.  (See <a class="reference internal" href="../../references.html#finufft" id="id13"><span>[FINUFFT]</span></a> for details.)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>grid</strong> – (N1, …, Nd, d) grid.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArray</span></code></a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pyxu.operator</span> <span class="k">as</span> <span class="nn">pxo</span>

<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">D</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span>  <span class="c1"># D denotes the dimension of the data</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fmod</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">D</span><span class="p">)),</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">pxo</span><span class="o">.</span><span class="n">NUFFT</span><span class="o">.</span><span class="n">type1</span><span class="p">(</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span>
    <span class="n">isign</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">eps</span><span class="o">=</span><span class="mf">1e-3</span>
<span class="p">)</span>
<span class="n">A</span><span class="o">.</span><span class="n">mesh</span><span class="p">()</span>  <span class="c1"># array([[-1.],</span>
          <span class="c1">#        [ 0.],</span>
          <span class="c1">#        [ 1.]])</span>
</pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.operator.linop.fft.nufft.NUFFT.plot_kernel">
<span class="sig-name descname"><span class="pre">plot_kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/fft/nufft.html#NUFFT.plot_kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.fft.nufft.NUFFT.plot_kernel" title="Link to this definition">#</a></dt>
<dd><p>Plot the spreading/interpolation kernel (along each dimension) on its support.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes" title="(in Matplotlib v3.7.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Axes</span></code></a>) – Axes to draw on.
If <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>, a new axes is used.</p></li>
<li><p><strong>**kwargs</strong> – Keyword arguments forwarded to <a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.plot.html#matplotlib.axes.Axes.plot" title="(in Matplotlib v3.7.2)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">matplotlib.axes.Axes.plot()</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ax</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes" title="(in Matplotlib v3.7.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Axes</span></code></a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/index.html#module-numpy" title="numpy"><span class="nn">numpy</span></a> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pyxu.operator</span> <span class="k">as</span> <span class="nn">pxo</span>
<span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/pyplot_summary.html#module-matplotlib.pyplot" title="matplotlib.pyplot"><span class="nn">matplotlib.pyplot</span></a> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">rng</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/random/generator.html#numpy.random.default_rng" title="numpy.random.default_rng"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span></a><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">D</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span>  <span class="c1"># D denotes the dimension of the data</span>
<span class="n">x</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.fmod.html#numpy.fmod" title="numpy.fmod"><span class="n">np</span><span class="o">.</span><span class="n">fmod</span></a><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">D</span><span class="p">)),</span> <span class="mi">2</span> <span class="o">*</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/constants.html#numpy.pi" title="numpy.pi"><span class="n">np</span><span class="o">.</span><span class="n">pi</span></a><span class="p">)</span>
<span class="n">A</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.linop.fft.nufft.NUFFT.type1" title="pyxu.operator.linop.fft.nufft.NUFFT.type1"><span class="n">pxo</span><span class="o">.</span><span class="n">NUFFT</span><span class="o">.</span><span class="n">type1</span></a><span class="p">(</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span>
    <span class="n">isign</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">eps</span><span class="o">=</span><span class="mf">1e-9</span>
<span class="p">)</span>
<span class="n">A</span><span class="o">.</span><span class="n">plot_kernel</span><span class="p">()</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../_downloads/1ca2eac05e4e846c261061a368416210/linop-1.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/bad8b499444b02c5b24a36ba5ed4206e/linop-1.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/aee252674a1cbdd16ee7585368a2fac3/linop-1.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/5d831190e971237b56d4c6f5001a1497/linop-1.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../../_images/linop-1.png" class="plot-directive" src="../../_images/linop-1.png"/>
</figure>
<p class="rubric">Notes</p>
<p>Requires <a class="reference external" href="https://matplotlib.org/">Matplotlib</a> to be installed.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.operator.linop.fft.nufft.NUFFT.params">
<span class="sig-name descname"><span class="pre">params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/fft/nufft.html#NUFFT.params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.fft.nufft.NUFFT.params" title="Link to this definition">#</a></dt>
<dd><p>Compute internal parameters of the <a class="reference internal" href="../../references.html#finufft" id="id14"><span>[FINUFFT]</span></a> implementation.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p><strong>p</strong> – Internal parameters of the FINUFFT implementation, with fields:</p>
<ul class="simple">
<li><dl class="simple">
<dt>upsample_factor: <a class="reference internal" href="../info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Real</span></code></a></dt><dd><p>FFT upsampling factor &gt; 1</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>kernel_width: <a class="reference internal" href="../info.html#pyxu.info.ptype.Integer" title="pyxu.info.ptype.Integer"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Integer</span></code></a></dt><dd><p>Width of the spreading/interpolation kernels (in number of samples).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>kernel_beta: <a class="reference internal" href="../info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Real</span></code></a></dt><dd><p>Kernel decay parameter <span class="math notranslate nohighlight">\(\beta &gt; 0\)</span>.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>fft_shape: (d,) [<a class="reference internal" href="../info.html#pyxu.info.ptype.Integer" title="pyxu.info.ptype.Integer"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Integer</span></code></a>]</dt><dd><p>Size of the D-dimensional FFT(s) performed internally.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>dilation_factor: (d,) [<a class="reference internal" href="../info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Real</span></code></a>]</dt><dd><p>Dilation factor(s) <span class="math notranslate nohighlight">\(\gamma_{d}\)</span>. (Type-3 only)</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/collections.html#collections.namedtuple" title="(in Python v3.11)"><code class="xref py py-func docutils literal notranslate"><span class="pre">namedtuple()</span></code></a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>When called from a chunked type-3 transform, <a class="reference internal" href="#pyxu.operator.linop.fft.nufft.NUFFT.params" title="pyxu.operator.linop.fft.nufft.NUFFT.params"><code class="xref py py-meth docutils literal notranslate"><span class="pre">params()</span></code></a> returns
parameters of the equivalent monolithic type-3 transform.
The monolithic transform is seldom instantiable due to its large memory requirements.
This method can hence be used to estimate the memory savings induced by chunking.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.operator.linop.fft.nufft.NUFFT.auto_chunk">
<span class="sig-name descname"><span class="pre">auto_chunk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_mem</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_anisotropy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/fft/nufft.html#NUFFT.auto_chunk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.fft.nufft.NUFFT.auto_chunk" title="Link to this definition">#</a></dt>
<dd><p>(Only applies to chunked type-3 transforms.)</p>
<p>Auto-determine chunk indices per domain.</p>
<p>Use this function if you don’t know how to optimally ‘cut’ x/z manually.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_mem</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-class docutils literal notranslate"><span class="pre">Real</span></code></a>) – Max FFT memory (MiB) allowed per sub-block. (Default = 10 MiB)</p></li>
<li><p><strong>max_anisotropy</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-class docutils literal notranslate"><span class="pre">Real</span></code></a>) – <p>Max tolerated (normalized) anisotropy ratio &gt;= 1.</p>
<ul>
<li><p>Setting close to 1 favors cubeoid-shaped partitions of x/z space.</p></li>
<li><p>Setting large allows x/z-partitions to be highly-rectangular.</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>x_chunks</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list[NDArray[int]]</span></code>) – (x_idx[0], …, x_idx[A-1]) x-coordinate chunk specifier.
<code class="code docutils literal notranslate"><span class="pre">x_idx[k]</span></code> contains indices of <code class="code docutils literal notranslate"><span class="pre">x</span></code> which participate in the k-th NUFFT sub-problem.</p></li>
<li><p><strong>z_chunks</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list[NDArray[int]]</span></code>) – (z_idx[0], …, z_idx[B-1]) z-coordinate chunk specifier.
<code class="code docutils literal notranslate"><span class="pre">z_idx[k]</span></code> contains indices of <code class="code docutils literal notranslate"><span class="pre">z</span></code> which participate in the k-th NUFFT sub-problem.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)">tuple</a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)">list</a>[<a class="reference internal" href="../info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><em>NDArray</em></a>], <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)">list</a>[<a class="reference internal" href="../info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><em>NDArray</em></a>]]</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Chunks are identified by a custom hierarchical clustering method, with main steps:</p>
<ol class="arabic">
<li><p><strong>Partition the NUFFT domains.</strong>
Given a maximum FFT memory budget <span class="math notranslate nohighlight">\(B&gt;0\)</span> and chunk anisotropy <span class="math notranslate nohighlight">\(\alpha\geq 1\)</span>, partition the
source/target domains into uniform rectangular cells.
The (half) widths of the source/target cells <span class="math notranslate nohighlight">\(h_{k}&gt;0\)</span> and <span class="math notranslate nohighlight">\(\eta_{k}&gt;0\)</span> in each dimension
<span class="math notranslate nohighlight">\(k=\{1,\ldots d\}\)</span> are chosen so as to:</p>
<p>Minimize the total number of partitions:</p>
<div class="math notranslate nohighlight">
\[N_{c}
=
\underbrace{\prod_{k=1}^{d} \frac{X_k}{h_k}}_{\text{Source partition count}}
\times
\underbrace{\prod_{k=1}^{d} \frac{Z_k}{\eta_k}}_{\text{Target partition count}}\]</div>
<p>subject to:</p>
<blockquote>
<div><ol class="loweralpha">
<li><div class="math notranslate nohighlight">
\[\prod_{k=1}^{d} \eta_k h_k
\leq
(\pi/2\upsilon)^{d} \frac{B}{\delta \; \texttt{n_trans}},\]</div>
<p>where</p>
<blockquote>
<div><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\upsilon\)</span> denotes the NUFFT’s grid upsampling factor,</p></li>
<li><p><span class="math notranslate nohighlight">\(\delta\)</span> the number of bytes occupied by a complex number,</p></li>
<li><p><span class="math notranslate nohighlight">\(\texttt{n_trans}\)</span> the number of simultaneous transforms performed.</p></li>
</ul>
</div></blockquote>
</li>
<li><div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
    h_{k} &amp; \leq X_{k}, \quad k=\{1,\ldots,d\} \\
    \eta_{k} &amp; \leq Z_{k}, \quad k=\{1,\ldots,d\}
\end{align*}\end{split}\]</div>
</li>
<li><div class="math notranslate nohighlight">
\[N_{c} \ge 1.\]</div>
</li>
<li><div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
    \frac{1}{\alpha} &amp; \leq \frac{h_{k}}{h_{j}} \frac{X_{j}}{X_{k}} \leq \alpha, \quad k \ne j, \\
    \frac{1}{\alpha} &amp; \leq \frac{\eta_{k}}{\eta_{j}} \frac{Z_{j}}{Z_{k}} \leq \alpha, \quad k \ne j.
\end{align*}\end{split}\]</div>
</li>
<li><div class="math notranslate nohighlight">
\[\begin{align*}
    \frac{1}{\alpha} &amp; \leq \frac{h_{k}}{\eta_{j}} \frac{Z_{j}}{X_{k}} \leq \alpha, \quad (j, k) = \{1,\ldots,d\}^{2}.
\end{align*}\]</div>
</li>
</ol>
</div></blockquote>
<p>Constraint (a) ensures type-3 NUFFTs performed in each sub-problem do not exceed the FFT memory budget.
Constraints (b-c) ensure that partitions are non-degenerate/non-trivial respectively.
Constraints (d-e) limit the anisotropy of the partitioning cells in each domain and across domains.</p>
</li>
<li><p><strong>Data-independent Chunking.</strong>
Chunk the data by assigning non-uniform samples to their enclosing cell in the partition.
Empty partitions are dropped.</p></li>
<li><p><strong>Data-dependent Chunk Fusion.</strong>
Since (1) is data-independent, data chunks obtained in (2) may split clusters among adjacent chunks, which is
undesirable.
Clusters whose joint-spread is small enough are hence fused hierarchically.</p></li>
</ol>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This procedure yields a small number of memory-capped and well-separated data chunks in source/target
domains.
However, it may result in unbalanced chunks, with some chunks containing significantly more data-points than
others.
FINUFFT mitigates the unbalanced-chunk problem by spawning multiple threads to process dense clusters.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyxu.operator.linop.fft.nufft.NUFFT.allocate" title="pyxu.operator.linop.fft.nufft.NUFFT.allocate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">allocate()</span></code></a>, <a class="reference internal" href="#pyxu.operator.linop.fft.nufft.NUFFT.diagnostic_plot" title="pyxu.operator.linop.fft.nufft.NUFFT.diagnostic_plot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">diagnostic_plot()</span></code></a>, <a class="reference internal" href="#pyxu.operator.linop.fft.nufft.NUFFT.stats" title="pyxu.operator.linop.fft.nufft.NUFFT.stats"><code class="xref py py-meth docutils literal notranslate"><span class="pre">stats()</span></code></a></p>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.operator.linop.fft.nufft.NUFFT.allocate">
<span class="sig-name descname"><span class="pre">allocate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_chunks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_chunks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direct_eval_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/fft/nufft.html#NUFFT.allocate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.fft.nufft.NUFFT.allocate" title="Link to this definition">#</a></dt>
<dd><p>(Only applies to chunked type-3 transforms.)</p>
<p>Allocate NUFFT sub-problems based on chunk specification.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_chunks</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list[NDArray[int]</span> <span class="pre">|</span> <span class="pre">slice]</span></code>) – (x_idx[0], …, x_idx[A-1]) x-coordinate chunk specifier.
<code class="code docutils literal notranslate"><span class="pre">x_idx[k]</span></code> contains indices of <code class="code docutils literal notranslate"><span class="pre">x</span></code> which participate in the k-th NUFFT sub-problem.</p></li>
<li><p><strong>z_chunks</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list[NDArray[int]</span> <span class="pre">|</span> <span class="pre">slice]</span></code>) – (z_idx[0], …, z_idx[B-1]) z-coordinate chunk specifier.
<code class="code docutils literal notranslate"><span class="pre">z_idx[k]</span></code> contains indices of <code class="code docutils literal notranslate"><span class="pre">z</span></code> which participate in the k-th NUFFT sub-problem.</p></li>
<li><p><strong>direct_eval_threshold</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.Integer" title="pyxu.info.ptype.Integer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Integer</span></code></a>) – <p>If provided: lower bound on <code class="docutils literal notranslate"><span class="pre">len(x)</span> <span class="pre">*</span> <span class="pre">len(z)</span></code> below which an NUFFT sub-problem is
replaced with direct-evaluation (eps=0) for performance reasons.</p>
<p>(Defaults to 10k as per the <a class="reference external" href="https://finufft.readthedocs.io/en/latest/#do-i-even-need-a-nufft">FINUFFT guidelines</a>.)</p>
</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyxu.operator.linop.fft.nufft.NUFFT.auto_chunk" title="pyxu.operator.linop.fft.nufft.NUFFT.auto_chunk"><code class="xref py py-meth docutils literal notranslate"><span class="pre">auto_chunk()</span></code></a>, <a class="reference internal" href="#pyxu.operator.linop.fft.nufft.NUFFT.diagnostic_plot" title="pyxu.operator.linop.fft.nufft.NUFFT.diagnostic_plot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">diagnostic_plot()</span></code></a>, <a class="reference internal" href="#pyxu.operator.linop.fft.nufft.NUFFT.stats" title="pyxu.operator.linop.fft.nufft.NUFFT.stats"><code class="xref py py-meth docutils literal notranslate"><span class="pre">stats()</span></code></a></p>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.operator.linop.fft.nufft.NUFFT.diagnostic_plot">
<span class="sig-name descname"><span class="pre">diagnostic_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domain</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/fft/nufft.html#NUFFT.diagnostic_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.fft.nufft.NUFFT.diagnostic_plot" title="Link to this definition">#</a></dt>
<dd><p>(Only applies to chunked type-3 transforms.)</p>
<p>Plot data + tesselation structure for diagnostic purposes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>domain</strong> (<code class="docutils literal notranslate"><span class="pre">'x'</span></code>, <code class="docutils literal notranslate"><span class="pre">'z'</span></code>) – Plot x-domain or z-domain data.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fig</strong> – Diagnostic plot.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://matplotlib.org/stable/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.7.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Figure</span></code></a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>This method can only be called after <a class="reference internal" href="#pyxu.operator.linop.fft.nufft.NUFFT.allocate" title="pyxu.operator.linop.fft.nufft.NUFFT.allocate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">allocate()</span></code></a>.</p></li>
<li><p>This method only works for 2D/3D domains.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/index.html#module-numpy" title="numpy"><span class="nn">numpy</span></a> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pyxu.operator</span> <span class="k">as</span> <span class="nn">pxo</span>

<span class="n">rng</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/random/generator.html#numpy.random.default_rng" title="numpy.random.default_rng"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span></a><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">D</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">200</span>
<span class="n">rnd_points</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="n">rng</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">D</span><span class="p">,)),</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">D</span><span class="p">))</span>
<span class="n">rnd_offset</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">rng</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">D</span><span class="p">,))</span>
<span class="n">scale</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">x</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.concatenate.html#numpy.concatenate" title="numpy.concatenate"><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span></a><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">rnd_points</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">+</span> <span class="n">rnd_offset</span><span class="p">()</span> <span class="o">*</span> <span class="n">scale</span><span class="p">,</span>
        <span class="n">rnd_points</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">+</span> <span class="n">rnd_offset</span><span class="p">()</span> <span class="o">*</span> <span class="n">scale</span><span class="p">,</span>
        <span class="n">rnd_points</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">+</span> <span class="n">rnd_offset</span><span class="p">()</span> <span class="o">*</span> <span class="n">scale</span><span class="p">,</span>
        <span class="n">rnd_points</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">+</span> <span class="n">rnd_offset</span><span class="p">()</span> <span class="o">*</span> <span class="n">scale</span><span class="p">,</span>
        <span class="n">rnd_points</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">+</span> <span class="n">rnd_offset</span><span class="p">()</span> <span class="o">*</span> <span class="n">scale</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.concatenate.html#numpy.concatenate" title="numpy.concatenate"><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span></a><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">rnd_points</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">+</span> <span class="n">rnd_offset</span><span class="p">()</span> <span class="o">*</span> <span class="n">scale</span><span class="p">,</span>
        <span class="n">rnd_points</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">+</span> <span class="n">rnd_offset</span><span class="p">()</span> <span class="o">*</span> <span class="n">scale</span><span class="p">,</span>
        <span class="n">rnd_points</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">+</span> <span class="n">rnd_offset</span><span class="p">()</span> <span class="o">*</span> <span class="n">scale</span><span class="p">,</span>
        <span class="n">rnd_points</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">+</span> <span class="n">rnd_offset</span><span class="p">()</span> <span class="o">*</span> <span class="n">scale</span><span class="p">,</span>
        <span class="n">rnd_points</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">+</span> <span class="n">rnd_offset</span><span class="p">()</span> <span class="o">*</span> <span class="n">scale</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">kwargs</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/stdtypes.html#dict" title="dict"><span class="nb">dict</span></a><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
    <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">,</span>
    <span class="n">isign</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">eps</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">A</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.linop.fft.nufft.NUFFT.type3" title="pyxu.operator.linop.fft.nufft.NUFFT.type3"><span class="n">pxo</span><span class="o">.</span><span class="n">NUFFT</span><span class="o">.</span><span class="n">type3</span></a><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">,</span> <span class="n">chunked</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">x_chunks</span><span class="p">,</span> <span class="n">z_chunks</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">auto_chunk</span><span class="p">(</span>
    <span class="n">max_mem</span><span class="o">=</span><span class="mf">.1</span><span class="p">,</span>
    <span class="n">max_anisotropy</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">A</span><span class="o">.</span><span class="n">allocate</span><span class="p">(</span><span class="n">x_chunks</span><span class="p">,</span> <span class="n">z_chunks</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">diagnostic_plot</span><span class="p">(</span><span class="s1">'x'</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../_downloads/d60813d4e69b6bcee2cab872f9762285/linop-2.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/cf5529db13896740795f2511b3b561c8/linop-2.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/ff0fa1f9542551d9d3aff87c6527e5bc/linop-2.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/852396df1c2a68b4ab13ea440094a13b/linop-2.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../../_images/linop-2.png" class="plot-directive" src="../../_images/linop-2.png"/>
</figure>
<p class="rubric">Notes</p>
<p>Requires <a class="reference external" href="https://matplotlib.org/">Matplotlib</a> to be installed.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.operator.linop.fft.nufft.NUFFT.stats">
<span class="sig-name descname"><span class="pre">stats</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/fft/nufft.html#NUFFT.stats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.fft.nufft.NUFFT.stats" title="Link to this definition">#</a></dt>
<dd><p>(Only applies to chunked type-3 transforms.)</p>
<p>Gather internal statistics about a chunked type-3 NUFFT.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p><strong>p</strong> – Statistics on the NUFFT chunks, with fields:</p>
<ul class="simple">
<li><dl class="simple">
<dt>blk_count: <a class="reference internal" href="../info.html#pyxu.info.ptype.Integer" title="pyxu.info.ptype.Integer"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Integer</span></code></a></dt><dd><p>Number of NUFFT chunks.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>dEval_count: <a class="reference internal" href="../info.html#pyxu.info.ptype.Integer" title="pyxu.info.ptype.Integer"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Integer</span></code></a></dt><dd><p>Number of chunks directly evaluated via the NUDFT.</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/collections.html#collections.namedtuple" title="(in Python v3.11)"><code class="xref py py-func docutils literal notranslate"><span class="pre">namedtuple()</span></code></a></p>
</dd>
</dl>
</dd></dl>
</dd></dl>
</section>
<section id="derivatives">
<h2><a class="toc-backref" href="#id45" role="doc-backlink">Derivatives</a><a class="headerlink" href="#derivatives" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyxu.operator.linop.diff.PartialDerivative">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PartialDerivative</span></span><a class="reference internal" href="../../_modules/pyxu/operator/linop/diff.html#PartialDerivative"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.diff.PartialDerivative" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Partial derivative operator based on <a class="reference external" href="https://numba.pydata.org/numba-doc/latest/user/stencil.html">Numba stencils</a>.</p>
<p class="rubric">Notes</p>
<ul>
<li><p>This operator approximates the partial derivative of a <span class="math notranslate nohighlight">\(D\)</span>-dimensional signal <span class="math notranslate nohighlight">\(\mathbf{f} \in
\mathbb{R}^{N_0 \times \cdots \times N_{D-1}}\)</span></p>
<div class="math notranslate nohighlight">
\[\frac{\partial^{n} \mathbf{f}}{\partial x_0^{n_0} \cdots \partial x_{D-1}^{n_{D-1}}} \in
\mathbb{R}^{N_0 \times \cdots \times N_{D-1}}\]</div>
<p>where <span class="math notranslate nohighlight">\(\frac{\partial^{n_i}}{\partial x_i^{n_i}}\)</span> is the <span class="math notranslate nohighlight">\(n_i\)</span>-th order partial derivative along
dimension <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(n = \prod_{i=0}^{D-1} n_{i}\)</span> is the total derivative order.</p>
<p>Partial derivatives can be implemented with <a class="reference external" href="https://en.wikipedia.org/wiki/Finite_difference">finite differences</a> via the
<a class="reference internal" href="#pyxu.operator.linop.diff.PartialDerivative.finite_difference" title="pyxu.operator.linop.diff.PartialDerivative.finite_difference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">finite_difference()</span></code></a> constructor, or with the <a class="reference external" href="https://www.crisluengo.net/archives/22/">Gaussian
derivative</a> via the
<a class="reference internal" href="#pyxu.operator.linop.diff.PartialDerivative.gaussian_derivative" title="pyxu.operator.linop.diff.PartialDerivative.gaussian_derivative"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gaussian_derivative()</span></code></a> constructor.</p>
</li>
<li><p>When using the <a class="reference internal" href="#pyxu.operator.linop.diff.PartialDerivative.finite_difference" title="pyxu.operator.linop.diff.PartialDerivative.finite_difference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">finite_difference()</span></code></a> constructor, the adjoint
of the resulting linear operator will vary depending on the type of finite differences:</p>
<ul>
<li><p>For <code class="docutils literal notranslate"><span class="pre">forward</span></code> type, the adjoint corresponds to:</p>
<p><span class="math notranslate nohighlight">\((\frac{\partial^{\text{fwd}}}{\partial x})^{\ast} = -\frac{\partial^{\text{bwd}}}{\partial x}\)</span></p>
</li>
<li><p>For <code class="docutils literal notranslate"><span class="pre">backward</span></code> type, the adjoint corresponds to:</p>
<p><span class="math notranslate nohighlight">\((\frac{\partial^{\text{bwd}}}{\partial x})^{\ast} = -\frac{\partial^{\text{fwd}}}{\partial x}\)</span></p>
</li>
<li><p>For <code class="docutils literal notranslate"><span class="pre">central</span></code> type, and for the <a class="reference internal" href="#pyxu.operator.linop.diff.PartialDerivative.gaussian_derivative" title="pyxu.operator.linop.diff.PartialDerivative.gaussian_derivative"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gaussian_derivative()</span></code></a>
constructor, the adjoint corresponds to:</p>
<p><span class="math notranslate nohighlight">\((\frac{\partial}{\partial x})^{\ast} = -\frac{\partial}{\partial x}\)</span></p>
</li>
</ul>
</li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When dealing with high-order partial derivatives, the stencils required to compute them can become large,
resulting in computationally expensive evaluations.
In such scenarios, it can be more efficient to construct the partial derivative through a composition of
lower-order partial derivatives.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyxu.operator.linop.diff.Gradient" title="pyxu.operator.linop.diff.Gradient"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gradient</span></code></a>, <a class="reference internal" href="#pyxu.operator.linop.diff.Laplacian" title="pyxu.operator.linop.diff.Laplacian"><code class="xref py py-class docutils literal notranslate"><span class="pre">Laplacian</span></code></a>, <a class="reference internal" href="#pyxu.operator.linop.diff.Hessian" title="pyxu.operator.linop.diff.Hessian"><code class="xref py py-class docutils literal notranslate"><span class="pre">Hessian</span></code></a></p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.operator.linop.diff.PartialDerivative.finite_difference">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">finite_difference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scheme</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'forward'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accuracy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gpu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/diff.html#PartialDerivative.finite_difference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.diff.PartialDerivative.finite_difference" title="Link to this definition">#</a></dt>
<dd><p>Compute partial derivatives for multi-dimensional signals using finite differences.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arg_shape</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.NDArrayShape" title="pyxu.info.ptype.NDArrayShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayShape</span></code></a>) – Shape of the input array.</p></li>
<li><p><strong>order</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list[Integer]</span></code>) – Derivative order for each dimension.
The total order of the partial derivative is the sum of the elements of the tuple.
Use zeros to indicate dimensions in which the derivative should not be computed.</p></li>
<li><p><strong>scheme</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[str]</span></code>) – Type of finite differences: [‘forward, ‘backward, ‘central’].
Defaults to ‘forward’.
If a string is provided, the same <code class="code docutils literal notranslate"><span class="pre">scheme</span></code> is assumed for all dimensions.
If a tuple is provided, it should have as many elements as <code class="code docutils literal notranslate"><span class="pre">order</span></code>.</p></li>
<li><p><strong>accuracy</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.Integer" title="pyxu.info.ptype.Integer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Integer</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[Integer]</span></code>) – Determines the number of points used to approximate the derivative with finite differences (see <code class="code docutils literal notranslate"><span class="pre">Notes</span></code>).
Defaults to 1.
If an int is provided, the same <code class="code docutils literal notranslate"><span class="pre">accuracy</span></code> is assumed for all dimensions.
If a tuple is provided, it should have as many elements as <code class="code docutils literal notranslate"><span class="pre">arg_shape</span></code>.</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[str]</span></code>) – <p>Boundary conditions.
Multiple forms are accepted:</p>
<ul>
<li><p>str: unique mode shared amongst dimensions.
Must be one of:</p>
<ul>
<li><p>’constant’ (default): zero-padding</p></li>
<li><p>’wrap’</p></li>
<li><p>’reflect’</p></li>
<li><p>’symmetric’</p></li>
<li><p>’edge’</p></li>
</ul>
</li>
<li><p>tuple[str, …]: the <code class="code docutils literal notranslate"><span class="pre">d</span></code>-th dimension uses <code class="docutils literal notranslate"><span class="pre">mode[d]</span></code> as boundary condition.</p></li>
</ul>
<p>(See <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.pad.html#numpy.pad" title="(in NumPy v1.25)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.pad()</span></code></a> for details.)</p>
</p></li>
<li><p><strong>gpu</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Input NDArray type (<code class="code docutils literal notranslate"><span class="pre">True</span></code> for GPU, <code class="code docutils literal notranslate"><span class="pre">False</span></code> for CPU).
Defaults to <code class="code docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>dtype</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.DType" title="pyxu.info.ptype.DType"><code class="xref py py-class docutils literal notranslate"><span class="pre">DType</span></code></a>) – Working precision of the linear operator.</p></li>
<li><p><strong>sampling</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-class docutils literal notranslate"><span class="pre">Real</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[Real]</span></code>) – Sampling step (i.e. distance between two consecutive elements of an array).
Defaults to 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>op</strong> – Partial derivative</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>We explain here finite differences for one-dimensional signals; this operator performs finite differences for
multi-dimensional signals along dimensions specified by <code class="code docutils literal notranslate"><span class="pre">order</span></code>.</p>
<p>This operator approximates derivatives with <a class="reference external" href="https://en.wikipedia.org/wiki/Finite_difference">finite differences</a>.
It is inspired by the <a class="reference external" href="https://web.media.mit.edu/~crtaylor/calculator.html">Finite Difference Coefficients Calculator</a> to construct finite-difference approximations for the
desired <em>(i)</em> derivative order, <em>(ii)</em> approximation accuracy, and <em>(iii)</em> finite difference type.
Three basic types of finite differences are supported, which lead to the following first-order (<code class="docutils literal notranslate"><span class="pre">order</span> <span class="pre">=</span> <span class="pre">1</span></code>)
operators with <code class="docutils literal notranslate"><span class="pre">accuracy</span> <span class="pre">=</span> <span class="pre">1</span></code> and sampling step <code class="docutils literal notranslate"><span class="pre">sampling</span> <span class="pre">=</span> <span class="pre">h</span></code> for one-dimensional signals:</p>
<ul>
<li><p><strong>Forward difference</strong>:
Approximates the continuous operator <span class="math notranslate nohighlight">\(D_{F}f(x) = \frac{f(x+h) - f(x)}{h}\)</span> with the discrete operator</p>
<div class="math notranslate nohighlight">
\[\mathbf{D}_{F} f [n] = \frac{f[n+1] - f[n]}{h},\]</div>
<p>whose kernel is <span class="math notranslate nohighlight">\(d = \frac{1}{h}[-1, 1]\)</span> and center is (0, ).</p>
</li>
<li><p><strong>Backward difference</strong>:
Approximates the continuous operator <span class="math notranslate nohighlight">\(D_{B}f(x) = \frac{f(x) - f(x-h)}{h}\)</span> with the discrete operator</p>
<div class="math notranslate nohighlight">
\[\mathbf{D}_{B} f [n] = \frac{f[n] - f[n-1]}{h},\]</div>
<p>whose kernel is <span class="math notranslate nohighlight">\(d = \frac{1}{h}[-1, 1]\)</span> and center is (1, ).</p>
</li>
<li><p><strong>Central difference</strong>:
Approximates the continuous operator <span class="math notranslate nohighlight">\(D_{C}f(x) = \frac{f(x+h) - f(x-h)}{2h}\)</span> with the discrete operator</p>
<div class="math notranslate nohighlight">
\[\mathbf{D}_{C} f [n] = \frac{f[n+1] - f[n-1]}{2h},\]</div>
<p>whose kernel is <span class="math notranslate nohighlight">\(d = \frac{1}{h}[-\frac12, 0, \frac12]\)</span> and center is (1, ).</p>
</li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>For forward and backward differences, higher-order operators correspond to the composition of first-order
operators.
This is not the case for central differences: the second-order continuous operator is given by
<span class="math notranslate nohighlight">\(D^2_{C}f(x) = \frac{f(x+h) - 2 f(x) + f(x-h)}{h}\)</span>, hence <span class="math notranslate nohighlight">\(D^2_{C} \neq D_{C} \circ D_{C}\)</span>.
The corresponding discrete operator is given by <span class="math notranslate nohighlight">\(\mathbf{D}^2_{C} f [n] = \frac{f[n+1] - 2 f[n] +
f[n-1]}{h}\)</span>, whose kernel is <span class="math notranslate nohighlight">\(d = \frac{1}{h}[1, -2, 1]\)</span> and center is (1, ).
We refer to <a class="reference external" href="https://www.ams.org/journals/mcom/1988-51-184/S0025-5718-1988-0935077-0/S0025-5718-1988-0935077-0.pdf">this paper</a> for
more details.</p>
</div>
<p>For a given derivative order <span class="math notranslate nohighlight">\(N\in\mathbb{Z}^{+}\)</span> and accuracy <span class="math notranslate nohighlight">\(a\in\mathbb{Z}^{+}\)</span>, the size
<span class="math notranslate nohighlight">\(N_s\)</span> of the stencil kernel <span class="math notranslate nohighlight">\(d\)</span> used for finite differences is given by:</p>
<ul class="simple">
<li><p>For central differences: <span class="math notranslate nohighlight">\(N_s = 2 \lfloor\frac{N + 1}{2}\rfloor - 1 + a\)</span></p></li>
<li><p>For forward and backward differences: <span class="math notranslate nohighlight">\(N_s = N + a\)</span></p></li>
</ul>
<p>For <span class="math notranslate nohighlight">\(N_s\)</span> given support indices <span class="math notranslate nohighlight">\(\{s_1, \ldots , s_{N_s} \} \subset \mathbb{Z}\)</span> and a derivative
order <span class="math notranslate nohighlight">\(N&lt;N_s\)</span>, the stencil kernel <span class="math notranslate nohighlight">\(d = [d_1, \ldots, d_{N_s}]\)</span> of the finite-difference
approximation of the derivative is obtained by solving the following system of linear equations (see the <a class="reference external" href="https://web.media.mit.edu/~crtaylor/calculator.html">Finite
Difference Coefficients Calculator</a> documentation):</p>
<div class="admonition-remark admonition">
<p class="admonition-title">Remark</p>
<p>The number of coefficients of the finite-difference kernel is chosen to guarantee the requested accuracy, but
might be larger than requested accuracy.
For example, if choosing <code class="code docutils literal notranslate"><span class="pre">scheme='central'</span></code> with <code class="code docutils literal notranslate"><span class="pre">accuracy=1</span></code>, it will create a kernel corresponding to
<code class="code docutils literal notranslate"><span class="pre">accuracy=2</span></code>, as it is the minimum accuracy possible for such scheme (see the <a class="reference external" href="https://en.wikipedia.org/wiki/Finite_difference_coefficient">finite difference coefficient
table</a>).</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left(\begin{array}{ccc}
s_{1}^{0} &amp; \cdots &amp; s_{N_s}^{0} \\
\vdots &amp; \ddots &amp; \vdots \\
s_{1}^{N_s-1} &amp; \cdots &amp; s_{N_s}^{N_s-1}
\end{array}\right)\left(\begin{array}{c}
d_{1} \\
\vdots \\
d_{N_s}
\end{array}\right)= \frac{1}{h^{N}}\left(\begin{array}{c}
\delta_{0, N} \\
\vdots \\
\delta_{i, N} \\
\vdots \\
\delta_{N_s-1, N}
\end{array}\right),\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\delta_{i, j}\)</span> is the Kronecker delta.</p>
</div>
<p>This class inherits its methods from <a class="reference internal" href="#pyxu.operator.linop.stencil.stencil.Stencil" title="pyxu.operator.linop.stencil.stencil.Stencil"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stencil</span></code></a>.</p>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/index.html#module-numpy" title="numpy"><span class="nn">numpy</span></a> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/pyplot_summary.html#module-matplotlib.pyplot" title="matplotlib.pyplot"><span class="nn">matplotlib.pyplot</span></a> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">pyxu.operator</span> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.linop.diff.PartialDerivative" title="pyxu.operator.linop.diff.PartialDerivative"><span class="n">PartialDerivative</span></a>
<span class="kn">from</span> <a class="sphinx-codeautolink-a" href="../../api/util.html#module-pyxu.util.misc" title="pyxu.util.misc"><span class="nn">pyxu.util.misc</span></a> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/util.html#pyxu.util.misc.peaks" title="pyxu.util.misc.peaks"><span class="n">peaks</span></a>

<span class="n">x</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.linspace.html#numpy.linspace" title="numpy.linspace"><span class="n">np</span><span class="o">.</span><span class="n">linspace</span></a><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
<span class="n">xx</span><span class="p">,</span> <span class="n">yy</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.meshgrid.html#numpy.meshgrid" title="numpy.meshgrid"><span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span></a><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">image</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/util.html#pyxu.util.misc.peaks" title="pyxu.util.misc.peaks"><span class="n">peaks</span></a><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">)</span>
<span class="n">arg_shape</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># Shape of our image</span>
<span class="c1"># Specify derivative order at each direction</span>
<span class="n">df_dx</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># Compute derivative of order 1 in first dimension</span>
<span class="n">d2f_dy2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># Compute derivative of order 2 in second dimension</span>
<span class="n">d3f_dxdy2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># Compute derivative of order 1 in first dimension and der. of order 2 in second dimension</span>
<span class="c1"># Instantiate derivative operators</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="n">diff1</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.linop.diff.PartialDerivative.gaussian_derivative" title="pyxu.operator.linop.diff.PartialDerivative.gaussian_derivative"><span class="n">PartialDerivative</span><span class="o">.</span><span class="n">gaussian_derivative</span></a><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="n">df_dx</span><span class="p">,</span> <span class="n">arg_shape</span><span class="o">=</span><span class="n">arg_shape</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span> <span class="o">/</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.sqrt.html#numpy.sqrt" title="numpy.sqrt"><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span></a><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="n">diff2</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.linop.diff.PartialDerivative.gaussian_derivative" title="pyxu.operator.linop.diff.PartialDerivative.gaussian_derivative"><span class="n">PartialDerivative</span><span class="o">.</span><span class="n">gaussian_derivative</span></a><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="n">d2f_dy2</span><span class="p">,</span> <span class="n">arg_shape</span><span class="o">=</span><span class="n">arg_shape</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span> <span class="o">/</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.sqrt.html#numpy.sqrt" title="numpy.sqrt"><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span></a><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="n">diff</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.linop.diff.PartialDerivative.gaussian_derivative" title="pyxu.operator.linop.diff.PartialDerivative.gaussian_derivative"><span class="n">PartialDerivative</span><span class="o">.</span><span class="n">gaussian_derivative</span></a><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="n">d3f_dxdy2</span><span class="p">,</span> <span class="n">arg_shape</span><span class="o">=</span><span class="n">arg_shape</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">)</span>
<span class="c1"># Compute derivatives</span>
<span class="n">out1</span> <span class="o">=</span> <span class="p">(</span><span class="n">diff1</span> <span class="o">*</span> <span class="n">diff2</span><span class="p">)(</span><span class="n">image</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">arg_shape</span><span class="p">)</span>
<span class="n">out2</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">arg_shape</span><span class="p">)</span>
<span class="c1"># Plot derivatives</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots" title="matplotlib.pyplot.subplots"><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span></a><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">"off"</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"f(x,y)"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">out1</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">"off"</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$\frac{\partial^</span><span class="si">{3}</span><span class="s2"> f(x,y)}{\partial x\partial y^</span><span class="si">{2}</span><span class="s2">}$"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">out2</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">"off"</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$\frac{\partial^</span><span class="si">{3}</span><span class="s2"> f(x,y)}{\partial x\partial y^</span><span class="si">{2}</span><span class="s2">}$"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

<span class="c1"># Test approximation error</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.imshow.html#matplotlib.pyplot.imshow" title="matplotlib.pyplot.imshow"><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span></a><span class="p">(</span><a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#abs" title="abs"><span class="nb">abs</span></a><span class="p">(</span><span class="n">out1</span> <span class="o">-</span> <span class="n">out2</span><span class="p">)</span> <span class="o">/</span> <a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#abs" title="abs"><span class="nb">abs</span></a><span class="p">(</span><span class="n">out2</span><span class="p">)),</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../_downloads/13d4155c4f8b2570495858ee4ff14c77/linop-3.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>)</p>
<figure class="align-default" id="id28">
<img alt="../../_images/linop-3_00.png" class="plot-directive" src="../../_images/linop-3_00.png"/>
<figcaption>
<p><span class="caption-text">(<a class="reference download internal" download="" href="../../_downloads/a65f90bcbe154b20bfa66b70ccf8657f/linop-3_00.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/80addee3e5ddf78f60a7c11d664bee28/linop-3_00.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/0e4825835a3d6d1b8ed46f992d78d573/linop-3_00.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</span><a class="headerlink" href="#id28" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id29">
<img alt="../../_images/linop-3_01.png" class="plot-directive" src="../../_images/linop-3_01.png"/>
<figcaption>
<p><span class="caption-text">(<a class="reference download internal" download="" href="../../_downloads/8b1f3ad99310d672760460d94ff5ae53/linop-3_01.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/7f7cb23a315a631d79c8a7353eb5e5ea/linop-3_01.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/beadf23da07c5206cde021558c7f49fa/linop-3_01.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</span><a class="headerlink" href="#id29" title="Link to this image">#</a></p>
</figcaption>
</figure>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.operator.linop.diff.PartialDerivative.gaussian_derivative">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">gaussian_derivative</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">truncate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gpu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/diff.html#PartialDerivative.gaussian_derivative"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.diff.PartialDerivative.gaussian_derivative" title="Link to this definition">#</a></dt>
<dd><p>Compute partial derivatives for multi-dimensional signals using gaussian derivatives.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arg_shape</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.NDArrayShape" title="pyxu.info.ptype.NDArrayShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayShape</span></code></a>) – Shape of the input array.</p></li>
<li><p><strong>order</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list[Integer]</span></code>) – Derivative order for each dimension.
The total order of the partial derivative is the sum of the elements of the tuple.
Use zeros to indicate dimensions in which the derivative should not be computed.</p></li>
<li><p><strong>sigma</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-class docutils literal notranslate"><span class="pre">Real</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[Real]</span></code>) – Standard deviation for the Gaussian kernel.
Defaults to 1.0.
If a float is provided, the same <code class="code docutils literal notranslate"><span class="pre">sigma</span></code> is assumed for all dimensions.
If a tuple is provided, it should have as many elements as <code class="code docutils literal notranslate"><span class="pre">order</span></code>.</p></li>
<li><p><strong>truncate</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-class docutils literal notranslate"><span class="pre">Real</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[Real]</span></code>) – Truncate the filter at this many standard deviations (at each side from the origin).
Defaults to 3.0.
If a float is provided, the same <code class="code docutils literal notranslate"><span class="pre">truncate</span></code> is assumed for all dimensions.
If a tuple is provided, it should have as many elements as <code class="code docutils literal notranslate"><span class="pre">order</span></code>.</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[str]</span></code>) – <p>Boundary conditions.
Multiple forms are accepted:</p>
<ul>
<li><p>str: unique mode shared amongst dimensions.
Must be one of:</p>
<ul>
<li><p>’constant’ (default): zero-padding</p></li>
<li><p>’wrap’</p></li>
<li><p>’reflect’</p></li>
<li><p>’symmetric’</p></li>
<li><p>’edge’</p></li>
</ul>
</li>
<li><p>tuple[str, …]: the <code class="code docutils literal notranslate"><span class="pre">d</span></code>-th dimension uses <code class="docutils literal notranslate"><span class="pre">mode[d]</span></code> as boundary condition.</p></li>
</ul>
<p>(See <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.pad.html#numpy.pad" title="(in NumPy v1.25)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.pad()</span></code></a> for details.)</p>
</p></li>
<li><p><strong>gpu</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Input NDArray type (<code class="code docutils literal notranslate"><span class="pre">True</span></code> for GPU, <code class="code docutils literal notranslate"><span class="pre">False</span></code> for CPU).
Defaults to <code class="code docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>dtype</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.DType" title="pyxu.info.ptype.DType"><code class="xref py py-class docutils literal notranslate"><span class="pre">DType</span></code></a>) – Working precision of the linear operator.</p></li>
<li><p><strong>sampling</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-class docutils literal notranslate"><span class="pre">Real</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[Real]</span></code>) – Sampling step (i.e., the distance between two consecutive elements of an array).
Defaults to 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>op</strong> – Partial derivative.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>We explain here Gaussian derivatives for one-dimensional signals; this operator performs partial Gaussian
derivatives for multi-dimensional signals along dimensions specified by <code class="docutils literal notranslate"><span class="pre">order</span></code>.</p>
<p>A Gaussian derivative is an approximation of a derivative that consists in convolving the input function with a
Gaussian function <span class="math notranslate nohighlight">\(g\)</span> before applying a derivative.
In the continuous domain, the <span class="math notranslate nohighlight">\(N\)</span>-th order Gaussian derivative <span class="math notranslate nohighlight">\(D^N_G\)</span> amounts to a convolution with
the <span class="math notranslate nohighlight">\(N\)</span>-th order derivative of <span class="math notranslate nohighlight">\(g\)</span>:</p>
<div class="math notranslate nohighlight">
\[D^N_G f (x)
=
\frac{\mathrm{d}^N (f * g) }{\mathrm{d} x^N} (x)
=
f(x) * \frac{\mathrm{d}^N g}{\mathrm{d} x^N} (x).\]</div>
<p>For discrete signals <span class="math notranslate nohighlight">\(f[n]\)</span>, this operator is approximated by</p>
<div class="math notranslate nohighlight">
\[\mathbf{D}^N_G f [n]
=
f[n] *\frac{\mathrm{d}^N g}{\mathrm{d} x^N} \left(\frac{n}{h}\right),\]</div>
<p>where <span class="math notranslate nohighlight">\(h\)</span> is the spacing between samples and the operator <span class="math notranslate nohighlight">\(*\)</span> is now a discrete convolution.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The operator <span class="math notranslate nohighlight">\(\mathbf{D}_{G} \circ \mathbf{D}_{G}\)</span> is not directly related to
<span class="math notranslate nohighlight">\(\mathbf{D}_{G}^{2}\)</span>: Gaussian smoothing is performed twice in the case of the former, whereas it is
performed only once in the case of the latter.</p>
</div>
<p>Note that in contrast with finite differences (see
<a class="reference internal" href="#pyxu.operator.linop.diff.PartialDerivative.finite_difference" title="pyxu.operator.linop.diff.PartialDerivative.finite_difference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">finite_difference()</span></code></a>), Gaussian derivatives compute exact
derivatives in the continuous domain, since Gaussians can be differentiated analytically.
This derivative is then sampled in order to perform a discrete convolution.</p>
<p>This class inherits its methods from <a class="reference internal" href="#pyxu.operator.linop.stencil.stencil.Stencil" title="pyxu.operator.linop.stencil.stencil.Stencil"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stencil</span></code></a>.</p>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/index.html#module-numpy" title="numpy"><span class="nn">numpy</span></a> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/pyplot_summary.html#module-matplotlib.pyplot" title="matplotlib.pyplot"><span class="nn">matplotlib.pyplot</span></a> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">pyxu.operator</span> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.linop.diff.PartialDerivative" title="pyxu.operator.linop.diff.PartialDerivative"><span class="n">PartialDerivative</span></a>
<span class="kn">from</span> <a class="sphinx-codeautolink-a" href="../../api/util.html#module-pyxu.util.misc" title="pyxu.util.misc"><span class="nn">pyxu.util.misc</span></a> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/util.html#pyxu.util.misc.peaks" title="pyxu.util.misc.peaks"><span class="n">peaks</span></a>
<span class="n">x</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.linspace.html#numpy.linspace" title="numpy.linspace"><span class="n">np</span><span class="o">.</span><span class="n">linspace</span></a><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
<span class="n">xx</span><span class="p">,</span> <span class="n">yy</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.meshgrid.html#numpy.meshgrid" title="numpy.meshgrid"><span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span></a><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">image</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/util.html#pyxu.util.misc.peaks" title="pyxu.util.misc.peaks"><span class="n">peaks</span></a><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">)</span>
<span class="n">arg_shape</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># Shape of our image</span>
<span class="c1"># Specify derivative order at each direction</span>
<span class="n">df_dx</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="c1"># Compute derivative of order 1 in first dimension</span>
<span class="n">d2f_dy2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="c1"># Compute derivative of order 2 in second dimension</span>
<span class="n">d3f_dxdy2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="c1"># Compute derivative of order 1 in first dimension and der. of order 2 in second dimension</span>
<span class="c1"># Instantiate derivative operators</span>
<span class="n">diff1</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.linop.diff.PartialDerivative.gaussian_derivative" title="pyxu.operator.linop.diff.PartialDerivative.gaussian_derivative"><span class="n">PartialDerivative</span><span class="o">.</span><span class="n">gaussian_derivative</span></a><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="n">df_dx</span><span class="p">,</span> <span class="n">arg_shape</span><span class="o">=</span><span class="n">arg_shape</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
<span class="n">diff2</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.linop.diff.PartialDerivative.gaussian_derivative" title="pyxu.operator.linop.diff.PartialDerivative.gaussian_derivative"><span class="n">PartialDerivative</span><span class="o">.</span><span class="n">gaussian_derivative</span></a><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="n">d2f_dy2</span><span class="p">,</span> <span class="n">arg_shape</span><span class="o">=</span><span class="n">arg_shape</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
<span class="n">diff</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.linop.diff.PartialDerivative.gaussian_derivative" title="pyxu.operator.linop.diff.PartialDerivative.gaussian_derivative"><span class="n">PartialDerivative</span><span class="o">.</span><span class="n">gaussian_derivative</span></a><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="n">d3f_dxdy2</span><span class="p">,</span> <span class="n">arg_shape</span><span class="o">=</span><span class="n">arg_shape</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
<span class="c1"># Compute derivatives</span>
<span class="n">out1</span> <span class="o">=</span> <span class="p">(</span><span class="n">diff1</span> <span class="o">*</span> <span class="n">diff2</span><span class="p">)(</span><span class="n">image</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">arg_shape</span><span class="p">)</span>
<span class="n">out2</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">arg_shape</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.imshow.html#matplotlib.pyplot.imshow" title="matplotlib.pyplot.imshow"><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span></a><span class="p">(</span><span class="n">image</span><span class="p">),</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.axis.html#matplotlib.pyplot.axis" title="matplotlib.pyplot.axis"><span class="n">plt</span><span class="o">.</span><span class="n">axis</span></a><span class="p">(</span><span class="s1">'off'</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">()</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="s1">'f(x,y)'</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.imshow.html#matplotlib.pyplot.imshow" title="matplotlib.pyplot.imshow"><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span></a><span class="p">(</span><span class="n">out1</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.axis.html#matplotlib.pyplot.axis" title="matplotlib.pyplot.axis"><span class="n">plt</span><span class="o">.</span><span class="n">axis</span></a><span class="p">(</span><span class="s1">'off'</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="sa">r</span><span class="s1">'$\frac{\partial^</span><span class="si">{3}</span><span class="s1"> f(x,y)}{\partial x\partial y^</span><span class="si">{2}</span><span class="s1">}$'</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.imshow.html#matplotlib.pyplot.imshow" title="matplotlib.pyplot.imshow"><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span></a><span class="p">(</span><span class="n">out2</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.axis.html#matplotlib.pyplot.axis" title="matplotlib.pyplot.axis"><span class="n">plt</span><span class="o">.</span><span class="n">axis</span></a><span class="p">(</span><span class="s1">'off'</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="sa">r</span><span class="s1">'$\frac{\partial^</span><span class="si">{3}</span><span class="s1"> f(x,y)}{\partial x\partial y^</span><span class="si">{2}</span><span class="s1">}$'</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../_downloads/b2cf59b0745316197a94be979d5ca5c1/linop-4.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>)</p>
<figure class="align-default" id="id30">
<img alt="../../_images/linop-4_00.png" class="plot-directive" src="../../_images/linop-4_00.png"/>
<figcaption>
<p><span class="caption-text">(<a class="reference download internal" download="" href="../../_downloads/c935bd338de06e762ff0060037d2bdbf/linop-4_00.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/7c525dffe55156065be00ab7ed0fdbc9/linop-4_00.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/bf001791fa8cc4ac5b9c6369e6c26d9b/linop-4_00.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</span><a class="headerlink" href="#id30" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id31">
<img alt="../../_images/linop-4_01.png" class="plot-directive" src="../../_images/linop-4_01.png"/>
<figcaption>
<p><span class="caption-text">(<a class="reference download internal" download="" href="../../_downloads/65a0f0ae34645fbd8fc9c45aa8707cb6/linop-4_01.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/398290731e77c5555d2871cb9b024a36/linop-4_01.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/01d31b53f3906f9c7594bb738943953e/linop-4_01.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</span><a class="headerlink" href="#id31" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id32">
<img alt="../../_images/linop-4_02.png" class="plot-directive" src="../../_images/linop-4_02.png"/>
<figcaption>
<p><span class="caption-text">(<a class="reference download internal" download="" href="../../_downloads/4cc16af0bb9cf504a115b5d05f3dbec2/linop-4_02.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/dbc64e26ca6edbd26084bb910e4ff9f7/linop-4_02.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/dc98e14e812e6f847c4fbabc802e630d/linop-4_02.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</span><a class="headerlink" href="#id32" title="Link to this image">#</a></p>
</figcaption>
</figure>
</dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.operator.linop.diff.Gradient">
<span class="sig-name descname"><span class="pre">Gradient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diff_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fd'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gpu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">diff_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/diff.html#Gradient"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.diff.Gradient" title="Link to this definition">#</a></dt>
<dd><p>Gradient operator.</p>
<p class="rubric">Notes</p>
<p>This operator stacks the first-order partial derivatives of a <span class="math notranslate nohighlight">\(D\)</span>-dimensional signal <span class="math notranslate nohighlight">\(\mathbf{f} \in
\mathbb{R}^{N_{0} \times \cdots \times N_{D-1}}\)</span> along each dimension:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\boldsymbol{\nabla} \mathbf{f} = \begin{bmatrix}
\frac{\partial \mathbf{f}}{\partial x_0} \\
\vdots \\
\frac{\partial \mathbf{f}}{\partial x_{D-1}}
\end{bmatrix} \in \mathbb{R}^{D \times N_{0} \times \cdots \times N_{D-1}}\end{split}\]</div>
<p>The partial derivatives can be approximated by <a class="reference external" href="https://en.wikipedia.org/wiki/Finite_difference">finite differences</a> via the
<a class="reference internal" href="#pyxu.operator.linop.diff.PartialDerivative.finite_difference" title="pyxu.operator.linop.diff.PartialDerivative.finite_difference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">finite_difference()</span></code></a> constructor or by the <a class="reference external" href="https://www.crisluengo.net/archives/22/">Gaussian derivative</a> via
<a class="reference internal" href="#pyxu.operator.linop.diff.PartialDerivative.gaussian_derivative" title="pyxu.operator.linop.diff.PartialDerivative.gaussian_derivative"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gaussian_derivative()</span></code></a> constructor.
The parametrization of the partial derivatives can be done via the keyword arguments <code class="code docutils literal notranslate"><span class="pre">**diff_kwargs</span></code>, which will
default to the same values as the <a class="reference internal" href="#pyxu.operator.linop.diff.PartialDerivative" title="pyxu.operator.linop.diff.PartialDerivative"><code class="xref py py-class docutils literal notranslate"><span class="pre">PartialDerivative</span></code></a> constructor.</p>
<p>The gradient operator’s method <code class="xref py py-meth docutils literal notranslate"><span class="pre">unravel()</span></code> allows reshaping the vectorized
output gradient to <code class="docutils literal notranslate"><span class="pre">[n_dirs,</span> <span class="pre">N0,</span> <span class="pre">...,</span> <span class="pre">ND]</span></code> (see the example below).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arg_shape</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.NDArrayShape" title="pyxu.info.ptype.NDArrayShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayShape</span></code></a>) – Shape of the input array.</p></li>
<li><p><strong>directions</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.Integer" title="pyxu.info.ptype.Integer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Integer</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[Integer]</span></code>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>) – Gradient directions.
Defaults to <code class="code docutils literal notranslate"><span class="pre">None</span></code>, which computes the gradient for all directions.</p></li>
<li><p><strong>diff_method</strong> (<code class="docutils literal notranslate"><span class="pre">'gd'</span></code>, <code class="docutils literal notranslate"><span class="pre">'fd'</span></code>) – <p>Method used to approximate the derivative.
Must be one of:</p>
<ul>
<li><p>’fd’ (default): finite differences</p></li>
<li><p>’gd’: Gaussian derivative</p></li>
</ul>
</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[str]</span></code>) – <p>Boundary conditions.
Multiple forms are accepted:</p>
<ul>
<li><p>str: unique mode shared amongst dimensions.
Must be one of:</p>
<ul>
<li><p>’constant’ (default): zero-padding</p></li>
<li><p>’wrap’</p></li>
<li><p>’reflect’</p></li>
<li><p>’symmetric’</p></li>
<li><p>’edge’</p></li>
</ul>
</li>
<li><p>tuple[str, …]: the <code class="code docutils literal notranslate"><span class="pre">d</span></code>-th dimension uses <code class="docutils literal notranslate"><span class="pre">mode[d]</span></code> as boundary condition.</p></li>
</ul>
<p>(See <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.pad.html#numpy.pad" title="(in NumPy v1.25)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.pad()</span></code></a> for details.)</p>
</p></li>
<li><p><strong>gpu</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Input NDArray type (<code class="code docutils literal notranslate"><span class="pre">True</span></code> for GPU, <code class="code docutils literal notranslate"><span class="pre">False</span></code> for CPU).
Defaults to <code class="code docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>dtype</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.DType" title="pyxu.info.ptype.DType"><code class="xref py py-class docutils literal notranslate"><span class="pre">DType</span></code></a>) – Working precision of the linear operator.</p></li>
<li><p><strong>parallel</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, use Dask to evaluate the different partial derivatives in parallel.</p></li>
<li><p><strong>diff_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>) – Keyword arguments to parametrize partial derivatives (see
<a class="reference internal" href="#pyxu.operator.linop.diff.PartialDerivative.finite_difference" title="pyxu.operator.linop.diff.PartialDerivative.finite_difference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">finite_difference()</span></code></a> and
<a class="reference internal" href="#pyxu.operator.linop.diff.PartialDerivative.gaussian_derivative" title="pyxu.operator.linop.diff.PartialDerivative.gaussian_derivative"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gaussian_derivative()</span></code></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>op</strong> – Gradient</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/index.html#module-numpy" title="numpy"><span class="nn">numpy</span></a> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/pyplot_summary.html#module-matplotlib.pyplot" title="matplotlib.pyplot"><span class="nn">matplotlib.pyplot</span></a> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">pyxu.operator</span> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.linop.diff.Gradient" title="pyxu.operator.linop.diff.Gradient"><span class="n">Gradient</span></a>
<span class="kn">from</span> <a class="sphinx-codeautolink-a" href="../../api/util.html#module-pyxu.util.misc" title="pyxu.util.misc"><span class="nn">pyxu.util.misc</span></a> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/util.html#pyxu.util.misc.peaks" title="pyxu.util.misc.peaks"><span class="n">peaks</span></a>

<span class="c1"># Define input image</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">x</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.linspace.html#numpy.linspace" title="numpy.linspace"><span class="n">np</span><span class="o">.</span><span class="n">linspace</span></a><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">xx</span><span class="p">,</span> <span class="n">yy</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.meshgrid.html#numpy.meshgrid" title="numpy.meshgrid"><span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span></a><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">image</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/util.html#pyxu.util.misc.peaks" title="pyxu.util.misc.peaks"><span class="n">peaks</span></a><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">)</span>
<span class="n">arg_shape</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># (1000, 1000)</span>
<span class="c1"># Instantiate gradient operator</span>
<span class="n">grad</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.linop.diff.Gradient" title="pyxu.operator.linop.diff.Gradient"><span class="n">Gradient</span></a><span class="p">(</span><span class="n">arg_shape</span><span class="o">=</span><span class="n">arg_shape</span><span class="p">)</span>

<span class="c1"># Compute gradients</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">grad</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span> <span class="c1"># shape = (2000000, )</span>
<span class="n">df_dx</span><span class="p">,</span> <span class="n">df_dy</span> <span class="o">=</span> <span class="n">grad</span><span class="o">.</span><span class="n">unravel</span><span class="p">(</span><span class="n">output</span><span class="p">)</span> <span class="c1"># shape = (2, 1000, 1000)</span>

<span class="c1"># Plot image</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots" title="matplotlib.pyplot.subplots"><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span></a><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"Image"</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">"off"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># Plot gradient</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">df_dx</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$\partial f/ \partial x$"</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">"off"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">df_dy</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$\partial f/ \partial y$"</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">"off"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../_downloads/c5957e5510f7a3e008be152d620d9cd0/linop-5.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/a46945b9ac28103cc2ae27158e140ffb/linop-5.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/48e4fd6bd0ff07d32c9663e17e75135d/linop-5.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/09b83b84e67dd3bf3bfa9889ef5464d2/linop-5.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../../_images/linop-5.png" class="plot-directive" src="../../_images/linop-5.png"/>
</figure>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyxu.operator.linop.diff.PartialDerivative" title="pyxu.operator.linop.diff.PartialDerivative"><code class="xref py py-func docutils literal notranslate"><span class="pre">PartialDerivative()</span></code></a>, <a class="reference internal" href="#pyxu.operator.linop.diff.Jacobian" title="pyxu.operator.linop.diff.Jacobian"><code class="xref py py-func docutils literal notranslate"><span class="pre">Jacobian()</span></code></a></p>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.operator.linop.diff.Jacobian">
<span class="sig-name descname"><span class="pre">Jacobian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diff_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fd'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gpu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">diff_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/diff.html#Jacobian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.diff.Jacobian" title="Link to this definition">#</a></dt>
<dd><p>Jacobian operator.</p>
<p class="rubric">Notes</p>
<p>This operator computes the first-order partial derivatives of a <span class="math notranslate nohighlight">\(D\)</span>-dimensional vector-valued signal of
<span class="math notranslate nohighlight">\(C\)</span> variables or channels <span class="math notranslate nohighlight">\(\mathbf{f} = [\mathbf{f}_{0}, \ldots, \mathbf{f}_{C-1}]\)</span> with
<span class="math notranslate nohighlight">\(\mathbf{f}_{c} \in \mathbb{R}^{N_{0} \times \cdots \times N_{D-1}}\)</span>.</p>
<p>The Jacobian of <span class="math notranslate nohighlight">\(\mathbf{f}\)</span> is computed via the gradient as follows:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{J} \mathbf{f} = \begin{bmatrix}
(\boldsymbol{\nabla} \mathbf{f}_{0})^{\top} \\
\vdots \\
(\boldsymbol{\nabla} \mathbf{f}_{C-1})^{\top} \\
\end{bmatrix} \in \mathbb{R}^{C \times D \times N_0 \times \cdots \times N_{D-1}}\end{split}\]</div>
<p>The partial derivatives can be approximated by <a class="reference external" href="https://en.wikipedia.org/wiki/Finite_difference">finite differences</a> via the
<a class="reference internal" href="#pyxu.operator.linop.diff.PartialDerivative.finite_difference" title="pyxu.operator.linop.diff.PartialDerivative.finite_difference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">finite_difference()</span></code></a> constructor or by the <a class="reference external" href="https://www.crisluengo.net/archives/22/">Gaussian derivative</a> via
<a class="reference internal" href="#pyxu.operator.linop.diff.PartialDerivative.gaussian_derivative" title="pyxu.operator.linop.diff.PartialDerivative.gaussian_derivative"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gaussian_derivative()</span></code></a> constructor.
The parametrization of the partial derivatives can be done via the keyword arguments <code class="code docutils literal notranslate"><span class="pre">**diff_kwargs</span></code>, which will
default to the same values as the <a class="reference internal" href="#pyxu.operator.linop.diff.PartialDerivative" title="pyxu.operator.linop.diff.PartialDerivative"><code class="xref py py-class docutils literal notranslate"><span class="pre">PartialDerivative</span></code></a> constructor.</p>
<p>The Jacobian operator’s method <code class="xref py py-meth docutils literal notranslate"><span class="pre">unravel()</span></code> allows reshaping the vectorized
output Jacobian to <code class="docutils literal notranslate"><span class="pre">[...,</span> <span class="pre">n_channels,</span> <span class="pre">n_dirs,</span> <span class="pre">N0,</span> <span class="pre">...,</span> <span class="pre">ND]</span></code> (see the example below).</p>
<p><strong>Remark</strong></p>
<p>Pyxu’s convention when it comes to field-vectors, is to work with vectorized arrays.  However, the memory order of
these arrays before raveling should be <code class="code docutils literal notranslate"><span class="pre">[S_0,</span> <span class="pre">...,</span> <span class="pre">S_D,</span> <span class="pre">C,</span> <span class="pre">N]</span></code> shape, with <code class="code docutils literal notranslate"><span class="pre">S_0,</span> <span class="pre">...,</span> <span class="pre">S_D</span></code> being stacking
dimensions, <code class="code docutils literal notranslate"><span class="pre">C</span></code> being the number of variables or channels, and <code class="code docutils literal notranslate"><span class="pre">N</span></code> being the size of the domain (for example, <code class="code docutils literal notranslate"><span class="pre">N</span> <span class="pre">=</span>
<span class="pre">npixels_x</span> <span class="pre">*</span> <span class="pre">npixels_y</span></code> for a 2D image).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arg_shape</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.NDArrayShape" title="pyxu.info.ptype.NDArrayShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayShape</span></code></a>) – Shape of the input array.</p></li>
<li><p><strong>n_channels</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.Integer" title="pyxu.info.ptype.Integer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Integer</span></code></a>) – Number of channels or variables of the input vector-valued signal.
The Jacobian with <code class="code docutils literal notranslate"><span class="pre">n_channels==1</span></code> yields the gradient.</p></li>
<li><p><strong>directions</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.Integer" title="pyxu.info.ptype.Integer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Integer</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[Integer]</span></code>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>) – Gradient directions.
Defaults to <code class="code docutils literal notranslate"><span class="pre">None</span></code>, which computes the gradient for all directions.</p></li>
<li><p><strong>diff_method</strong> (<code class="docutils literal notranslate"><span class="pre">"gd"</span></code>, <code class="docutils literal notranslate"><span class="pre">"fd"</span></code>) – <p>Method used to approximate the derivative.
Must be one of:</p>
<ul>
<li><p>’fd’ (default): finite differences</p></li>
<li><p>’gd’: Gaussian derivative</p></li>
</ul>
</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[str]</span></code>) – <p>Boundary conditions.
Multiple forms are accepted:</p>
<ul>
<li><p>str: unique mode shared amongst dimensions.
Must be one of:</p>
<ul>
<li><p>’constant’ (default): zero-padding</p></li>
<li><p>’wrap’</p></li>
<li><p>’reflect’</p></li>
<li><p>’symmetric’</p></li>
<li><p>’edge’</p></li>
</ul>
</li>
<li><p>tuple[str, …]: the <code class="code docutils literal notranslate"><span class="pre">d</span></code>-th dimension uses <code class="docutils literal notranslate"><span class="pre">mode[d]</span></code> as boundary condition.</p></li>
</ul>
<p>(See <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.pad.html#numpy.pad" title="(in NumPy v1.25)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.pad()</span></code></a> for details.)</p>
</p></li>
<li><p><strong>gpu</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Input NDArray type (<code class="code docutils literal notranslate"><span class="pre">True</span></code> for GPU, <code class="code docutils literal notranslate"><span class="pre">False</span></code> for CPU).
Defaults to <code class="code docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>dtype</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.DType" title="pyxu.info.ptype.DType"><code class="xref py py-class docutils literal notranslate"><span class="pre">DType</span></code></a>) – Working precision of the linear operator.</p></li>
<li><p><strong>parallel</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, use Dask to evaluate the different partial derivatives in parallel.</p></li>
<li><p><strong>diff_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>) – Keyword arguments to parametrize partial derivatives (see
<a class="reference internal" href="#pyxu.operator.linop.diff.PartialDerivative.finite_difference" title="pyxu.operator.linop.diff.PartialDerivative.finite_difference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">finite_difference()</span></code></a> and
<a class="reference internal" href="#pyxu.operator.linop.diff.PartialDerivative.gaussian_derivative" title="pyxu.operator.linop.diff.PartialDerivative.gaussian_derivative"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gaussian_derivative()</span></code></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>op</strong> – Jacobian</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/index.html#module-numpy" title="numpy"><span class="nn">numpy</span></a> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/pyplot_summary.html#module-matplotlib.pyplot" title="matplotlib.pyplot"><span class="nn">matplotlib.pyplot</span></a> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">pyxu.operator</span> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.linop.diff.Jacobian" title="pyxu.operator.linop.diff.Jacobian"><span class="n">Jacobian</span></a>
<span class="kn">from</span> <a class="sphinx-codeautolink-a" href="../../api/util.html#module-pyxu.util.misc" title="pyxu.util.misc"><span class="nn">pyxu.util.misc</span></a> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/util.html#pyxu.util.misc.peaks" title="pyxu.util.misc.peaks"><span class="n">peaks</span></a>

<span class="n">x</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.linspace.html#numpy.linspace" title="numpy.linspace"><span class="n">np</span><span class="o">.</span><span class="n">linspace</span></a><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
<span class="n">xx</span><span class="p">,</span> <span class="n">yy</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.meshgrid.html#numpy.meshgrid" title="numpy.meshgrid"><span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span></a><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">image</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.tile.html#numpy.tile" title="numpy.tile"><span class="n">np</span><span class="o">.</span><span class="n">tile</span></a><span class="p">(</span><a class="sphinx-codeautolink-a" href="../../api/util.html#pyxu.util.misc.peaks" title="pyxu.util.misc.peaks"><span class="n">peaks</span></a><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">jac</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.linop.diff.Jacobian" title="pyxu.operator.linop.diff.Jacobian"><span class="n">Jacobian</span></a><span class="p">(</span><span class="n">arg_shape</span><span class="o">=</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">n_channels</span><span class="o">=</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">jac</span><span class="o">.</span><span class="n">unravel</span><span class="p">(</span><span class="n">jac</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">ravel</span><span class="p">()))</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots" title="matplotlib.pyplot.subplots"><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span></a><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/stdtypes.html#range" title="range"><span class="nb">range</span></a><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/stdtypes.html#range" title="range"><span class="nb">range</span></a><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="p">[</span><span class="s2">"Reds"</span><span class="p">,</span> <span class="s2">"Greens"</span><span class="p">,</span> <span class="s2">"Blues"</span><span class="p">][</span><span class="n">j</span><span class="p">])</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">"$\partial I_</span><span class="se">{{</span><span class="si">{</span><span class="p">[</span><span class="s1">'R'</span><span class="p">,</span><span class="w"> </span><span class="s1">'G'</span><span class="p">,</span><span class="w"> </span><span class="s1">'B'</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="si">}</span><span class="se">}}</span><span class="s2">/\partial</span><span class="se">{{</span><span class="si">{</span><span class="p">[</span><span class="s1">'x'</span><span class="p">,</span><span class="w"> </span><span class="s1">'y'</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="si">}</span><span class="se">}}</span><span class="s2">$"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.suptitle.html#matplotlib.pyplot.suptitle" title="matplotlib.pyplot.suptitle"><span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span></a><span class="p">(</span><span class="s2">"Jacobian"</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../_downloads/86c9574267ec7b8962aeba64be5b073c/linop-6.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/ffda470275900c5520f894834127f285/linop-6.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/0b6013e7f37dad4e1e5dc6147b68a69a/linop-6.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/e8cf3ce50f34b6ff0831d06aeebabca8/linop-6.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../../_images/linop-6.png" class="plot-directive" src="../../_images/linop-6.png"/>
</figure>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyxu.operator.linop.diff.Gradient" title="pyxu.operator.linop.diff.Gradient"><code class="xref py py-func docutils literal notranslate"><span class="pre">Gradient()</span></code></a>, <a class="reference internal" href="#pyxu.operator.linop.diff.PartialDerivative" title="pyxu.operator.linop.diff.PartialDerivative"><code class="xref py py-func docutils literal notranslate"><span class="pre">PartialDerivative()</span></code></a></p>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.operator.linop.diff.Divergence">
<span class="sig-name descname"><span class="pre">Divergence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diff_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fd'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gpu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">diff_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/diff.html#Divergence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.diff.Divergence" title="Link to this definition">#</a></dt>
<dd><p>Divergence operator.</p>
<p class="rubric">Notes</p>
<p>This operator computes the expansion or outgoingness of a <span class="math notranslate nohighlight">\(D\)</span>-dimensional vector-valued signal of <span class="math notranslate nohighlight">\(C\)</span>
variables <span class="math notranslate nohighlight">\(\mathbf{f} = [\mathbf{f}_{0}, \ldots, \mathbf{f}_{C-1}]\)</span> with <span class="math notranslate nohighlight">\(\mathbf{f}_{c} \in
\mathbb{R}^{N_{0} \times \cdots \times N_{D-1}}\)</span>.</p>
<p>The Divergence of <span class="math notranslate nohighlight">\(\mathbf{f}\)</span> is computed via the adjoint of the gradient as follows:</p>
<div class="math notranslate nohighlight">
\[\operatorname{Div} \mathbf{f} = \boldsymbol{\nabla}^{\ast} \mathbf{f}
= \begin{bmatrix}
\frac{\partial \mathbf{f}}{\partial x_0} + \cdots + \frac{\partial \mathbf{f}}{\partial x_{D-1}}
\end{bmatrix} \in \mathbb{R}^{N_{0} \times \cdots \times N_{D-1}}\]</div>
<p>The partial derivatives can be approximated by <a class="reference external" href="https://en.wikipedia.org/wiki/Finite_difference">finite differences</a> via the
<a class="reference internal" href="#pyxu.operator.linop.diff.PartialDerivative.finite_difference" title="pyxu.operator.linop.diff.PartialDerivative.finite_difference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">finite_difference()</span></code></a> constructor or by the <a class="reference external" href="https://www.crisluengo.net/archives/22/">Gaussian derivative</a> via
<a class="reference internal" href="#pyxu.operator.linop.diff.PartialDerivative.gaussian_derivative" title="pyxu.operator.linop.diff.PartialDerivative.gaussian_derivative"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gaussian_derivative()</span></code></a> constructor.
The parametrization of the partial derivatives can be done via the keyword arguments <code class="code docutils literal notranslate"><span class="pre">**diff_kwargs</span></code>, which will
default to the same values as the <a class="reference internal" href="#pyxu.operator.linop.diff.PartialDerivative" title="pyxu.operator.linop.diff.PartialDerivative"><code class="xref py py-class docutils literal notranslate"><span class="pre">PartialDerivative</span></code></a> constructor.</p>
<p>When using finite differences to compute the Divergence (i.e., <code class="docutils literal notranslate"><span class="pre">diff_method</span> <span class="pre">=</span> <span class="pre">"fd"</span></code>), the divergence returns the
adjoint of the gradient in reversed order:</p>
<ul class="simple">
<li><p>For <code class="docutils literal notranslate"><span class="pre">forward</span></code> type divergence, the adjoint of the gradient of “backward” type is used.</p></li>
<li><p>For <code class="docutils literal notranslate"><span class="pre">backward</span></code> type divergence, the adjoint of the gradient of “forward” type is used.</p></li>
</ul>
<p>For <code class="docutils literal notranslate"><span class="pre">central</span></code> type divergence, and for the Gaussian derivative method (i.e., <code class="docutils literal notranslate"><span class="pre">diff_method</span> <span class="pre">=</span> <span class="pre">"gd"</span></code>), the adjoint
of the gradient of “central” type is used (no reversed order).</p>
<p>The divergence operator’s method <code class="xref py py-meth docutils literal notranslate"><span class="pre">unravel()</span></code> allows reshaping the
vectorized output divergence to <code class="docutils literal notranslate"><span class="pre">[...,</span> <span class="pre">N0,</span> <span class="pre">...,</span> <span class="pre">ND]</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arg_shape</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.NDArrayShape" title="pyxu.info.ptype.NDArrayShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayShape</span></code></a>) – Shape of the input array.</p></li>
<li><p><strong>directions</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.Integer" title="pyxu.info.ptype.Integer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Integer</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[Integer]</span></code>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>) – Divergence directions.
Defaults to <code class="code docutils literal notranslate"><span class="pre">None</span></code>, which computes the divergence for all directions.</p></li>
<li><p><strong>diff_method</strong> (<code class="docutils literal notranslate"><span class="pre">"gd"</span></code>, <code class="docutils literal notranslate"><span class="pre">"fd"</span></code>) – <p>Method used to approximate the derivative.
Must be one of:</p>
<ul>
<li><p>’fd’ (default): finite differences</p></li>
<li><p>’gd’: Gaussian derivative</p></li>
</ul>
</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[str]</span></code>) – <p>Boundary conditions.
Multiple forms are accepted:</p>
<ul>
<li><p>str: unique mode shared amongst dimensions.
Must be one of:</p>
<ul>
<li><p>’constant’ (default): zero-padding</p></li>
<li><p>’wrap’</p></li>
<li><p>’reflect’</p></li>
<li><p>’symmetric’</p></li>
<li><p>’edge’</p></li>
</ul>
</li>
<li><p>tuple[str, …]: the <code class="code docutils literal notranslate"><span class="pre">d</span></code>-th dimension uses <code class="docutils literal notranslate"><span class="pre">mode[d]</span></code> as boundary condition.</p></li>
</ul>
<p>(See <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.pad.html#numpy.pad" title="(in NumPy v1.25)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.pad()</span></code></a> for details.)</p>
</p></li>
<li><p><strong>gpu</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Input NDArray type (<code class="code docutils literal notranslate"><span class="pre">True</span></code> for GPU, <code class="code docutils literal notranslate"><span class="pre">False</span></code> for CPU).
Defaults to <code class="code docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>dtype</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.DType" title="pyxu.info.ptype.DType"><code class="xref py py-class docutils literal notranslate"><span class="pre">DType</span></code></a>) – Working precision of the linear operator.</p></li>
<li><p><strong>parallel</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, use Dask to evaluate the different partial derivatives in parallel.</p></li>
<li><p><strong>diff_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>) – Keyword arguments to parametrize partial derivatives (see
<a class="reference internal" href="#pyxu.operator.linop.diff.PartialDerivative.finite_difference" title="pyxu.operator.linop.diff.PartialDerivative.finite_difference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">finite_difference()</span></code></a> and
<a class="reference internal" href="#pyxu.operator.linop.diff.PartialDerivative.gaussian_derivative" title="pyxu.operator.linop.diff.PartialDerivative.gaussian_derivative"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gaussian_derivative()</span></code></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>op</strong> – Divergence</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/index.html#module-numpy" title="numpy"><span class="nn">numpy</span></a> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/pyplot_summary.html#module-matplotlib.pyplot" title="matplotlib.pyplot"><span class="nn">matplotlib.pyplot</span></a> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">pyxu.operator</span> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.linop.diff.Gradient" title="pyxu.operator.linop.diff.Gradient"><span class="n">Gradient</span></a><span class="p">,</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.linop.diff.Divergence" title="pyxu.operator.linop.diff.Divergence"><span class="n">Divergence</span></a><span class="p">,</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.linop.diff.Laplacian" title="pyxu.operator.linop.diff.Laplacian"><span class="n">Laplacian</span></a>
<span class="kn">from</span> <a class="sphinx-codeautolink-a" href="../../api/util.html#module-pyxu.util.misc" title="pyxu.util.misc"><span class="nn">pyxu.util.misc</span></a> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/util.html#pyxu.util.misc.peaks" title="pyxu.util.misc.peaks"><span class="n">peaks</span></a>

<span class="n">n</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">x</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.linspace.html#numpy.linspace" title="numpy.linspace"><span class="n">np</span><span class="o">.</span><span class="n">linspace</span></a><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">xx</span><span class="p">,</span> <span class="n">yy</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.meshgrid.html#numpy.meshgrid" title="numpy.meshgrid"><span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span></a><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">image</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/util.html#pyxu.util.misc.peaks" title="pyxu.util.misc.peaks"><span class="n">peaks</span></a><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">)</span>
<span class="n">arg_shape</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># (1000, 1000)</span>
<span class="n">grad</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.linop.diff.Gradient" title="pyxu.operator.linop.diff.Gradient"><span class="n">Gradient</span></a><span class="p">(</span><span class="n">arg_shape</span><span class="o">=</span><span class="n">arg_shape</span><span class="p">)</span>
<span class="n">div</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.linop.diff.Divergence" title="pyxu.operator.linop.diff.Divergence"><span class="n">Divergence</span></a><span class="p">(</span><span class="n">arg_shape</span><span class="o">=</span><span class="n">arg_shape</span><span class="p">)</span>
<span class="c1"># Construct Laplacian via composition</span>
<span class="n">laplacian1</span> <span class="o">=</span> <span class="n">div</span> <span class="o">*</span> <span class="n">grad</span>
<span class="c1"># Compare to default Laplacian</span>
<span class="n">laplacian2</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.linop.diff.Laplacian" title="pyxu.operator.linop.diff.Laplacian"><span class="n">Laplacian</span></a><span class="p">(</span><span class="n">arg_shape</span><span class="o">=</span><span class="n">arg_shape</span><span class="p">)</span>
<span class="n">output1</span> <span class="o">=</span> <span class="n">laplacian1</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
<span class="n">output2</span> <span class="o">=</span> <span class="n">laplacian2</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots" title="matplotlib.pyplot.subplots"><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span></a><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.log.html#numpy.log" title="numpy.log"><span class="n">np</span><span class="o">.</span><span class="n">log</span></a><span class="p">(</span><a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#abs" title="abs"><span class="nb">abs</span></a><span class="p">(</span><span class="n">output1</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">*</span><span class="n">arg_shape</span><span class="p">))</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"Laplacian via composition"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.log.html#numpy.log" title="numpy.log"><span class="n">np</span><span class="o">.</span><span class="n">log</span></a><span class="p">(</span><a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#abs" title="abs"><span class="nb">abs</span></a><span class="p">(</span><span class="n">output1</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">*</span><span class="n">arg_shape</span><span class="p">))</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"Default Laplacian"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../_downloads/412a24acb2bac1b40c380b09be1a2726/linop-7.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/6814b3e67359eade3351579c92de4611/linop-7.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/a484efb2ba74b7838eef1ab011e5f948/linop-7.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/9e57502a9a3a00032c71b730aca92025/linop-7.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../../_images/linop-7.png" class="plot-directive" src="../../_images/linop-7.png"/>
</figure>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyxu.operator.linop.diff.Gradient" title="pyxu.operator.linop.diff.Gradient"><code class="xref py py-func docutils literal notranslate"><span class="pre">Gradient()</span></code></a>, <a class="reference internal" href="#pyxu.operator.linop.diff.PartialDerivative" title="pyxu.operator.linop.diff.PartialDerivative"><code class="xref py py-func docutils literal notranslate"><span class="pre">PartialDerivative()</span></code></a></p>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.operator.linop.diff.Hessian">
<span class="sig-name descname"><span class="pre">Hessian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diff_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fd'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gpu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">diff_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/diff.html#Hessian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.diff.Hessian" title="Link to this definition">#</a></dt>
<dd><p>Hessian operator.</p>
<p class="rubric">Notes</p>
<p>The Hessian matrix or Hessian of a <span class="math notranslate nohighlight">\(D\)</span>-dimensional signal <span class="math notranslate nohighlight">\(\mathbf{f} \in \mathbb{R}^{N_0 \times \cdots
\times N_{D-1}}\)</span> is the square matrix of second-order partial derivatives:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{H} \mathbf{f} = \begin{bmatrix}
\dfrac{ \partial^{2}\mathbf{f} }{ \partial x_{0}^{2} } &amp;  \dfrac{ \partial^{2}\mathbf{f} }{ \partial x_{0}\,\partial x_{1} } &amp; \cdots &amp; \dfrac{ \partial^{2}\mathbf{f} }{ \partial x_{0} \, \partial x_{D-1} } \\
\dfrac{ \partial^{2}\mathbf{f} }{ \partial x_{1} \, \partial x_{0} } &amp; \dfrac{ \partial^{2}\mathbf{f} }{ \partial x_{1}^{2} } &amp; \cdots &amp; \dfrac{ \partial^{2}\mathbf{f} }{\partial x_{1} \,\partial x_{D-1}} \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
\dfrac{ \partial^{2}\mathbf{f} }{ \partial x_{D-1} \, \partial x_{0} } &amp; \dfrac{ \partial^{2}\mathbf{f} }{ \partial x_{D-1} \, \partial x_{1} } &amp; \cdots &amp; \dfrac{ \partial^{2}\mathbf{f} }{ \partial x_{D-1}^{2}}
\end{bmatrix}\end{split}\]</div>
<p>The partial derivatives can be approximated by <a class="reference external" href="https://en.wikipedia.org/wiki/Finite_difference">finite differences</a> via the
<a class="reference internal" href="#pyxu.operator.linop.diff.PartialDerivative.finite_difference" title="pyxu.operator.linop.diff.PartialDerivative.finite_difference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">finite_difference()</span></code></a> constructor or by the <a class="reference external" href="https://www.crisluengo.net/archives/22/">Gaussian derivative</a> via
<a class="reference internal" href="#pyxu.operator.linop.diff.PartialDerivative.gaussian_derivative" title="pyxu.operator.linop.diff.PartialDerivative.gaussian_derivative"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gaussian_derivative()</span></code></a> constructor.
The parametrization of the partial derivatives can be done via the keyword arguments <code class="code docutils literal notranslate"><span class="pre">**diff_kwargs</span></code>, which will
default to the same values as the <a class="reference internal" href="#pyxu.operator.linop.diff.PartialDerivative" title="pyxu.operator.linop.diff.PartialDerivative"><code class="xref py py-class docutils literal notranslate"><span class="pre">PartialDerivative</span></code></a> constructor.</p>
<p>The Hessian being symmetric, only the upper triangular part at most needs to be computed.
Due to the (possibly) large size of the full Hessian, 4 different options are handled:</p>
<ul>
<li><p>[mode 0] <code class="docutils literal notranslate"><span class="pre">directions</span></code> is an integer, e.g.: <code class="docutils literal notranslate"><span class="pre">directions=0</span></code></p>
<div class="math notranslate nohighlight">
\[\partial^{2}\mathbf{f}/\partial x_{0}^{2}.\]</div>
</li>
<li><p>[mode 1] <code class="docutils literal notranslate"><span class="pre">directions</span></code> is a tuple of length 2, e.g.: <code class="docutils literal notranslate"><span class="pre">directions=(0,1)</span></code></p>
<div class="math notranslate nohighlight">
\[\partial^{2}\mathbf{f}/\partial x_{0}\partial x_{1}.\]</div>
</li>
<li><p>[mode 2] <code class="docutils literal notranslate"><span class="pre">directions</span></code> is a tuple of tuples, e.g.: <code class="docutils literal notranslate"><span class="pre">directions=((0,0),</span> <span class="pre">(0,1))</span></code></p>
<div class="math notranslate nohighlight">
\[\left(\frac{ \partial^{2}\mathbf{f} }{ \partial x_{0}^{2} }, \frac{ \partial^{2}\mathbf{f} }{ \partial x_{0}\partial x_{1} }\right).\]</div>
</li>
<li><p>[mode 3] <code class="docutils literal notranslate"><span class="pre">directions</span> <span class="pre">=</span> <span class="pre">'all'</span></code> (default), computes the Hessian for all directions (only the
upper triangular part of the Hessian matrix), in row order, i.e.:</p>
<div class="math notranslate nohighlight">
\[\left(\frac{ \partial^{2}\mathbf{f} }{ \partial x_{0}^{2} }, \frac{ \partial^{2}\mathbf{f} }
{ \partial x_{0}\partial x_{1} }, \, \ldots , \, \frac{ \partial^{2}\mathbf{f} }{ \partial x_{D-1}^{2} }\right).\]</div>
</li>
</ul>
<p>The shape of the output <a class="reference internal" href="../abc.html#pyxu.abc.operator.LinOp" title="pyxu.abc.operator.LinOp"><code class="xref py py-class docutils literal notranslate"><span class="pre">LinOp</span></code></a> depends on the number of computed directions; by
default (all directions), we have <span class="math notranslate nohighlight">\(\mathbf{H} \mathbf{f} \in \mathbb{R}^{\frac{D(D-1)}{2} \times N_0 \times
\cdots \times N_{D-1}}\)</span>.</p>
<p>The Hessian operator’s <code class="xref py py-meth docutils literal notranslate"><span class="pre">unravel()</span></code> method allows reshaping the vectorized
output Hessian to <code class="code docutils literal notranslate"><span class="pre">[n_dirs,</span> <span class="pre">N0,</span> <span class="pre">...,</span> <span class="pre">ND]</span></code> (see the example below).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arg_shape</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.NDArrayShape" title="pyxu.info.ptype.NDArrayShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayShape</span></code></a>) – Shape of the input array.</p></li>
<li><p><strong>directions</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.Integer" title="pyxu.info.ptype.Integer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Integer</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">(Integer</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Integer)</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">((Integer</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Integer)</span></code>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#Ellipsis" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">...</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">(Integer</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Integer))</span></code>, <code class="docutils literal notranslate"><span class="pre">'all'</span></code>) – Hessian directions.
Defaults to <code class="code docutils literal notranslate"><span class="pre">all</span></code>, which computes the Hessian for all directions. (See <code class="docutils literal notranslate"><span class="pre">Notes</span></code>.)</p></li>
<li><p><strong>diff_method</strong> (<code class="docutils literal notranslate"><span class="pre">"gd"</span></code>, <code class="docutils literal notranslate"><span class="pre">"fd"</span></code>) – <p>Method used to approximate the derivative.
Must be one of:</p>
<ul>
<li><p>’fd’ (default): finite differences</p></li>
<li><p>’gd’: Gaussian derivative</p></li>
</ul>
</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[str]</span></code>) – <p>Boundary conditions.
Multiple forms are accepted:</p>
<ul>
<li><p>str: unique mode shared amongst dimensions.
Must be one of:</p>
<ul>
<li><p>’constant’ (default): zero-padding</p></li>
<li><p>’wrap’</p></li>
<li><p>’reflect’</p></li>
<li><p>’symmetric’</p></li>
<li><p>’edge’</p></li>
</ul>
</li>
<li><p>tuple[str, …]: the <code class="code docutils literal notranslate"><span class="pre">d</span></code>-th dimension uses <code class="docutils literal notranslate"><span class="pre">mode[d]</span></code> as boundary condition.</p></li>
</ul>
<p>(See <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.pad.html#numpy.pad" title="(in NumPy v1.25)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.pad()</span></code></a> for details.)</p>
</p></li>
<li><p><strong>gpu</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Input NDArray type (<code class="code docutils literal notranslate"><span class="pre">True</span></code> for GPU, <code class="code docutils literal notranslate"><span class="pre">False</span></code> for CPU).
Defaults to <code class="code docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>dtype</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.DType" title="pyxu.info.ptype.DType"><code class="xref py py-class docutils literal notranslate"><span class="pre">DType</span></code></a>) – Working precision of the linear operator.</p></li>
<li><p><strong>parallel</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, use Dask to evaluate the different partial derivatives in parallel.</p></li>
<li><p><strong>diff_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>) – Keyword arguments to parametrize partial derivatives (see
<a class="reference internal" href="#pyxu.operator.linop.diff.PartialDerivative.finite_difference" title="pyxu.operator.linop.diff.PartialDerivative.finite_difference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">finite_difference()</span></code></a> and
<a class="reference internal" href="#pyxu.operator.linop.diff.PartialDerivative.gaussian_derivative" title="pyxu.operator.linop.diff.PartialDerivative.gaussian_derivative"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gaussian_derivative()</span></code></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>op</strong> – Hessian</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/index.html#module-numpy" title="numpy"><span class="nn">numpy</span></a> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/pyplot_summary.html#module-matplotlib.pyplot" title="matplotlib.pyplot"><span class="nn">matplotlib.pyplot</span></a> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">pyxu.operator</span> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.linop.diff.Hessian" title="pyxu.operator.linop.diff.Hessian"><span class="n">Hessian</span></a><span class="p">,</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.linop.diff.PartialDerivative" title="pyxu.operator.linop.diff.PartialDerivative"><span class="n">PartialDerivative</span></a>
<span class="kn">from</span> <a class="sphinx-codeautolink-a" href="../../api/util.html#module-pyxu.util.misc" title="pyxu.util.misc"><span class="nn">pyxu.util.misc</span></a> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/util.html#pyxu.util.misc.peaks" title="pyxu.util.misc.peaks"><span class="n">peaks</span></a>

<span class="n">n</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">x</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.linspace.html#numpy.linspace" title="numpy.linspace"><span class="n">np</span><span class="o">.</span><span class="n">linspace</span></a><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">xx</span><span class="p">,</span> <span class="n">yy</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.meshgrid.html#numpy.meshgrid" title="numpy.meshgrid"><span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span></a><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">image</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/util.html#pyxu.util.misc.peaks" title="pyxu.util.misc.peaks"><span class="n">peaks</span></a><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">)</span>
<span class="n">arg_shape</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># (1000, 1000)</span>

<span class="c1"># Instantiate Hessian operator</span>
<span class="n">hessian</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.linop.diff.Hessian" title="pyxu.operator.linop.diff.Hessian"><span class="n">Hessian</span></a><span class="p">(</span><span class="n">arg_shape</span><span class="o">=</span><span class="n">arg_shape</span><span class="p">,</span> <span class="n">directions</span><span class="o">=</span><span class="s2">"all"</span><span class="p">)</span>
<span class="c1"># Compute Hessian</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">hessian</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span> <span class="c1"># shape = (300000,)</span>
<span class="n">d2f_dx2</span><span class="p">,</span> <span class="n">d2f_dxdy</span><span class="p">,</span> <span class="n">d2f_dy2</span> <span class="o">=</span> <span class="n">hessian</span><span class="o">.</span><span class="n">unravel</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>

<span class="c1"># Plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots" title="matplotlib.pyplot.subplots"><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span></a><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"Image"</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">"off"</span><span class="p">)</span>

<span class="n">im</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">d2f_dx2</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$\partial^</span><span class="si">{2}</span><span class="s2"> f/ \partial x^</span><span class="si">{2}</span><span class="s2">$"</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">"off"</span><span class="p">)</span>

<span class="n">im</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">d2f_dxdy</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$\partial^</span><span class="si">{2}</span><span class="s2"> f/ \partial x\partial y$"</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">"off"</span><span class="p">)</span>

<span class="n">im</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">d2f_dy2</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$\partial^</span><span class="si">{2}</span><span class="s2"> f/ \partial y^</span><span class="si">{2}</span><span class="s2">$"</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">"off"</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../_downloads/4e9c8982201c2baa2ef38bb0ea842376/linop-8.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/825084a2e9970390b42ebd177311ceba/linop-8.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/4758257a3242982102520f152b50ca40/linop-8.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/1f117a6a28d0313d35ba2f9b8f29caee/linop-8.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../../_images/linop-8.png" class="plot-directive" src="../../_images/linop-8.png"/>
</figure>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyxu.operator.linop.diff.PartialDerivative" title="pyxu.operator.linop.diff.PartialDerivative"><code class="xref py py-class docutils literal notranslate"><span class="pre">PartialDerivative</span></code></a>, <a class="reference internal" href="#pyxu.operator.linop.diff.Gradient" title="pyxu.operator.linop.diff.Gradient"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gradient</span></code></a>, <a class="reference internal" href="#pyxu.operator.linop.diff.Laplacian" title="pyxu.operator.linop.diff.Laplacian"><code class="xref py py-class docutils literal notranslate"><span class="pre">Laplacian</span></code></a></p>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.operator.linop.diff.Laplacian">
<span class="sig-name descname"><span class="pre">Laplacian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diff_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fd'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gpu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">diff_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/diff.html#Laplacian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.diff.Laplacian" title="Link to this definition">#</a></dt>
<dd><p>Laplacian operator.</p>
<p class="rubric">Notes</p>
<p>The Laplacian of a <span class="math notranslate nohighlight">\(D\)</span>-dimensional signal <span class="math notranslate nohighlight">\(\mathbf{f} \in \mathbb{R}^{N_0 \times \cdots \times N_{D-1}}\)</span>
is the sum of second-order partial derivatives across all input directions:</p>
<div class="math notranslate nohighlight">
\[\sum_{d = 0}^{D-1} \dfrac{ \partial^{2}\mathbf{f} }{ \partial x_{d}^{2} }\]</div>
<p>The partial derivatives can be approximated by <a class="reference external" href="https://en.wikipedia.org/wiki/Finite_difference">finite differences</a> via the
<a class="reference internal" href="#pyxu.operator.linop.diff.PartialDerivative.finite_difference" title="pyxu.operator.linop.diff.PartialDerivative.finite_difference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">finite_difference()</span></code></a> constructor or by the <a class="reference external" href="https://www.crisluengo.net/archives/22/">Gaussian derivative</a> via
<a class="reference internal" href="#pyxu.operator.linop.diff.PartialDerivative.gaussian_derivative" title="pyxu.operator.linop.diff.PartialDerivative.gaussian_derivative"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gaussian_derivative()</span></code></a> constructor.
The parametrization of the partial derivatives can be done via the keyword arguments <code class="code docutils literal notranslate"><span class="pre">**diff_kwargs</span></code>, which will
default to <code class="code docutils literal notranslate"><span class="pre">scheme='central'</span></code> and <code class="code docutils literal notranslate"><span class="pre">accuracy=2</span></code> for <code class="code docutils literal notranslate"><span class="pre">diff_method='fd'</span></code> (finite difference), and the same values as
the <a class="reference internal" href="#pyxu.operator.linop.diff.PartialDerivative" title="pyxu.operator.linop.diff.PartialDerivative"><code class="xref py py-class docutils literal notranslate"><span class="pre">PartialDerivative</span></code></a> constructor for <code class="code docutils literal notranslate"><span class="pre">diff_method='gd'</span></code> (gaussian
derivative).</p>
<p>The Laplacian operator’s method <code class="xref py py-meth docutils literal notranslate"><span class="pre">unravel()</span></code> allows reshaping the
vectorized output Laplacian to <code class="docutils literal notranslate"><span class="pre">[...,</span> <span class="pre">N0,</span> <span class="pre">...,</span> <span class="pre">ND]</span></code> (see the example below).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arg_shape</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.NDArrayShape" title="pyxu.info.ptype.NDArrayShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayShape</span></code></a>) – Shape of the input array.</p></li>
<li><p><strong>directions</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.Integer" title="pyxu.info.ptype.Integer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Integer</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[Integer]</span></code>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>) – Laplacian directions. Defaults to <code class="code docutils literal notranslate"><span class="pre">None</span></code>, which computes the Laplacian with all directions.</p></li>
<li><p><strong>diff_method</strong> (<code class="docutils literal notranslate"><span class="pre">"gd"</span></code>, <code class="docutils literal notranslate"><span class="pre">"fd"</span></code>) – <p>Method used to approximate the derivative.
Must be one of:</p>
<ul>
<li><p>’fd’ (default): finite differences</p></li>
<li><p>’gd’: Gaussian derivative</p></li>
</ul>
</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[str]</span></code>) – <p>Boundary conditions.
Multiple forms are accepted:</p>
<ul>
<li><p>str: unique mode shared amongst dimensions.
Must be one of:</p>
<ul>
<li><p>’constant’ (default): zero-padding</p></li>
<li><p>’wrap’</p></li>
<li><p>’reflect’</p></li>
<li><p>’symmetric’</p></li>
<li><p>’edge’</p></li>
</ul>
</li>
<li><p>tuple[str, …]: the <code class="code docutils literal notranslate"><span class="pre">d</span></code>-th dimension uses <code class="docutils literal notranslate"><span class="pre">mode[d]</span></code> as boundary condition.</p></li>
</ul>
<p>(See <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.pad.html#numpy.pad" title="(in NumPy v1.25)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.pad()</span></code></a> for details.)</p>
</p></li>
<li><p><strong>gpu</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Input NDArray type (<code class="code docutils literal notranslate"><span class="pre">True</span></code> for GPU, <code class="code docutils literal notranslate"><span class="pre">False</span></code> for CPU).
Defaults to <code class="code docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>dtype</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.DType" title="pyxu.info.ptype.DType"><code class="xref py py-class docutils literal notranslate"><span class="pre">DType</span></code></a>) – Working precision of the linear operator.</p></li>
<li><p><strong>parallel</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, use Dask to evaluate the different partial derivatives in parallel.</p></li>
<li><p><strong>diff_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>) – Keyword arguments to parametrize partial derivatives (see
<a class="reference internal" href="#pyxu.operator.linop.diff.PartialDerivative.finite_difference" title="pyxu.operator.linop.diff.PartialDerivative.finite_difference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">finite_difference()</span></code></a> and
<a class="reference internal" href="#pyxu.operator.linop.diff.PartialDerivative.gaussian_derivative" title="pyxu.operator.linop.diff.PartialDerivative.gaussian_derivative"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gaussian_derivative()</span></code></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>op</strong> – Laplacian</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/index.html#module-numpy" title="numpy"><span class="nn">numpy</span></a> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/pyplot_summary.html#module-matplotlib.pyplot" title="matplotlib.pyplot"><span class="nn">matplotlib.pyplot</span></a> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">pyxu.operator</span> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.linop.diff.Laplacian" title="pyxu.operator.linop.diff.Laplacian"><span class="n">Laplacian</span></a>
<span class="kn">from</span> <a class="sphinx-codeautolink-a" href="../../api/util.html#module-pyxu.util.misc" title="pyxu.util.misc"><span class="nn">pyxu.util.misc</span></a> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/util.html#pyxu.util.misc.peaks" title="pyxu.util.misc.peaks"><span class="n">peaks</span></a>

<span class="c1"># Define input image</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">x</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.linspace.html#numpy.linspace" title="numpy.linspace"><span class="n">np</span><span class="o">.</span><span class="n">linspace</span></a><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">xx</span><span class="p">,</span> <span class="n">yy</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.meshgrid.html#numpy.meshgrid" title="numpy.meshgrid"><span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span></a><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">image</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/util.html#pyxu.util.misc.peaks" title="pyxu.util.misc.peaks"><span class="n">peaks</span></a><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">)</span>

<span class="n">arg_shape</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># (1000, 1000)</span>
<span class="c1"># Compute Laplacian</span>
<span class="n">laplacian</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.linop.diff.Laplacian" title="pyxu.operator.linop.diff.Laplacian"><span class="n">Laplacian</span></a><span class="p">(</span><span class="n">arg_shape</span><span class="o">=</span><span class="n">arg_shape</span><span class="p">)</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">laplacian</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">laplacian</span><span class="o">.</span><span class="n">unravel</span><span class="p">(</span><span class="n">output</span><span class="p">)</span> <span class="c1"># shape = (1, 1000, 1000)</span>
<span class="c1"># Plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots" title="matplotlib.pyplot.subplots"><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span></a><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"Image"</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">"off"</span><span class="p">)</span>

<span class="n">im</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">squeeze</span><span class="p">())</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$\partial^</span><span class="si">{2}</span><span class="s2"> f/ \partial x^</span><span class="si">{2}</span><span class="s2">+\partial^</span><span class="si">{2}</span><span class="s2"> f/ \partial y^</span><span class="si">{2}</span><span class="s2">$"</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">"off"</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../_downloads/d8c134d2a8e4a675726495e10717b038/linop-9.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/216917b64f8906bb5bdc3cb2d7dbd523/linop-9.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/3de52ad022d9db69f865cca508591b1d/linop-9.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/17ea64344184b13eb3942803c2022ec7/linop-9.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../../_images/linop-9.png" class="plot-directive" src="../../_images/linop-9.png"/>
</figure>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyxu.operator.linop.diff.PartialDerivative" title="pyxu.operator.linop.diff.PartialDerivative"><code class="xref py py-class docutils literal notranslate"><span class="pre">PartialDerivative</span></code></a>, <a class="reference internal" href="#pyxu.operator.linop.diff.Gradient" title="pyxu.operator.linop.diff.Gradient"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gradient</span></code></a>, <a class="reference internal" href="#pyxu.operator.linop.diff.Hessian" title="pyxu.operator.linop.diff.Hessian"><code class="xref py py-class docutils literal notranslate"><span class="pre">Hessian</span></code></a></p>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.operator.linop.diff.DirectionalDerivative">
<span class="sig-name descname"><span class="pre">DirectionalDerivative</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diff_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fd'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">diff_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/diff.html#DirectionalDerivative"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.diff.DirectionalDerivative" title="Link to this definition">#</a></dt>
<dd><p>Directional derivative operator.</p>
<p class="rubric">Notes</p>
<p>The <strong>first-order</strong> <code class="docutils literal notranslate"><span class="pre">DirectionalDerivative</span></code> of a <span class="math notranslate nohighlight">\(D\)</span>-dimensional signal <span class="math notranslate nohighlight">\(\mathbf{f} \in
\mathbb{R}^{N_0 \times \cdots \times N_{D-1}}\)</span> applies a derivative along the direction specified by a constant
unitary vector <span class="math notranslate nohighlight">\(\mathbf{v} \in \mathbb{R}^D\)</span>:</p>
<div class="math notranslate nohighlight">
\[\boldsymbol{\nabla}_\mathbf{v} \mathbf{f} = \sum_{i=0}^{D-1} v_i \frac{\partial \mathbf{f}}{\partial x_i} \in
\mathbb{R}^{N_0 \times \cdots \times N_{D-1}}\]</div>
<p>or along spatially-varying directions <span class="math notranslate nohighlight">\(\mathbf{v} = [\mathbf{v}_0, \ldots , \mathbf{v}_{D-1}]^\top \in
\mathbb{R}^{D \times N_0 \times \cdots \times N_{D-1} }\)</span> where each direction <span class="math notranslate nohighlight">\(\mathbf{v}_{\cdot, i_0, \ldots
, i_{D-1}} \in \mathbb{R}^D\)</span> for any <span class="math notranslate nohighlight">\(0 \leq i_d \leq N_d-1\)</span> with <span class="math notranslate nohighlight">\(0 \leq d \leq D-1\)</span> is a unitary
vector:</p>
<div class="math notranslate nohighlight">
\[\boldsymbol{\nabla}_\mathbf{v} \mathbf{f} = \sum_{i=0}^{D-1} \mathbf{v}_i \odot
\frac{\partial \mathbf{f}}{\partial x_i} \in \mathbb{R}^{N_0 \times \cdots \times N_{D-1}},\]</div>
<p>where <span class="math notranslate nohighlight">\(\odot\)</span> denotes the Hadamard (elementwise) product.</p>
<p>Note that choosing <span class="math notranslate nohighlight">\(\mathbf{v}= \mathbf{e}_d \in \mathbb{R}^D\)</span> (the <span class="math notranslate nohighlight">\(d\)</span>-th canonical basis vector)
amounts to the first-order <a class="reference internal" href="#pyxu.operator.linop.diff.PartialDerivative" title="pyxu.operator.linop.diff.PartialDerivative"><code class="xref py py-func docutils literal notranslate"><span class="pre">PartialDerivative()</span></code></a> operator applied along axis
<span class="math notranslate nohighlight">\(d\)</span>.</p>
<p>The <strong>second-order</strong> <code class="docutils literal notranslate"><span class="pre">DirectionalDerivative</span></code> <span class="math notranslate nohighlight">\(\boldsymbol{\nabla}^2_{\mathbf{v}_{1, 2}}\)</span> is obtained by
composing the first-order directional derivatives <span class="math notranslate nohighlight">\(\boldsymbol{\nabla}_{\mathbf{v}_{1}}\)</span> and
<span class="math notranslate nohighlight">\(\boldsymbol{\nabla}_{\mathbf{v}_{2}}\)</span>:</p>
<div class="math notranslate nohighlight">
\[\boldsymbol{\nabla}_{\mathbf{v}_{1}} (\boldsymbol{\nabla}_{\mathbf{v}_{2}} \mathbf{f}) =
\boldsymbol{\nabla}_{\mathbf{v}_{1}} (\sum_{i=0}^{D-1} {v_{2}}_{i} \frac{\partial \mathbf{f}}{\partial x_i}) =
\sum_{j=0}^{D-1} {v_{1}}_{j} \frac{\partial}{\partial x_j} (\sum_{i=0}^{D-1} {v_{2}}_{i} \frac{\partial \mathbf{f}}{\partial x_i}) =
\sum_{i, j=0}^{D-1} {v_{1}}_{j} {v_{2}}_{i} \frac{\partial}{\partial x_j} \frac{\partial}{\partial x_i}\mathbf{f} =
\mathbf{v}_{1}^{\top}\mathbf{H}\mathbf{f}\mathbf{v}_{2},\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{H}\)</span> is the discrete Hessian operator, implemented via
<a class="reference internal" href="#pyxu.operator.linop.diff.Hessian" title="pyxu.operator.linop.diff.Hessian"><code class="xref py py-class docutils literal notranslate"><span class="pre">Hessian</span></code></a>.</p>
<p>Higher-order <code class="docutils literal notranslate"><span class="pre">DirectionalDerivative</span></code> <span class="math notranslate nohighlight">\(\boldsymbol{\nabla}^{N}_\mathbf{v}\)</span> can be obtained by composing the
first-order directional derivative <span class="math notranslate nohighlight">\(\boldsymbol{\nabla}_\mathbf{v}\)</span> <span class="math notranslate nohighlight">\(N\)</span> times.</p>
<p>The directional derivative operator’s method <code class="xref py py-meth docutils literal notranslate"><span class="pre">unravel()</span></code>
allows reshaping the vectorized output directional derivative to <code class="docutils literal notranslate"><span class="pre">[...,</span> <span class="pre">N0,</span> <span class="pre">...,</span> <span class="pre">ND]</span></code> (see the example below).</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<ul class="simple">
<li><p><a class="reference internal" href="#pyxu.operator.linop.diff.DirectionalDerivative" title="pyxu.operator.linop.diff.DirectionalDerivative"><code class="xref py py-func docutils literal notranslate"><span class="pre">DirectionalDerivative()</span></code></a> instances are <strong>not array module-agnostic</strong>: they
will only work with NDArrays belonging to the same array module as <code class="docutils literal notranslate"><span class="pre">directions</span></code>. Inner
computations may recast input arrays when the precision of <code class="docutils literal notranslate"><span class="pre">directions</span></code> does not match the user-requested
precision.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">directions</span></code> are always normalized to be unit vectors.</p></li>
</ul>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arg_shape</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.NDArrayShape" title="pyxu.info.ptype.NDArrayShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayShape</span></code></a>) – Shape of the input array.</p></li>
<li><p><strong>order</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.Integer" title="pyxu.info.ptype.Integer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Integer</span></code></a>) – Which directional derivative (restricted to 1: First or 2: Second, see <code class="docutils literal notranslate"><span class="pre">Notes</span></code>).</p></li>
<li><p><strong>directions</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArray</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>) – <p>For <code class="docutils literal notranslate"><span class="pre">order=1</span></code>, it can be a single direction (array of size <span class="math notranslate nohighlight">\((D,)\)</span>, where <span class="math notranslate nohighlight">\(D\)</span> is the number of
axes) or spatially-varying directions:</p>
<ul>
<li><p>array of size <span class="math notranslate nohighlight">\((D, N_0 \times \ldots \times N_{D-1})\)</span> for <code class="docutils literal notranslate"><span class="pre">order=1</span></code>, i.e., one direction per element
in the gradient, and,</p></li>
<li><p>array of size <span class="math notranslate nohighlight">\((D * (D + 1) / 2, N_0 \times \ldots \times N_{D-1})\)</span> for <code class="docutils literal notranslate"><span class="pre">order=2</span></code>, i.e., one direction
per element in the Hessian.</p></li>
</ul>
<p>For <code class="docutils literal notranslate"><span class="pre">order=2</span></code>, it can be a tuple/list of two single directions or spatially-varying dimensions of the same
shape, which will compute <span class="math notranslate nohighlight">\(\mathbf{v}_{1}^{\top}\mathbf{H}\mathbf{f}\mathbf{v}_{2}\)</span> or a single direction,
as for <code class="docutils literal notranslate"><span class="pre">order=1</span></code>, which will compute <span class="math notranslate nohighlight">\(\mathbf{v}_{1}^{\top}\mathbf{H}\mathbf{f}\mathbf{v}_{1}\)</span>. Note
that for <code class="docutils literal notranslate"><span class="pre">order=2</span></code>, even though directions are spatially-varying, no differentiation is performed for this
parameter.</p>
</p></li>
<li><p><strong>diff_method</strong> (<code class="docutils literal notranslate"><span class="pre">"gd"</span></code>, <code class="docutils literal notranslate"><span class="pre">"fd"</span></code>) – <p>Method used to approximate the derivative. Must be one of:</p>
<ul>
<li><p>’fd’ (default): finite differences</p></li>
<li><p>’gd’: Gaussian derivative</p></li>
</ul>
</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[str]</span></code>) – <p>Boundary conditions.
Multiple forms are accepted:</p>
<ul>
<li><p>str: unique mode shared amongst dimensions.
Must be one of:</p>
<ul>
<li><p>’constant’ (default): zero-padding</p></li>
<li><p>’wrap’</p></li>
<li><p>’reflect’</p></li>
<li><p>’symmetric’</p></li>
<li><p>’edge’</p></li>
</ul>
</li>
<li><p>tuple[str, …]: the <code class="code docutils literal notranslate"><span class="pre">d</span></code>-th dimension uses <code class="docutils literal notranslate"><span class="pre">mode[d]</span></code> as boundary condition.</p></li>
</ul>
<p>(See <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.pad.html#numpy.pad" title="(in NumPy v1.25)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.pad()</span></code></a> for details.)</p>
</p></li>
<li><p><strong>parallel</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, use Dask to evaluate the different partial derivatives in parallel.</p></li>
<li><p><strong>diff_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>) – Keyword arguments to parametrize partial derivatives (see
<a class="reference internal" href="#pyxu.operator.linop.diff.PartialDerivative.finite_difference" title="pyxu.operator.linop.diff.PartialDerivative.finite_difference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">finite_difference()</span></code></a> and
<a class="reference internal" href="#pyxu.operator.linop.diff.PartialDerivative.gaussian_derivative" title="pyxu.operator.linop.diff.PartialDerivative.gaussian_derivative"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gaussian_derivative()</span></code></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>op</strong> – Directional derivative</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/index.html#module-numpy" title="numpy"><span class="nn">numpy</span></a> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/pyplot_summary.html#module-matplotlib.pyplot" title="matplotlib.pyplot"><span class="nn">matplotlib.pyplot</span></a> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">pyxu.operator</span> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.linop.diff.DirectionalDerivative" title="pyxu.operator.linop.diff.DirectionalDerivative"><span class="n">DirectionalDerivative</span></a>
<span class="kn">from</span> <a class="sphinx-codeautolink-a" href="../../api/util.html#module-pyxu.util.misc" title="pyxu.util.misc"><span class="nn">pyxu.util.misc</span></a> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/util.html#pyxu.util.misc.peaks" title="pyxu.util.misc.peaks"><span class="n">peaks</span></a>

<span class="n">x</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.linspace.html#numpy.linspace" title="numpy.linspace"><span class="n">np</span><span class="o">.</span><span class="n">linspace</span></a><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
<span class="n">xx</span><span class="p">,</span> <span class="n">yy</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.meshgrid.html#numpy.meshgrid" title="numpy.meshgrid"><span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span></a><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/util.html#pyxu.util.misc.peaks" title="pyxu.util.misc.peaks"><span class="n">peaks</span></a><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">)</span>
<span class="n">directions</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
<span class="n">directions</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:</span> <span class="n">z</span><span class="o">.</span><span class="n">size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">directions</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">z</span><span class="o">.</span><span class="n">size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">:]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">dop</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.linop.diff.DirectionalDerivative" title="pyxu.operator.linop.diff.DirectionalDerivative"><span class="n">DirectionalDerivative</span></a><span class="p">(</span><span class="n">arg_shape</span><span class="o">=</span><span class="n">z</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">directions</span><span class="o">=</span><span class="n">directions</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">dop</span><span class="o">.</span><span class="n">unravel</span><span class="p">(</span><span class="n">dop</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">ravel</span><span class="p">()))</span>
<span class="n">dop2</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.linop.diff.DirectionalDerivative" title="pyxu.operator.linop.diff.DirectionalDerivative"><span class="n">DirectionalDerivative</span></a><span class="p">(</span><span class="n">arg_shape</span><span class="o">=</span><span class="n">z</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">directions</span><span class="o">=</span><span class="n">directions</span><span class="p">)</span>
<span class="n">out2</span> <span class="o">=</span> <span class="n">dop2</span><span class="o">.</span><span class="n">unravel</span><span class="p">(</span><span class="n">dop2</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">ravel</span><span class="p">()))</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots" title="matplotlib.pyplot.subplots"><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span></a><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">axs</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.ravel.html#numpy.ravel" title="numpy.ravel"><span class="n">np</span><span class="o">.</span><span class="n">ravel</span></a><span class="p">(</span><span class="n">axs</span><span class="p">)</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">shading</span><span class="o">=</span><span class="s2">"auto"</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">directions</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">xx</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">directions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">xx</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"Signal and directions of first derivatives"</span><span class="p">)</span>

<span class="n">h</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">out</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span> <span class="n">shading</span><span class="o">=</span><span class="s2">"auto"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"First-order directional derivatives"</span><span class="p">)</span>

<span class="n">h</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">out2</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span> <span class="n">shading</span><span class="o">=</span><span class="s2">"auto"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"Second-order directional derivative"</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../_downloads/74c02ef0f5c3c0df3e96c1f5c5adc42e/linop-10.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/3566084b06716c19cd096b504dd5245c/linop-10.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/f9ba4343980bdb8f37da0283f3a6d97e/linop-10.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/c0190b5d57d3d151adb5651d8b8a1ee5/linop-10.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../../_images/linop-10.png" class="plot-directive" src="../../_images/linop-10.png"/>
</figure>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyxu.operator.linop.diff.Gradient" title="pyxu.operator.linop.diff.Gradient"><code class="xref py py-func docutils literal notranslate"><span class="pre">Gradient()</span></code></a>, <a class="reference internal" href="#pyxu.operator.linop.diff.DirectionalGradient" title="pyxu.operator.linop.diff.DirectionalGradient"><code class="xref py py-func docutils literal notranslate"><span class="pre">DirectionalGradient()</span></code></a></p>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.operator.linop.diff.DirectionalGradient">
<span class="sig-name descname"><span class="pre">DirectionalGradient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diff_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fd'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">diff_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/diff.html#DirectionalGradient"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.diff.DirectionalGradient" title="Link to this definition">#</a></dt>
<dd><p>Directional gradient operator.</p>
<p class="rubric">Notes</p>
<p>The <code class="docutils literal notranslate"><span class="pre">DirectionalGradient</span></code> of a <span class="math notranslate nohighlight">\(D\)</span>-dimensional signal <span class="math notranslate nohighlight">\(\mathbf{f} \in \mathbb{R}^{N_0 \times \cdots
\times N_{D-1}}\)</span> stacks the directional derivatives of <span class="math notranslate nohighlight">\(\mathbf{f}\)</span> along a list of <span class="math notranslate nohighlight">\(m\)</span> directions
<span class="math notranslate nohighlight">\(\mathbf{v}_i\)</span> for <span class="math notranslate nohighlight">\(1 \leq i \leq m\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\boldsymbol{\nabla}_{\mathbf{v}_1, \ldots ,\mathbf{v}_m} \mathbf{f} = \begin{bmatrix}
     \boldsymbol{\nabla}_{\mathbf{v}_1} \\
     \vdots\\
     \boldsymbol{\nabla}_{\mathbf{v}_m}\\
    \end{bmatrix} \mathbf{f} \in \mathbb{R}^{m \times N_0 \times \cdots \times N_{D-1}},\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\boldsymbol{\nabla}_{\mathbf{v}_i}\)</span> is the first-order directional derivative along
<span class="math notranslate nohighlight">\(\mathbf{v}_i\)</span> implemented with <a class="reference internal" href="#pyxu.operator.linop.diff.DirectionalDerivative" title="pyxu.operator.linop.diff.DirectionalDerivative"><code class="xref py py-func docutils literal notranslate"><span class="pre">DirectionalDerivative()</span></code></a>, with
<span class="math notranslate nohighlight">\(\mathbf{v}_i \in \mathbb{R}^D\)</span> or <span class="math notranslate nohighlight">\(\mathbf{v}_i \in \mathbb{R}^{D \times N_0 \times \cdots \times
N_{D-1}}\)</span>.</p>
<p>Note that choosing <span class="math notranslate nohighlight">\(m=D\)</span> and <span class="math notranslate nohighlight">\(\mathbf{v}_i = \mathbf{e}_i \in \mathbb{R}^D\)</span> (the <span class="math notranslate nohighlight">\(i\)</span>-th canonical
basis vector) amounts to the <a class="reference internal" href="#pyxu.operator.linop.diff.Gradient" title="pyxu.operator.linop.diff.Gradient"><code class="xref py py-func docutils literal notranslate"><span class="pre">Gradient()</span></code></a> operator.</p>
<p>The directional gradient operator’s method <code class="xref py py-meth docutils literal notranslate"><span class="pre">unravel()</span></code> allows
reshaping the vectorized output directional derivative to <code class="docutils literal notranslate"><span class="pre">[...,</span> <span class="pre">n_dirs,</span> <span class="pre">N0,</span> <span class="pre">...,</span> <span class="pre">ND]</span></code> (see the example below).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arg_shape</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.NDArrayShape" title="pyxu.info.ptype.NDArrayShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayShape</span></code></a>) – Shape of the input array.</p></li>
<li><p><strong>directions</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list[NDArray]</span></code>) – List of directions, either constant (array of size <span class="math notranslate nohighlight">\((D,)\)</span>) or spatially-varying (array of size <span class="math notranslate nohighlight">\((D,
N_0, \ldots, N_{D-1})\)</span>)</p></li>
<li><p><strong>diff_method</strong> (<code class="docutils literal notranslate"><span class="pre">"gd"</span></code>, <code class="docutils literal notranslate"><span class="pre">"fd"</span></code>) – <p>Method used to approximate the derivative. Must be one of:</p>
<ul>
<li><p>’fd’ (default): finite differences</p></li>
<li><p>’gd’: Gaussian derivative</p></li>
</ul>
</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[str]</span></code>) – <p>Boundary conditions.
Multiple forms are accepted:</p>
<ul>
<li><p>str: unique mode shared amongst dimensions.
Must be one of:</p>
<ul>
<li><p>’constant’ (default): zero-padding</p></li>
<li><p>’wrap’</p></li>
<li><p>’reflect’</p></li>
<li><p>’symmetric’</p></li>
<li><p>’edge’</p></li>
</ul>
</li>
<li><p>tuple[str, …]: the <code class="code docutils literal notranslate"><span class="pre">d</span></code>-th dimension uses <code class="docutils literal notranslate"><span class="pre">mode[d]</span></code> as boundary condition.</p></li>
</ul>
<p>(See <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.pad.html#numpy.pad" title="(in NumPy v1.25)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.pad()</span></code></a> for details.)</p>
</p></li>
<li><p><strong>parallel</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, use Dask to evaluate the different partial derivatives in parallel.</p></li>
<li><p><strong>diff_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>) – Keyword arguments to parametrize partial derivatives (see
<a class="reference internal" href="#pyxu.operator.linop.diff.PartialDerivative.finite_difference" title="pyxu.operator.linop.diff.PartialDerivative.finite_difference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">finite_difference()</span></code></a> and
<a class="reference internal" href="#pyxu.operator.linop.diff.PartialDerivative.gaussian_derivative" title="pyxu.operator.linop.diff.PartialDerivative.gaussian_derivative"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gaussian_derivative()</span></code></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>op</strong> – Directional gradient</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/index.html#module-numpy" title="numpy"><span class="nn">numpy</span></a> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/pyplot_summary.html#module-matplotlib.pyplot" title="matplotlib.pyplot"><span class="nn">matplotlib.pyplot</span></a> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">pyxu.operator</span> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.linop.diff.DirectionalGradient" title="pyxu.operator.linop.diff.DirectionalGradient"><span class="n">DirectionalGradient</span></a>
<span class="kn">from</span> <a class="sphinx-codeautolink-a" href="../../api/util.html#module-pyxu.util.misc" title="pyxu.util.misc"><span class="nn">pyxu.util.misc</span></a> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/util.html#pyxu.util.misc.peaks" title="pyxu.util.misc.peaks"><span class="n">peaks</span></a>

<span class="n">x</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.linspace.html#numpy.linspace" title="numpy.linspace"><span class="n">np</span><span class="o">.</span><span class="n">linspace</span></a><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
<span class="n">xx</span><span class="p">,</span> <span class="n">yy</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.meshgrid.html#numpy.meshgrid" title="numpy.meshgrid"><span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span></a><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/util.html#pyxu.util.misc.peaks" title="pyxu.util.misc.peaks"><span class="n">peaks</span></a><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">)</span>
<span class="n">directions1</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
<span class="n">directions1</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:</span><span class="n">z</span><span class="o">.</span><span class="n">size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">directions1</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">z</span><span class="o">.</span><span class="n">size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">:]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">directions2</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
<span class="n">directions2</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:</span><span class="n">z</span><span class="o">.</span><span class="n">size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">directions2</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">z</span><span class="o">.</span><span class="n">size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">:]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">arg_shape</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">shape</span>
<span class="n">dop</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.linop.diff.DirectionalGradient" title="pyxu.operator.linop.diff.DirectionalGradient"><span class="n">DirectionalGradient</span></a><span class="p">(</span><span class="n">arg_shape</span><span class="o">=</span><span class="n">arg_shape</span><span class="p">,</span> <span class="n">directions</span><span class="o">=</span><span class="p">[</span><span class="n">directions1</span><span class="p">,</span> <span class="n">directions2</span><span class="p">])</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">dop</span><span class="o">.</span><span class="n">unravel</span><span class="p">(</span><span class="n">dop</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">ravel</span><span class="p">()))</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
<span class="n">h</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.pcolormesh.html#matplotlib.pyplot.pcolormesh" title="matplotlib.pyplot.pcolormesh"><span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span></a><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">shading</span><span class="o">=</span><span class="s1">'auto'</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.quiver.html#matplotlib.pyplot.quiver" title="matplotlib.pyplot.quiver"><span class="n">plt</span><span class="o">.</span><span class="n">quiver</span></a><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">directions1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">arg_shape</span><span class="p">),</span> <span class="n">directions1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">xx</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.quiver.html#matplotlib.pyplot.quiver" title="matplotlib.pyplot.quiver"><span class="n">plt</span><span class="o">.</span><span class="n">quiver</span></a><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">directions2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">arg_shape</span><span class="p">),</span> <span class="n">directions2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">xx</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">'red'</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="sa">r</span><span class="s1">'Signal $\mathbf</span><span class="si">{f}</span><span class="s1">$ and directions of derivatives'</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
<span class="n">h</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.pcolormesh.html#matplotlib.pyplot.pcolormesh" title="matplotlib.pyplot.pcolormesh"><span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span></a><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">shading</span><span class="o">=</span><span class="s1">'auto'</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="sa">r</span><span class="s1">'$\nabla_{\mathbf</span><span class="si">{v}</span><span class="s1">_0} \mathbf</span><span class="si">{f}</span><span class="s1">$'</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
<span class="n">h</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.pcolormesh.html#matplotlib.pyplot.pcolormesh" title="matplotlib.pyplot.pcolormesh"><span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span></a><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">out</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">shading</span><span class="o">=</span><span class="s1">'auto'</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="sa">r</span><span class="s1">'$\nabla_{\mathbf</span><span class="si">{v}</span><span class="s1">_1} \mathbf</span><span class="si">{f}</span><span class="s1">$'</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../_downloads/e1a75dcc78d38d076dc2ecbd8c33f9ad/linop-11.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>)</p>
<figure class="align-default" id="id33">
<img alt="../../_images/linop-11_00.png" class="plot-directive" src="../../_images/linop-11_00.png"/>
<figcaption>
<p><span class="caption-text">(<a class="reference download internal" download="" href="../../_downloads/8e2b9f5b48a9fcb61cddedef5641d524/linop-11_00.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/05ca4c1d7c08843dd63c373f56165367/linop-11_00.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/1cd8e614728fc68270743fa172a043f0/linop-11_00.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</span><a class="headerlink" href="#id33" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id34">
<img alt="../../_images/linop-11_01.png" class="plot-directive" src="../../_images/linop-11_01.png"/>
<figcaption>
<p><span class="caption-text">(<a class="reference download internal" download="" href="../../_downloads/1afb1ff7f88d33f9d3bf15c2560c74ef/linop-11_01.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/1702b305e1cb9e54e7738ebc64606e50/linop-11_01.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/e0eefa74af9eff0db39630aafbdd32db/linop-11_01.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</span><a class="headerlink" href="#id34" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id35">
<img alt="../../_images/linop-11_02.png" class="plot-directive" src="../../_images/linop-11_02.png"/>
<figcaption>
<p><span class="caption-text">(<a class="reference download internal" download="" href="../../_downloads/ebb87a8c84008c9385f6e91393987384/linop-11_02.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/157c6163c0348ead39d6ceb2a1fd7fbe/linop-11_02.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/5a9ba501121acc4e444b2d68b182a34f/linop-11_02.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</span><a class="headerlink" href="#id35" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyxu.operator.linop.diff.Gradient" title="pyxu.operator.linop.diff.Gradient"><code class="xref py py-func docutils literal notranslate"><span class="pre">Gradient()</span></code></a>, <a class="reference internal" href="#pyxu.operator.linop.diff.DirectionalDerivative" title="pyxu.operator.linop.diff.DirectionalDerivative"><code class="xref py py-func docutils literal notranslate"><span class="pre">DirectionalDerivative()</span></code></a></p>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.operator.linop.diff.DirectionalLaplacian">
<span class="sig-name descname"><span class="pre">DirectionalLaplacian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diff_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fd'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">diff_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/diff.html#DirectionalLaplacian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.diff.DirectionalLaplacian" title="Link to this definition">#</a></dt>
<dd><p>Directional Laplacian operator.</p>
<p>Sum of the second directional derivatives of a multi-dimensional array (at least two dimensions are required) along
multiple <code class="docutils literal notranslate"><span class="pre">directions</span></code> for each entry of the array.</p>
<p class="rubric">Notes</p>
<p>The <code class="docutils literal notranslate"><span class="pre">DirectionalLaplacian</span></code> of a <span class="math notranslate nohighlight">\(D\)</span>-dimensional signal <span class="math notranslate nohighlight">\(\mathbf{f} \in \mathbb{R}^{N_0 \times \cdots
\times N_{D-1}}\)</span> sums the second-order directional derivatives of <span class="math notranslate nohighlight">\(\mathbf{f}\)</span> along a list of <span class="math notranslate nohighlight">\(m\)</span>
directions <span class="math notranslate nohighlight">\(\mathbf{v}_i\)</span> for <span class="math notranslate nohighlight">\(1 \leq i \leq m\)</span>:</p>
<div class="math notranslate nohighlight">
\[\boldsymbol{\Delta}_{\mathbf{v}_1, \ldots ,\mathbf{v}_m} \mathbf{f} = \sum_{i=1}^m
\boldsymbol{\nabla}^2_{\mathbf{v}_i} \mathbf{f} \in \mathbb{R}^{N_0 \times \cdots \times N_{D-1}},\]</div>
<p>where <span class="math notranslate nohighlight">\(\boldsymbol{\nabla}^2_{\mathbf{v}_i}\)</span> is the second-order directional derivative along
<span class="math notranslate nohighlight">\(\mathbf{v}_i\)</span> implemented with <a class="reference internal" href="#pyxu.operator.linop.diff.DirectionalDerivative" title="pyxu.operator.linop.diff.DirectionalDerivative"><code class="xref py py-func docutils literal notranslate"><span class="pre">DirectionalDerivative()</span></code></a>.</p>
<p>Note that choosing <span class="math notranslate nohighlight">\(m=D\)</span> and <span class="math notranslate nohighlight">\(\mathbf{v}_i = \mathbf{e}_i \in \mathbb{R}^D\)</span> (the <span class="math notranslate nohighlight">\(i\)</span>-th canonical
basis vector) amounts to the <a class="reference internal" href="#pyxu.operator.linop.diff.Laplacian" title="pyxu.operator.linop.diff.Laplacian"><code class="xref py py-func docutils literal notranslate"><span class="pre">Laplacian()</span></code></a> operator.</p>
<p>The directional Laplacian operator’s method <code class="xref py py-meth docutils literal notranslate"><span class="pre">unravel()</span></code> allows
reshaping the vectorized output directional Laplacian to <code class="docutils literal notranslate"><span class="pre">[...,</span> <span class="pre">N0,</span> <span class="pre">...,</span> <span class="pre">ND]</span></code> (see the example below).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arg_shape</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.NDArrayShape" title="pyxu.info.ptype.NDArrayShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayShape</span></code></a>) – Shape of the input array.</p></li>
<li><p><strong>directions</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list[NDArray]</span></code>) – List of directions, either constant (array of size <span class="math notranslate nohighlight">\((D,)\)</span>) or spatially-varying (array of size
<span class="math notranslate nohighlight">\((D, N_0, \ldots, N_{D-1})\)</span>)</p></li>
<li><p><strong>weights</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list[Real]</span></code>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>) – List of optional positive weights with which each second directional derivative operator is multiplied.</p></li>
<li><p><strong>diff_method</strong> (<code class="docutils literal notranslate"><span class="pre">"gd"</span></code>, <code class="docutils literal notranslate"><span class="pre">"fd"</span></code>) – <p>Method used to approximate the derivative. Must be one of:</p>
<ul>
<li><p>’fd’ (default): finite differences</p></li>
<li><p>’gd’: Gaussian derivative</p></li>
</ul>
</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[str]</span></code>) – <p>Boundary conditions.
Multiple forms are accepted:</p>
<ul>
<li><p>str: unique mode shared amongst dimensions.
Must be one of:</p>
<ul>
<li><p>’constant’ (default): zero-padding</p></li>
<li><p>’wrap’</p></li>
<li><p>’reflect’</p></li>
<li><p>’symmetric’</p></li>
<li><p>’edge’</p></li>
</ul>
</li>
<li><p>tuple[str, …]: the <code class="code docutils literal notranslate"><span class="pre">d</span></code>-th dimension uses <code class="docutils literal notranslate"><span class="pre">mode[d]</span></code> as boundary condition.</p></li>
</ul>
<p>(See <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.pad.html#numpy.pad" title="(in NumPy v1.25)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.pad()</span></code></a> for details.)</p>
</p></li>
<li><p><strong>parallel</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, use Dask to evaluate the different partial derivatives in parallel.</p></li>
<li><p><strong>diff_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>) – Keyword arguments to parametrize partial derivatives (see
<a class="reference internal" href="#pyxu.operator.linop.diff.PartialDerivative.finite_difference" title="pyxu.operator.linop.diff.PartialDerivative.finite_difference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">finite_difference()</span></code></a> and
<a class="reference internal" href="#pyxu.operator.linop.diff.PartialDerivative.gaussian_derivative" title="pyxu.operator.linop.diff.PartialDerivative.gaussian_derivative"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gaussian_derivative()</span></code></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>op</strong> – Directional Laplacian</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/index.html#module-numpy" title="numpy"><span class="nn">numpy</span></a> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/pyplot_summary.html#module-matplotlib.pyplot" title="matplotlib.pyplot"><span class="nn">matplotlib.pyplot</span></a> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">pyxu.operator</span> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.linop.diff.DirectionalLaplacian" title="pyxu.operator.linop.diff.DirectionalLaplacian"><span class="n">DirectionalLaplacian</span></a>
<span class="kn">from</span> <a class="sphinx-codeautolink-a" href="../../api/util.html#module-pyxu.util.misc" title="pyxu.util.misc"><span class="nn">pyxu.util.misc</span></a> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/util.html#pyxu.util.misc.peaks" title="pyxu.util.misc.peaks"><span class="n">peaks</span></a>

<span class="n">x</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.linspace.html#numpy.linspace" title="numpy.linspace"><span class="n">np</span><span class="o">.</span><span class="n">linspace</span></a><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
<span class="n">xx</span><span class="p">,</span> <span class="n">yy</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.meshgrid.html#numpy.meshgrid" title="numpy.meshgrid"><span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span></a><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/util.html#pyxu.util.misc.peaks" title="pyxu.util.misc.peaks"><span class="n">peaks</span></a><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">)</span>
<span class="n">directions1</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
<span class="n">directions1</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:</span><span class="n">z</span><span class="o">.</span><span class="n">size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">directions1</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">z</span><span class="o">.</span><span class="n">size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">:]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">directions2</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
<span class="n">directions2</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:</span><span class="n">z</span><span class="o">.</span><span class="n">size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">directions2</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">z</span><span class="o">.</span><span class="n">size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">:]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">arg_shape</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">shape</span>
<span class="n">dop</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.linop.diff.DirectionalLaplacian" title="pyxu.operator.linop.diff.DirectionalLaplacian"><span class="n">DirectionalLaplacian</span></a><span class="p">(</span><span class="n">arg_shape</span><span class="o">=</span><span class="n">arg_shape</span><span class="p">,</span> <span class="n">directions</span><span class="o">=</span><span class="p">[</span><span class="n">directions1</span><span class="p">,</span> <span class="n">directions2</span><span class="p">])</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">dop</span><span class="o">.</span><span class="n">unravel</span><span class="p">(</span><span class="n">dop</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">ravel</span><span class="p">()))</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
<span class="n">h</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.pcolormesh.html#matplotlib.pyplot.pcolormesh" title="matplotlib.pyplot.pcolormesh"><span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span></a><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">shading</span><span class="o">=</span><span class="s1">'auto'</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.quiver.html#matplotlib.pyplot.quiver" title="matplotlib.pyplot.quiver"><span class="n">plt</span><span class="o">.</span><span class="n">quiver</span></a><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">directions1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">arg_shape</span><span class="p">),</span> <span class="n">directions1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">xx</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.quiver.html#matplotlib.pyplot.quiver" title="matplotlib.pyplot.quiver"><span class="n">plt</span><span class="o">.</span><span class="n">quiver</span></a><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">directions2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">arg_shape</span><span class="p">),</span> <span class="n">directions2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">xx</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">'red'</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="s1">'Signal and directions of derivatives'</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
<span class="n">h</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.pcolormesh.html#matplotlib.pyplot.pcolormesh" title="matplotlib.pyplot.pcolormesh"><span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span></a><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">out</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span> <span class="n">shading</span><span class="o">=</span><span class="s1">'auto'</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="s1">'Directional Laplacian'</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../_downloads/7a277daee554ebe111b667c4f725a8be/linop-12.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>)</p>
<figure class="align-default" id="id36">
<img alt="../../_images/linop-12_00.png" class="plot-directive" src="../../_images/linop-12_00.png"/>
<figcaption>
<p><span class="caption-text">(<a class="reference download internal" download="" href="../../_downloads/af4585b8ef6fabd3efe8eeac055bf5d2/linop-12_00.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/3ca7b9e313a7885723b3846da42ca297/linop-12_00.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/fd4ec1dae59f3f8ce46dd8ad9d29ad84/linop-12_00.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</span><a class="headerlink" href="#id36" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id37">
<img alt="../../_images/linop-12_01.png" class="plot-directive" src="../../_images/linop-12_01.png"/>
<figcaption>
<p><span class="caption-text">(<a class="reference download internal" download="" href="../../_downloads/73239aa6bc7317b86007b13e92ace8c8/linop-12_01.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/8c40864482c4ade0ec4f5abf4ca000a2/linop-12_01.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/6902f0f4b2fd599de9c794c345b38a48/linop-12_01.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</span><a class="headerlink" href="#id37" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyxu.operator.linop.diff.Laplacian" title="pyxu.operator.linop.diff.Laplacian"><code class="xref py py-func docutils literal notranslate"><span class="pre">Laplacian()</span></code></a>, <a class="reference internal" href="#pyxu.operator.linop.diff.DirectionalDerivative" title="pyxu.operator.linop.diff.DirectionalDerivative"><code class="xref py py-func docutils literal notranslate"><span class="pre">DirectionalDerivative()</span></code></a></p>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.operator.linop.diff.DirectionalHessian">
<span class="sig-name descname"><span class="pre">DirectionalHessian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diff_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gd'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">diff_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/diff.html#DirectionalHessian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.diff.DirectionalHessian" title="Link to this definition">#</a></dt>
<dd><p>Directional Hessian operator.</p>
<p class="rubric">Notes</p>
<p>The <code class="docutils literal notranslate"><span class="pre">DirectionalHessian</span></code> of a <span class="math notranslate nohighlight">\(D\)</span>-dimensional signal <span class="math notranslate nohighlight">\(\mathbf{f} \in \mathbb{R}^{N_0 \times \cdots
\times N_{D-1}}\)</span> stacks the second-order directional derivatives of <span class="math notranslate nohighlight">\(\mathbf{f}\)</span> along a list of <span class="math notranslate nohighlight">\(m\)</span>
directions <span class="math notranslate nohighlight">\(\mathbf{v}_i\)</span> for <span class="math notranslate nohighlight">\(1 \leq i \leq m\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{H}_{\mathbf{v}_1, \ldots ,\mathbf{v}_m} \mathbf{f} = \begin{bmatrix}
\boldsymbol{\nabla}^2_{\mathbf{v}_0} &amp; \cdots &amp; \boldsymbol{\nabla}_{\mathbf{v}_0} \boldsymbol{\nabla}_{\mathbf{v}_{m-1}} \\
\vdots &amp; \ddots &amp; \vdots \\
\boldsymbol{\nabla}_{\mathbf{v}_{m-1}} \boldsymbol{\nabla}_{\mathbf{v}_0} &amp; \cdots &amp; \boldsymbol{\nabla}^2_{\mathbf{v}_{m-1}}
\end{bmatrix} \mathbf{f},\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\boldsymbol{\nabla}_{\mathbf{v}_i}\)</span> is the first-order directional derivative along
<span class="math notranslate nohighlight">\(\mathbf{v}_i\)</span> implemented with <a class="reference internal" href="#pyxu.operator.linop.diff.DirectionalDerivative" title="pyxu.operator.linop.diff.DirectionalDerivative"><code class="xref py py-func docutils literal notranslate"><span class="pre">DirectionalDerivative()</span></code></a>.</p>
<p>However, due to the symmetry of the Hessian, only the upper triangular part is computed in practice:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{H}_{\mathbf{v}_1, \ldots ,\mathbf{v}_m} \mathbf{f} = \begin{bmatrix}
\boldsymbol{\nabla}^2_{\mathbf{v}_0}\\
\boldsymbol{\nabla}_{\mathbf{v}_0} \boldsymbol{\nabla}_{\mathbf{v}_{1}} \\
\vdots \\
\boldsymbol{\nabla}^2_{\mathbf{v}_{m-1}}
\end{bmatrix} \mathbf{f} \in \mathbb{R}^{\frac{m (m-1)}{2} \times N_0 \times \cdots \times N_{D-1}}\end{split}\]</div>
<p>Note that choosing <span class="math notranslate nohighlight">\(m=D\)</span> and <span class="math notranslate nohighlight">\(\mathbf{v}_i = \mathbf{e}_i \in \mathbb{R}^D\)</span> (the <span class="math notranslate nohighlight">\(i\)</span>-th canonical
basis vector) amounts to the <a class="reference internal" href="#pyxu.operator.linop.diff.Hessian" title="pyxu.operator.linop.diff.Hessian"><code class="xref py py-func docutils literal notranslate"><span class="pre">Hessian()</span></code></a> operator.</p>
<p>The directional Hessian operator’s method <code class="xref py py-meth docutils literal notranslate"><span class="pre">unravel()</span></code> allows
reshaping the vectorized output directional Hessian to <code class="docutils literal notranslate"><span class="pre">[...,</span> <span class="pre">n_dirs,</span> <span class="pre">N0,</span> <span class="pre">...,</span> <span class="pre">ND]</span></code> (see the example below).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arg_shape</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.NDArrayShape" title="pyxu.info.ptype.NDArrayShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayShape</span></code></a>) – Shape of the input array.</p></li>
<li><p><strong>directions</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list[NDArray]</span></code>) – List of directions, either constant (array of size <span class="math notranslate nohighlight">\((D,)\)</span>) or spatially-varying (array of size <span class="math notranslate nohighlight">\((D,
N_0, \ldots, N_{D-1})\)</span>)</p></li>
<li><p><strong>diff_method</strong> (<code class="docutils literal notranslate"><span class="pre">"gd"</span></code>, <code class="docutils literal notranslate"><span class="pre">"fd"</span></code>) – <p>Method used to approximate the derivative. Must be one of:</p>
<ul>
<li><p>’fd’ (default): finite differences</p></li>
<li><p>’gd’: Gaussian derivative</p></li>
</ul>
</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[str]</span></code>) – <p>Boundary conditions.
Multiple forms are accepted:</p>
<ul>
<li><p>str: unique mode shared amongst dimensions.
Must be one of:</p>
<ul>
<li><p>’constant’ (default): zero-padding</p></li>
<li><p>’wrap’</p></li>
<li><p>’reflect’</p></li>
<li><p>’symmetric’</p></li>
<li><p>’edge’</p></li>
</ul>
</li>
<li><p>tuple[str, …]: the <code class="code docutils literal notranslate"><span class="pre">d</span></code>-th dimension uses <code class="docutils literal notranslate"><span class="pre">mode[d]</span></code> as boundary condition.</p></li>
</ul>
<p>(See <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.pad.html#numpy.pad" title="(in NumPy v1.25)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.pad()</span></code></a> for details.)</p>
</p></li>
<li><p><strong>parallel</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, use Dask to evaluate the different partial derivatives in parallel.</p></li>
<li><p><strong>diff_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>) – Keyword arguments to parametrize partial derivatives (see
<a class="reference internal" href="#pyxu.operator.linop.diff.PartialDerivative.finite_difference" title="pyxu.operator.linop.diff.PartialDerivative.finite_difference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">finite_difference()</span></code></a> and
<a class="reference internal" href="#pyxu.operator.linop.diff.PartialDerivative.gaussian_derivative" title="pyxu.operator.linop.diff.PartialDerivative.gaussian_derivative"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gaussian_derivative()</span></code></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>op</strong> – Directional Hessian</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/index.html#module-numpy" title="numpy"><span class="nn">numpy</span></a> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/pyplot_summary.html#module-matplotlib.pyplot" title="matplotlib.pyplot"><span class="nn">matplotlib.pyplot</span></a> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">pyxu.operator</span> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.linop.diff.DirectionalHessian" title="pyxu.operator.linop.diff.DirectionalHessian"><span class="n">DirectionalHessian</span></a>
<span class="kn">from</span> <a class="sphinx-codeautolink-a" href="../../api/util.html#module-pyxu.util.misc" title="pyxu.util.misc"><span class="nn">pyxu.util.misc</span></a> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/util.html#pyxu.util.misc.peaks" title="pyxu.util.misc.peaks"><span class="n">peaks</span></a>

<span class="n">x</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.linspace.html#numpy.linspace" title="numpy.linspace"><span class="n">np</span><span class="o">.</span><span class="n">linspace</span></a><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
<span class="n">xx</span><span class="p">,</span> <span class="n">yy</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.meshgrid.html#numpy.meshgrid" title="numpy.meshgrid"><span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span></a><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/util.html#pyxu.util.misc.peaks" title="pyxu.util.misc.peaks"><span class="n">peaks</span></a><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">)</span>
<span class="n">directions1</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
<span class="n">directions1</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:</span><span class="n">z</span><span class="o">.</span><span class="n">size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">directions1</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">z</span><span class="o">.</span><span class="n">size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">:]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">directions2</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
<span class="n">directions2</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:</span><span class="n">z</span><span class="o">.</span><span class="n">size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">directions2</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">z</span><span class="o">.</span><span class="n">size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">:]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">arg_shape</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">shape</span>
<span class="n">d_hess</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.linop.diff.DirectionalHessian" title="pyxu.operator.linop.diff.DirectionalHessian"><span class="n">DirectionalHessian</span></a><span class="p">(</span><span class="n">arg_shape</span><span class="o">=</span><span class="n">arg_shape</span><span class="p">,</span> <span class="n">directions</span><span class="o">=</span><span class="p">[</span><span class="n">directions1</span><span class="p">,</span> <span class="n">directions2</span><span class="p">])</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">d_hess</span><span class="o">.</span><span class="n">unravel</span><span class="p">(</span><span class="n">d_hess</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">ravel</span><span class="p">()))</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
<span class="n">h</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.pcolormesh.html#matplotlib.pyplot.pcolormesh" title="matplotlib.pyplot.pcolormesh"><span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span></a><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">shading</span><span class="o">=</span><span class="s1">'auto'</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.quiver.html#matplotlib.pyplot.quiver" title="matplotlib.pyplot.quiver"><span class="n">plt</span><span class="o">.</span><span class="n">quiver</span></a><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">directions1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">arg_shape</span><span class="p">),</span> <span class="n">directions1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">xx</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.quiver.html#matplotlib.pyplot.quiver" title="matplotlib.pyplot.quiver"><span class="n">plt</span><span class="o">.</span><span class="n">quiver</span></a><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">directions2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">arg_shape</span><span class="p">),</span> <span class="n">directions2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">xx</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">'red'</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="sa">r</span><span class="s1">'Signal $\mathbf</span><span class="si">{f}</span><span class="s1">$ and directions of derivatives'</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
<span class="n">h</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.pcolormesh.html#matplotlib.pyplot.pcolormesh" title="matplotlib.pyplot.pcolormesh"><span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span></a><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">shading</span><span class="o">=</span><span class="s1">'auto'</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="sa">r</span><span class="s1">'$\nabla^2_{\mathbf</span><span class="si">{v}</span><span class="s1">_0} \mathbf</span><span class="si">{f}</span><span class="s1">$'</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
<span class="n">h</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.pcolormesh.html#matplotlib.pyplot.pcolormesh" title="matplotlib.pyplot.pcolormesh"><span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span></a><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">out</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">shading</span><span class="o">=</span><span class="s1">'auto'</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="sa">r</span><span class="s1">'$\nabla_{\mathbf</span><span class="si">{v}</span><span class="s1">_0} \nabla_{\mathbf</span><span class="si">{v}</span><span class="s1">_</span><span class="si">{1}</span><span class="s1">} \mathbf</span><span class="si">{f}</span><span class="s1">$'</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
<span class="n">h</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.pcolormesh.html#matplotlib.pyplot.pcolormesh" title="matplotlib.pyplot.pcolormesh"><span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span></a><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">out</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">shading</span><span class="o">=</span><span class="s1">'auto'</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="sa">r</span><span class="s1">'$\nabla^2_{\mathbf</span><span class="si">{v}</span><span class="s1">_1} \mathbf</span><span class="si">{f}</span><span class="s1">$'</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../_downloads/0621d0c54bd7a885d7e18dbeba324de3/linop-13.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>)</p>
<figure class="align-default" id="id38">
<img alt="../../_images/linop-13_00.png" class="plot-directive" src="../../_images/linop-13_00.png"/>
<figcaption>
<p><span class="caption-text">(<a class="reference download internal" download="" href="../../_downloads/c6b0f3c315acd2b5a9a28ec22e1ea553/linop-13_00.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/056a52abc2bba483fc2b1a564d9714ff/linop-13_00.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/89cf7e77837a5c3249511293b70d7aa2/linop-13_00.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</span><a class="headerlink" href="#id38" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id39">
<img alt="../../_images/linop-13_01.png" class="plot-directive" src="../../_images/linop-13_01.png"/>
<figcaption>
<p><span class="caption-text">(<a class="reference download internal" download="" href="../../_downloads/0f251ac595e8816e9c76523c2acfad07/linop-13_01.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/9ef5b55562f46c73423fa8bff428227e/linop-13_01.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/0f65a5f8726612599305eeb053b028a0/linop-13_01.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</span><a class="headerlink" href="#id39" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id40">
<img alt="../../_images/linop-13_02.png" class="plot-directive" src="../../_images/linop-13_02.png"/>
<figcaption>
<p><span class="caption-text">(<a class="reference download internal" download="" href="../../_downloads/d94d98623f466a362f24485e332111fc/linop-13_02.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/6e540c944bfd9490bda771e3a4d2d051/linop-13_02.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/b1cab852cc8994069d3eb7349822e126/linop-13_02.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</span><a class="headerlink" href="#id40" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id41">
<img alt="../../_images/linop-13_03.png" class="plot-directive" src="../../_images/linop-13_03.png"/>
<figcaption>
<p><span class="caption-text">(<a class="reference download internal" download="" href="../../_downloads/55d371222ffd54cabbfd4963a3d08463/linop-13_03.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/939913c4d6f629c9f874b65940808e69/linop-13_03.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/e52263af1a66ae9a23ee58f7c56f3a6f/linop-13_03.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</span><a class="headerlink" href="#id41" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyxu.operator.linop.diff.Hessian" title="pyxu.operator.linop.diff.Hessian"><code class="xref py py-func docutils literal notranslate"><span class="pre">Hessian()</span></code></a>, <a class="reference internal" href="#pyxu.operator.linop.diff.DirectionalDerivative" title="pyxu.operator.linop.diff.DirectionalDerivative"><code class="xref py py-func docutils literal notranslate"><span class="pre">DirectionalDerivative()</span></code></a></p>
</div>
</dd></dl>
</section>
<section id="filters">
<h2><a class="toc-backref" href="#id46" role="doc-backlink">Filters</a><a class="headerlink" href="#filters" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.operator.linop.filter.MovingAverage">
<span class="sig-name descname"><span class="pre">MovingAverage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gpu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/filter.html#MovingAverage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.filter.MovingAverage" title="Link to this definition">#</a></dt>
<dd><p>Multidimensional moving average or uniform filter.</p>
<p class="rubric">Notes</p>
<p>This operator performs a convolution between the input <span class="math notranslate nohighlight">\(D\)</span>-dimensional NDArray <span class="math notranslate nohighlight">\(\mathbf{x} \in
\mathbb{R}^{N_0 \times \cdots \times N_{D-1}}\)</span> and a uniform <span class="math notranslate nohighlight">\(D\)</span>-dimensional filter <span class="math notranslate nohighlight">\(\mathbf{h} \in
\mathbb{R}^{\text{size} \times \cdots \times \text{size}}\)</span> that computes the <code class="code docutils literal notranslate"><span class="pre">size</span></code>-point local mean values using
separable kernels for improved performance.</p>
<div class="math notranslate nohighlight">
\[y_{i} = \frac{1}{|\mathcal{N}_{i}|}\sum_{j \in \mathcal{N}_{i}} x_{j}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\mathcal{N}_{i}\)</span> is the set of elements neighbouring the <span class="math notranslate nohighlight">\(i\)</span>-th element of the input array, and
<span class="math notranslate nohighlight">\(\mathcal{N}_{i}\)</span> denotes its cardinality, i.e. the total number of neighbors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arg_shape</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.NDArrayShape" title="pyxu.info.ptype.NDArrayShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayShape</span></code></a>) – Shape of the input array.</p></li>
<li><p><strong>size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>) – <p>Size of the moving average kernel.</p>
<p>If a single integer value is provided, then the moving average filter will have as many dimensions as the input
array.
If a tuple is provided, it should contain as many elements as <code class="code docutils literal notranslate"><span class="pre">arg_shape</span></code>.
For example, the <code class="docutils literal notranslate"><span class="pre">size=(1,</span> <span class="pre">3)</span></code> will convolve the input image with the filter <code class="docutils literal notranslate"><span class="pre">[[1,</span> <span class="pre">1,</span> <span class="pre">1]]</span> <span class="pre">/</span> <span class="pre">3</span></code>.</p>
</p></li>
<li><p><strong>center</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">IndexSpec</span></code>) – <p>(i_1, …, i_D) index of the kernel’s center.</p>
<p><code class="code docutils literal notranslate"><span class="pre">center</span></code> defines how a kernel is overlaid on inputs to produce outputs.
For odd <code class="code docutils literal notranslate"><span class="pre">size</span></code>, it defaults to the central element (<code class="docutils literal notranslate"><span class="pre">center=size//2</span></code>).
For even <code class="code docutils literal notranslate"><span class="pre">size</span></code> the desired center indices must be provided.</p>
</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[str]</span></code>) – <p>Boundary conditions.
Multiple forms are accepted:</p>
<ul>
<li><p>str: unique mode shared amongst dimensions.
Must be one of:</p>
<ul>
<li><p>’constant’ (default): zero-padding</p></li>
<li><p>’wrap’</p></li>
<li><p>’reflect’</p></li>
<li><p>’symmetric’</p></li>
<li><p>’edge’</p></li>
</ul>
</li>
<li><p>tuple[str, …]: the <code class="code docutils literal notranslate"><span class="pre">d</span></code>-th dimension uses <code class="code docutils literal notranslate"><span class="pre">mode[d]</span></code> as boundary condition.</p></li>
</ul>
<p>(See <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.pad.html#numpy.pad" title="(in NumPy v1.25)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.pad()</span></code></a> for details.)</p>
</p></li>
<li><p><strong>gpu</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Input NDArray type (<code class="code docutils literal notranslate"><span class="pre">True</span></code> for GPU, <code class="code docutils literal notranslate"><span class="pre">False</span></code> for CPU). Defaults to <code class="code docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>dtype</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.DType" title="pyxu.info.ptype.DType"><code class="xref py py-class docutils literal notranslate"><span class="pre">DType</span></code></a>) – Working precision of the linear operator.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>op</strong> – MovingAverage</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/pyplot_summary.html#module-matplotlib.pyplot" title="matplotlib.pyplot"><span class="nn">matplotlib.pyplot</span></a> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">pyxu.operator</span> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.linop.filter.MovingAverage" title="pyxu.operator.linop.filter.MovingAverage"><span class="n">MovingAverage</span></a>

<span class="n">arg_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">image</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">(</span><span class="n">arg_shape</span><span class="p">)</span>
<span class="n">image</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>

<span class="n">ma</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.linop.filter.MovingAverage" title="pyxu.operator.linop.filter.MovingAverage"><span class="n">MovingAverage</span></a><span class="p">(</span><span class="n">arg_shape</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">ma</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplot.html#matplotlib.pyplot.subplot" title="matplotlib.pyplot.subplot"><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span></a><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.imshow.html#matplotlib.pyplot.imshow" title="matplotlib.pyplot.imshow"><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span></a><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">()</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplot.html#matplotlib.pyplot.subplot" title="matplotlib.pyplot.subplot"><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span></a><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.imshow.html#matplotlib.pyplot.imshow" title="matplotlib.pyplot.imshow"><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span></a><span class="p">(</span><span class="n">out</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">*</span><span class="n">arg_shape</span><span class="p">))</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../_downloads/d899da601481b1ad85c1f7f702fa7044/linop-14.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/20c9215929fd9d943331468699173a26/linop-14.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/7c6a196c5691e8874ae3fb42a191bc83/linop-14.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/46ba4351fee97ccd2e3d0aba89e7413d/linop-14.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../../_images/linop-14.png" class="plot-directive" src="../../_images/linop-14.png"/>
</figure>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyxu.operator.linop.filter.Gaussian" title="pyxu.operator.linop.filter.Gaussian"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gaussian</span></code></a></p>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.operator.linop.filter.Gaussian">
<span class="sig-name descname"><span class="pre">Gaussian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">truncate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gpu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/filter.html#Gaussian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.filter.Gaussian" title="Link to this definition">#</a></dt>
<dd><p>Multidimensional Gaussian filter.</p>
<p class="rubric">Notes</p>
<p>This operator performs a convolution between the input <span class="math notranslate nohighlight">\(D\)</span>-dimensional NDArray <span class="math notranslate nohighlight">\(\mathbf{x} \in
\mathbb{R}^{N_0 \times \cdots \times N_{D-1}}\)</span> and a Gaussian <span class="math notranslate nohighlight">\(D\)</span>-dimensional filter <span class="math notranslate nohighlight">\(\mathbf{h} \in
\mathbb{R}^{\text{size} \times \cdots \times \text{size}}\)</span> using separable kernels for improved performance.</p>
<div class="math notranslate nohighlight">
\[y_{i} = \sum_{j \in \mathcal{N}_{i}} a_{j} x_{j} \exp(\frac{d_{ij}^{2}}{\sigma^{2}})\]</div>
<p>Where <span class="math notranslate nohighlight">\(\mathcal{N}_{i}\)</span> is the set of elements neighbouring the <span class="math notranslate nohighlight">\(i\)</span>-th element of the input array, and
<span class="math notranslate nohighlight">\(a_{j} = \sum_{j \in \mathcal{N}_{i}} a_{j} \exp(\frac{d_{ij}^{2}}{\sigma^{2}})\)</span> normalizes the kernel to sum
to one.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arg_shape</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.NDArrayShape" title="pyxu.info.ptype.NDArrayShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayShape</span></code></a>) – Shape of the input array.</p></li>
<li><p><strong>sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>) – <p>Standard deviation of the Gaussian kernel.</p>
<p>If a scalar value is provided, then the Gaussian filter will have as many dimensions as the input array.
If a tuple is provided, it should contain as many elements as <code class="code docutils literal notranslate"><span class="pre">arg_shape</span></code>.
Use <code class="docutils literal notranslate"><span class="pre">0</span></code> to prevent filtering in a given dimension.
For example, the <code class="docutils literal notranslate"><span class="pre">sigma=(0,</span> <span class="pre">3)</span></code> will convolve the input image in its last dimension.</p>
</p></li>
<li><p><strong>truncate</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>) – Truncate the filter at this many standard deviations.
Defaults to 3.0.</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>) – <p>Gaussian derivative order.</p>
<p>Use <code class="docutils literal notranslate"><span class="pre">0</span></code> for the standard Gaussian kernel.</p>
</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[str]</span></code>) – <p>Boundary conditions.
Multiple forms are accepted:</p>
<ul>
<li><p>str: unique mode shared amongst dimensions.
Must be one of:</p>
<ul>
<li><p>’constant’ (default): zero-padding</p></li>
<li><p>’wrap’</p></li>
<li><p>’reflect’</p></li>
<li><p>’symmetric’</p></li>
<li><p>’edge’</p></li>
</ul>
</li>
<li><p>tuple[str, …]: the <code class="code docutils literal notranslate"><span class="pre">d</span></code>-th dimension uses <code class="code docutils literal notranslate"><span class="pre">mode[d]</span></code> as boundary condition.</p></li>
</ul>
<p>(See <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.pad.html#numpy.pad" title="(in NumPy v1.25)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.pad()</span></code></a> for details.)</p>
</p></li>
<li><p><strong>sampling</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-class docutils literal notranslate"><span class="pre">Real</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[Real]</span></code>) – Sampling step (i.e. distance between two consecutive elements of an array).
Defaults to 1.</p></li>
<li><p><strong>gpu</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Input NDArray type (<code class="code docutils literal notranslate"><span class="pre">True</span></code> for GPU, <code class="code docutils literal notranslate"><span class="pre">False</span></code> for CPU).
Defaults to <code class="code docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>dtype</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.DType" title="pyxu.info.ptype.DType"><code class="xref py py-class docutils literal notranslate"><span class="pre">DType</span></code></a>) – Working precision of the linear operator.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>op</strong> – Gaussian</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/pyplot_summary.html#module-matplotlib.pyplot" title="matplotlib.pyplot"><span class="nn">matplotlib.pyplot</span></a> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">pyxu.operator</span> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.linop.filter.Gaussian" title="pyxu.operator.linop.filter.Gaussian"><span class="n">Gaussian</span></a>

<span class="n">arg_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">image</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">(</span><span class="n">arg_shape</span><span class="p">)</span>
<span class="n">image</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>

<span class="n">gaussian</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.linop.filter.Gaussian" title="pyxu.operator.linop.filter.Gaussian"><span class="n">Gaussian</span></a><span class="p">(</span><span class="n">arg_shape</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">gaussian</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplot.html#matplotlib.pyplot.subplot" title="matplotlib.pyplot.subplot"><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span></a><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.imshow.html#matplotlib.pyplot.imshow" title="matplotlib.pyplot.imshow"><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span></a><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">()</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplot.html#matplotlib.pyplot.subplot" title="matplotlib.pyplot.subplot"><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span></a><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.imshow.html#matplotlib.pyplot.imshow" title="matplotlib.pyplot.imshow"><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span></a><span class="p">(</span><span class="n">out</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">*</span><span class="n">arg_shape</span><span class="p">))</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../_downloads/3766306ab40d62f49982f6cbfd2d4ac7/linop-15.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/b625b60b9c2ea7c0965d290b09d2a43a/linop-15.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/78c81f9d963b95deb1d660029ac521fd/linop-15.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/5ebda40b456c165df2ad890040597b6f/linop-15.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../../_images/linop-15.png" class="plot-directive" src="../../_images/linop-15.png"/>
</figure>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyxu.operator.linop.filter.MovingAverage" title="pyxu.operator.linop.filter.MovingAverage"><code class="xref py py-class docutils literal notranslate"><span class="pre">MovingAverage</span></code></a>, <a class="reference internal" href="#pyxu.operator.linop.filter.DifferenceOfGaussians" title="pyxu.operator.linop.filter.DifferenceOfGaussians"><code class="xref py py-class docutils literal notranslate"><span class="pre">DifferenceOfGaussians</span></code></a></p>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.operator.linop.filter.DifferenceOfGaussians">
<span class="sig-name descname"><span class="pre">DifferenceOfGaussians</span></span><span class="sig-paren">(</span>
<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">arg_shape</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">low_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">high_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">low_truncate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">high_truncate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">sampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">gpu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>
<span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/filter.html#DifferenceOfGaussians"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.filter.DifferenceOfGaussians" title="Link to this definition">#</a></dt>
<dd><p>Multidimensional Difference of Gaussians filter.</p>
<p class="rubric">Notes</p>
<p>This operator uses the Difference of Gaussians (DoG) method to a <span class="math notranslate nohighlight">\(D\)</span>-dimensional NDArray <span class="math notranslate nohighlight">\(\mathbf{x} \in
\mathbb{R}^{N_0 \times \cdots \times N_{D-1}}\)</span> using separable kernels for improved performance.
The DoG method blurs the input image with two Gaussian kernels with different sigma, and subtracts the more-blurred
signal from the less-blurred image.
This creates an output signal containing only the information from the original signal at the spatial scale
indicated by the two sigmas.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arg_shape</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.NDArrayShape" title="pyxu.info.ptype.NDArrayShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayShape</span></code></a>) – Shape of the input array.</p></li>
<li><p><strong>low_sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>) – <p>Standard deviation of the Gaussian kernel with smaller sigmas across all axes.</p>
<p>If a scalar value is provided, then the Gaussian filter will have as many dimensions as the input array.
If a tuple is provided, it should contain as many elements as <code class="code docutils literal notranslate"><span class="pre">arg_shape</span></code>.
Use <code class="docutils literal notranslate"><span class="pre">0</span></code> to prevent filtering in a given dimension.
For example, the <code class="docutils literal notranslate"><span class="pre">low_sigma=(0,</span> <span class="pre">3)</span></code> will convolve the input image in its last dimension.</p>
</p></li>
<li><p><strong>high_sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>) – Standard deviation of the Gaussian kernel with larger sigmas across all axes.
If <code class="docutils literal notranslate"><span class="pre">None</span></code> is given (default), sigmas for all axes are calculated as <code class="docutils literal notranslate"><span class="pre">1.6</span> <span class="pre">*</span> <span class="pre">low_sigma</span></code>.</p></li>
<li><p><strong>low_truncate</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>) – Truncate the filter at this many standard deviations.
Defaults to 3.0.</p></li>
<li><p><strong>high_truncate</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>) – Truncate the filter at this many standard deviations.
Defaults to 3.0.</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[str]</span></code>) – <p>Boundary conditions.
Multiple forms are accepted:</p>
<ul>
<li><p>str: unique mode shared amongst dimensions.
Must be one of:</p>
<ul>
<li><p>’constant’ (default): zero-padding</p></li>
<li><p>’wrap’</p></li>
<li><p>’reflect’</p></li>
<li><p>’symmetric’</p></li>
<li><p>’edge’</p></li>
</ul>
</li>
<li><p>tuple[str, …]: the <code class="code docutils literal notranslate"><span class="pre">d</span></code>-th dimension uses <code class="code docutils literal notranslate"><span class="pre">mode[d]</span></code> as boundary condition.</p></li>
</ul>
<p>(See <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.pad.html#numpy.pad" title="(in NumPy v1.25)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.pad()</span></code></a> for details.)</p>
</p></li>
<li><p><strong>sampling</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-class docutils literal notranslate"><span class="pre">Real</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[Real]</span></code>) – Sampling step (i.e. distance between two consecutive elements of an array).
Defaults to 1.</p></li>
<li><p><strong>gpu</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Input NDArray type (<code class="code docutils literal notranslate"><span class="pre">True</span></code> for GPU, <code class="code docutils literal notranslate"><span class="pre">False</span></code> for CPU). Defaults to <code class="code docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>dtype</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.DType" title="pyxu.info.ptype.DType"><code class="xref py py-class docutils literal notranslate"><span class="pre">DType</span></code></a>) – Working precision of the linear operator.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>op</strong> – DifferenceOfGaussians</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/pyplot_summary.html#module-matplotlib.pyplot" title="matplotlib.pyplot"><span class="nn">matplotlib.pyplot</span></a> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">pyxu.operator</span> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.linop.filter.DifferenceOfGaussians" title="pyxu.operator.linop.filter.DifferenceOfGaussians"><span class="n">DoG</span></a>

<span class="n">arg_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">image</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">(</span><span class="n">arg_shape</span><span class="p">)</span>
<span class="n">image</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>

<span class="n">dog</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.linop.filter.DifferenceOfGaussians" title="pyxu.operator.linop.filter.DifferenceOfGaussians"><span class="n">DoG</span></a><span class="p">(</span><span class="n">arg_shape</span><span class="p">,</span> <span class="n">low_sigma</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">dog</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplot.html#matplotlib.pyplot.subplot" title="matplotlib.pyplot.subplot"><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span></a><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.imshow.html#matplotlib.pyplot.imshow" title="matplotlib.pyplot.imshow"><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span></a><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">()</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplot.html#matplotlib.pyplot.subplot" title="matplotlib.pyplot.subplot"><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span></a><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.imshow.html#matplotlib.pyplot.imshow" title="matplotlib.pyplot.imshow"><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span></a><span class="p">(</span><span class="n">out</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">*</span><span class="n">arg_shape</span><span class="p">))</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../_downloads/a57efbda9e1e769c7f98f7198c6a45f3/linop-16.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/4398d07d43693803394fb71e08107f57/linop-16.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/89e687938d2283eedd33996ddd31e3e8/linop-16.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/c6700c20988494320e4fca76fe07c2f7/linop-16.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../../_images/linop-16.png" class="plot-directive" src="../../_images/linop-16.png"/>
</figure>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyxu.operator.linop.filter.Gaussian" title="pyxu.operator.linop.filter.Gaussian"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gaussian</span></code></a>, <a class="reference internal" href="#pyxu.operator.linop.filter.Sobel" title="pyxu.operator.linop.filter.Sobel"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sobel</span></code></a>, <a class="reference internal" href="#pyxu.operator.linop.filter.Prewitt" title="pyxu.operator.linop.filter.Prewitt"><code class="xref py py-class docutils literal notranslate"><span class="pre">Prewitt</span></code></a>, <a class="reference internal" href="#pyxu.operator.linop.filter.Scharr" title="pyxu.operator.linop.filter.Scharr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Scharr</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">StructureTensor</span></code></p>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.operator.linop.filter.DoG">
<span class="sig-name descname"><span class="pre">DoG</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">low_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">high_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">low_truncate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">high_truncate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gpu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyxu.operator.linop.filter.DoG" title="Link to this definition">#</a></dt>
<dd><p>Multidimensional Difference of Gaussians filter.</p>
<p class="rubric">Notes</p>
<p>This operator uses the Difference of Gaussians (DoG) method to a <span class="math notranslate nohighlight">\(D\)</span>-dimensional NDArray <span class="math notranslate nohighlight">\(\mathbf{x} \in
\mathbb{R}^{N_0 \times \cdots \times N_{D-1}}\)</span> using separable kernels for improved performance.
The DoG method blurs the input image with two Gaussian kernels with different sigma, and subtracts the more-blurred
signal from the less-blurred image.
This creates an output signal containing only the information from the original signal at the spatial scale
indicated by the two sigmas.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arg_shape</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.NDArrayShape" title="pyxu.info.ptype.NDArrayShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayShape</span></code></a>) – Shape of the input array.</p></li>
<li><p><strong>low_sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>) – <p>Standard deviation of the Gaussian kernel with smaller sigmas across all axes.</p>
<p>If a scalar value is provided, then the Gaussian filter will have as many dimensions as the input array.
If a tuple is provided, it should contain as many elements as <code class="code docutils literal notranslate"><span class="pre">arg_shape</span></code>.
Use <code class="docutils literal notranslate"><span class="pre">0</span></code> to prevent filtering in a given dimension.
For example, the <code class="docutils literal notranslate"><span class="pre">low_sigma=(0,</span> <span class="pre">3)</span></code> will convolve the input image in its last dimension.</p>
</p></li>
<li><p><strong>high_sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>) – Standard deviation of the Gaussian kernel with larger sigmas across all axes.
If <code class="docutils literal notranslate"><span class="pre">None</span></code> is given (default), sigmas for all axes are calculated as <code class="docutils literal notranslate"><span class="pre">1.6</span> <span class="pre">*</span> <span class="pre">low_sigma</span></code>.</p></li>
<li><p><strong>low_truncate</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>) – Truncate the filter at this many standard deviations.
Defaults to 3.0.</p></li>
<li><p><strong>high_truncate</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>) – Truncate the filter at this many standard deviations.
Defaults to 3.0.</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[str]</span></code>) – <p>Boundary conditions.
Multiple forms are accepted:</p>
<ul>
<li><p>str: unique mode shared amongst dimensions.
Must be one of:</p>
<ul>
<li><p>’constant’ (default): zero-padding</p></li>
<li><p>’wrap’</p></li>
<li><p>’reflect’</p></li>
<li><p>’symmetric’</p></li>
<li><p>’edge’</p></li>
</ul>
</li>
<li><p>tuple[str, …]: the <code class="code docutils literal notranslate"><span class="pre">d</span></code>-th dimension uses <code class="code docutils literal notranslate"><span class="pre">mode[d]</span></code> as boundary condition.</p></li>
</ul>
<p>(See <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.pad.html#numpy.pad" title="(in NumPy v1.25)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.pad()</span></code></a> for details.)</p>
</p></li>
<li><p><strong>sampling</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-class docutils literal notranslate"><span class="pre">Real</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[Real]</span></code>) – Sampling step (i.e. distance between two consecutive elements of an array).
Defaults to 1.</p></li>
<li><p><strong>gpu</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Input NDArray type (<code class="code docutils literal notranslate"><span class="pre">True</span></code> for GPU, <code class="code docutils literal notranslate"><span class="pre">False</span></code> for CPU). Defaults to <code class="code docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>dtype</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.DType" title="pyxu.info.ptype.DType"><code class="xref py py-class docutils literal notranslate"><span class="pre">DType</span></code></a>) – Working precision of the linear operator.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>op</strong> – DifferenceOfGaussians</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/pyplot_summary.html#module-matplotlib.pyplot" title="matplotlib.pyplot"><span class="nn">matplotlib.pyplot</span></a> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">pyxu.operator</span> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.linop.filter.DifferenceOfGaussians" title="pyxu.operator.linop.filter.DifferenceOfGaussians"><span class="n">DoG</span></a>

<span class="n">arg_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">image</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">(</span><span class="n">arg_shape</span><span class="p">)</span>
<span class="n">image</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>

<span class="n">dog</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.linop.filter.DifferenceOfGaussians" title="pyxu.operator.linop.filter.DifferenceOfGaussians"><span class="n">DoG</span></a><span class="p">(</span><span class="n">arg_shape</span><span class="p">,</span> <span class="n">low_sigma</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">dog</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplot.html#matplotlib.pyplot.subplot" title="matplotlib.pyplot.subplot"><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span></a><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.imshow.html#matplotlib.pyplot.imshow" title="matplotlib.pyplot.imshow"><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span></a><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">()</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplot.html#matplotlib.pyplot.subplot" title="matplotlib.pyplot.subplot"><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span></a><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.imshow.html#matplotlib.pyplot.imshow" title="matplotlib.pyplot.imshow"><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span></a><span class="p">(</span><span class="n">out</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">*</span><span class="n">arg_shape</span><span class="p">))</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../_downloads/a6b72438f1f4eeb8e21f26d89762a34f/linop-17.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/09c95fe693f0d5343f3a925cdb8c3fa9/linop-17.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/c7844935e3aafc3a24dfed1185281db3/linop-17.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/a7fbcf236aa04c1f2f0fe84dd0beb567/linop-17.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../../_images/linop-17.png" class="plot-directive" src="../../_images/linop-17.png"/>
</figure>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyxu.operator.linop.filter.Gaussian" title="pyxu.operator.linop.filter.Gaussian"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gaussian</span></code></a>, <a class="reference internal" href="#pyxu.operator.linop.filter.Sobel" title="pyxu.operator.linop.filter.Sobel"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sobel</span></code></a>, <a class="reference internal" href="#pyxu.operator.linop.filter.Prewitt" title="pyxu.operator.linop.filter.Prewitt"><code class="xref py py-class docutils literal notranslate"><span class="pre">Prewitt</span></code></a>, <a class="reference internal" href="#pyxu.operator.linop.filter.Scharr" title="pyxu.operator.linop.filter.Scharr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Scharr</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">StructureTensor</span></code></p>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.operator.linop.filter.Laplace">
<span class="sig-name descname"><span class="pre">Laplace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gpu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/filter.html#Laplace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.filter.Laplace" title="Link to this definition">#</a></dt>
<dd><p>Multidimensional Laplace filter based on second derivatives approximated via finite differences.</p>
<p class="rubric">Notes</p>
<p>This operator uses the applies the Laplace kernel <span class="math notranslate nohighlight">\([1 -2 1]\)</span> to a <span class="math notranslate nohighlight">\(D\)</span>-dimensional NDArray
<span class="math notranslate nohighlight">\(\mathbf{x} \in \mathbb{R}^{N_0 \times \cdots \times N_{D-1}}\)</span> using separable kernels for improved
performance.
The Laplace filter is commonly used to find high-frequency components in the signal, such as for example, the edges
in an image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arg_shape</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.NDArrayShape" title="pyxu.info.ptype.NDArrayShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayShape</span></code></a>) – Shape of the input array.</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[str]</span></code>) – <p>Boundary conditions.
Multiple forms are accepted:</p>
<ul>
<li><p>str: unique mode shared amongst dimensions.
Must be one of:</p>
<ul>
<li><p>’constant’ (default): zero-padding</p></li>
<li><p>’wrap’</p></li>
<li><p>’reflect’</p></li>
<li><p>’symmetric’</p></li>
<li><p>’edge’</p></li>
</ul>
</li>
<li><p>tuple[str, …]: the <code class="code docutils literal notranslate"><span class="pre">d</span></code>-th dimension uses <code class="code docutils literal notranslate"><span class="pre">mode[d]</span></code> as boundary condition.</p></li>
</ul>
<p>(See <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.pad.html#numpy.pad" title="(in NumPy v1.25)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.pad()</span></code></a> for details.)</p>
</p></li>
<li><p><strong>sampling</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-class docutils literal notranslate"><span class="pre">Real</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[Real]</span></code>) – Sampling step (i.e. distance between two consecutive elements of an array).
Defaults to 1.</p></li>
<li><p><strong>gpu</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Input NDArray type (<code class="code docutils literal notranslate"><span class="pre">True</span></code> for GPU, <code class="code docutils literal notranslate"><span class="pre">False</span></code> for CPU). Defaults to <code class="code docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>dtype</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.DType" title="pyxu.info.ptype.DType"><code class="xref py py-class docutils literal notranslate"><span class="pre">DType</span></code></a>) – Working precision of the linear operator.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>op</strong> – DifferenceOfGaussians</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/pyplot_summary.html#module-matplotlib.pyplot" title="matplotlib.pyplot"><span class="nn">matplotlib.pyplot</span></a> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">pyxu.operator</span> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.linop.filter.Laplace" title="pyxu.operator.linop.filter.Laplace"><span class="n">Laplace</span></a>

<span class="n">arg_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">image</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">(</span><span class="n">arg_shape</span><span class="p">)</span>
<span class="n">image</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>

<span class="n">laplace</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.linop.filter.Laplace" title="pyxu.operator.linop.filter.Laplace"><span class="n">Laplace</span></a><span class="p">(</span><span class="n">arg_shape</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">laplace</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplot.html#matplotlib.pyplot.subplot" title="matplotlib.pyplot.subplot"><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span></a><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.imshow.html#matplotlib.pyplot.imshow" title="matplotlib.pyplot.imshow"><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span></a><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">()</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplot.html#matplotlib.pyplot.subplot" title="matplotlib.pyplot.subplot"><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span></a><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.imshow.html#matplotlib.pyplot.imshow" title="matplotlib.pyplot.imshow"><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span></a><span class="p">(</span><span class="n">out</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">*</span><span class="n">arg_shape</span><span class="p">))</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../_downloads/d9532a31cab2ae0a0aead1ef9ce35695/linop-18.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/6d7de1d6dcf416157b85a1ab8997d053/linop-18.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/0e3ce448ac644c512d6fa5b580eb3aef/linop-18.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/3b75210a4ac872e658bfc6fd21a99402/linop-18.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../../_images/linop-18.png" class="plot-directive" src="../../_images/linop-18.png"/>
</figure>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyxu.operator.linop.filter.Sobel" title="pyxu.operator.linop.filter.Sobel"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sobel</span></code></a>, <a class="reference internal" href="#pyxu.operator.linop.filter.Prewitt" title="pyxu.operator.linop.filter.Prewitt"><code class="xref py py-class docutils literal notranslate"><span class="pre">Prewitt</span></code></a>, <a class="reference internal" href="#pyxu.operator.linop.filter.Scharr" title="pyxu.operator.linop.filter.Scharr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Scharr</span></code></a></p>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.operator.linop.filter.Sobel">
<span class="sig-name descname"><span class="pre">Sobel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gpu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/filter.html#Sobel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.filter.Sobel" title="Link to this definition">#</a></dt>
<dd><p>Multidimensional Sobel filter.</p>
<p class="rubric">Notes</p>
<p>This operator uses the applies the multi-dimensional Sobel filter to a <span class="math notranslate nohighlight">\(D\)</span>-dimensional NDArray
<span class="math notranslate nohighlight">\(\mathbf{x} \in \mathbb{R}^{N_0 \times \cdots \times N_{D-1}}\)</span> using separable kernels for improved
performance.  The Sobel filter applies the following edge filter in the dimensions of interest: <code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">0,</span> <span class="pre">-1]</span></code>
and the smoothing filter on the rest of dimensions: <code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">2,</span> <span class="pre">1]</span> <span class="pre">/</span> <span class="pre">4</span></code>.
The Sobel filter is commonly used to find high-frequency components in the signal, such as for example, the edges in
an image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arg_shape</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.NDArrayShape" title="pyxu.info.ptype.NDArrayShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayShape</span></code></a>) – Shape of the input array.</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>) – <p>Compute the edge filter along this axis. If not provided, the edge magnitude is computed.</p>
<p>This is defined as:
<code class="docutils literal notranslate"><span class="pre">np.sqrt(sum([sobel(array,</span> <span class="pre">axis=i)**2</span> <span class="pre">for</span> <span class="pre">i</span> <span class="pre">in</span> <span class="pre">range(array.ndim)])</span> <span class="pre">/</span> <span class="pre">array.ndim)</span></code>
The magnitude is also computed if axis is a sequence.</p>
</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[str]</span></code>) – <p>Boundary conditions.
Multiple forms are accepted:</p>
<ul>
<li><p>str: unique mode shared amongst dimensions.
Must be one of:</p>
<ul>
<li><p>’constant’ (default): zero-padding</p></li>
<li><p>’wrap’</p></li>
<li><p>’reflect’</p></li>
<li><p>’symmetric’</p></li>
<li><p>’edge’</p></li>
</ul>
</li>
<li><p>tuple[str, …]: the <code class="code docutils literal notranslate"><span class="pre">d</span></code>-th dimension uses <code class="code docutils literal notranslate"><span class="pre">mode[d]</span></code> as boundary condition.</p></li>
</ul>
<p>(See <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.pad.html#numpy.pad" title="(in NumPy v1.25)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.pad()</span></code></a> for details.)</p>
</p></li>
<li><p><strong>sampling</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-class docutils literal notranslate"><span class="pre">Real</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[Real]</span></code>) – Sampling step (i.e. distance between two consecutive elements of an array).
Defaults to 1.</p></li>
<li><p><strong>gpu</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Input NDArray type (<code class="code docutils literal notranslate"><span class="pre">True</span></code> for GPU, <code class="code docutils literal notranslate"><span class="pre">False</span></code> for CPU). Defaults to <code class="code docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>dtype</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.DType" title="pyxu.info.ptype.DType"><code class="xref py py-class docutils literal notranslate"><span class="pre">DType</span></code></a>) – Working precision of the linear operator.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>op</strong> – Sobel</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/pyplot_summary.html#module-matplotlib.pyplot" title="matplotlib.pyplot"><span class="nn">matplotlib.pyplot</span></a> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">pyxu.operator</span> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.linop.filter.Sobel" title="pyxu.operator.linop.filter.Sobel"><span class="n">Sobel</span></a>

<span class="n">arg_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">image</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">(</span><span class="n">arg_shape</span><span class="p">)</span>
<span class="n">image</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>

<span class="n">sobel</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.linop.filter.Sobel" title="pyxu.operator.linop.filter.Sobel"><span class="n">Sobel</span></a><span class="p">(</span><span class="n">arg_shape</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">sobel</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplot.html#matplotlib.pyplot.subplot" title="matplotlib.pyplot.subplot"><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span></a><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.imshow.html#matplotlib.pyplot.imshow" title="matplotlib.pyplot.imshow"><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span></a><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">()</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplot.html#matplotlib.pyplot.subplot" title="matplotlib.pyplot.subplot"><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span></a><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.imshow.html#matplotlib.pyplot.imshow" title="matplotlib.pyplot.imshow"><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span></a><span class="p">(</span><span class="n">out</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">*</span><span class="n">arg_shape</span><span class="p">))</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../_downloads/d0bcd49cb76b65258ab9d089ffda233a/linop-19.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/e1c2f45952876293feb161611e3c2d06/linop-19.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/2dfedee52a994ad94fb7bd9b94482b47/linop-19.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/5f62c6bb5301ff3e2502fc8625ddc3e8/linop-19.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../../_images/linop-19.png" class="plot-directive" src="../../_images/linop-19.png"/>
</figure>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyxu.operator.linop.filter.Prewitt" title="pyxu.operator.linop.filter.Prewitt"><code class="xref py py-class docutils literal notranslate"><span class="pre">Prewitt</span></code></a>, <a class="reference internal" href="#pyxu.operator.linop.filter.Scharr" title="pyxu.operator.linop.filter.Scharr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Scharr</span></code></a></p>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.operator.linop.filter.Prewitt">
<span class="sig-name descname"><span class="pre">Prewitt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gpu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/filter.html#Prewitt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.filter.Prewitt" title="Link to this definition">#</a></dt>
<dd><p>Multidimensional Prewitt filter.</p>
<p class="rubric">Notes</p>
<p>This operator uses the applies the multi-dimensional Prewitt filter to a <span class="math notranslate nohighlight">\(D\)</span>-dimensional NDArray
<span class="math notranslate nohighlight">\(\mathbf{x} \in \mathbb{R}^{N_0 \times \cdots \times N_{D-1}}\)</span> using separable kernels for improved
performance.  The Prewitt filter applies the following edge filter in the dimensions of interest:
<code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">0,</span> <span class="pre">-1]</span></code>, and the smoothing filter on the rest of dimensions: <code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">1,</span> <span class="pre">1]</span> <span class="pre">/</span> <span class="pre">3</span></code>.
The Prewitt filter is commonly used to find high-frequency components in the signal, such as for example, the edges
in an image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arg_shape</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.NDArrayShape" title="pyxu.info.ptype.NDArrayShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayShape</span></code></a>) – Shape of the input array.</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>) – <p>Compute the edge filter along this axis. If not provided, the edge magnitude is computed. This is defined as:</p>
<p><code class="docutils literal notranslate"><span class="pre">np.sqrt(sum([prewitt(array,</span> <span class="pre">axis=i)**2</span> <span class="pre">for</span> <span class="pre">i</span> <span class="pre">in</span> <span class="pre">range(array.ndim)])</span> <span class="pre">/</span> <span class="pre">array.ndim)</span></code>
The magnitude is also computed if axis is a sequence.</p>
</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[str]</span></code>) – <p>Boundary conditions.
Multiple forms are accepted:</p>
<ul>
<li><p>str: unique mode shared amongst dimensions.
Must be one of:</p>
<ul>
<li><p>’constant’ (default): zero-padding</p></li>
<li><p>’wrap’</p></li>
<li><p>’reflect’</p></li>
<li><p>’symmetric’</p></li>
<li><p>’edge’</p></li>
</ul>
</li>
<li><p>tuple[str, …]: the <code class="code docutils literal notranslate"><span class="pre">d</span></code>-th dimension uses <code class="code docutils literal notranslate"><span class="pre">mode[d]</span></code> as boundary condition.</p></li>
</ul>
<p>(See <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.pad.html#numpy.pad" title="(in NumPy v1.25)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.pad()</span></code></a> for details.)</p>
</p></li>
<li><p><strong>sampling</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-class docutils literal notranslate"><span class="pre">Real</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[Real]</span></code>) – Sampling step (i.e. distance between two consecutive elements of an array).
Defaults to 1.</p></li>
<li><p><strong>gpu</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Input NDArray type (<code class="code docutils literal notranslate"><span class="pre">True</span></code> for GPU, <code class="code docutils literal notranslate"><span class="pre">False</span></code> for CPU). Defaults to <code class="code docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>dtype</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.DType" title="pyxu.info.ptype.DType"><code class="xref py py-class docutils literal notranslate"><span class="pre">DType</span></code></a>) – Working precision of the linear operator.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>op</strong> – Prewitt</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/pyplot_summary.html#module-matplotlib.pyplot" title="matplotlib.pyplot"><span class="nn">matplotlib.pyplot</span></a> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">pyxu.operator</span> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.linop.filter.Prewitt" title="pyxu.operator.linop.filter.Prewitt"><span class="n">Prewitt</span></a>

<span class="n">arg_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">image</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">(</span><span class="n">arg_shape</span><span class="p">)</span>
<span class="n">image</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>

<span class="n">prewitt</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.linop.filter.Prewitt" title="pyxu.operator.linop.filter.Prewitt"><span class="n">Prewitt</span></a><span class="p">(</span><span class="n">arg_shape</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">prewitt</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplot.html#matplotlib.pyplot.subplot" title="matplotlib.pyplot.subplot"><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span></a><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.imshow.html#matplotlib.pyplot.imshow" title="matplotlib.pyplot.imshow"><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span></a><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">()</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplot.html#matplotlib.pyplot.subplot" title="matplotlib.pyplot.subplot"><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span></a><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.imshow.html#matplotlib.pyplot.imshow" title="matplotlib.pyplot.imshow"><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span></a><span class="p">(</span><span class="n">out</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">*</span><span class="n">arg_shape</span><span class="p">))</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../_downloads/1039f8cb4f20cfaa9d739bcc6c4aed5c/linop-20.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/a787a4de8a26371e9e6db60996ebc82f/linop-20.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/09786f40eba03e70a1bcdf11579b8e69/linop-20.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/e9c0199593213119a01b24588af34368/linop-20.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../../_images/linop-20.png" class="plot-directive" src="../../_images/linop-20.png"/>
</figure>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyxu.operator.linop.filter.Sobel" title="pyxu.operator.linop.filter.Sobel"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sobel</span></code></a>, <a class="reference internal" href="#pyxu.operator.linop.filter.Scharr" title="pyxu.operator.linop.filter.Scharr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Scharr</span></code></a></p>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.operator.linop.filter.Scharr">
<span class="sig-name descname"><span class="pre">Scharr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gpu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/filter.html#Scharr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.linop.filter.Scharr" title="Link to this definition">#</a></dt>
<dd><p>Multidimensional Scharr filter.</p>
<p class="rubric">Notes</p>
<p>This operator uses the applies the multi-dimensional Scharr filter to a <span class="math notranslate nohighlight">\(D\)</span>-dimensional NDArray
<span class="math notranslate nohighlight">\(\mathbf{x} \in \mathbb{R}^{N_0 \times \cdots \times N_{D-1}}\)</span> using separable kernels for improved
performance.  The Scharr filter applies the following edge filter in the dimensions of interest: <code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">0,</span> <span class="pre">-1]</span></code>, and
the smoothing filter on the rest of dimensions: <code class="docutils literal notranslate"><span class="pre">[3,</span> <span class="pre">10,</span> <span class="pre">3]</span> <span class="pre">/</span> <span class="pre">16</span></code>.
The Scharr filter is commonly used to find high-frequency components in the signal, such as for example, the edges
in an image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arg_shape</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.NDArrayShape" title="pyxu.info.ptype.NDArrayShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayShape</span></code></a>) – Shape of the input array.</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>) – <p>Compute the edge filter along this axis. If not provided, the edge magnitude is computed. This is defined as:</p>
<p><code class="docutils literal notranslate"><span class="pre">np.sqrt(sum([scharr(array,</span> <span class="pre">axis=i)**2</span> <span class="pre">for</span> <span class="pre">i</span> <span class="pre">in</span> <span class="pre">range(array.ndim)])</span> <span class="pre">/</span> <span class="pre">array.ndim)</span></code>
The magnitude is also computed if axis is a sequence.</p>
</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[str]</span></code>) – <p>Boundary conditions.
Multiple forms are accepted:</p>
<ul>
<li><p>str: unique mode shared amongst dimensions.
Must be one of:</p>
<ul>
<li><p>’constant’ (default): zero-padding</p></li>
<li><p>’wrap’</p></li>
<li><p>’reflect’</p></li>
<li><p>’symmetric’</p></li>
<li><p>’edge’</p></li>
</ul>
</li>
<li><p>tuple[str, …]: the <code class="code docutils literal notranslate"><span class="pre">d</span></code>-th dimension uses <code class="code docutils literal notranslate"><span class="pre">mode[d]</span></code> as boundary condition.</p></li>
</ul>
<p>(See <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.pad.html#numpy.pad" title="(in NumPy v1.25)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.pad()</span></code></a> for details.)</p>
</p></li>
<li><p><strong>sampling</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-class docutils literal notranslate"><span class="pre">Real</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[Real]</span></code>) – Sampling step (i.e. distance between two consecutive elements of an array).
Defaults to 1.</p></li>
<li><p><strong>gpu</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Input NDArray type (<code class="code docutils literal notranslate"><span class="pre">True</span></code> for GPU, <code class="code docutils literal notranslate"><span class="pre">False</span></code> for CPU). Defaults to <code class="code docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>dtype</strong> (<a class="reference internal" href="../info.html#pyxu.info.ptype.DType" title="pyxu.info.ptype.DType"><code class="xref py py-class docutils literal notranslate"><span class="pre">DType</span></code></a>) – Working precision of the linear operator.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>op</strong> – Scharr</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/pyplot_summary.html#module-matplotlib.pyplot" title="matplotlib.pyplot"><span class="nn">matplotlib.pyplot</span></a> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">pyxu.operator</span> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.linop.filter.Scharr" title="pyxu.operator.linop.filter.Scharr"><span class="n">Scharr</span></a>

<span class="n">arg_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">image</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">(</span><span class="n">arg_shape</span><span class="p">)</span>
<span class="n">image</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>

<span class="n">scharr</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.linop.filter.Scharr" title="pyxu.operator.linop.filter.Scharr"><span class="n">Scharr</span></a><span class="p">(</span><span class="n">arg_shape</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">scharr</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplot.html#matplotlib.pyplot.subplot" title="matplotlib.pyplot.subplot"><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span></a><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.imshow.html#matplotlib.pyplot.imshow" title="matplotlib.pyplot.imshow"><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span></a><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">()</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplot.html#matplotlib.pyplot.subplot" title="matplotlib.pyplot.subplot"><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span></a><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.imshow.html#matplotlib.pyplot.imshow" title="matplotlib.pyplot.imshow"><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span></a><span class="p">(</span><span class="n">out</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">*</span><span class="n">arg_shape</span><span class="p">))</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../_downloads/cb45ae12f425be74e48e11c23e137541/linop-21.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/21d149a39c58daf587fccda553930dfa/linop-21.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/5dae74c59590de9941fc8e69d39c3f0c/linop-21.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/edea08851573d4f271df708dfee884d4/linop-21.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../../_images/linop-21.png" class="plot-directive" src="../../_images/linop-21.png"/>
</figure>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyxu.operator.linop.filter.Sobel" title="pyxu.operator.linop.filter.Sobel"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sobel</span></code></a>, <a class="reference internal" href="#pyxu.operator.linop.filter.Prewitt" title="pyxu.operator.linop.filter.Prewitt"><code class="xref py py-class docutils literal notranslate"><span class="pre">Prewitt</span></code></a></p>
</div>
</dd></dl>
</section>
</section>
</article>
<footer class="bd-footer-article">
<div class="footer-article-items footer-article__inner">
<div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
<a class="left-prev" href="func.html" title="previous page">
<i class="fa-solid fa-angle-left"></i>
<div class="prev-next-info">
<p class="prev-next-subtitle">previous</p>
<p class="prev-next-title">pyxu.operator.func</p>
</div>
</a>
<a class="right-next" href="blocks.html" title="next page">
<div class="prev-next-info">
<p class="prev-next-subtitle">next</p>
<p class="prev-next-title">pyxu.operator.blocks</p>
</div>
<i class="fa-solid fa-angle-right"></i>
</a>
</div></div>
</div>
</footer>
</div>
<div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">
<div class="sidebar-secondary-item">
<div class="page-toc tocsection onthispage">
<i class="fa-solid fa-list"></i> On this page
  </div>
<nav class="bd-toc-nav page-toc">
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-operators">Basic operators</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.select.SubSample"><code class="docutils literal notranslate"><span class="pre">SubSample</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.select.SubSample.IndexSpec"><code class="docutils literal notranslate"><span class="pre">SubSample.IndexSpec</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.select.SubSample.TrimSpec"><code class="docutils literal notranslate"><span class="pre">SubSample.TrimSpec</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.select.SubSample.__init__"><code class="docutils literal notranslate"><span class="pre">SubSample.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.select.SubSample.apply"><code class="docutils literal notranslate"><span class="pre">SubSample.apply()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.select.SubSample.adjoint"><code class="docutils literal notranslate"><span class="pre">SubSample.adjoint()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.select.Trim"><code class="docutils literal notranslate"><span class="pre">Trim()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.reduce.Sum"><code class="docutils literal notranslate"><span class="pre">Sum()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.kron.kron"><code class="docutils literal notranslate"><span class="pre">kron()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.kron.khatri_rao"><code class="docutils literal notranslate"><span class="pre">khatri_rao()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.base.IdentityOp"><code class="docutils literal notranslate"><span class="pre">IdentityOp</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.base.NullOp"><code class="docutils literal notranslate"><span class="pre">NullOp</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.base.NullFunc"><code class="docutils literal notranslate"><span class="pre">NullFunc()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.base.HomothetyOp"><code class="docutils literal notranslate"><span class="pre">HomothetyOp()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.base.DiagonalOp"><code class="docutils literal notranslate"><span class="pre">DiagonalOp()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.base._ExplicitLinOp"><code class="docutils literal notranslate"><span class="pre">_ExplicitLinOp()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.pad.Pad"><code class="docutils literal notranslate"><span class="pre">Pad</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.pad.Pad.WidthSpec"><code class="docutils literal notranslate"><span class="pre">Pad.WidthSpec</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.pad.Pad.ModeSpec"><code class="docutils literal notranslate"><span class="pre">Pad.ModeSpec</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.pad.Pad.__init__"><code class="docutils literal notranslate"><span class="pre">Pad.__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stencils-and-convolutions">Stencils and Convolutions</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.stencil._stencil._Stencil"><code class="docutils literal notranslate"><span class="pre">_Stencil</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.stencil._stencil._Stencil.IndexSpec"><code class="docutils literal notranslate"><span class="pre">_Stencil.IndexSpec</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.stencil._stencil._Stencil.init"><code class="docutils literal notranslate"><span class="pre">_Stencil.init()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.stencil._stencil._Stencil.apply"><code class="docutils literal notranslate"><span class="pre">_Stencil.apply()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.stencil.stencil.Stencil"><code class="docutils literal notranslate"><span class="pre">Stencil</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.stencil.stencil.Stencil.KernelSpec"><code class="docutils literal notranslate"><span class="pre">Stencil.KernelSpec</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.stencil.stencil.Stencil.__init__"><code class="docutils literal notranslate"><span class="pre">Stencil.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.stencil.stencil.Stencil.configure_dispatcher"><code class="docutils literal notranslate"><span class="pre">Stencil.configure_dispatcher()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.stencil.stencil.Stencil.kernel"><code class="docutils literal notranslate"><span class="pre">Stencil.kernel</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.stencil.stencil.Stencil.center"><code class="docutils literal notranslate"><span class="pre">Stencil.center</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.stencil.stencil.Stencil.relative_indices"><code class="docutils literal notranslate"><span class="pre">Stencil.relative_indices</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.stencil.stencil.Stencil.visualize"><code class="docutils literal notranslate"><span class="pre">Stencil.visualize()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.stencil.stencil.Correlate"><code class="docutils literal notranslate"><span class="pre">Correlate</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.stencil.stencil.Convolve"><code class="docutils literal notranslate"><span class="pre">Convolve()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transforms">Transforms</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.fft.fft.FFT"><code class="docutils literal notranslate"><span class="pre">FFT</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.fft.fft.FFT.__init__"><code class="docutils literal notranslate"><span class="pre">FFT.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.fft.fft.FFT.apply"><code class="docutils literal notranslate"><span class="pre">FFT.apply()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.fft.fft.FFT.adjoint"><code class="docutils literal notranslate"><span class="pre">FFT.adjoint()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.fft.nufft.NUFFT"><code class="docutils literal notranslate"><span class="pre">NUFFT</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.fft.nufft.NUFFT.type1"><code class="docutils literal notranslate"><span class="pre">NUFFT.type1()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.fft.nufft.NUFFT.type2"><code class="docutils literal notranslate"><span class="pre">NUFFT.type2()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.fft.nufft.NUFFT.type3"><code class="docutils literal notranslate"><span class="pre">NUFFT.type3()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.fft.nufft.NUFFT.apply"><code class="docutils literal notranslate"><span class="pre">NUFFT.apply()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.fft.nufft.NUFFT.adjoint"><code class="docutils literal notranslate"><span class="pre">NUFFT.adjoint()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.fft.nufft.NUFFT.ascomplexarray"><code class="docutils literal notranslate"><span class="pre">NUFFT.ascomplexarray()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.fft.nufft.NUFFT.mesh"><code class="docutils literal notranslate"><span class="pre">NUFFT.mesh()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.fft.nufft.NUFFT.plot_kernel"><code class="docutils literal notranslate"><span class="pre">NUFFT.plot_kernel()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.fft.nufft.NUFFT.params"><code class="docutils literal notranslate"><span class="pre">NUFFT.params()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.fft.nufft.NUFFT.auto_chunk"><code class="docutils literal notranslate"><span class="pre">NUFFT.auto_chunk()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.fft.nufft.NUFFT.allocate"><code class="docutils literal notranslate"><span class="pre">NUFFT.allocate()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.fft.nufft.NUFFT.diagnostic_plot"><code class="docutils literal notranslate"><span class="pre">NUFFT.diagnostic_plot()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.fft.nufft.NUFFT.stats"><code class="docutils literal notranslate"><span class="pre">NUFFT.stats()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#derivatives">Derivatives</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.diff.PartialDerivative"><code class="docutils literal notranslate"><span class="pre">PartialDerivative</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.diff.PartialDerivative.finite_difference"><code class="docutils literal notranslate"><span class="pre">PartialDerivative.finite_difference()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.diff.PartialDerivative.gaussian_derivative"><code class="docutils literal notranslate"><span class="pre">PartialDerivative.gaussian_derivative()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.diff.Gradient"><code class="docutils literal notranslate"><span class="pre">Gradient()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.diff.Jacobian"><code class="docutils literal notranslate"><span class="pre">Jacobian()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.diff.Divergence"><code class="docutils literal notranslate"><span class="pre">Divergence()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.diff.Hessian"><code class="docutils literal notranslate"><span class="pre">Hessian()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.diff.Laplacian"><code class="docutils literal notranslate"><span class="pre">Laplacian()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.diff.DirectionalDerivative"><code class="docutils literal notranslate"><span class="pre">DirectionalDerivative()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.diff.DirectionalGradient"><code class="docutils literal notranslate"><span class="pre">DirectionalGradient()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.diff.DirectionalLaplacian"><code class="docutils literal notranslate"><span class="pre">DirectionalLaplacian()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.diff.DirectionalHessian"><code class="docutils literal notranslate"><span class="pre">DirectionalHessian()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#filters">Filters</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.filter.MovingAverage"><code class="docutils literal notranslate"><span class="pre">MovingAverage()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.filter.Gaussian"><code class="docutils literal notranslate"><span class="pre">Gaussian()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.filter.DifferenceOfGaussians"><code class="docutils literal notranslate"><span class="pre">DifferenceOfGaussians()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.filter.DoG"><code class="docutils literal notranslate"><span class="pre">DoG()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.filter.Laplace"><code class="docutils literal notranslate"><span class="pre">Laplace()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.filter.Sobel"><code class="docutils literal notranslate"><span class="pre">Sobel()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.filter.Prewitt"><code class="docutils literal notranslate"><span class="pre">Prewitt()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.linop.filter.Scharr"><code class="docutils literal notranslate"><span class="pre">Scharr()</span></code></a></li>
</ul>
</li>
</ul>
</nav></div>
<div class="sidebar-secondary-item">
<div id="searchbox"></div></div>
<div class="sidebar-secondary-item">
<div class="tocsection editthispage">
<a href="https://github.com/matthieumeo/pyxu/edit/main/doc/api/operator/linop.rst">
<i class="fa-solid fa-pencil"></i>
      
      
        
          Edit on GitHub
        
      
    </a>
</div>
</div>
<div class="sidebar-secondary-item">
<div class="tocsection sourcelink">
<a href="../../_sources/api/operator/linop.rst">
<i class="fa-solid fa-file-lines"></i> Show Source
    </a>
</div>
</div>
</div></div>
</div>
<footer class="bd-footer-content">
</footer>
</main>
</div>
</div>
<!-- Scripts loaded after <body> so the DOM is not blocked -->
<script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>
<footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
<div class="footer-items__start">
<div class="footer-item">
<p class="copyright">
    
      © Copyright 2023, M. Simeoni, S. Kashani, J. Rué-Queralt &amp; Pyxu Developers.
      <br/>
</p>
</div>
<div class="footer-item">
<p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.5.
    <br/>
</p>
</div>
<div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.13.3.
</p></div>
</div>
<div class="footer-items__end">
<div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.13.3.
</p></div>
</div>
</div>
</footer>
</body>
</html>