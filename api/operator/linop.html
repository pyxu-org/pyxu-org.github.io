
<!DOCTYPE html>

<html data-theme="light" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/><meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>pyxu.operator.linop — Pyxu Documentation</title>
<script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "light";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
<!-- Loaded before other Sphinx assets -->
<link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet"/>
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet"/>
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet"/>
<link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet"/>
<link as="font" crossorigin="" href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" rel="preload" type="font/woff2"/>
<link href="../../_static/pygments.css?v=fa44fd50" rel="stylesheet" type="text/css"/>
<link href="../../_static/plot_directive.css" rel="stylesheet" type="text/css"/>
<link href="../../_static/sphinx-codeautolink.css?v=125d5c1c" rel="stylesheet" type="text/css"/>
<link href="../../_static/copybutton.css?v=76b2166b" rel="stylesheet" type="text/css"/>
<link href="../../_static/togglebutton.css?v=13237357" rel="stylesheet" type="text/css"/>
<link href="../../_static/sg_gallery.css?v=d2d258e8" rel="stylesheet" type="text/css"/>
<link href="../../_static/sg_gallery-binder.css?v=f4aeca0c" rel="stylesheet" type="text/css"/>
<link href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" rel="stylesheet" type="text/css"/>
<link href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" rel="stylesheet" type="text/css"/>
<link href="../../_static/sphinx-design.min.css?v=95c83b7e" rel="stylesheet" type="text/css"/>
<link href="../../_static/css/custom.css?v=14df3d68" rel="stylesheet" type="text/css"/>
<!-- Pre-loaded scripts that we'll load fully later -->
<link as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" rel="preload"/>
<link as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" rel="preload"/>
<script src="../../_static/documentation_options.js?v=89f91371"></script>
<script src="../../_static/doctools.js?v=9a2dae69"></script>
<script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
<script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
<script src="../../_static/copybutton.js?v=30646c52"></script>
<script>let toggleHintShow = 'Click to show';</script>
<script>let toggleHintHide = 'Click to hide';</script>
<script>let toggleOpenOnPrint = 'true';</script>
<script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
<script src="../../_static/design-tabs.js?v=f930bc37"></script>
<script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
<script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
<script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
<script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
<script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>DOCUMENTATION_OPTIONS.pagename = 'api/operator/linop';</script>
<link href="../../_static/favicon.png" rel="icon"/>
<link href="../../genindex.html" rel="index" title="Index"/>
<link href="../../search.html" rel="search" title="Search"/>
<link href="map.html" rel="next" title="pyxu.operator.map"/>
<link href="func.html" rel="prev" title="pyxu.operator.func"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="en" name="docsearch:language"/>
</head>
<body data-bs-root-margin="0px 0px -60%" data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-default-mode="light" data-offset="180">
<a class="skip-link" href="#main-content">Skip to main content</a>
<input class="sidebar-toggle" id="__primary" name="__primary" type="checkbox"/>
<label class="overlay overlay-primary" for="__primary"></label>
<input class="sidebar-toggle" id="__secondary" name="__secondary" type="checkbox"/>
<label class="overlay overlay-secondary" for="__secondary"></label>
<div class="search-button__wrapper">
<div class="search-button__overlay"></div>
<div class="search-button__search-container">
<form action="../../search.html" class="bd-search d-flex align-items-center" method="get">
<i class="fa-solid fa-magnifying-glass"></i>
<input aria-label="Search the docs ..." autocapitalize="off" autocomplete="off" autocorrect="off" class="form-control" id="search-input" name="q" placeholder="Search the docs ..." spellcheck="false" type="search"/>
<span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
</div>
<nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
<label class="sidebar-toggle primary-toggle" for="__primary">
<span class="fa-solid fa-bars"></span>
</label>
<div class="navbar-header-items__start">
<div class="navbar-item">
<a class="navbar-brand logo" href="../../index.html">
<img alt="Logo image" class="logo__image only-light" src="../../_static/logo.png"/>
<script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
</a></div>
</div>
<div class="col-lg-9 navbar-header-items">
<div class="me-auto navbar-header-items__center">
<div class="navbar-item"><nav class="navbar-nav">
<p aria-label="Site Navigation" aria-level="1" class="sidebar-header-items__title" role="heading">
    Site Navigation
  </p>
<ul class="bd-navbar-elements navbar-nav">
<li class="nav-item">
<a class="nav-link nav-internal" href="../../intro/index.html">
                        Getting Started
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../guide/index.html">
                        User Guide
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../examples/index.html">
                        Example Gallery
                      </a>
</li>
<li class="nav-item current active">
<a class="nav-link nav-internal" href="../index.html">
                        API Reference
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../fair/index.html">
                        Extending Pyxu
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../migration_guide.html">
                        Migrating from v1 to v2
                      </a>
</li>
</ul>
</nav></div>
</div>
<div class="navbar-header-items__end">
<div class="navbar-item navbar-persistent--container">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
</div>
<div class="navbar-item"><strong> Pyxu v2.0 </strong></div>
<div class="navbar-item"><ul aria-label="Icon Links" class="navbar-icon-links navbar-nav">
<li class="nav-item">
<a class="nav-link" data-bs-placement="bottom" data-bs-toggle="tooltip" href="https://github.com/pyxu-org/pyxu" rel="noopener" target="_blank" title="GitHub"><span><i class="fa-brands fa-github"></i></span>
<label class="sr-only">GitHub</label></a>
</li>
<li class="nav-item">
<a class="nav-link" data-bs-placement="bottom" data-bs-toggle="tooltip" href="https://pypi.org/project/pyxu/" rel="noopener" target="_blank" title="PyPI"><span><i class="fa-brands fa-python"></i></span>
<label class="sr-only">PyPI</label></a>
</li>
<li class="nav-item">
<a class="nav-link" data-bs-placement="bottom" data-bs-toggle="tooltip" href="mailto: contact@pyxu.org" rel="noopener" target="_blank" title="Contact"><span><i class="fa-brands fa-telegram"></i></span>
<label class="sr-only">Contact</label></a>
</li>
<li class="nav-item">
<a class="nav-link" data-bs-placement="bottom" data-bs-toggle="tooltip" href="https://imaging.epfl.ch/" rel="noopener" target="_blank" title="EPFL Center for Imaging"><img alt="EPFL Center for Imaging" class="icon-link-image" src="../../_static/imaging.png"/></a>
</li>
</ul></div>
</div>
</div>
<div class="navbar-persistent--mobile">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
</div>
<label class="sidebar-toggle secondary-toggle" for="__secondary">
<span class="fa-solid fa-outdent"></span>
</label>
</div>
</nav>
<div class="bd-container">
<div class="bd-container__inner bd-page-width">
<div class="bd-sidebar-primary bd-sidebar">
<div class="sidebar-header-items sidebar-primary__section">
<div class="sidebar-header-items__center">
<div class="navbar-item"><nav class="navbar-nav">
<p aria-label="Site Navigation" aria-level="1" class="sidebar-header-items__title" role="heading">
    Site Navigation
  </p>
<ul class="bd-navbar-elements navbar-nav">
<li class="nav-item">
<a class="nav-link nav-internal" href="../../intro/index.html">
                        Getting Started
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../guide/index.html">
                        User Guide
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../examples/index.html">
                        Example Gallery
                      </a>
</li>
<li class="nav-item current active">
<a class="nav-link nav-internal" href="../index.html">
                        API Reference
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../fair/index.html">
                        Extending Pyxu
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../migration_guide.html">
                        Migrating from v1 to v2
                      </a>
</li>
</ul>
</nav></div>
</div>
<div class="sidebar-header-items__end">
<div class="navbar-item"><strong> Pyxu v2.0 </strong></div>
<div class="navbar-item"><ul aria-label="Icon Links" class="navbar-icon-links navbar-nav">
<li class="nav-item">
<a class="nav-link" data-bs-placement="bottom" data-bs-toggle="tooltip" href="https://github.com/pyxu-org/pyxu" rel="noopener" target="_blank" title="GitHub"><span><i class="fa-brands fa-github"></i></span>
<label class="sr-only">GitHub</label></a>
</li>
<li class="nav-item">
<a class="nav-link" data-bs-placement="bottom" data-bs-toggle="tooltip" href="https://pypi.org/project/pyxu/" rel="noopener" target="_blank" title="PyPI"><span><i class="fa-brands fa-python"></i></span>
<label class="sr-only">PyPI</label></a>
</li>
<li class="nav-item">
<a class="nav-link" data-bs-placement="bottom" data-bs-toggle="tooltip" href="mailto: contact@pyxu.org" rel="noopener" target="_blank" title="Contact"><span><i class="fa-brands fa-telegram"></i></span>
<label class="sr-only">Contact</label></a>
</li>
<li class="nav-item">
<a class="nav-link" data-bs-placement="bottom" data-bs-toggle="tooltip" href="https://imaging.epfl.ch/" rel="noopener" target="_blank" title="EPFL Center for Imaging"><img alt="EPFL Center for Imaging" class="icon-link-image" src="../../_static/imaging.png"/></a>
</li>
</ul></div>
</div>
</div>
<div class="sidebar-primary-items__start sidebar-primary__section">
<div class="sidebar-primary-item"><nav aria-label="Section Navigation" class="bd-docs-nav bd-links">
<p aria-level="1" class="bd-links__title" role="heading">Section Navigation</p>
<div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../abc.html">pyxu.abc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../info.deps.html">pyxu.info.deps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../info.ptype.html">pyxu.info.ptype</a></li>
<li class="toctree-l1"><a class="reference internal" href="../info.warning.html">pyxu.info.warning</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">pyxu.operator</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="blocks.html">pyxu.operator.blocks</a></li>
<li class="toctree-l2"><a class="reference internal" href="func.html">pyxu.operator.func</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">pyxu.operator.linop</a></li>
<li class="toctree-l2"><a class="reference internal" href="map.html">pyxu.operator.map</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../operator.interop.html">pyxu.operator.interop</a></li>
<li class="toctree-l1"><a class="reference internal" href="../opt.solver.html">pyxu.opt.solver</a></li>
<li class="toctree-l1"><a class="reference internal" href="../opt.stop.html">pyxu.opt.stop</a></li>
<li class="toctree-l1"><a class="reference internal" href="../runtime.html">pyxu.runtime</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math.html">pyxu.math</a></li>
<li class="toctree-l1"><a class="reference internal" href="../util.html">pyxu.util</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../experimental/index.html">pyxu.experimental</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../experimental/sampler.html">pyxu.experimental.sampler</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../references.html"><strong>References</strong></a></li>
</ul>
</div>
</nav></div>
</div>
<div class="sidebar-primary-items__end sidebar-primary__section">
</div>
<div id="rtd-footer-container"></div>
</div>
<main class="bd-main" id="main-content">
<div class="bd-content">
<div class="bd-article-container">
<div class="bd-header-article">
<div class="header-article-items header-article__inner">
<div class="header-article-items__start">
<div class="header-article-item">
<nav aria-label="Breadcrumbs">
<ul aria-label="Breadcrumb" class="bd-breadcrumbs" role="navigation">
<li class="breadcrumb-item breadcrumb-home">
<a aria-label="Home" class="nav-link" href="../../index.html">
<i class="fa-solid fa-home"></i>
</a>
</li>
<li class="breadcrumb-item"><a class="nav-link" href="../index.html">API Reference</a></li>
<li class="breadcrumb-item"><a class="nav-link" href="index.html">pyxu.operator</a></li>
<li aria-current="page" class="breadcrumb-item active">pyxu.operator.linop</li>
</ul>
</nav>
</div>
</div>
</div>
</div>
<div id="searchbox"></div>
<article class="bd-article" role="main">
<section id="pyxu-operator-linop">
<h1>pyxu.operator.linop<a class="headerlink" href="#pyxu-operator-linop" title="Link to this heading">#</a></h1>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#basic-operators" id="id31">Basic Operators</a></p></li>
<li><p><a class="reference internal" href="#transforms" id="id32">Transforms</a></p></li>
<li><p><a class="reference internal" href="#stencils-convolutions" id="id33">Stencils &amp; Convolutions</a></p></li>
<li><p><a class="reference internal" href="#filters" id="id34">Filters</a></p></li>
<li><p><a class="reference internal" href="#derivatives" id="id35">Derivatives</a></p></li>
<li><p><a class="reference internal" href="#tensor-products" id="id36">Tensor Products</a></p></li>
</ul>
</nav>
<section id="basic-operators">
<h2><a class="toc-backref" href="#id31" role="doc-backlink">Basic Operators</a><a class="headerlink" href="#basic-operators" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyxu.operator.SubSample">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SubSample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim_shape</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">indices</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/select.html#SubSample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.SubSample" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="../abc.html#pyxu.abc.LinOp" title="pyxu.abc.operator.LinOp"><code class="xref py py-class docutils literal notranslate"><span class="pre">LinOp</span></code></a></p>
<p>Multi-dimensional sub-sampling operator.</p>
<p>This operator extracts a subset of the input matching the provided subset specifier.
Its Lipschitz constant is 1.</p>
<p class="rubric">Examples</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Extract even samples of a 1D signal.</span>
<span class="kn">import</span> <span class="nn">pyxu.operator</span> <span class="k">as</span> <span class="nn">pxo</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">pxo</span><span class="o">.</span><span class="n">SubSample</span><span class="p">(</span>
      <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
      <span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># array([0, 2, 4, 6, 8])</span>
</pre></div>
</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Extract columns[1, 3, -1] from a 2D matrix</span>
<span class="kn">import</span> <span class="nn">pyxu.operator</span> <span class="k">as</span> <span class="nn">pxo</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="mi">40</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>  <span class="c1"># the input</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">pxo</span><span class="o">.</span><span class="n">SubSample</span><span class="p">(</span>
      <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
      <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span>  <span class="c1"># take all rows</span>
      <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>   <span class="c1"># and these columns</span>
<span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># array([[  1.,   3.,  39.],</span>
          <span class="c1">#        [ 41.,  43.,  79.],</span>
          <span class="c1">#        [ 81.,  83., 119.]])</span>
</pre></div>
</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Extract all red rows of an (D,H,W) RGB image matching a boolean mask.</span>
<span class="kn">import</span> <span class="nn">pyxu.operator</span> <span class="k">as</span> <span class="nn">pxo</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">*</span> <span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">pxo</span><span class="o">.</span><span class="n">SubSample</span><span class="p">(</span>
      <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
      <span class="mi">0</span><span class="p">,</span>            <span class="c1"># red channel</span>
      <span class="n">mask</span><span class="p">,</span>         <span class="c1"># row selector</span>
      <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span>  <span class="c1"># all columns; this field can be omitted.</span>
<span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># array([[[ 0,  1,  2,  3],</span>
          <span class="c1">#         [12, 13, 14, 15]]])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><em>Integral</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><em>Integral</em></a><em>, </em><em>...</em><em>]</em>)</p></li>
<li><p><strong>indices</strong> (<a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><em>Integral</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><em>Sequence</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><em>Integral</em></a><em>] </em><em>| </em><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><em>Sequence</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>] </em><em>| </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#slice" title="(in Python v3.13)"><em>slice</em></a>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyxu.operator.SubSample.IndexSpec">
<span class="sig-name descname"><span class="pre">IndexSpec</span></span><a class="headerlink" href="#pyxu.operator.SubSample.IndexSpec" title="Link to this definition">#</a></dt>
<dd><p>alias of <a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Integral</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Integral</span></code></a>] | <a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>] | <a class="reference external" href="https://docs.python.org/3/library/functions.html#slice" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">slice</span></code></a></p>
</dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyxu.operator.SubSample.TrimSpec">
<span class="sig-name descname"><span class="pre">TrimSpec</span></span><a class="headerlink" href="#pyxu.operator.SubSample.TrimSpec" title="Link to this definition">#</a></dt>
<dd><p>alias of <a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Integral</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Integral</span></code></a>] | <a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Integral</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Integral</span></code></a>]]</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.operator.SubSample.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim_shape</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">indices</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/select.html#SubSample.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.SubSample.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim_shape</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArrayShape" title="pyxu.info.ptype.NDArrayShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayShape</span></code></a>) – (M1,…,MD) domain dimensions.</p></li>
<li><p><strong>indices</strong> (<a class="reference internal" href="#pyxu.operator.SubSample.IndexSpec" title="pyxu.operator.SubSample.IndexSpec"><code class="xref py py-class docutils literal notranslate"><span class="pre">IndexSpec</span></code></a>) – <p>Sub-sample specifier per dimension. (See examples.)</p>
<p>Valid specifiers are:</p>
<ul>
<li><p>integers</p></li>
<li><p>1D sequence of int/bool-s</p></li>
<li><p>slices</p></li>
</ul>
<p>Unspecified trailing dimensions are not sub-sampled.</p>
</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The co-dimension rank <strong>always</strong> matches the dimension rank, i.e. sub-sampling does not drop dimensions.
Single-element dimensions can be removed by composing <a class="reference internal" href="#pyxu.operator.SubSample" title="pyxu.operator.SubSample"><code class="xref py py-class docutils literal notranslate"><span class="pre">SubSample</span></code></a> with
<a class="reference internal" href="map.html#pyxu.operator.SqueezeAxes" title="pyxu.operator.SqueezeAxes"><code class="xref py py-class docutils literal notranslate"><span class="pre">SqueezeAxes</span></code></a>.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.operator.SubSample.apply">
<span class="sig-name descname"><span class="pre">apply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/select.html#SubSample.apply"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.SubSample.apply" title="Link to this definition">#</a></dt>
<dd><p>Sub-sample the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>arr</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArray</span></code></a>) – (…, M1,…,MD) data points.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>out</strong> – (…, N1,..,NK) sub-sampled data points.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArray</span></code></a></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.operator.SubSample.adjoint">
<span class="sig-name descname"><span class="pre">adjoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/select.html#SubSample.adjoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.SubSample.adjoint" title="Link to this definition">#</a></dt>
<dd><p>Up-sample the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>arr</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArray</span></code></a>) – (…, N1,…,NK) data points.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>out</strong> – (…, M1,…,MD) up-sampled data points. (Zero-filled.)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArray</span></code></a></p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.operator.Trim">
<span class="sig-name descname"><span class="pre">Trim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trim_width</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/select.html#Trim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.Trim" title="Link to this definition">#</a></dt>
<dd><p>Multi-dimensional trimming operator.</p>
<p>This operator trims the input array in each dimension according to specified widths.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim_shape</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArrayShape" title="pyxu.info.ptype.NDArrayShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayShape</span></code></a>) – (M1,…,MD) domain dimensions.</p></li>
<li><p><strong>trim_width</strong> (<a class="reference internal" href="#pyxu.operator.SubSample.TrimSpec" title="pyxu.operator.SubSample.TrimSpec"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrimSpec</span></code></a>) – <p>Number of values trimmed from the edges of each axis.
Multiple forms are accepted:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">int</span></code>: trim each dimension’s head/tail by <code class="code docutils literal notranslate"><span class="pre">trim_width</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tuple[int,</span> <span class="pre">...]</span></code>: trim dimension[k]’s head/tail by <code class="code docutils literal notranslate"><span class="pre">trim_width[k]</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tuple[tuple[int,</span> <span class="pre">int],</span> <span class="pre">...]</span></code>: trim dimension[k]’s head/tail by <code class="code docutils literal notranslate"><span class="pre">trim_width[k][0]</span></code> / <code class="code docutils literal notranslate"><span class="pre">trim_width[k][1]</span></code>
respectively.</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>op</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a></p>
</dd>
</dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyxu.operator.Sum">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Sum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/reduce.html#Sum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.Sum" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="../abc.html#pyxu.abc.LinOp" title="pyxu.abc.operator.LinOp"><code class="xref py py-class docutils literal notranslate"><span class="pre">LinOp</span></code></a></p>
<p>Multi-dimensional sum reduction <span class="math notranslate nohighlight">\(\mathbf{A}: \mathbb{R}^{M_{1} \times\cdots\times M_{D}} \to \mathbb{R}^{N_{1}
\times\cdots\times N_{D}}\)</span>.</p>
<p class="rubric">Notes</p>
<ul>
<li><p>The co-dimension rank <strong>always</strong> matches the dimension rank, i.e. summed-over dimensions are not dropped.
Single-element dimensions can be removed by composing <a class="reference internal" href="#pyxu.operator.Sum" title="pyxu.operator.Sum"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sum</span></code></a> with
<a class="reference internal" href="map.html#pyxu.operator.SqueezeAxes" title="pyxu.operator.SqueezeAxes"><code class="xref py py-class docutils literal notranslate"><span class="pre">SqueezeAxes</span></code></a>.</p></li>
<li><p>The matrix operator of a 1D reduction applied to <span class="math notranslate nohighlight">\(\mathbf{x} \in \mathbb{R}^{M}\)</span> is given by</p>
<div class="math notranslate nohighlight">
\[\mathbf{A}(x) = \mathbf{1}^{T} \mathbf{x},\]</div>
<p>where <span class="math notranslate nohighlight">\(\sigma_{\max}(\mathbf{A}) = \sqrt{M}\)</span>.  An ND reduction is a chain of 1D reductions in orthogonal
dimensions.  Hence the Lipschitz constant of an ND reduction is the product of Lipschitz constants of all 1D
reductions involved, i.e.:</p>
<div class="math notranslate nohighlight">
\[L = \sqrt{\prod_{i_{k}} M_{i_{k}}},\]</div>
<p>where <span class="math notranslate nohighlight">\(\{i_{k}\}_{k}\)</span> denotes the axes being summed over.</p>
</li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><em>Integral</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><em>Integral</em></a><em>, </em><em>...</em><em>]</em>)</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><em>Integral</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><em>Integral</em></a><em>, </em><em>...</em><em>]</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.operator.Sum.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/reduce.html#Sum.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.Sum.__init__" title="Link to this definition">#</a></dt>
<dd><p>Multi-dimensional sum reduction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim_shape</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArrayShape" title="pyxu.info.ptype.NDArrayShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayShape</span></code></a>) – (M1,…,MD) domain dimensions.</p></li>
<li><p><strong>axis</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArrayAxis" title="pyxu.info.ptype.NDArrayAxis"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayAxis</span></code></a>) – Axis or axes along which a sum is performed.  The default, axis=None, will sum all the elements of the input
array.</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.operator.Sum.apply">
<span class="sig-name descname"><span class="pre">apply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/reduce.html#Sum.apply"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.Sum.apply" title="Link to this definition">#</a></dt>
<dd><p>Evaluate operator at specified point(s).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>arr</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArray</span></code></a>) – (…, M1,…,MD) input points.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>out</strong> – (…, N1,…,NK) output points.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArray</span></code></a></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.operator.Sum.adjoint">
<span class="sig-name descname"><span class="pre">adjoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/reduce.html#Sum.adjoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.Sum.adjoint" title="Link to this definition">#</a></dt>
<dd><p>Evaluate operator adjoint at specified point(s).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>arr</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArray</span></code></a>) – (…, N1,…,NK) input points.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>out</strong> – (…, M1,…,MD) adjoint evaluations.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArray</span></code></a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The <em>adjoint</em> <span class="math notranslate nohighlight">\(\mathbf{A}^{\ast}: \mathbb{R}^{N_{1} \times\cdots\times N_{K}} \to \mathbb{R}^{M_{1}
\times\cdots\times M_{D}}\)</span> of <span class="math notranslate nohighlight">\(\mathbf{A}: \mathbb{R}^{M_{1} \times\cdots\times M_{D}} \to
\mathbb{R}^{N_{1} \times\cdots\times N_{K}}\)</span> is defined as:</p>
<div class="math notranslate nohighlight">
\[\langle \mathbf{x}, \mathbf{A}^{\ast}\mathbf{y}\rangle_{\mathbb{R}^{M_{1} \times\cdots\times M_{D}}}
:=
\langle \mathbf{A}\mathbf{x}, \mathbf{y}\rangle_{\mathbb{R}^{N_{1} \times\cdots\times N_{K}}},
\qquad
\forall (\mathbf{x},\mathbf{y})\in \mathbb{R}^{M_{1} \times\cdots\times M_{D}} \times \mathbb{R}^{N_{1}
\times\cdots\times N_{K}}.\]</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.operator.Sum.estimate_lipschitz">
<span class="sig-name descname"><span class="pre">estimate_lipschitz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/reduce.html#Sum.estimate_lipschitz"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.Sum.estimate_lipschitz" title="Link to this definition">#</a></dt>
<dd><p>Compute a Lipschitz constant of the operator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> (<code class="docutils literal notranslate"><span class="pre">"svd"</span></code> | <code class="docutils literal notranslate"><span class="pre">"trace"</span></code>) – <ul>
<li><p>If <code class="code docutils literal notranslate"><span class="pre">svd</span></code>, compute the optimal Lipschitz constant.</p></li>
<li><p>If <code class="code docutils literal notranslate"><span class="pre">trace</span></code>, compute an upper bound. (Default)</p></li>
</ul>
</p></li>
<li><p><strong>kwargs</strong> – <p>Optional kwargs passed on to:</p>
<ul>
<li><p><code class="code docutils literal notranslate"><span class="pre">svd</span></code>: <a class="reference internal" href="../abc.html#pyxu.abc.LinOp.svdvals" title="pyxu.abc.LinOp.svdvals"><code class="xref py py-func docutils literal notranslate"><span class="pre">svdvals()</span></code></a></p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">trace</span></code>: <a class="reference internal" href="../math.html#pyxu.math.hutchpp" title="pyxu.math.hutchpp"><code class="xref py py-func docutils literal notranslate"><span class="pre">hutchpp()</span></code></a></p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Real" title="(in Python v3.13)"><em>Real</em></a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul>
<li><p>The tightest Lipschitz constant is given by the spectral norm of the operator <span class="math notranslate nohighlight">\(\mathbf{A}\)</span>:
<span class="math notranslate nohighlight">\(\|\mathbf{A}\|_{2}\)</span>.  It can be computed via the SVD, which is compute-intensive task for large
operators.  In this setting, it may be advantageous to overestimate the Lipschitz constant with the Frobenius
norm of <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> since <span class="math notranslate nohighlight">\(\|\mathbf{A}\|_{F} \geq \|\mathbf{A}\|_{2}\)</span>.</p>
<p><span class="math notranslate nohighlight">\(\|\mathbf{A}\|_{F}\)</span> can be efficiently approximated by computing the trace of <span class="math notranslate nohighlight">\(\mathbf{A}^{\ast}
\mathbf{A}\)</span> (or <span class="math notranslate nohighlight">\(\mathbf{A}\mathbf{A}^{\ast}\)</span>) via the <a class="reference external" href="https://arxiv.org/abs/2010.09649">Hutch++ stochastic algorithm</a>.</p>
</li>
<li><p><span class="math notranslate nohighlight">\(\|\mathbf{A}\|_{F}\)</span> is upper-bounded by <span class="math notranslate nohighlight">\(\|\mathbf{A}\|_{F} \leq \sqrt{n} \|\mathbf{A}\|_{2}\)</span>,
where the equality is reached (worst-case scenario) when the eigenspectrum of the linear operator is flat.</p></li>
</ul>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyxu.operator.IdentityOp">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">IdentityOp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/base.html#IdentityOp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.IdentityOp" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="../abc.html#pyxu.abc.OrthProjOp" title="pyxu.abc.operator.OrthProjOp"><code class="xref py py-class docutils literal notranslate"><span class="pre">OrthProjOp</span></code></a></p>
<p>Identity operator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dim_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><em>Integral</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><em>Integral</em></a><em>, </em><em>...</em><em>]</em>)</p>
</dd>
</dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyxu.operator.NullOp">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">NullOp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">codim_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/base.html#NullOp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.NullOp" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="../abc.html#pyxu.abc.LinOp" title="pyxu.abc.operator.LinOp"><code class="xref py py-class docutils literal notranslate"><span class="pre">LinOp</span></code></a></p>
<p>Null operator.</p>
<p>This operator maps any input vector on the null vector.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><em>Integral</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><em>Integral</em></a><em>, </em><em>...</em><em>]</em>)</p></li>
<li><p><strong>codim_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><em>Integral</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><em>Integral</em></a><em>, </em><em>...</em><em>]</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.operator.NullFunc">
<span class="sig-name descname"><span class="pre">NullFunc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/base.html#NullFunc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.NullFunc" title="Link to this definition">#</a></dt>
<dd><p>Null functional.</p>
<p>This functional maps any input vector on the null scalar.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dim_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><em>Integral</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><em>Integral</em></a><em>, </em><em>...</em><em>]</em>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><em>OpT</em></a></p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.operator.HomothetyOp">
<span class="sig-name descname"><span class="pre">HomothetyOp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cst</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/base.html#HomothetyOp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.HomothetyOp" title="Link to this definition">#</a></dt>
<dd><p>Constant scaling operator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cst</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-class docutils literal notranslate"><span class="pre">Real</span></code></a>) – Scaling factor.</p></li>
<li><p><strong>dim_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><em>Integral</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><em>Integral</em></a><em>, </em><em>...</em><em>]</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>op</strong> – Scaling operator.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This operator is not defined in terms of <a class="reference internal" href="#pyxu.operator.DiagonalOp" title="pyxu.operator.DiagonalOp"><code class="xref py py-func docutils literal notranslate"><span class="pre">DiagonalOp()</span></code></a> since it is array-backend-agnostic.</p>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.operator.DiagonalOp">
<span class="sig-name descname"><span class="pre">DiagonalOp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_warnings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/base.html#DiagonalOp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.DiagonalOp" title="Link to this definition">#</a></dt>
<dd><p>Element-wise scaling operator.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p><a class="reference internal" href="#pyxu.operator.DiagonalOp" title="pyxu.operator.DiagonalOp"><code class="xref py py-func docutils literal notranslate"><span class="pre">DiagonalOp()</span></code></a> instances are <strong>not arraymodule-agnostic</strong>: they will only work with NDArrays
belonging to the same array module as <code class="code docutils literal notranslate"><span class="pre">vec</span></code>.  Moreover, inner computations may cast input arrays when the
precision of <code class="code docutils literal notranslate"><span class="pre">vec</span></code> does not match the user-requested precision.  If such a situation occurs, a warning is raised.</p></li>
<li><p>If <code class="code docutils literal notranslate"><span class="pre">vec</span></code> is a DASK array, the operator will be a <a class="reference internal" href="../abc.html#pyxu.abc.SelfAdjointOp" title="pyxu.abc.SelfAdjointOp"><code class="xref py py-class docutils literal notranslate"><span class="pre">SelfAdjointOp</span></code></a>.  If <code class="code docutils literal notranslate"><span class="pre">vec</span></code> is a NUMPY/CUPY
array, the created operator specializes to <a class="reference internal" href="../abc.html#pyxu.abc.PosDefOp" title="pyxu.abc.PosDefOp"><code class="xref py py-class docutils literal notranslate"><span class="pre">PosDefOp</span></code></a> when possible.  Specialization is not
automatic for DASK inputs because operators should be quick to build under all circumstances, and this is not
guaranteed if we have to check that all entries are positive for out-of-core arrays.  Users who know that all
<code class="code docutils literal notranslate"><span class="pre">vec</span></code> entries are positive can manually cast to <a class="reference internal" href="../abc.html#pyxu.abc.PosDefOp" title="pyxu.abc.PosDefOp"><code class="xref py py-class docutils literal notranslate"><span class="pre">PosDefOp</span></code></a> afterwards if required.</p></li>
</ul>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim_shape</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArrayShape" title="pyxu.info.ptype.NDArrayShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayShape</span></code></a>) – (M1,…,MD) shape of operator’s domain.
Defaults to the shape of <code class="code docutils literal notranslate"><span class="pre">vec</span></code> when omitted.</p></li>
<li><p><strong>vec</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArray</span></code></a>) – Scale factors. If <code class="code docutils literal notranslate"><span class="pre">dim_shape</span></code> is provided, then <code class="code docutils literal notranslate"><span class="pre">vec</span></code> must be broadcastable with arrays of size <code class="code docutils literal notranslate"><span class="pre">dim_shape</span></code>.</p></li>
<li><p><strong>enable_warnings</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, emit a warning in case of precision mis-match issues.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><em>OpT</em></a></p>
</dd>
</dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyxu.operator.Pad">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Pad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/pad.html#Pad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.Pad" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="../abc.html#pyxu.abc.LinOp" title="pyxu.abc.operator.LinOp"><code class="xref py py-class docutils literal notranslate"><span class="pre">LinOp</span></code></a></p>
<p>Multi-dimensional padding operator.</p>
<p>This operator pads the input array in each dimension according to specified widths.</p>
<p class="rubric">Notes</p>
<ul>
<li><p>If inputs are D-dimensional, then some of the padding of later axes are calculated from padding of previous axes.</p></li>
<li><p>The <em>adjoint</em> of the padding operator performs a cumulative summation over the original positions used to pad.
Its effect is clear from its matrix form.  For example the matrix-form of <code class="docutils literal notranslate"><span class="pre">Pad(dim_shape=(3,),</span> <span class="pre">mode="wrap",</span>
<span class="pre">pad_width=(1,</span> <span class="pre">1))</span></code> is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{A}
=
\left[
   \begin{array}{ccc}
       0 &amp; 0 &amp; 1 \\
       1 &amp; 0 &amp; 0 \\
       0 &amp; 1 &amp; 0 \\
       0 &amp; 0 &amp; 1 \\
       1 &amp; 0 &amp; 0
   \end{array}
\right].\end{split}\]</div>
<p>The adjoint of <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> corresponds to its matrix transpose:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{A}^{\ast}
=
\left[
    \begin{array}{ccccc}
        0 &amp; 1 &amp; 0 &amp; 0 &amp; 1 \\
        0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\
        1 &amp; 0 &amp; 0 &amp; 1 &amp; 0
    \end{array}
\right].\end{split}\]</div>
<p>This operation can be seen as a trimming (<span class="math notranslate nohighlight">\(\mathbf{T}\)</span>) plus a cumulative summation (<span class="math notranslate nohighlight">\(\mathbf{S}\)</span>):</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{A}^{\ast}
=
\mathbf{T} + \mathbf{S}
=
\left[
   \begin{array}{ccccc}
       0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 \\
       0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\
       0 &amp; 0 &amp; 0 &amp; 1 &amp; 0
   \end{array}
\right]
+
\left[
   \begin{array}{ccccc}
       0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 \\
       0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
       1 &amp; 0 &amp; 0 &amp; 0 &amp; 0
   \end{array}
\right],\end{split}\]</div>
<p>where both <span class="math notranslate nohighlight">\(\mathbf{T}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{S}\)</span> are efficiently implemented in matrix-free form.</p>
</li>
<li><p>The Lipschitz constant of the multi-dimensional padding operator is upper-bounded by the product of Lipschitz
constants of the uni-dimensional paddings applied per dimension, i.e.:</p>
<div class="math notranslate nohighlight">
\[L \le \prod_{i} L_{i}, \qquad i \in \{1, \ldots, D\},\]</div>
<p>where <span class="math notranslate nohighlight">\(L_{i}\)</span> depends on the boundary condition at the <span class="math notranslate nohighlight">\(i\)</span>-th axis.</p>
<p><span class="math notranslate nohighlight">\(L_{i}^{2}\)</span> corresponds to the maximum singular value of the diagonal matrix</p>
<div class="math notranslate nohighlight">
\[\mathbf{A}_{i}^{\ast} \mathbf{A}_{i}
=
\mathbf{T}_{i}^{\ast} \mathbf{T}_{i} + \mathbf{S}_{i}^{\ast} \mathbf{S}_{i}
=
\mathbf{I}_{N} + \mathbf{S}_{i}^{\ast} \mathbf{S}_{i}.\]</div>
<ul>
<li><p>In mode=”constant”, <span class="math notranslate nohighlight">\(\text{diag}(\mathbf{S}_{i}^{\ast} \mathbf{S}_{i}) = \mathbf{0}\)</span>, hence <span class="math notranslate nohighlight">\(L_{i} =
1\)</span>.</p></li>
<li><p>In mode=”edge”,</p>
<div class="math notranslate nohighlight">
\[\text{diag}(\mathbf{S}_{i}^{\ast} \mathbf{S}_{i})
=
\left[p_{lhs}, 0, \ldots, 0, p_{rhs} \right],\]</div>
<p>hence <span class="math notranslate nohighlight">\(L_{i} = \sqrt{1 + \max(p_{lhs}, p_{rhs})}\)</span>.</p>
</li>
<li><p>In mode=”symmetric”, “wrap”, “reflect”, <span class="math notranslate nohighlight">\(\text{diag}(\mathbf{S}_{i}^{\ast} \mathbf{S}_{i})\)</span> equals (up to
a mode-dependant permutation)</p>
<div class="math notranslate nohighlight">
\[\text{diag}(\mathbf{S}_{i}^{\ast} \mathbf{S}_{i})
=
\left[1, \ldots, 1, 0, \ldots, 0\right]
+
\left[0, \ldots, 0, 1, \ldots, 1\right],\]</div>
<p>hence</p>
<div class="math notranslate nohighlight">
\[\begin{split}L^{\text{wrap, symmetric}}_{i} = \sqrt{1 + \lceil\frac{p_{lhs} + p_{rhs}}{N}\rceil}, \\
L^{\text{reflect}}_{i} = \sqrt{1 + \lceil\frac{p_{lhs} + p_{rhs}}{N-2}\rceil}.\end{split}\]</div>
</li>
</ul>
</li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><em>Integral</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><em>Integral</em></a><em>, </em><em>...</em><em>]</em>)</p></li>
<li><p><strong>pad_width</strong> (<a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><em>Integral</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><em>Sequence</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><em>Integral</em></a><em>] </em><em>| </em><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><em>Sequence</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><em>Integral</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><em>Integral</em></a><em>]</em><em>]</em>)</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><em>Sequence</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyxu.operator.Pad.WidthSpec">
<span class="sig-name descname"><span class="pre">WidthSpec</span></span><a class="headerlink" href="#pyxu.operator.Pad.WidthSpec" title="Link to this definition">#</a></dt>
<dd><p>alias of <a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Integral</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Integral</span></code></a>] | <a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Integral</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Integral</span></code></a>]]</p>
</dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyxu.operator.Pad.ModeSpec">
<span class="sig-name descname"><span class="pre">ModeSpec</span></span><a class="headerlink" href="#pyxu.operator.Pad.ModeSpec" title="Link to this definition">#</a></dt>
<dd><p>alias of <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.operator.Pad.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/pad.html#Pad.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.Pad.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim_shape</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArrayShape" title="pyxu.info.ptype.NDArrayShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayShape</span></code></a>) – (M1,…,MD) domain dimensions.</p></li>
<li><p><strong>pad_width</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">WidthSpec</span></code>) – <p>Number of values padded to the edges of each axis.
Multiple forms are accepted:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">int</span></code>: pad each dimension’s head/tail by <code class="code docutils literal notranslate"><span class="pre">pad_width</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tuple[int,</span> <span class="pre">...]</span></code>: pad dimension[k]’s head/tail by <code class="code docutils literal notranslate"><span class="pre">pad_width[k]</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tuple[tuple[int,</span> <span class="pre">int],</span> <span class="pre">...]</span></code>: pad dimension[k]’s head/tail by <code class="code docutils literal notranslate"><span class="pre">pad_width[k][0]</span></code> /
<code class="code docutils literal notranslate"><span class="pre">pad_width[k][1]</span></code> respectively.</p></li>
</ul>
</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> ( str )) – <p>Padding mode.
Multiple forms are accepted:</p>
<ul>
<li><p>str: unique mode shared amongst dimensions.
Must be one of:</p>
<ul>
<li><p>’constant’ (zero-padding)</p></li>
<li><p>’wrap’</p></li>
<li><p>’reflect’</p></li>
<li><p>’symmetric’</p></li>
<li><p>’edge’</p></li>
</ul>
</li>
<li><p>tuple[str, …]: pad dimension[k] using <code class="code docutils literal notranslate"><span class="pre">mode[k]</span></code>.</p></li>
</ul>
<p>(See <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.pad.html#numpy.pad" title="(in NumPy v2.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.pad()</span></code></a> for details.)</p>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>
</dd></dl>
</section>
<section id="transforms">
<h2><a class="toc-backref" href="#id32" role="doc-backlink">Transforms</a><a class="headerlink" href="#transforms" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyxu.operator.FFT">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">FFT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/fft/fft.html#FFT"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.FFT" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="../abc.html#pyxu.abc.NormalOp" title="pyxu.abc.operator.NormalOp"><code class="xref py py-class docutils literal notranslate"><span class="pre">NormalOp</span></code></a></p>
<p>Multi-dimensional Discrete Fourier Transform (DFT) <span class="math notranslate nohighlight">\(A: \mathbb{C}^{M_{1} \times\cdots\times M_{D}} \to
\mathbb{C}^{M_{1} \times\cdots\times M_{D}}\)</span>.</p>
<p>The FFT is defined as follows:</p>
<div class="math notranslate nohighlight">
\[(A \, \mathbf{x})[\mathbf{k}]
=
\sum_{\mathbf{n}} \mathbf{x}[\mathbf{n}]
\exp\left[-j 2 \pi \langle \frac{\mathbf{n}}{\mathbf{N}}, \mathbf{k} \rangle \right],\]</div>
<div class="math notranslate nohighlight">
\[(A^{*} \, \hat{\mathbf{x}})[\mathbf{n}]
=
\sum_{\mathbf{k}} \hat{\mathbf{x}}[\mathbf{k}]
\exp\left[j 2 \pi \langle \frac{\mathbf{n}}{\mathbf{N}}, \mathbf{k} \rangle \right],\]</div>
<div class="math notranslate nohighlight">
\[(\mathbf{x}, \, \hat{\mathbf{x}}) \in \mathbb{C}^{M_{1} \times\cdots\times M_{D}},
\quad
(\mathbf{n}, \, \mathbf{k}) \in \{0, \ldots, M_{1}-1\} \times\cdots\times \{0, \ldots, M_{D}-1\}.\]</div>
<p>The DFT is taken over any number of axes by means of the Fast Fourier Transform algorithm (FFT).</p>
<p class="rubric">Implementation Notes</p>
<ul>
<li><p>The CPU implementation uses <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/fft.html">SciPy’s FFT implementation</a>.</p></li>
<li><p>The GPU implementation uses cuFFT via <a class="reference external" href="https://docs.cupy.dev/en/latest/reference/scipy_fft.html">CuPy</a>.</p></li>
<li><p>The DASK implementation evaluates the FFT in chunks using the <a class="reference external" href="https://en.wikipedia.org/wiki/Chirp_Z-transform">CZT algorithm</a>.</p>
<p>Caveat: the cost of assembling the DASK graph grows with the total number of chunks; just calling <code class="docutils literal notranslate"><span class="pre">FFT.apply()</span></code>
may take a few seconds or more if inputs are highly chunked. Performance is ~7-10x slower than equivalent
non-chunked NUMPY version (assuming it fits in memory).</p>
</li>
</ul>
<p class="rubric">Examples</p>
<ul>
<li><p>1D DFT of a cosine pulse.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyxu.operator</span> <span class="kn">import</span> <span class="n">FFT</span>
<span class="kn">import</span> <span class="nn">pyxu.util</span> <span class="k">as</span> <span class="nn">pxu</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">op</span> <span class="o">=</span> <span class="n">FFT</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">N</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>  <span class="c1"># (N,)</span>
<span class="n">x_r</span> <span class="o">=</span> <span class="n">pxu</span><span class="o">.</span><span class="n">view_as_real</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>                                <span class="c1"># (N, 2)</span>

<span class="n">y_r</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">x_r</span><span class="p">)</span>                                      <span class="c1"># (N, 2)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">pxu</span><span class="o">.</span><span class="n">view_as_complex</span><span class="p">(</span><span class="n">y_r</span><span class="p">)</span>                             <span class="c1"># (N,)</span>
<span class="c1"># [0, N/2, 0, 0, 0, 0, 0, 0, 0, N/2]</span>

<span class="n">z_r</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">adjoint</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">x_r</span><span class="p">))</span>                          <span class="c1"># (N, 2)</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">pxu</span><span class="o">.</span><span class="n">view_as_complex</span><span class="p">(</span><span class="n">z_r</span><span class="p">)</span>                             <span class="c1"># (N,)</span>
<span class="c1"># np.allclose(z, N * x) -&gt; True</span>
</pre></div>
</div>
</li>
<li><p>1D DFT of a complex exponential pulse.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyxu.operator</span> <span class="kn">import</span> <span class="n">FFT</span>
<span class="kn">import</span> <span class="nn">pyxu.util</span> <span class="k">as</span> <span class="nn">pxu</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">op</span> <span class="o">=</span> <span class="n">FFT</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">N</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>            <span class="c1"># (N,)</span>
<span class="n">x_r</span> <span class="o">=</span> <span class="n">pxu</span><span class="o">.</span><span class="n">view_as_real</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>                                <span class="c1"># (N, 2)</span>

<span class="n">y_r</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">x_r</span><span class="p">)</span>                                      <span class="c1"># (N, 2)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">pxu</span><span class="o">.</span><span class="n">view_as_complex</span><span class="p">(</span><span class="n">y_r</span><span class="p">)</span>                             <span class="c1"># (N,)</span>
<span class="c1"># [0, N, 0, 0, 0, 0, 0, 0, 0, 0]</span>

<span class="n">z_r</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">adjoint</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">x_r</span><span class="p">))</span>                          <span class="c1"># (N, 2)</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">pxu</span><span class="o">.</span><span class="n">view_as_complex</span><span class="p">(</span><span class="n">z_r</span><span class="p">)</span>                             <span class="c1"># (N,)</span>
<span class="c1"># np.allclose(z, N * x) -&gt; True</span>
</pre></div>
</div>
</li>
<li><p>2D DFT of an image</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyxu.operator</span> <span class="kn">import</span> <span class="n">FFT</span>
<span class="kn">import</span> <span class="nn">pyxu.util</span> <span class="k">as</span> <span class="nn">pxu</span>

<span class="n">N_h</span><span class="p">,</span> <span class="n">N_w</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">8</span>
<span class="n">op</span> <span class="o">=</span> <span class="n">FFT</span><span class="p">((</span><span class="n">N_h</span><span class="p">,</span> <span class="n">N_w</span><span class="p">))</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span>                                              <span class="c1"># (N_h, N_w)</span>
    <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">N_h</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span> <span class="n">N_w</span><span class="o">//</span><span class="mi">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">),</span>
    <span class="n">pad_width</span><span class="o">=</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="n">N_h</span><span class="o">//</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">N_w</span><span class="o">//</span><span class="mi">2</span><span class="p">)),</span>
<span class="p">)</span>
<span class="n">x_r</span> <span class="o">=</span> <span class="n">pxu</span><span class="o">.</span><span class="n">view_as_real</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>                                <span class="c1"># (N_h, N_w, 2)</span>

<span class="n">y_r</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">x_r</span><span class="p">)</span>                                      <span class="c1"># (N_h, N_w, 2)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">pxu</span><span class="o">.</span><span class="n">view_as_complex</span><span class="p">(</span><span class="n">y_r</span><span class="p">)</span>                             <span class="c1"># (N_h, N_w)</span>

<span class="n">z_r</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">adjoint</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">x_r</span><span class="p">))</span>                          <span class="c1"># (N_h, N_w, 2)</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">pxu</span><span class="o">.</span><span class="n">view_as_complex</span><span class="p">(</span><span class="n">z_r</span><span class="p">)</span>                             <span class="c1"># (N_h, N_w)</span>
<span class="c1"># np.allclose(z, (N_h * N_w) * x) -&gt; True</span>
</pre></div>
</div>
</li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><em>Integral</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><em>Integral</em></a><em>, </em><em>...</em><em>]</em>)</p></li>
<li><p><strong>axes</strong> (<a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><em>Integral</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><em>Integral</em></a><em>, </em><em>...</em><em>]</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.operator.FFT.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/fft/fft.html#FFT.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.FFT.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim_shape</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArrayShape" title="pyxu.info.ptype.NDArrayShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayShape</span></code></a>) – (M1,…,MD) dimensions of the input <span class="math notranslate nohighlight">\(\mathbf{x} \in \mathbb{C}^{M_{1} \times\cdots\times M_{D}}\)</span>.</p></li>
<li><p><strong>axes</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArrayAxis" title="pyxu.info.ptype.NDArrayAxis"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayAxis</span></code></a>) – Axes over which to compute the FFT. If not given, all axes are used.</p></li>
<li><p><strong>kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>) – <p>Extra kwargs passed to <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.fft.fftn.html#scipy.fft.fftn" title="(in SciPy v1.14.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.fft.fftn()</span></code></a> or <a class="reference external" href="https://docs.cupy.dev/en/latest/reference/generated/cupyx.scipy.fft.fftn.html#cupyx.scipy.fft.fftn" title="(in CuPy v14.0.0a1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">cupyx.scipy.fft.fftn()</span></code></a>.</p>
<p>Supported parameters for <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.fft.fftn.html#scipy.fft.fftn" title="(in SciPy v1.14.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.fft.fftn()</span></code></a> are:</p>
<blockquote>
<div><ul>
<li><p>workers: int = None</p></li>
</ul>
</div></blockquote>
<p>Supported parameters for <a class="reference external" href="https://docs.cupy.dev/en/latest/reference/generated/cupyx.scipy.fft.fftn.html#cupyx.scipy.fft.fftn" title="(in CuPy v14.0.0a1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">cupyx.scipy.fft.fftn()</span></code></a> are:</p>
<blockquote>
<div><ul>
<li><p>NOT SUPPORTED FOR NOW</p></li>
</ul>
</div></blockquote>
<p>Default values are chosen if unspecified.</p>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.operator.FFT.apply">
<span class="sig-name descname"><span class="pre">apply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/fft/fft.html#FFT.apply"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.FFT.apply" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>arr</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArray</span></code></a>) – (…, M1,…,MD,2) inputs <span class="math notranslate nohighlight">\(\mathbf{x} \in \mathbb{C}^{M_{1} \times\cdots\times M_{D}}\)</span> viewed as a
real array. (See <a class="reference internal" href="../util.html#pyxu.util.view_as_real" title="pyxu.util.view_as_real"><code class="xref py py-func docutils literal notranslate"><span class="pre">view_as_real()</span></code></a>.)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>out</strong> – (…, M1,…,MD,2) outputs <span class="math notranslate nohighlight">\(\hat{\mathbf{x}} \in \mathbb{C}^{M_{1} \times\cdots\times M_{D}}\)</span> viewed
as a real array. (See <a class="reference internal" href="../util.html#pyxu.util.view_as_real" title="pyxu.util.view_as_real"><code class="xref py py-func docutils literal notranslate"><span class="pre">view_as_real()</span></code></a>.)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArray</span></code></a></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.operator.FFT.adjoint">
<span class="sig-name descname"><span class="pre">adjoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/fft/fft.html#FFT.adjoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.FFT.adjoint" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>arr</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArray</span></code></a>) – (…, M1,…,MD,2) inputs <span class="math notranslate nohighlight">\(\hat{\mathbf{x}} \in \mathbb{C}^{M_{1} \times\cdots\times M_{D}}\)</span> viewed
as a real array. (See <a class="reference internal" href="../util.html#pyxu.util.view_as_real" title="pyxu.util.view_as_real"><code class="xref py py-func docutils literal notranslate"><span class="pre">view_as_real()</span></code></a>.)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>out</strong> – (…, M1,…,MD,2) outputs <span class="math notranslate nohighlight">\(\mathbf{x} \in \mathbb{C}^{M_{1} \times\cdots\times M_{D}}\)</span> viewed as a
real array. (See <a class="reference internal" href="../util.html#pyxu.util.view_as_real" title="pyxu.util.view_as_real"><code class="xref py py-func docutils literal notranslate"><span class="pre">view_as_real()</span></code></a>.)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArray</span></code></a></p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyxu.operator.CZT">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">CZT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/fft/czt.html#CZT"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.CZT" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="../abc.html#pyxu.abc.LinOp" title="pyxu.abc.operator.LinOp"><code class="xref py py-class docutils literal notranslate"><span class="pre">LinOp</span></code></a></p>
<p>Multi-dimensional Chirp Z-Transform (CZT) <span class="math notranslate nohighlight">\(C: \mathbb{C}^{N_{1} \times\cdots\times N_{D}} \to
\mathbb{C}^{M_{1} \times\cdots\times M_{D}}\)</span>.</p>
<p>The 1D CZT of parameters <span class="math notranslate nohighlight">\((A, W, M)\)</span> is defined as:</p>
<div class="math notranslate nohighlight">
\[(C \, \mathbf{x})[k]
=
\sum_{n=0}^{N-1} \mathbf{x}[n] A^{-n} W^{nk},\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{x} \in \mathbb{C}^{N}\)</span>, <span class="math notranslate nohighlight">\(A, W \in \mathbb{C}\)</span>, and <span class="math notranslate nohighlight">\(k = \{0, \ldots, M-1\}\)</span>.</p>
<p>A D-dimensional CZT corresponds to taking a 1D CZT along each transform axis.</p>
<p class="rubric">Implementation Notes</p>
<p>For stability reasons, this implementation assumes <span class="math notranslate nohighlight">\(A, W \in \mathbb{C}\)</span> lie on the unit circle.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyxu.operator.FFT" title="pyxu.operator.FFT"><code class="xref py py-class docutils literal notranslate"><span class="pre">FFT</span></code></a></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><em>Integral</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><em>Integral</em></a><em>, </em><em>...</em><em>]</em>)</p></li>
<li><p><strong>axes</strong> (<a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><em>Integral</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><em>Integral</em></a><em>, </em><em>...</em><em>]</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.operator.CZT.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/fft/czt.html#CZT.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.CZT.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim_shape</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArrayShape" title="pyxu.info.ptype.NDArrayShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayShape</span></code></a>) – (N1,…,ND) dimensions of the input <span class="math notranslate nohighlight">\(\mathbf{x} \in \mathbb{C}^{N_{1} \times\cdots\times N_{D}}\)</span>.</p></li>
<li><p><strong>axes</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArrayAxis" title="pyxu.info.ptype.NDArrayAxis"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayAxis</span></code></a>) – Axes over which to compute the CZT. If not given, all axes are used.</p></li>
<li><p><strong>M</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list(int)</span></code>) – Length of the transform per axis.</p></li>
<li><p><strong>A</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">complex</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list(complex)</span></code>) – Circular offset from the positive real-axis per axis.</p></li>
<li><p><strong>W</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">complex</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list(complex)</span></code>) – Circular spacing between transform points per axis.</p></li>
<li><p><strong>kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>) – Extra kwargs passed to <a class="reference internal" href="#pyxu.operator.FFT" title="pyxu.operator.FFT"><code class="xref py py-class docutils literal notranslate"><span class="pre">FFT</span></code></a>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.operator.CZT.apply">
<span class="sig-name descname"><span class="pre">apply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/fft/czt.html#CZT.apply"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.CZT.apply" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>arr</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArray</span></code></a>) – (…, N1,…,ND,2) inputs <span class="math notranslate nohighlight">\(\mathbf{x} \in \mathbb{C}^{N_{1} \times\cdots\times N_{D}}\)</span> viewed as a
real array. (See <a class="reference internal" href="../util.html#pyxu.util.view_as_real" title="pyxu.util.view_as_real"><code class="xref py py-func docutils literal notranslate"><span class="pre">view_as_real()</span></code></a>.)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>out</strong> – (…, M1,…,MD,2) outputs <span class="math notranslate nohighlight">\(\hat{\mathbf{x}} \in \mathbb{C}^{M_{1} \times\cdots\times M_{D}}\)</span> viewed
as a real array. (See <a class="reference internal" href="../util.html#pyxu.util.view_as_real" title="pyxu.util.view_as_real"><code class="xref py py-func docutils literal notranslate"><span class="pre">view_as_real()</span></code></a>.)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArray</span></code></a></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.operator.CZT.adjoint">
<span class="sig-name descname"><span class="pre">adjoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/fft/czt.html#CZT.adjoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.CZT.adjoint" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>arr</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArray</span></code></a>) – (…, M1,…,MD,2) inputs <span class="math notranslate nohighlight">\(\hat{\mathbf{x}} \in \mathbb{C}^{M_{1} \times\cdots\times M_{D}}\)</span> viewed
as a real array. (See <a class="reference internal" href="../util.html#pyxu.util.view_as_real" title="pyxu.util.view_as_real"><code class="xref py py-func docutils literal notranslate"><span class="pre">view_as_real()</span></code></a>.)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>out</strong> – (…, N1,…,ND,2) outputs <span class="math notranslate nohighlight">\(\mathbf{x} \in \mathbb{C}^{N_{1} \times\cdots\times N_{D}}\)</span> viewed as a
real array. (See <a class="reference internal" href="../util.html#pyxu.util.view_as_real" title="pyxu.util.view_as_real"><code class="xref py py-func docutils literal notranslate"><span class="pre">view_as_real()</span></code></a>.)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArray</span></code></a></p>
</dd>
</dl>
</dd></dl>
</dd></dl>
</section>
<section id="stencils-convolutions">
<h2><a class="toc-backref" href="#id33" role="doc-backlink">Stencils &amp; Convolutions</a><a class="headerlink" href="#stencils-convolutions" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyxu.operator._Stencil">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_Stencil</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kernel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/stencil/_stencil.html#_Stencil"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator._Stencil" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Multi-dimensional JIT-compiled stencil. (Low-level function.)</p>
<p>This low-level class creates a gu-vectorized stencil applicable on multiple inputs simultaneously.
Only NUMPY/CUPY arrays are accepted.</p>
<p>Create instances via factory method <a class="reference internal" href="#pyxu.operator._Stencil.init" title="pyxu.operator._Stencil.init"><code class="xref py py-meth docutils literal notranslate"><span class="pre">init()</span></code></a>.</p>
<p class="rubric">Example</p>
<p>Correlate a stack of images <code class="code docutils literal notranslate"><span class="pre">A</span></code> with a (3, 3) kernel such that:</p>
<div class="math notranslate nohighlight">
\[B[n, m] = A[n-1, m] + A[n, m-1] + A[n, m+1] + A[n+1, m]\]</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pyxu.operator</span> <span class="kn">import</span> <span class="n">_Stencil</span>

<span class="c1"># create the stencil</span>
<span class="n">kernel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                   <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                   <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="n">center</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">stencil</span> <span class="o">=</span> <span class="n">_Stencil</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">kernel</span><span class="p">,</span> <span class="n">center</span><span class="p">)</span>

<span class="c1"># apply it to the data</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span>  <span class="c1"># 24 images of size (30, 30)</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">stencil</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>  <span class="c1"># (2, 3, 4, 30, 30)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kernel</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><em>NDArray</em></a>)</p></li>
<li><p><strong>center</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><em>NDArray</em></a>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyxu.operator._Stencil.IndexSpec">
<span class="sig-name descname"><span class="pre">IndexSpec</span></span><a class="headerlink" href="#pyxu.operator._Stencil.IndexSpec" title="Link to this definition">#</a></dt>
<dd><p>alias of <a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Integral</span></code></a>]</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.operator._Stencil.init">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kernel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/stencil/_stencil.html#_Stencil.init"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator._Stencil.init" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kernel</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArray</span></code></a>) – <p>(k1,…,kD) kernel coefficients.</p>
<p>Only float32/64 kernels are supported.</p>
</p></li>
<li><p><strong>center</strong> (<a class="reference internal" href="#pyxu.operator._Stencil.IndexSpec" title="pyxu.operator._Stencil.IndexSpec"><code class="xref py py-class docutils literal notranslate"><span class="pre">IndexSpec</span></code></a>) – (D,) index of the kernel’s center.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>st</strong> – Rank-D stencil.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#pyxu.operator._Stencil" title="pyxu.operator._Stencil"><code class="xref py py-class docutils literal notranslate"><span class="pre">_Stencil</span></code></a></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.operator._Stencil.apply">
<span class="sig-name descname"><span class="pre">apply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/stencil/_stencil.html#_Stencil.apply"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator._Stencil.apply" title="Link to this definition">#</a></dt>
<dd><p>Evaluate stencil on multiple inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArray</span></code></a>) – (…, M1,…,MD) data to process.</p></li>
<li><p><strong>out</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArray</span></code></a>) – (…, M1,…,MD) array to which outputs are written.</p></li>
<li><p><strong>kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>) – <p>Extra kwargs to configure <code class="code docutils literal notranslate"><span class="pre">f_jit()</span></code>, the Dispatcher instance created by Numba.</p>
<p>Only relevant for GPU stencils, with values:</p>
<ul>
<li><p>blockspergrid: int</p></li>
<li><p>threadsperblock: int</p></li>
</ul>
<p>Default values are chosen if unspecified.</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>out</strong> – (…, M1,…,MD) outputs.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArray</span></code></a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul>
<li><p><code class="code docutils literal notranslate"><span class="pre">arr</span></code> and <code class="code docutils literal notranslate"><span class="pre">out</span></code> must have the same type/dtype as the kernel used during instantiation.</p></li>
<li><p>Index regions in <code class="code docutils literal notranslate"><span class="pre">out</span></code> where the stencil is not fully supported are set to 0.</p></li>
<li><p><a class="reference internal" href="#pyxu.operator._Stencil.apply" title="pyxu.operator._Stencil.apply"><code class="xref py py-meth docutils literal notranslate"><span class="pre">apply()</span></code></a> may raise <code class="docutils literal notranslate"><span class="pre">CUDA_ERROR_LAUNCH_OUT_OF_RESOURCES</span></code> when the number of
GPU registers required exceeds resource limits.  There are 2 solutions to this problem:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Pass the <code class="code docutils literal notranslate"><span class="pre">max_registers</span></code> kwarg to f_jit()’s decorator; or</p></li>
<li><p><a class="reference external" href="https://stackoverflow.com/a/68659008">Limit the number of threads per block</a>.</p></li>
</ol>
</div></blockquote>
<ol class="arabic simple">
<li><p>must be set at compile time; it is thus left unbounded.</p></li>
<li><p>is accessible through .apply(**kwargs).</p></li>
</ol>
</li>
</ul>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyxu.operator.Stencil">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Stencil</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_warnings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/stencil/stencil.html#Stencil"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.Stencil" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="../abc.html#pyxu.abc.SquareOp" title="pyxu.abc.operator.SquareOp"><code class="xref py py-class docutils literal notranslate"><span class="pre">SquareOp</span></code></a></p>
<p>Multi-dimensional JIT-compiled stencil.</p>
<p>Stencils are a common computational pattern in which array elements are updated according to some fixed pattern
called the <em>stencil kernel</em>.  Notable examples include multi-dimensional convolutions, correlations and finite
differences.  (See Notes for a definition.)</p>
<p>Stencils can be evaluated efficiently on CPU/GPU architectures.</p>
<p>Several boundary conditions are supported.  Moreover boundary conditions may differ per axis.</p>
<p class="rubric">Implementation Notes</p>
<ul class="simple">
<li><p>Numba (and its <code class="docutils literal notranslate"><span class="pre">@stencil</span></code> decorator) is used to compile efficient machine code from a stencil kernel
specification.  This has 2 consequences:</p>
<ul>
<li><dl class="simple">
<dt><a class="reference internal" href="#pyxu.operator.Stencil" title="pyxu.operator.Stencil"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stencil</span></code></a> instances are <strong>not arraymodule-agnostic</strong>: they will only work with NDArrays</dt><dd><p>belonging to the same array module as <code class="code docutils literal notranslate"><span class="pre">kernel</span></code>.</p>
</dd>
</dl>
</li>
<li><p>Compiled stencils are not <strong>precision-agnostic</strong>: they will only work on NDArrays with the same dtype as
<code class="code docutils literal notranslate"><span class="pre">kernel</span></code>.  A warning is emitted if inputs must be cast to the kernel dtype.</p></li>
</ul>
</li>
<li><p>Stencil kernels can be specified in two forms: (See <a class="reference internal" href="#pyxu.operator.Stencil.__init__" title="pyxu.operator.Stencil.__init__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__init__()</span></code></a> for details.)</p>
<ul>
<li><p>A single non-separable <span class="math notranslate nohighlight">\(D\)</span>-dimensional kernel <span class="math notranslate nohighlight">\(k[i_{1},\ldots,i_{D}]\)</span> of shape
<span class="math notranslate nohighlight">\((K_{1},\ldots,K_{D})\)</span>.</p></li>
<li><p>A sequence of separable <span class="math notranslate nohighlight">\(1\)</span>-dimensional kernel(s) <span class="math notranslate nohighlight">\(k_{d}[i]\)</span> of shapes
<span class="math notranslate nohighlight">\((K_{1},),\ldots,(K_{D},)\)</span> such that <span class="math notranslate nohighlight">\(k[i_{1},\ldots,i_{D}] = \Pi_{d=1}^{D} k_{d}[i_{d}]\)</span>.</p></li>
</ul>
</li>
</ul>
<p class="rubric">Mathematical Notes</p>
<p>Given a <span class="math notranslate nohighlight">\(D\)</span>-dimensional array <span class="math notranslate nohighlight">\(x\in\mathbb{R}^{N_1\times\cdots\times N_D}\)</span> and kernel
<span class="math notranslate nohighlight">\(k\in\mathbb{R}^{K_1\times\cdots\times K_D}\)</span> with center <span class="math notranslate nohighlight">\((c_1, \ldots, c_D)\)</span>, the output of the stencil
operator is an array <span class="math notranslate nohighlight">\(y\in\mathbb{R}^{N_1\times\cdots\times N_D}\)</span> given by:</p>
<div class="math notranslate nohighlight">
\[y[i_{1},\ldots,i_{D}]
=
\sum_{q_{1},\ldots,q_{D}=0}^{K_{1},\ldots,K_{D}}
x[i_{1} - c_{1} + q_{1},\ldots,i_{D} - c_{D} + q_{D}]
\,\cdot\,
k[q_{1},\ldots,q_{D}].\]</div>
<p>This corresponds to a <em>correlation</em> with a shifted version of the kernel <span class="math notranslate nohighlight">\(k\)</span>.</p>
<p>Numba stencils assume summation terms involving out-of-bound indices of <span class="math notranslate nohighlight">\(x\)</span> are set to zero.
<a class="reference internal" href="#pyxu.operator.Stencil" title="pyxu.operator.Stencil"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stencil</span></code></a> lifts this constraint by extending the stencil to boundary values via pre-padding
and post-trimming.  Concretely, any stencil operator <span class="math notranslate nohighlight">\(S\)</span> instantiated with <a class="reference internal" href="#pyxu.operator.Stencil" title="pyxu.operator.Stencil"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stencil</span></code></a>
can be written as the composition <span class="math notranslate nohighlight">\(S = TS_0P\)</span>, where <span class="math notranslate nohighlight">\((T, S_0, P)\)</span> are trimming, stencil with
zero-padding conditions, and padding operators respectively.  This construct allows
<a class="reference internal" href="#pyxu.operator.Stencil" title="pyxu.operator.Stencil"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stencil</span></code></a> to handle complex boundary conditions under which <span class="math notranslate nohighlight">\(S\)</span> <em>may not be a proper
stencil</em> (i.e., varying kernel) but can still be implemented efficiently via a proper stencil upon appropriate
trimming/padding.</p>
<p>For example consider the decomposition of the following (improper) stencil operator:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">S</span> <span class="o">=</span> <span class="n">Stencil</span><span class="p">(</span>
<span class="gp">... </span>     <span class="n">dim_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,),</span>
<span class="gp">... </span>     <span class="n">kernel</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">],</span>
<span class="gp">... </span>     <span class="n">center</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,),</span>
<span class="gp">... </span>     <span class="n">mode</span><span class="o">=</span><span class="s2">"reflect"</span><span class="p">,</span>
<span class="gp">... </span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">S</span><span class="o">.</span><span class="n">asarray</span><span class="p">()</span>
<span class="go">[[-3   2   1   0   0]</span>
<span class="go"> [ 2  -2   0   0   0]</span>
<span class="go"> [ 1   2  -3   0   0]</span>
<span class="go"> [ 0   1   2  -3   0]</span>
<span class="go"> [ 0   0   1   2  -3]] # Improper stencil (kernel varies across rows)</span>
<span class="go">=</span>
<span class="go">[[0  0  1  0  0  0  0  0  0]</span>
<span class="go"> [0  0  0  1  0  0  0  0  0]</span>
<span class="go"> [0  0  0  0  1  0  0  0  0]</span>
<span class="go"> [0  0  0  0  0  1  0  0  0]</span>
<span class="go"> [0  0  0  0  0  0  1  0  0]]  # Trimming</span>
<span class="go">@</span>
<span class="go">[[-3   0   0   0   0   0   0   0   0]</span>
<span class="go"> [ 2  -3   0   0   0   0   0   0   0]</span>
<span class="go"> [ 1   2  -3   0   0   0   0   0   0]</span>
<span class="go"> [ 0   1   2  -3   0   0   0   0   0]</span>
<span class="go"> [ 0   0   1   2  -3   0   0   0   0]</span>
<span class="go"> [ 0   0   0   1   2  -3   0   0   0]</span>
<span class="go"> [ 0   0   0   0   1   2  -3   0   0]</span>
<span class="go"> [ 0   0   0   0   0   1   2  -3   0]</span>
<span class="go"> [ 0   0   0   0   0   0   1   2  -3]]  # Proper stencil (Toeplitz structure)</span>
<span class="go">@</span>
<span class="go">[[0  0  1  0  0]</span>
<span class="go"> [0  1  0  0  0]</span>
<span class="go"> [1  0  0  0  0]</span>
<span class="go"> [0  1  0  0  0]</span>
<span class="go"> [0  0  1  0  0]</span>
<span class="go"> [0  0  0  1  0]</span>
<span class="go"> [0  0  0  0  1]</span>
<span class="go"> [0  0  0  1  0]</span>
<span class="go"> [0  0  1  0  0]]  # Padding with reflect mode.</span>
</pre></div>
</div>
<p>Note that the adjoint of a stencil operator may not necessarily be a stencil operator, or the associated center and
boundary conditions may be hard to predict.  For example, the adjoint of the stencil operator defined above is given
by:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">S</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">asarray</span><span class="p">()</span>
<span class="go">[[-3   2   1   0   0],</span>
<span class="go"> [ 2  -2   2   1   0],</span>
<span class="go"> [ 1   0  -3   2   1],</span>
<span class="go"> [ 0   0   0  -3   2],</span>
<span class="go"> [ 0   0   0   0  -3]]</span>
</pre></div>
</div>
<p>which resembles a stencil with time-reversed kernel, but with weird (if not improper) boundary conditions.  This can
also be seen from the fact that <span class="math notranslate nohighlight">\(S^\ast = P^\ast S_0^\ast T^\ast = P^\ast S_0^\ast P_0,\)</span> and <span class="math notranslate nohighlight">\(P^\ast\)</span> is
in general not a trimming operator.  (See <a class="reference internal" href="#pyxu.operator.Pad" title="pyxu.operator.Pad"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pad</span></code></a>.)</p>
<p>The same holds for gram/cogram operators.  Consider indeed the following order-1 backward finite-difference operator
with zero-padding:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">S</span> <span class="o">=</span> <span class="n">Stencil</span><span class="p">(</span>
<span class="gp">... </span>     <span class="n">dim_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,),</span>
<span class="gp">... </span>     <span class="n">kernel</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>     <span class="n">center</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,),</span>
<span class="gp">... </span>     <span class="n">mode</span><span class="o">=</span><span class="s1">'constant'</span><span class="p">,</span>
<span class="gp">... </span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">S</span><span class="o">.</span><span class="n">gram</span><span class="p">()</span><span class="o">.</span><span class="n">asarray</span><span class="p">()</span>
<span class="go">[[ 1  -1   0   0   0]</span>
<span class="go"> [-1   2  -1   0   0]</span>
<span class="go"> [ 0  -1   2  -1   0]</span>
<span class="go"> [ 0   0  -1   2  -1]</span>
<span class="go"> [ 0   0   0  -1   2]]</span>
</pre></div>
</div>
<p>We observe that the Gram differs from the order 2 centered finite-difference operator.  (Reduced-order derivative on
one side.)</p>
<p class="rubric">Example</p>
<ul>
<li><p><strong>Moving average of a 1D signal</strong></p>
<p>Let <span class="math notranslate nohighlight">\(x[n]\)</span> denote a 1D signal.  The weighted moving average</p>
<div class="math notranslate nohighlight">
\[y[n] = x[n-2] + 2 x[n-1] + 3 x[n]\]</div>
<p>can be viewed as the output of the 3-point stencil of kernel <span class="math notranslate nohighlight">\(k = [1, 2, 3]\)</span>.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pyxu.operator</span> <span class="kn">import</span> <span class="n">Stencil</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>  <span class="c1"># [0  1  2  3  4  5  6  7  8  9]</span>

<span class="n">op</span> <span class="o">=</span> <span class="n">Stencil</span><span class="p">(</span>
    <span class="n">dim_shape</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
    <span class="n">kernel</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span>
    <span class="n">center</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,),</span>  <span class="c1"># k[2] applies on x[n]</span>
<span class="p">)</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># [0  3  8  14  20  26  32  38  44  50]</span>
</pre></div>
</div>
</li>
<li><p><strong>Non-seperable image filtering</strong></p>
<p>Let <span class="math notranslate nohighlight">\(x[n, m]\)</span> denote a 2D image.  The blurred image</p>
<div class="math notranslate nohighlight">
\[y[n, m] = 2 x[n-1,m-1] + 3 x[n-1,m+1] + 4 x[n+1,m-1] + 5 x[n+1,m+1]\]</div>
<p>can be viewed as the output of the 9-point stencil</p>
<div class="math notranslate nohighlight">
\[\begin{split}k =
\left[
\begin{array}{ccc}
   2 &amp; 0 &amp; 3 \\
   0 &amp; 0 &amp; 0 \\
   4 &amp; 0 &amp; 5
\end{array}
\right].\end{split}\]</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pyxu.operator</span> <span class="kn">import</span> <span class="n">Stencil</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>  <span class="c1"># square image</span>
<span class="c1"># [[ 0   1   2   3   4   5   6   7]</span>
<span class="c1">#  [ 8   9  10  11  12  13  14  15]</span>
<span class="c1">#  [16  17  18  19  20  21  22  23]</span>
<span class="c1">#  [24  25  26  27  28  29  30  31]</span>
<span class="c1">#  [32  33  34  35  36  37  38  39]</span>
<span class="c1">#  [40  41  42  43  44  45  46  47]</span>
<span class="c1">#  [48  49  50  51  52  53  54  55]</span>
<span class="c1">#  [56  57  58  59  60  61  62  63]]</span>

<span class="n">op</span> <span class="o">=</span> <span class="n">Stencil</span><span class="p">(</span>
    <span class="n">dim_shape</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
    <span class="n">kernel</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
        <span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
         <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
         <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">]]),</span>
    <span class="n">center</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>  <span class="c1"># k[1, 1] applies on x[n, m]</span>
<span class="p">)</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="c1"># [[ 45   82   91  100  109  118  127   56 ]</span>
<span class="c1">#  [ 88  160  174  188  202  216  230  100 ]</span>
<span class="c1">#  [152  272  286  300  314  328  342  148 ]</span>
<span class="c1">#  [216  384  398  412  426  440  454  196 ]</span>
<span class="c1">#  [280  496  510  524  538  552  566  244 ]</span>
<span class="c1">#  [344  608  622  636  650  664  678  292 ]</span>
<span class="c1">#  [408  720  734  748  762  776  790  340 ]</span>
<span class="c1">#  [147  246  251  256  261  266  271  108 ]]</span>
</pre></div>
</div>
</li>
<li><p><strong>Seperable image filtering</strong></p>
<p>Let <span class="math notranslate nohighlight">\(x[n, m]\)</span> denote a 2D image.  The warped image</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
    y[n, m] = &amp; +  4 x[n-1,m-1] +  5 x[n-1,m] +  6 x[n-1,m+1] \\
              &amp; +  8 x[n  ,m-1] + 10 x[n  ,m] + 12 x[n  ,m+1] \\
              &amp; + 12 x[n+1,m-1] + 15 x[n+1,m] + 18 x[n+1,m+1]
\end{align*}\end{split}\]</div>
<p>can be viewed as the output of the 9-point stencil</p>
<div class="math notranslate nohighlight">
\[\begin{split}k_{2D} =
\left[
\begin{array}{ccc}
    4 &amp;  5 &amp;  6 \\
    8 &amp; 10 &amp; 12 \\
   12 &amp; 15 &amp; 18 \\
\end{array}
\right].\end{split}\]</div>
<p>Notice however that <span class="math notranslate nohighlight">\(y[n, m]\)</span> can be implemented more efficiently by factoring the 9-point stencil as a
cascade of two 3-point stencils:</p>
<div class="math notranslate nohighlight">
\[\begin{split}k_{2D}
= k_{1} k_{2}^{T}
= \left[
\begin{array}{c}
   1 \\ 2 \\ 3
\end{array}
\right]
\left[
\begin{array}{c}
   4 &amp; 5 &amp; 6
\end{array}
\right].\end{split}\]</div>
<p>Seperable stencils are supported and should be preferred when applicable.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pyxu.operator</span> <span class="kn">import</span> <span class="n">Stencil</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>  <span class="c1"># square image</span>
<span class="c1"># [[ 0   1   2   3   4   5   6   7]</span>
<span class="c1">#  [ 8   9  10  11  12  13  14  15]</span>
<span class="c1">#  [16  17  18  19  20  21  22  23]</span>
<span class="c1">#  [24  25  26  27  28  29  30  31]</span>
<span class="c1">#  [32  33  34  35  36  37  38  39]</span>
<span class="c1">#  [40  41  42  43  44  45  46  47]</span>
<span class="c1">#  [48  49  50  51  52  53  54  55]</span>
<span class="c1">#  [56  57  58  59  60  61  62  63]]</span>

<span class="n">op_2D</span> <span class="o">=</span> <span class="n">Stencil</span><span class="p">(</span>  <span class="c1"># using non-seperable kernel</span>
    <span class="n">dim_shape</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
    <span class="n">kernel</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
        <span class="p">[[</span> <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">],</span>
         <span class="p">[</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span>
         <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">18</span><span class="p">]]),</span>
    <span class="n">center</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>  <span class="c1"># k[1, 1] applies on x[n, m]</span>
<span class="p">)</span>
<span class="n">op_sep</span> <span class="o">=</span> <span class="n">Stencil</span><span class="p">(</span>  <span class="c1"># using seperable kernels</span>
    <span class="n">dim_shape</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
    <span class="n">kernel</span><span class="o">=</span><span class="p">[</span>
        <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span>  <span class="c1"># k1: stencil along 1st axis</span>
        <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]),</span>  <span class="c1"># k2: stencil along 2nd axis</span>
    <span class="p">],</span>
    <span class="n">center</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>  <span class="c1"># k1[1] * k2[1] applies on x[n, m]</span>
<span class="p">)</span>

<span class="n">y_2D</span> <span class="o">=</span> <span class="n">op_2D</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">y_sep</span> <span class="o">=</span> <span class="n">op_sep</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># np.allclose(y_2D, y_sep) -&gt; True</span>
<span class="c1"># [[ 294   445   520   595   670   745   820   511 ]</span>
<span class="c1">#  [ 740  1062  1152  1242  1332  1422  1512   930 ]</span>
<span class="c1">#  [1268  1782  1872  1962  2052  2142  2232  1362 ]</span>
<span class="c1">#  [1796  2502  2592  2682  2772  2862  2952  1794 ]</span>
<span class="c1">#  [2324  3222  3312  3402  3492  3582  3672  2226 ]</span>
<span class="c1">#  [2852  3942  4032  4122  4212  4302  4392  2658 ]</span>
<span class="c1">#  [3380  4662  4752  4842  4932  5022  5112  3090 ]</span>
<span class="c1">#  [1778  2451  2496  2541  2586  2631  2676  1617 ]]</span>
</pre></div>
</div>
</li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>For large, non-separable kernels, stencil compilation can be time-consuming. Depending on your computer’s
architecture, using the :py:class:~pyxu.operator.FFTCorrelate operator might offer a more efficient solution.
However, the performance improvement varies, so we recommend evaluating this alternative in your specific
environment.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyxu.operator.Convolve" title="pyxu.operator.Convolve"><code class="xref py py-class docutils literal notranslate"><span class="pre">Convolve</span></code></a>, <a class="reference internal" href="#pyxu.operator._Stencil" title="pyxu.operator._Stencil"><code class="xref py py-class docutils literal notranslate"><span class="pre">_Stencil</span></code></a>, <a class="reference internal" href="#pyxu.operator.FFTCorrelate" title="pyxu.operator.FFTCorrelate"><code class="xref py py-class docutils literal notranslate"><span class="pre">FFTCorrelate</span></code></a>, <a class="reference internal" href="#pyxu.operator.FFTConvolve" title="pyxu.operator.FFTConvolve"><code class="xref py py-class docutils literal notranslate"><span class="pre">FFTConvolve</span></code></a></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><em>Integral</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><em>Integral</em></a><em>, </em><em>...</em><em>]</em>)</p></li>
<li><p><strong>kernel</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><em>NDArray</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><em>Sequence</em></a><em>[</em><a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><em>NDArray</em></a><em>]</em>)</p></li>
<li><p><strong>center</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><em>Sequence</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><em>Integral</em></a><em>]</em>)</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><em>Sequence</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em>)</p></li>
<li><p><strong>enable_warnings</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyxu.operator.Stencil.KernelSpec">
<span class="sig-name descname"><span class="pre">KernelSpec</span></span><a class="headerlink" href="#pyxu.operator.Stencil.KernelSpec" title="Link to this definition">#</a></dt>
<dd><p>alias of <a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NDArray</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NDArray</span></code></a>]</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.operator.Stencil.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_warnings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/stencil/stencil.html#Stencil.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.Stencil.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim_shape</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArrayShape" title="pyxu.info.ptype.NDArrayShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayShape</span></code></a>) – (M1,…,MD) input dimensions.</p></li>
<li><p><strong>kernel</strong> (<a class="reference internal" href="#pyxu.operator.Stencil.KernelSpec" title="pyxu.operator.Stencil.KernelSpec"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelSpec</span></code></a>) – <p>Stencil coefficients.  Two forms are accepted:</p>
<ul>
<li><p>NDArray of rank-<span class="math notranslate nohighlight">\(D\)</span>: denotes a non-seperable stencil.</p></li>
<li><p>tuple[NDArray_1, …, NDArray_D]: a sequence of 1D stencils such that dimension[k] is filtered by stencil
<code class="code docutils literal notranslate"><span class="pre">kernel[k]</span></code>, that is:</p>
<div class="math notranslate nohighlight">
\[k = k_1 \otimes\cdots\otimes k_D,\]</div>
<p>or in Python: <code class="docutils literal notranslate"><span class="pre">k</span> <span class="pre">=</span> <span class="pre">functools.reduce(numpy.multiply.outer,</span> <span class="pre">kernel)</span></code>.</p>
</li>
</ul>
</p></li>
<li><p><strong>center</strong> (<a class="reference internal" href="#pyxu.operator._Stencil.IndexSpec" title="pyxu.operator._Stencil.IndexSpec"><code class="xref py py-class docutils literal notranslate"><span class="pre">IndexSpec</span></code></a>) – <p>(i1,…,iD) index of the stencil’s center.</p>
<p><code class="code docutils literal notranslate"><span class="pre">center</span></code> defines how a kernel is overlaid on inputs to produce outputs.</p>
</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> ( str )) – <p>Boundary conditions.  Multiple forms are accepted:</p>
<ul>
<li><p>str: unique mode shared amongst dimensions.
Must be one of:</p>
<ul>
<li><p>’constant’ (zero-padding)</p></li>
<li><p>’wrap’</p></li>
<li><p>’reflect’</p></li>
<li><p>’symmetric’</p></li>
<li><p>’edge’</p></li>
</ul>
</li>
<li><p>tuple[str, …]: dimension[k] uses <code class="code docutils literal notranslate"><span class="pre">mode[k]</span></code> as boundary condition.</p></li>
</ul>
<p>(See <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.pad.html#numpy.pad" title="(in NumPy v2.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.pad()</span></code></a> for details.)</p>
</p></li>
<li><p><strong>enable_warnings</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, emit a warning in case of precision mis-match issues.</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.operator.Stencil.configure_dispatcher">
<span class="sig-name descname"><span class="pre">configure_dispatcher</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/stencil/stencil.html#Stencil.configure_dispatcher"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.Stencil.configure_dispatcher" title="Link to this definition">#</a></dt>
<dd><p>(Only applies if <code class="code docutils literal notranslate"><span class="pre">kernel</span></code> is a CuPy array.)</p>
<p>Configure stencil Dispatcher.</p>
<p>See <a class="reference internal" href="#pyxu.operator._Stencil.apply" title="pyxu.operator._Stencil.apply"><code class="xref py py-meth docutils literal notranslate"><span class="pre">apply()</span></code></a> for accepted options.</p>
<p class="rubric">Example</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cupy</span> <span class="k">as</span> <span class="nn">cp</span>
<span class="kn">from</span> <span class="nn">pyxu.operator</span> <span class="kn">import</span> <span class="n">Stencil</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

<span class="n">op</span> <span class="o">=</span> <span class="n">Stencil</span><span class="p">(</span>
    <span class="n">dim_shape</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
    <span class="n">kernel</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span>
    <span class="n">center</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span>
<span class="p">)</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># uses default threadsperblock/blockspergrid values</span>

<span class="n">op</span><span class="o">.</span><span class="n">configure_dispatcher</span><span class="p">(</span>
    <span class="n">threadsperblock</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
    <span class="n">blockspergrid</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># supplied values used instead</span>
</pre></div>
</div>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyxu.operator.Stencil.kernel">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">kernel</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><span class="pre">NDArray</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><span class="pre">NDArray</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#pyxu.operator.Stencil.kernel" title="Link to this definition">#</a></dt>
<dd><p>Stencil kernel coefficients.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p><strong>kern</strong> – Stencil coefficients.</p>
<p>If the kernel is non-seperable, a single array is returned.
Otherwise <span class="math notranslate nohighlight">\(D\)</span> arrays are returned, one per axis.</p>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#pyxu.operator.Stencil.KernelSpec" title="pyxu.operator.Stencil.KernelSpec"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelSpec</span></code></a></p>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyxu.operator.Stencil.center">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">center</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><span class="pre">Integral</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#pyxu.operator.Stencil.center" title="Link to this definition">#</a></dt>
<dd><p>Stencil central position.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ctr</strong> – Stencil central position.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#pyxu.operator._Stencil.IndexSpec" title="pyxu.operator._Stencil.IndexSpec"><code class="xref py py-class docutils literal notranslate"><span class="pre">IndexSpec</span></code></a></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.operator.Stencil.visualize">
<span class="sig-name descname"><span class="pre">visualize</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/stencil/stencil.html#Stencil.visualize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.Stencil.visualize" title="Link to this definition">#</a></dt>
<dd><p>Show the <span class="math notranslate nohighlight">\(D\)</span>-dimensional stencil kernel.</p>
<p>The stencil’s center is identified by surrounding parentheses.</p>
<p class="rubric">Example</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">S</span> <span class="o">=</span> <span class="n">Stencil</span><span class="p">(</span>
    <span class="n">dim_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
    <span class="n">kernel</span><span class="o">=</span><span class="p">[</span>
        <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="p">],</span>
    <span class="n">center</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">visualize</span><span class="p">())</span>  <span class="c1"># [[6.0 -3.0  9.0  3.0]</span>
                      <span class="c1">#  [4.0 -2.0 (6.0) 2.0]</span>
                      <span class="c1">#  [2.0 -1.0  3.0 1.0]]</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a></p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyxu.operator.Correlate">
<span class="sig-name descname"><span class="pre">Correlate</span></span><a class="headerlink" href="#pyxu.operator.Correlate" title="Link to this definition">#</a></dt>
<dd><p>alias of <a class="reference internal" href="#pyxu.operator.Stencil" title="pyxu.operator.linop.stencil.stencil.Stencil"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stencil</span></code></a></p>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyxu.operator.Convolve">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Convolve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_warnings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/stencil/stencil.html#Convolve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.Convolve" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyxu.operator.Stencil" title="pyxu.operator.linop.stencil.stencil.Stencil"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stencil</span></code></a></p>
<p>Multi-dimensional JIT-compiled convolution.</p>
<p>Inputs are convolved with the given kernel.</p>
<p class="rubric">Notes</p>
<p>Given a <span class="math notranslate nohighlight">\(D\)</span>-dimensional array <span class="math notranslate nohighlight">\(x\in\mathbb{R}^{N_1 \times\cdots\times N_D}\)</span> and kernel
<span class="math notranslate nohighlight">\(k\in\mathbb{R}^{K_1 \times\cdots\times K_D}\)</span> with center <span class="math notranslate nohighlight">\((c_1, \ldots, c_D)\)</span>, the output of the
convolution operator is an array <span class="math notranslate nohighlight">\(y\in\mathbb{R}^{N_1 \times\cdots\times N_D}\)</span> given by:</p>
<div class="math notranslate nohighlight">
\[y[i_{1},\ldots,i_{D}]
=
\sum_{q_{1},\ldots,q_{D}=0}^{K_{1},\ldots,K_{D}}
x[i_{1} - q_{1} + c_{1},\ldots,i_{D} - q_{D} + c_{D}]
\,\cdot\,
k[q_{1},\ldots,q_{D}].\]</div>
<p>The convolution is implemented via <a class="reference internal" href="#pyxu.operator.Stencil" title="pyxu.operator.Stencil"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stencil</span></code></a>.  To do so, the convolution kernel is
transformed to the equivalent correlation kernel:</p>
<div class="math notranslate nohighlight">
\[\begin{split}y[i_{1},\ldots,i_{D}]
=
\sum_{q_{1},\ldots,q_{D}=0}^{K_{1},\ldots,K_{D}}
&amp;x[i_{1} + q_{1} - (K_{1} - c_{1}),\ldots,i_{D} + q_{D} - (K_{D} - c_{D})] \\
&amp;\cdot\,
k[K_{1}-q_{1},\ldots,K_{D}-q_{D}].\end{split}\]</div>
<p>This corresponds to a correlation with a flipped kernel and center.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>For large, non-separable kernels, stencil compilation can be time-consuming. Depending on your computer’s
architecture, using the :py:class:~pyxu.operator.FFTConvolve operator might offer a more efficient solution.
However, the performance improvement varies, so we recommend evaluating this alternative in your specific
environment.</p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.ndimage</span> <span class="kn">import</span> <span class="n">convolve</span>
<span class="kn">from</span> <span class="nn">pyxu.operator</span> <span class="kn">import</span> <span class="n">Convolve</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
     <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
     <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
     <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
     <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="p">])</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
     <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
     <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
     <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="p">])</span>
<span class="n">op</span> <span class="o">=</span> <span class="n">Convolve</span><span class="p">(</span>
    <span class="n">dim_shape</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
    <span class="n">kernel</span><span class="o">=</span><span class="n">k</span><span class="p">,</span>
    <span class="n">center</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">mode</span><span class="o">=</span><span class="s2">"constant"</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">y_op</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">y_sp</span> <span class="o">=</span> <span class="n">convolve</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">"constant"</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># np.allclose(y_op, y_sp) -&gt; True</span>
<span class="c1"># [[11  10   7   4],</span>
<span class="c1">#  [10   3  11  11],</span>
<span class="c1">#  [15  12  14   7],</span>
<span class="c1">#  [12   3   7   0]]</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyxu.operator.Stencil" title="pyxu.operator.Stencil"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stencil</span></code></a></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><em>Integral</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><em>Integral</em></a><em>, </em><em>...</em><em>]</em>)</p></li>
<li><p><strong>kernel</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><em>NDArray</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><em>Sequence</em></a><em>[</em><a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><em>NDArray</em></a><em>]</em>)</p></li>
<li><p><strong>center</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><em>Sequence</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><em>Integral</em></a><em>]</em>)</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><em>Sequence</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em>)</p></li>
<li><p><strong>enable_warnings</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.operator.Convolve.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_warnings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/stencil/stencil.html#Convolve.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.Convolve.__init__" title="Link to this definition">#</a></dt>
<dd><p>See <a class="reference internal" href="#pyxu.operator.Stencil.__init__" title="pyxu.operator.Stencil.__init__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__init__()</span></code></a> for a description of the arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><em>Integral</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><em>Integral</em></a><em>, </em><em>...</em><em>]</em>)</p></li>
<li><p><strong>kernel</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><em>NDArray</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><em>Sequence</em></a><em>[</em><a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><em>NDArray</em></a><em>]</em>)</p></li>
<li><p><strong>center</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><em>Sequence</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><em>Integral</em></a><em>]</em>)</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><em>Sequence</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em>)</p></li>
<li><p><strong>enable_warnings</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyxu.operator.FFTCorrelate">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">FFTCorrelate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_warnings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/fft/filter.html#FFTCorrelate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.FFTCorrelate" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyxu.operator.Stencil" title="pyxu.operator.linop.stencil.stencil.Stencil"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stencil</span></code></a></p>
<p>Multi-dimensional FFT-based correlation.</p>
<p><a class="reference internal" href="#pyxu.operator.FFTCorrelate" title="pyxu.operator.FFTCorrelate"><code class="xref py py-class docutils literal notranslate"><span class="pre">FFTCorrelate</span></code></a> has the same interface as <a class="reference internal" href="#pyxu.operator.Stencil" title="pyxu.operator.Stencil"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stencil</span></code></a>.</p>
<p class="rubric">Implementation Notes</p>
<ul class="simple">
<li><p><a class="reference internal" href="#pyxu.operator.FFTCorrelate" title="pyxu.operator.FFTCorrelate"><code class="xref py py-class docutils literal notranslate"><span class="pre">FFTCorrelate</span></code></a> can scale to much larger kernels than <a class="reference internal" href="#pyxu.operator.Stencil" title="pyxu.operator.Stencil"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stencil</span></code></a>.</p></li>
<li><p>This implementation is most efficient with “constant” boundary conditions (default).</p></li>
<li><p>Kernels must be small enough to fit in memory, i.e. unbounded kernels are not allowed.</p></li>
<li><p>Kernels should be supplied an NUMPY/CUPY arrays. DASK arrays will be evaluated if provided.</p></li>
<li><p><a class="reference internal" href="#pyxu.operator.FFTCorrelate" title="pyxu.operator.FFTCorrelate"><code class="xref py py-class docutils literal notranslate"><span class="pre">FFTCorrelate</span></code></a> instances are <strong>not arraymodule-agnostic</strong>: they will only work with
NDArrays belonging to the same array module as <code class="code docutils literal notranslate"><span class="pre">kernel</span></code>, or DASK arrays where the chunk backend matches the
init-supplied kernel backend.</p></li>
<li><p>A warning is emitted if inputs must be cast to the kernel dtype.</p></li>
<li><p>The input array is transformed by calling <a class="reference internal" href="#pyxu.operator.FFT" title="pyxu.operator.FFT"><code class="xref py py-class docutils literal notranslate"><span class="pre">FFT</span></code></a>.</p></li>
<li><p>When operating on DASK inputs, the kernel DFT is computed per chunk at the best size to handle the inputs.
This was deemed preferable than pre-computing a huge kernel DFT once, then sending it to each worker process to
compute its chunk.</p></li>
</ul>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyxu.operator.Stencil" title="pyxu.operator.Stencil"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stencil</span></code></a>, <a class="reference internal" href="#pyxu.operator.FFTConvolve" title="pyxu.operator.FFTConvolve"><code class="xref py py-class docutils literal notranslate"><span class="pre">FFTConvolve</span></code></a></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><em>Integral</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><em>Integral</em></a><em>, </em><em>...</em><em>]</em>)</p></li>
<li><p><strong>kernel</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><em>NDArray</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><em>Sequence</em></a><em>[</em><a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><em>NDArray</em></a><em>]</em>)</p></li>
<li><p><strong>center</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><em>Sequence</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><em>Integral</em></a><em>]</em>)</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><em>Sequence</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em>)</p></li>
<li><p><strong>enable_warnings</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.operator.FFTCorrelate.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_warnings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/fft/filter.html#FFTCorrelate.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.FFTCorrelate.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim_shape</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArrayShape" title="pyxu.info.ptype.NDArrayShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayShape</span></code></a>) – (M1,…,MD) input dimensions.</p></li>
<li><p><strong>kernel</strong> (<a class="reference internal" href="#pyxu.operator.Stencil.KernelSpec" title="pyxu.operator.Stencil.KernelSpec"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelSpec</span></code></a>) – <p>Kernel coefficients.  Two forms are accepted:</p>
<ul>
<li><p>NDArray of rank-<span class="math notranslate nohighlight">\(D\)</span>: denotes a non-seperable kernel.</p></li>
<li><p>tuple[NDArray_1, …, NDArray_D]: a sequence of 1D kernels such that dimension[k] is filtered by kernel
<code class="code docutils literal notranslate"><span class="pre">kernel[k]</span></code>, that is:</p>
<div class="math notranslate nohighlight">
\[k = k_1 \otimes\cdots\otimes k_D,\]</div>
<p>or in Python: <code class="docutils literal notranslate"><span class="pre">k</span> <span class="pre">=</span> <span class="pre">functools.reduce(numpy.multiply.outer,</span> <span class="pre">kernel)</span></code>.</p>
</li>
</ul>
</p></li>
<li><p><strong>center</strong> (<a class="reference internal" href="#pyxu.operator._Stencil.IndexSpec" title="pyxu.operator._Stencil.IndexSpec"><code class="xref py py-class docutils literal notranslate"><span class="pre">IndexSpec</span></code></a>) – <p>(i1,…,iD) index of the kernel’s center.</p>
<p><code class="code docutils literal notranslate"><span class="pre">center</span></code> defines how a kernel is overlaid on inputs to produce outputs.</p>
</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> ( str )) – <p>Boundary conditions.  Multiple forms are accepted:</p>
<ul>
<li><p>str: unique mode shared amongst dimensions.
Must be one of:</p>
<ul>
<li><p>’constant’ (zero-padding)</p></li>
<li><p>’wrap’</p></li>
<li><p>’reflect’</p></li>
<li><p>’symmetric’</p></li>
<li><p>’edge’</p></li>
</ul>
</li>
<li><p>tuple[str, …]: dimension[k] uses <code class="code docutils literal notranslate"><span class="pre">mode[k]</span></code> as boundary condition.</p></li>
</ul>
<p>(See <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.pad.html#numpy.pad" title="(in NumPy v2.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.pad()</span></code></a> for details.)</p>
</p></li>
<li><p><strong>enable_warnings</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, emit a warning in case of precision mis-match issues.</p></li>
<li><p><strong>kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>) – Extra kwargs forwarded to <a class="reference internal" href="#pyxu.operator.FFT" title="pyxu.operator.FFT"><code class="xref py py-class docutils literal notranslate"><span class="pre">FFT</span></code></a>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.operator.FFTCorrelate.configure_dispatcher">
<span class="sig-name descname"><span class="pre">configure_dispatcher</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/fft/filter.html#FFTCorrelate.configure_dispatcher"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.FFTCorrelate.configure_dispatcher" title="Link to this definition">#</a></dt>
<dd><p>(Only applies if <code class="code docutils literal notranslate"><span class="pre">kernel</span></code> is a CuPy array.)</p>
<p>Configure stencil Dispatcher.</p>
<p>See <a class="reference internal" href="#pyxu.operator._Stencil.apply" title="pyxu.operator._Stencil.apply"><code class="xref py py-meth docutils literal notranslate"><span class="pre">apply()</span></code></a> for accepted options.</p>
<p class="rubric">Example</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cupy</span> <span class="k">as</span> <span class="nn">cp</span>
<span class="kn">from</span> <span class="nn">pyxu.operator</span> <span class="kn">import</span> <span class="n">Stencil</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

<span class="n">op</span> <span class="o">=</span> <span class="n">Stencil</span><span class="p">(</span>
    <span class="n">dim_shape</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
    <span class="n">kernel</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span>
    <span class="n">center</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span>
<span class="p">)</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># uses default threadsperblock/blockspergrid values</span>

<span class="n">op</span><span class="o">.</span><span class="n">configure_dispatcher</span><span class="p">(</span>
    <span class="n">threadsperblock</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
    <span class="n">blockspergrid</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># supplied values used instead</span>
</pre></div>
</div>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyxu.operator.FFTConvolve">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">FFTConvolve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_warnings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/fft/filter.html#FFTConvolve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.FFTConvolve" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyxu.operator.FFTCorrelate" title="pyxu.operator.linop.fft.filter.FFTCorrelate"><code class="xref py py-class docutils literal notranslate"><span class="pre">FFTCorrelate</span></code></a></p>
<p>Multi-dimensional FFT-based convolution.</p>
<p><a class="reference internal" href="#pyxu.operator.FFTConvolve" title="pyxu.operator.FFTConvolve"><code class="xref py py-class docutils literal notranslate"><span class="pre">FFTConvolve</span></code></a> has the same interface as <a class="reference internal" href="#pyxu.operator.Convolve" title="pyxu.operator.Convolve"><code class="xref py py-class docutils literal notranslate"><span class="pre">Convolve</span></code></a>.</p>
<p>See <a class="reference internal" href="#pyxu.operator.FFTCorrelate" title="pyxu.operator.FFTCorrelate"><code class="xref py py-class docutils literal notranslate"><span class="pre">FFTCorrelate</span></code></a> for implementation notes.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyxu.operator.Stencil" title="pyxu.operator.Stencil"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stencil</span></code></a>, <a class="reference internal" href="#pyxu.operator.FFTCorrelate" title="pyxu.operator.FFTCorrelate"><code class="xref py py-class docutils literal notranslate"><span class="pre">FFTCorrelate</span></code></a></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><em>Integral</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><em>Integral</em></a><em>, </em><em>...</em><em>]</em>)</p></li>
<li><p><strong>kernel</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><em>NDArray</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><em>Sequence</em></a><em>[</em><a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><em>NDArray</em></a><em>]</em>)</p></li>
<li><p><strong>center</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><em>Sequence</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><em>Integral</em></a><em>]</em>)</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><em>Sequence</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em>)</p></li>
<li><p><strong>enable_warnings</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.operator.FFTConvolve.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_warnings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/fft/filter.html#FFTConvolve.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.FFTConvolve.__init__" title="Link to this definition">#</a></dt>
<dd><p>See <a class="reference internal" href="#pyxu.operator.FFTCorrelate.__init__" title="pyxu.operator.FFTCorrelate.__init__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__init__()</span></code></a> for a description of the arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><em>Integral</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><em>Integral</em></a><em>, </em><em>...</em><em>]</em>)</p></li>
<li><p><strong>kernel</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><em>NDArray</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><em>Sequence</em></a><em>[</em><a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><em>NDArray</em></a><em>]</em>)</p></li>
<li><p><strong>center</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><em>Sequence</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><em>Integral</em></a><em>]</em>)</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><em>Sequence</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em>)</p></li>
<li><p><strong>enable_warnings</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>
</dd></dl>
</section>
<section id="filters">
<h2><a class="toc-backref" href="#id34" role="doc-backlink">Filters</a><a class="headerlink" href="#filters" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.operator.MovingAverage">
<span class="sig-name descname"><span class="pre">MovingAverage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gpu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/filter.html#MovingAverage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.MovingAverage" title="Link to this definition">#</a></dt>
<dd><p>Multi-dimensional moving average or uniform filter.</p>
<p class="rubric">Notes</p>
<p>This operator performs a convolution between the input <span class="math notranslate nohighlight">\(D\)</span>-dimensional NDArray <span class="math notranslate nohighlight">\(\mathbf{x} \in
\mathbb{R}^{N_0 \times \cdots \times N_{D-1}}\)</span> and a uniform <span class="math notranslate nohighlight">\(D\)</span>-dimensional filter <span class="math notranslate nohighlight">\(\mathbf{h} \in
\mathbb{R}^{\text{size} \times \cdots \times \text{size}}\)</span> that computes the <code class="code docutils literal notranslate"><span class="pre">size</span></code>-point local mean values using
separable kernels for improved performance.</p>
<div class="math notranslate nohighlight">
\[y_{i} = \frac{1}{|\mathcal{N}_{i}|}\sum_{j \in \mathcal{N}_{i}} x_{j}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\mathcal{N}_{i}\)</span> is the set of elements neighbouring the <span class="math notranslate nohighlight">\(i\)</span>-th element of the input array, and
<span class="math notranslate nohighlight">\(\mathcal{N}_{i}\)</span> denotes its cardinality, i.e. the total number of neighbors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim_shape</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArrayShape" title="pyxu.info.ptype.NDArrayShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayShape</span></code></a>) – Shape of the input array.</p></li>
<li><p><strong>size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>) – <p>Size of the moving average kernel.</p>
<p>If a single integer value is provided, then the moving average filter will have as many dimensions as the input
array.  If a tuple is provided, it should contain as many elements as <code class="code docutils literal notranslate"><span class="pre">dim_shape</span></code>.  For example, the <code class="docutils literal notranslate"><span class="pre">size=(1,</span>
<span class="pre">3)</span></code> will convolve the input image with the filter <code class="docutils literal notranslate"><span class="pre">[[1,</span> <span class="pre">1,</span> <span class="pre">1]]</span> <span class="pre">/</span> <span class="pre">3</span></code>.</p>
</p></li>
<li><p><strong>center</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">IndexSpec</span></code>) – <p>(i_1, …, i_D) index of the kernel’s center.</p>
<p><code class="code docutils literal notranslate"><span class="pre">center</span></code> defines how a kernel is overlaid on inputs to produce outputs.
For odd <code class="code docutils literal notranslate"><span class="pre">size</span></code>, it defaults to the central element (<code class="docutils literal notranslate"><span class="pre">center=size//2</span></code>).
For even <code class="code docutils literal notranslate"><span class="pre">size</span></code> the desired center indices must be provided.</p>
</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[str]</span></code>) – <p>Boundary conditions.
Multiple forms are accepted:</p>
<ul>
<li><p>str: unique mode shared amongst dimensions.
Must be one of:</p>
<ul>
<li><p>’constant’ (default): zero-padding</p></li>
<li><p>’wrap’</p></li>
<li><p>’reflect’</p></li>
<li><p>’symmetric’</p></li>
<li><p>’edge’</p></li>
</ul>
</li>
<li><p>tuple[str, …]: the <code class="code docutils literal notranslate"><span class="pre">d</span></code>-th dimension uses <code class="code docutils literal notranslate"><span class="pre">mode[d]</span></code> as boundary condition.</p></li>
</ul>
<p>(See <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.pad.html#numpy.pad" title="(in NumPy v2.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.pad()</span></code></a> for details.)</p>
</p></li>
<li><p><strong>gpu</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Input NDArray type (<code class="code docutils literal notranslate"><span class="pre">True</span></code> for GPU, <code class="code docutils literal notranslate"><span class="pre">False</span></code> for CPU). Defaults to <code class="code docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>dtype</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.DType" title="pyxu.info.ptype.DType"><code class="xref py py-class docutils literal notranslate"><span class="pre">DType</span></code></a>) – Working precision of the linear operator.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>op</strong> – MovingAverage</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/pyplot_summary.html#module-matplotlib.pyplot" title="matplotlib.pyplot"><span class="nn">matplotlib.pyplot</span></a> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/index.html#module-numpy" title="numpy"><span class="nn">numpy</span></a> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pyxu.operator</span> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.MovingAverage" title="pyxu.operator.MovingAverage"><span class="n">MovingAverage</span></a>

<span class="n">dim_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">image</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">(</span><span class="n">dim_shape</span><span class="p">)</span>
<span class="n">image</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>

<span class="n">ma</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.MovingAverage" title="pyxu.operator.MovingAverage"><span class="n">MovingAverage</span></a><span class="p">(</span><span class="n">dim_shape</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">ma</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplot.html#matplotlib.pyplot.subplot" title="matplotlib.pyplot.subplot"><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span></a><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.imshow.html#matplotlib.pyplot.imshow" title="matplotlib.pyplot.imshow"><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span></a><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">()</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplot.html#matplotlib.pyplot.subplot" title="matplotlib.pyplot.subplot"><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span></a><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.imshow.html#matplotlib.pyplot.imshow" title="matplotlib.pyplot.imshow"><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span></a><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../_downloads/1ca2eac05e4e846c261061a368416210/linop-1.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/bad8b499444b02c5b24a36ba5ed4206e/linop-1.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/aee252674a1cbdd16ee7585368a2fac3/linop-1.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/5d831190e971237b56d4c6f5001a1497/linop-1.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../../_images/linop-1.png" class="plot-directive" src="../../_images/linop-1.png"/>
</figure>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-class docutils literal notranslate"><span class="pre">GaussianFilter</span></code></p>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.operator.Gaussian">
<span class="sig-name descname"><span class="pre">Gaussian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/ufunc.html#Gaussian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.Gaussian" title="Link to this definition">#</a></dt>
<dd><p>Gaussian, element-wise.</p>
<p class="rubric">Notes</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(f(x) = \exp(-x^{2})\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(f'(x) = -2 x \exp(-x^{2})\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\vert f(x) - f(y) \vert \le L \vert x - y \vert\)</span>, with Lipschitz constant <span class="math notranslate nohighlight">\(L = \sqrt{2 / e}\)</span>.</p>
<p>(Reason: <span class="math notranslate nohighlight">\(\vert f'(x) \vert\)</span> is bounded by <span class="math notranslate nohighlight">\(L\)</span> at <span class="math notranslate nohighlight">\(x = \pm 1 / \sqrt{2}\)</span>.)</p>
</li>
<li><p><span class="math notranslate nohighlight">\(\vert f'(x) - f'(y) \vert \le \partial L \vert x - y \vert\)</span>, with diff-Lipschitz constant <span class="math notranslate nohighlight">\(\partial L
= 2\)</span>.</p>
<p>(Reason: <span class="math notranslate nohighlight">\(\vert f''(x) \vert\)</span> is bounded by <span class="math notranslate nohighlight">\(\partial L\)</span> at <span class="math notranslate nohighlight">\(x = 0\)</span>.)</p>
</li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dim_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><em>Integral</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><em>Integral</em></a><em>, </em><em>...</em><em>]</em>)</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.operator.DifferenceOfGaussians">
<span class="sig-name descname"><span class="pre">DifferenceOfGaussians</span></span><span class="sig-paren">(</span>
<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">dim_shape</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">low_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">high_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">low_truncate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">high_truncate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">sampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">gpu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>
<span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/filter.html#DifferenceOfGaussians"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.DifferenceOfGaussians" title="Link to this definition">#</a></dt>
<dd><p>Multi-dimensional Difference of Gaussians filter.</p>
<p class="rubric">Notes</p>
<p>This operator uses the Difference of Gaussians (DoG) method to a <span class="math notranslate nohighlight">\(D\)</span>-dimensional NDArray <span class="math notranslate nohighlight">\(\mathbf{x} \in
\mathbb{R}^{N_0 \times \cdots \times N_{D-1}}\)</span> using separable kernels for improved performance.
The DoG method blurs the input image with two Gaussian kernels with different sigma, and subtracts the more-blurred
signal from the less-blurred image.
This creates an output signal containing only the information from the original signal at the spatial scale
indicated by the two sigmas.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim_shape</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArrayShape" title="pyxu.info.ptype.NDArrayShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayShape</span></code></a>) – Shape of the input array.</p></li>
<li><p><strong>low_sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>) – <p>Standard deviation of the Gaussian kernel with smaller sigmas across all axes.</p>
<p>If a scalar value is provided, then the Gaussian filter will have as many dimensions as the input array.
If a tuple is provided, it should contain as many elements as <code class="code docutils literal notranslate"><span class="pre">dim_shape</span></code>.
Use <code class="docutils literal notranslate"><span class="pre">0</span></code> to prevent filtering in a given dimension.
For example, the <code class="docutils literal notranslate"><span class="pre">low_sigma=(0,</span> <span class="pre">3)</span></code> will convolve the input image in its last dimension.</p>
</p></li>
<li><p><strong>high_sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>) – Standard deviation of the Gaussian kernel with larger sigmas across all axes.
If <code class="docutils literal notranslate"><span class="pre">None</span></code> is given (default), sigmas for all axes are calculated as <code class="docutils literal notranslate"><span class="pre">1.6</span> <span class="pre">*</span> <span class="pre">low_sigma</span></code>.</p></li>
<li><p><strong>low_truncate</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>) – Truncate the filter at this many standard deviations.
Defaults to 3.0.</p></li>
<li><p><strong>high_truncate</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>) – Truncate the filter at this many standard deviations.
Defaults to 3.0.</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[str]</span></code>) – <p>Boundary conditions.
Multiple forms are accepted:</p>
<ul>
<li><p>str: unique mode shared amongst dimensions.
Must be one of:</p>
<ul>
<li><p>’constant’ (default): zero-padding</p></li>
<li><p>’wrap’</p></li>
<li><p>’reflect’</p></li>
<li><p>’symmetric’</p></li>
<li><p>’edge’</p></li>
</ul>
</li>
<li><p>tuple[str, …]: the <code class="code docutils literal notranslate"><span class="pre">d</span></code>-th dimension uses <code class="code docutils literal notranslate"><span class="pre">mode[d]</span></code> as boundary condition.</p></li>
</ul>
<p>(See <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.pad.html#numpy.pad" title="(in NumPy v2.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.pad()</span></code></a> for details.)</p>
</p></li>
<li><p><strong>sampling</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-class docutils literal notranslate"><span class="pre">Real</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[Real]</span></code>) – Sampling step (i.e. distance between two consecutive elements of an array).
Defaults to 1.</p></li>
<li><p><strong>gpu</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Input NDArray type (<code class="code docutils literal notranslate"><span class="pre">True</span></code> for GPU, <code class="code docutils literal notranslate"><span class="pre">False</span></code> for CPU). Defaults to <code class="code docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>dtype</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.DType" title="pyxu.info.ptype.DType"><code class="xref py py-class docutils literal notranslate"><span class="pre">DType</span></code></a>) – Working precision of the linear operator.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>op</strong> – DifferenceOfGaussians</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/pyplot_summary.html#module-matplotlib.pyplot" title="matplotlib.pyplot"><span class="nn">matplotlib.pyplot</span></a> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/index.html#module-numpy" title="numpy"><span class="nn">numpy</span></a> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pyxu.operator</span> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.DoG" title="pyxu.operator.DoG"><span class="n">DoG</span></a>

<span class="n">dim_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">image</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">(</span><span class="n">dim_shape</span><span class="p">)</span>
<span class="n">image</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>

<span class="n">dog</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.DoG" title="pyxu.operator.DoG"><span class="n">DoG</span></a><span class="p">(</span><span class="n">dim_shape</span><span class="p">,</span> <span class="n">low_sigma</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">dog</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplot.html#matplotlib.pyplot.subplot" title="matplotlib.pyplot.subplot"><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span></a><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.imshow.html#matplotlib.pyplot.imshow" title="matplotlib.pyplot.imshow"><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span></a><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">()</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplot.html#matplotlib.pyplot.subplot" title="matplotlib.pyplot.subplot"><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span></a><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.imshow.html#matplotlib.pyplot.imshow" title="matplotlib.pyplot.imshow"><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span></a><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../_downloads/d60813d4e69b6bcee2cab872f9762285/linop-2.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/cf5529db13896740795f2511b3b561c8/linop-2.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/ff0fa1f9542551d9d3aff87c6527e5bc/linop-2.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/852396df1c2a68b4ab13ea440094a13b/linop-2.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../../_images/linop-2.png" class="plot-directive" src="../../_images/linop-2.png"/>
</figure>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyxu.operator.Gaussian" title="pyxu.operator.Gaussian"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gaussian</span></code></a>, <a class="reference internal" href="#pyxu.operator.Sobel" title="pyxu.operator.Sobel"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sobel</span></code></a>, <a class="reference internal" href="#pyxu.operator.Prewitt" title="pyxu.operator.Prewitt"><code class="xref py py-class docutils literal notranslate"><span class="pre">Prewitt</span></code></a>, <a class="reference internal" href="#pyxu.operator.Scharr" title="pyxu.operator.Scharr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Scharr</span></code></a>, <a class="reference internal" href="#pyxu.operator.StructureTensor" title="pyxu.operator.StructureTensor"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructureTensor</span></code></a></p>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.operator.DoG">
<span class="sig-name descname"><span class="pre">DoG</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">low_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">high_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">low_truncate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">high_truncate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gpu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyxu.operator.DoG" title="Link to this definition">#</a></dt>
<dd><p>Alias of <a class="reference internal" href="#pyxu.operator.DifferenceOfGaussians" title="pyxu.operator.DifferenceOfGaussians"><code class="xref py py-func docutils literal notranslate"><span class="pre">DifferenceOfGaussians()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><em>Integral</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><em>Integral</em></a><em>, </em><em>...</em><em>]</em>)</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><em>Sequence</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em>)</p></li>
<li><p><strong>sampling</strong> (<a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Real" title="(in Python v3.13)"><em>Real</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><em>Sequence</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Real" title="(in Python v3.13)"><em>Real</em></a><em>, </em><em>...</em><em>]</em>)</p></li>
<li><p><strong>gpu</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.1)"><em>dtype</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><em>Any</em></a><em>] </em><em>| </em><em>None</em><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.13)"><em>type</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><em>Any</em></a><em>] </em><em>| </em><em>_SupportsDType</em><em>[</em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.1)"><em>dtype</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><em>Any</em></a><em>]</em><em>] </em><em>| </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><em>Any</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>] </em><em>| </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><em>Any</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.SupportsIndex" title="(in Python v3.13)"><em>SupportsIndex</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><em>Sequence</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.SupportsIndex" title="(in Python v3.13)"><em>SupportsIndex</em></a><em>]</em><em>] </em><em>| </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><em>Any</em></a><em>] </em><em>| </em><em>_DTypeDict</em><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><em>Any</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><em>Any</em></a><em>]</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.operator.Laplace">
<span class="sig-name descname"><span class="pre">Laplace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gpu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/filter.html#Laplace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.Laplace" title="Link to this definition">#</a></dt>
<dd><p>Multi-dimensional Laplace filter.</p>
<p>The implementation is based on second derivatives approximated via finite differences.</p>
<p class="rubric">Notes</p>
<p>This operator uses the applies the Laplace kernel <span class="math notranslate nohighlight">\([1 -2 1]\)</span> to a <span class="math notranslate nohighlight">\(D\)</span>-dimensional NDArray
<span class="math notranslate nohighlight">\(\mathbf{x} \in \mathbb{R}^{N_0 \times \cdots \times N_{D-1}}\)</span> using separable kernels for improved
performance.  The Laplace filter is commonly used to find high-frequency components in the signal, such as for
example, the edges in an image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim_shape</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArrayShape" title="pyxu.info.ptype.NDArrayShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayShape</span></code></a>) – Shape of the input array.</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[str]</span></code>) – <p>Boundary conditions.
Multiple forms are accepted:</p>
<ul>
<li><p>str: unique mode shared amongst dimensions.
Must be one of:</p>
<ul>
<li><p>’constant’ (default): zero-padding</p></li>
<li><p>’wrap’</p></li>
<li><p>’reflect’</p></li>
<li><p>’symmetric’</p></li>
<li><p>’edge’</p></li>
</ul>
</li>
<li><p>tuple[str, …]: the <code class="code docutils literal notranslate"><span class="pre">d</span></code>-th dimension uses <code class="code docutils literal notranslate"><span class="pre">mode[d]</span></code> as boundary condition.</p></li>
</ul>
<p>(See <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.pad.html#numpy.pad" title="(in NumPy v2.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.pad()</span></code></a> for details.)</p>
</p></li>
<li><p><strong>sampling</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-class docutils literal notranslate"><span class="pre">Real</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[Real]</span></code>) – Sampling step (i.e. distance between two consecutive elements of an array).
Defaults to 1.</p></li>
<li><p><strong>gpu</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Input NDArray type (<code class="code docutils literal notranslate"><span class="pre">True</span></code> for GPU, <code class="code docutils literal notranslate"><span class="pre">False</span></code> for CPU). Defaults to <code class="code docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>dtype</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.DType" title="pyxu.info.ptype.DType"><code class="xref py py-class docutils literal notranslate"><span class="pre">DType</span></code></a>) – Working precision of the linear operator.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>op</strong> – DifferenceOfGaussians</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/pyplot_summary.html#module-matplotlib.pyplot" title="matplotlib.pyplot"><span class="nn">matplotlib.pyplot</span></a> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/index.html#module-numpy" title="numpy"><span class="nn">numpy</span></a> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pyxu.operator</span> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.Laplace" title="pyxu.operator.Laplace"><span class="n">Laplace</span></a>

<span class="n">dim_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">image</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">(</span><span class="n">dim_shape</span><span class="p">)</span>
<span class="n">image</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>

<span class="n">laplace</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.Laplace" title="pyxu.operator.Laplace"><span class="n">Laplace</span></a><span class="p">(</span><span class="n">dim_shape</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">laplace</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplot.html#matplotlib.pyplot.subplot" title="matplotlib.pyplot.subplot"><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span></a><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.imshow.html#matplotlib.pyplot.imshow" title="matplotlib.pyplot.imshow"><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span></a><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">()</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplot.html#matplotlib.pyplot.subplot" title="matplotlib.pyplot.subplot"><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span></a><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.imshow.html#matplotlib.pyplot.imshow" title="matplotlib.pyplot.imshow"><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span></a><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../_downloads/13d4155c4f8b2570495858ee4ff14c77/linop-3.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/e858523622ca361a5cd8f41d0f14d11a/linop-3.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/bd07c0c5783aeff86f427ce12b848f99/linop-3.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/b793257364ec7e73fe09d6ac0cf897bb/linop-3.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../../_images/linop-3.png" class="plot-directive" src="../../_images/linop-3.png"/>
</figure>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyxu.operator.Sobel" title="pyxu.operator.Sobel"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sobel</span></code></a>, <a class="reference internal" href="#pyxu.operator.Prewitt" title="pyxu.operator.Prewitt"><code class="xref py py-class docutils literal notranslate"><span class="pre">Prewitt</span></code></a>, <a class="reference internal" href="#pyxu.operator.Scharr" title="pyxu.operator.Scharr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Scharr</span></code></a></p>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.operator.Sobel">
<span class="sig-name descname"><span class="pre">Sobel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gpu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/filter.html#Sobel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.Sobel" title="Link to this definition">#</a></dt>
<dd><p>Multi-dimensional Sobel filter.</p>
<p class="rubric">Notes</p>
<p>This operator uses the applies the multi-dimensional Sobel filter to a <span class="math notranslate nohighlight">\(D\)</span>-dimensional NDArray
<span class="math notranslate nohighlight">\(\mathbf{x} \in \mathbb{R}^{N_0 \times \cdots \times N_{D-1}}\)</span> using separable kernels for improved
performance.  The Sobel filter applies the following edge filter in the dimensions of interest: <code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">0,</span> <span class="pre">-1]</span></code> and
the smoothing filter on the rest of dimensions: <code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">2,</span> <span class="pre">1]</span> <span class="pre">/</span> <span class="pre">4</span></code>.  The Sobel filter is commonly used to find
high-frequency components in the signal, such as for example, the edges in an image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim_shape</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArrayShape" title="pyxu.info.ptype.NDArrayShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayShape</span></code></a>) – Shape of the input array.</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>) – <p>Compute the edge filter along this axis. If not provided, the edge magnitude is computed.</p>
<p>This is defined as: <code class="docutils literal notranslate"><span class="pre">np.sqrt(sum([sobel(array,</span> <span class="pre">axis=i)**2</span> <span class="pre">for</span> <span class="pre">i</span> <span class="pre">in</span> <span class="pre">range(array.ndim)])</span> <span class="pre">/</span> <span class="pre">array.ndim)</span></code> The
magnitude is also computed if axis is a sequence.</p>
</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[str]</span></code>) – <p>Boundary conditions.
Multiple forms are accepted:</p>
<ul>
<li><p>str: unique mode shared amongst dimensions.
Must be one of:</p>
<ul>
<li><p>’constant’ (default): zero-padding</p></li>
<li><p>’wrap’</p></li>
<li><p>’reflect’</p></li>
<li><p>’symmetric’</p></li>
<li><p>’edge’</p></li>
</ul>
</li>
<li><p>tuple[str, …]: the <code class="code docutils literal notranslate"><span class="pre">d</span></code>-th dimension uses <code class="code docutils literal notranslate"><span class="pre">mode[d]</span></code> as boundary condition.</p></li>
</ul>
<p>(See <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.pad.html#numpy.pad" title="(in NumPy v2.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.pad()</span></code></a> for details.)</p>
</p></li>
<li><p><strong>sampling</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-class docutils literal notranslate"><span class="pre">Real</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[Real]</span></code>) – Sampling step (i.e. distance between two consecutive elements of an array).
Defaults to 1.</p></li>
<li><p><strong>gpu</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Input NDArray type (<code class="code docutils literal notranslate"><span class="pre">True</span></code> for GPU, <code class="code docutils literal notranslate"><span class="pre">False</span></code> for CPU). Defaults to <code class="code docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>dtype</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.DType" title="pyxu.info.ptype.DType"><code class="xref py py-class docutils literal notranslate"><span class="pre">DType</span></code></a>) – Working precision of the linear operator.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>op</strong> – Sobel</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/pyplot_summary.html#module-matplotlib.pyplot" title="matplotlib.pyplot"><span class="nn">matplotlib.pyplot</span></a> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/index.html#module-numpy" title="numpy"><span class="nn">numpy</span></a> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pyxu.operator</span> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.Sobel" title="pyxu.operator.Sobel"><span class="n">Sobel</span></a>

<span class="n">dim_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">image</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">(</span><span class="n">dim_shape</span><span class="p">)</span>
<span class="n">image</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>

<span class="n">sobel</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.Sobel" title="pyxu.operator.Sobel"><span class="n">Sobel</span></a><span class="p">(</span><span class="n">dim_shape</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">sobel</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplot.html#matplotlib.pyplot.subplot" title="matplotlib.pyplot.subplot"><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span></a><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.imshow.html#matplotlib.pyplot.imshow" title="matplotlib.pyplot.imshow"><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span></a><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">()</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplot.html#matplotlib.pyplot.subplot" title="matplotlib.pyplot.subplot"><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span></a><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.imshow.html#matplotlib.pyplot.imshow" title="matplotlib.pyplot.imshow"><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span></a><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../_downloads/b2cf59b0745316197a94be979d5ca5c1/linop-4.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/be6347d5cb058094fdcaf45f1e4df488/linop-4.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/f5ee09b10d113018d7eff7d17a195848/linop-4.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/ef375de8a555744bde8d66d2be4d2ecd/linop-4.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../../_images/linop-4.png" class="plot-directive" src="../../_images/linop-4.png"/>
</figure>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyxu.operator.Prewitt" title="pyxu.operator.Prewitt"><code class="xref py py-class docutils literal notranslate"><span class="pre">Prewitt</span></code></a>, <a class="reference internal" href="#pyxu.operator.Scharr" title="pyxu.operator.Scharr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Scharr</span></code></a></p>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.operator.Prewitt">
<span class="sig-name descname"><span class="pre">Prewitt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gpu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/filter.html#Prewitt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.Prewitt" title="Link to this definition">#</a></dt>
<dd><p>Multi-dimensional Prewitt filter.</p>
<p class="rubric">Notes</p>
<p>This operator uses the applies the multi-dimensional Prewitt filter to a <span class="math notranslate nohighlight">\(D\)</span>-dimensional NDArray
<span class="math notranslate nohighlight">\(\mathbf{x} \in \mathbb{R}^{N_0 \times \cdots \times N_{D-1}}\)</span> using separable kernels for improved
performance.  The Prewitt filter applies the following edge filter in the dimensions of interest: <code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">0,</span> <span class="pre">-1]</span></code>,
and the smoothing filter on the rest of dimensions: <code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">1,</span> <span class="pre">1]</span> <span class="pre">/</span> <span class="pre">3</span></code>.  The Prewitt filter is commonly used to find
high-frequency components in the signal, such as for example, the edges in an image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim_shape</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArrayShape" title="pyxu.info.ptype.NDArrayShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayShape</span></code></a>) – Shape of the input array.</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>) – <p>Compute the edge filter along this axis. If not provided, the edge magnitude is computed. This is defined as:</p>
<p><code class="docutils literal notranslate"><span class="pre">np.sqrt(sum([prewitt(array,</span> <span class="pre">axis=i)**2</span> <span class="pre">for</span> <span class="pre">i</span> <span class="pre">in</span> <span class="pre">range(array.ndim)])</span> <span class="pre">/</span> <span class="pre">array.ndim)</span></code> The magnitude is also
computed if axis is a sequence.</p>
</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[str]</span></code>) – <p>Boundary conditions.
Multiple forms are accepted:</p>
<ul>
<li><p>str: unique mode shared amongst dimensions.
Must be one of:</p>
<ul>
<li><p>’constant’ (default): zero-padding</p></li>
<li><p>’wrap’</p></li>
<li><p>’reflect’</p></li>
<li><p>’symmetric’</p></li>
<li><p>’edge’</p></li>
</ul>
</li>
<li><p>tuple[str, …]: the <code class="code docutils literal notranslate"><span class="pre">d</span></code>-th dimension uses <code class="code docutils literal notranslate"><span class="pre">mode[d]</span></code> as boundary condition.</p></li>
</ul>
<p>(See <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.pad.html#numpy.pad" title="(in NumPy v2.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.pad()</span></code></a> for details.)</p>
</p></li>
<li><p><strong>sampling</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-class docutils literal notranslate"><span class="pre">Real</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[Real]</span></code>) – Sampling step (i.e. distance between two consecutive elements of an array).
Defaults to 1.</p></li>
<li><p><strong>gpu</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Input NDArray type (<code class="code docutils literal notranslate"><span class="pre">True</span></code> for GPU, <code class="code docutils literal notranslate"><span class="pre">False</span></code> for CPU). Defaults to <code class="code docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>dtype</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.DType" title="pyxu.info.ptype.DType"><code class="xref py py-class docutils literal notranslate"><span class="pre">DType</span></code></a>) – Working precision of the linear operator.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>op</strong> – Prewitt</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/pyplot_summary.html#module-matplotlib.pyplot" title="matplotlib.pyplot"><span class="nn">matplotlib.pyplot</span></a> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/index.html#module-numpy" title="numpy"><span class="nn">numpy</span></a> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pyxu.operator</span> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.Prewitt" title="pyxu.operator.Prewitt"><span class="n">Prewitt</span></a>

<span class="n">dim_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">image</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">(</span><span class="n">dim_shape</span><span class="p">)</span>
<span class="n">image</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>

<span class="n">prewitt</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.Prewitt" title="pyxu.operator.Prewitt"><span class="n">Prewitt</span></a><span class="p">(</span><span class="n">dim_shape</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">prewitt</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplot.html#matplotlib.pyplot.subplot" title="matplotlib.pyplot.subplot"><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span></a><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.imshow.html#matplotlib.pyplot.imshow" title="matplotlib.pyplot.imshow"><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span></a><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">()</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplot.html#matplotlib.pyplot.subplot" title="matplotlib.pyplot.subplot"><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span></a><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.imshow.html#matplotlib.pyplot.imshow" title="matplotlib.pyplot.imshow"><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span></a><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../_downloads/c5957e5510f7a3e008be152d620d9cd0/linop-5.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/a46945b9ac28103cc2ae27158e140ffb/linop-5.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/48e4fd6bd0ff07d32c9663e17e75135d/linop-5.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/09b83b84e67dd3bf3bfa9889ef5464d2/linop-5.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../../_images/linop-5.png" class="plot-directive" src="../../_images/linop-5.png"/>
</figure>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyxu.operator.Sobel" title="pyxu.operator.Sobel"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sobel</span></code></a>, <a class="reference internal" href="#pyxu.operator.Scharr" title="pyxu.operator.Scharr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Scharr</span></code></a></p>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.operator.Scharr">
<span class="sig-name descname"><span class="pre">Scharr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gpu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/filter.html#Scharr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.Scharr" title="Link to this definition">#</a></dt>
<dd><p>Multi-dimensional Scharr filter.</p>
<p class="rubric">Notes</p>
<p>This operator uses the applies the multi-dimensional Scharr filter to a <span class="math notranslate nohighlight">\(D\)</span>-dimensional NDArray
<span class="math notranslate nohighlight">\(\mathbf{x} \in \mathbb{R}^{N_0 \times \cdots \times N_{D-1}}\)</span> using separable kernels for improved
performance.  The Scharr filter applies the following edge filter in the dimensions of interest: <code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">0,</span> <span class="pre">-1]</span></code>, and
the smoothing filter on the rest of dimensions: <code class="docutils literal notranslate"><span class="pre">[3,</span> <span class="pre">10,</span> <span class="pre">3]</span> <span class="pre">/</span> <span class="pre">16</span></code>.  The Scharr filter is commonly used to find
high-frequency components in the signal, such as for example, the edges in an image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim_shape</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArrayShape" title="pyxu.info.ptype.NDArrayShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayShape</span></code></a>) – Shape of the input array.</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>) – <p>Compute the edge filter along this axis. If not provided, the edge magnitude is computed. This is defined as:</p>
<p><code class="docutils literal notranslate"><span class="pre">np.sqrt(sum([scharr(array,</span> <span class="pre">axis=i)**2</span> <span class="pre">for</span> <span class="pre">i</span> <span class="pre">in</span> <span class="pre">range(array.ndim)])</span> <span class="pre">/</span> <span class="pre">array.ndim)</span></code> The magnitude is also
computed if axis is a sequence.</p>
</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[str]</span></code>) – <p>Boundary conditions.
Multiple forms are accepted:</p>
<ul>
<li><p>str: unique mode shared amongst dimensions.
Must be one of:</p>
<ul>
<li><p>’constant’ (default): zero-padding</p></li>
<li><p>’wrap’</p></li>
<li><p>’reflect’</p></li>
<li><p>’symmetric’</p></li>
<li><p>’edge’</p></li>
</ul>
</li>
<li><p>tuple[str, …]: the <code class="code docutils literal notranslate"><span class="pre">d</span></code>-th dimension uses <code class="code docutils literal notranslate"><span class="pre">mode[d]</span></code> as boundary condition.</p></li>
</ul>
<p>(See <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.pad.html#numpy.pad" title="(in NumPy v2.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.pad()</span></code></a> for details.)</p>
</p></li>
<li><p><strong>sampling</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-class docutils literal notranslate"><span class="pre">Real</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[Real]</span></code>) – Sampling step (i.e. distance between two consecutive elements of an array).
Defaults to 1.</p></li>
<li><p><strong>gpu</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Input NDArray type (<code class="code docutils literal notranslate"><span class="pre">True</span></code> for GPU, <code class="code docutils literal notranslate"><span class="pre">False</span></code> for CPU). Defaults to <code class="code docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>dtype</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.DType" title="pyxu.info.ptype.DType"><code class="xref py py-class docutils literal notranslate"><span class="pre">DType</span></code></a>) – Working precision of the linear operator.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>op</strong> – Scharr</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/pyplot_summary.html#module-matplotlib.pyplot" title="matplotlib.pyplot"><span class="nn">matplotlib.pyplot</span></a> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/index.html#module-numpy" title="numpy"><span class="nn">numpy</span></a> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pyxu.operator</span> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.Scharr" title="pyxu.operator.Scharr"><span class="n">Scharr</span></a>

<span class="n">dim_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">image</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">(</span><span class="n">dim_shape</span><span class="p">)</span>
<span class="n">image</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>

<span class="n">scharr</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.Scharr" title="pyxu.operator.Scharr"><span class="n">Scharr</span></a><span class="p">(</span><span class="n">dim_shape</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">scharr</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplot.html#matplotlib.pyplot.subplot" title="matplotlib.pyplot.subplot"><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span></a><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.imshow.html#matplotlib.pyplot.imshow" title="matplotlib.pyplot.imshow"><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span></a><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">()</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplot.html#matplotlib.pyplot.subplot" title="matplotlib.pyplot.subplot"><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span></a><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.imshow.html#matplotlib.pyplot.imshow" title="matplotlib.pyplot.imshow"><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span></a><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../_downloads/86c9574267ec7b8962aeba64be5b073c/linop-6.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/ffda470275900c5520f894834127f285/linop-6.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/0b6013e7f37dad4e1e5dc6147b68a69a/linop-6.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/e8cf3ce50f34b6ff0831d06aeebabca8/linop-6.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../../_images/linop-6.png" class="plot-directive" src="../../_images/linop-6.png"/>
</figure>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyxu.operator.Sobel" title="pyxu.operator.Sobel"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sobel</span></code></a>, <a class="reference internal" href="#pyxu.operator.Prewitt" title="pyxu.operator.Prewitt"><code class="xref py py-class docutils literal notranslate"><span class="pre">Prewitt</span></code></a></p>
</div>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyxu.operator.StructureTensor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">StructureTensor</span></span><span class="sig-paren">(</span>
<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">dim_shape</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">diff_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fd'</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">smooth_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">smooth_truncate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">sampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">gpu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">diff_kwargs</span></span></em>,</dd>
</dl>
<span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/filter.html#StructureTensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.StructureTensor" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="../abc.html#pyxu.abc.DiffMap" title="pyxu.abc.operator.DiffMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiffMap</span></code></a></p>
<p>Structure tensor operator.</p>
<p class="rubric">Notes</p>
<p>The Structure Tensor, also known as the second-order moment tensor or the inertia tensor, is a matrix derived from
the gradient of a function. It describes the distribution of the gradient (i.e., its prominent directions) in a
specified neighbourhood around a point, and the degree to which those directions are coherent.  The structure tensor
of a <span class="math notranslate nohighlight">\(D\)</span>-dimensional signal <span class="math notranslate nohighlight">\(\mathbf{f} \in \mathbb{R}^{N_0 \times \cdots \times N_{D-1}}\)</span> can be
written as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{S}_\sigma \mathbf{f} = \mathbf{g}_{\sigma} * \nabla\mathbf{f} (\nabla\mathbf{f})^{\top} = \mathbf{g}_{\sigma} *
\begin{bmatrix}
\left( \dfrac{ \partial\mathbf{f} }{ \partial x_{0} } \right)^2 &amp;  \dfrac{ \partial^{2}\mathbf{f} }{ \partial x_{0}\,\partial x_{1} } &amp; \cdots &amp; \dfrac{ \partial\mathbf{f} }{ \partial x_{0} } \dfrac{ \partial\mathbf{f} }{ \partial x_{D-1} } \\
\dfrac{ \partial\mathbf{f} }{ \partial x_{1} } \dfrac{ \partial\mathbf{f} }{ \partial x_{0} } &amp; \left( \dfrac{ \partial\mathbf{f} }{ \partial x_{1} }\right)^2 &amp; \cdots &amp; \dfrac{ \partial\mathbf{f} }{ \partial x_{1} } \dfrac{ \partial\mathbf{f} }{ \partial x_{D-1} } \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
\dfrac{ \partial\mathbf{f} }{ \partial x_{D-1} } \dfrac{ \partial\mathbf{f} }{ \partial x_{0} } &amp; \dfrac{ \partial\mathbf{f} }{ \partial x_{D-1} } \dfrac{ \partial\mathbf{f} }{ \partial x_{1} } &amp; \cdots &amp; \left( \dfrac{ \partial\mathbf{f} }{ \partial x_{D-1}} \right)^2
\end{bmatrix},\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{g}_{\sigma} \in \mathbb{R}^{N_0 \times \cdots \times N_{D-1}}\)</span> is a discrete Gaussian filter
with standard variation <span class="math notranslate nohighlight">\(\sigma\)</span> with which a convolution is performed elementwise.</p>
<p>However, due to the symmetry of the structure tensor, only the upper triangular part is computed in practice:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{H}_{\mathbf{v}_1, \ldots ,\mathbf{v}_m} \mathbf{f} = \mathbf{g}_{\sigma} * \begin{bmatrix}
\left( \dfrac{ \partial\mathbf{f} }{ \partial x_{0} } \right)^2 \\
\dfrac{ \partial^{2}\mathbf{f} }{ \partial x_{0}\,\partial x_{1} } \\
\vdots \\
\left( \dfrac{ \partial\mathbf{f} }{ \partial x_{D-1}} \right)^2
\end{bmatrix} \mathbf{f} \in \mathbb{R}^{\frac{D (D-1)}{2} \times N_0 \times \cdots \times N_{D-1}}\end{split}\]</div>
<section id="remark">
<h3>Remark<a class="headerlink" href="#remark" title="Link to this heading">#</a></h3>
<p>In case of using the finite differences (<code class="code docutils literal notranslate"><span class="pre">diff_type="fd"</span></code>), the finite difference scheme defaults to <code class="code docutils literal notranslate"><span class="pre">central</span></code> (see
<a class="reference internal" href="#pyxu.operator.PartialDerivative" title="pyxu.operator.PartialDerivative"><code class="xref py py-class docutils literal notranslate"><span class="pre">PartialDerivative</span></code></a>).</p>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/index.html#module-numpy" title="numpy"><span class="nn">numpy</span></a> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/pyplot_summary.html#module-matplotlib.pyplot" title="matplotlib.pyplot"><span class="nn">matplotlib.pyplot</span></a> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">pyxu.operator</span> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.StructureTensor" title="pyxu.operator.linop.filter.StructureTensor"><span class="n">StructureTensor</span></a>
<span class="kn">from</span> <span class="nn">pyxu.util.misc</span> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/util.html#pyxu.util.misc.peaks" title="pyxu.util.misc.peaks"><span class="n">peaks</span></a>

<span class="c1"># Define input image</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">x</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.linspace.html#numpy.linspace" title="numpy.linspace"><span class="n">np</span><span class="o">.</span><span class="n">linspace</span></a><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">xx</span><span class="p">,</span> <span class="n">yy</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.meshgrid.html#numpy.meshgrid" title="numpy.meshgrid"><span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span></a><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">image</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/util.html#pyxu.util.misc.peaks" title="pyxu.util.misc.peaks"><span class="n">peaks</span></a><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">)</span>
<span class="n">nsamples</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">dim_shape</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># (1000, 1000)</span>
<span class="n">images</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.tile.html#numpy.tile" title="numpy.tile"><span class="n">np</span><span class="o">.</span><span class="n">tile</span></a><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="p">(</span><span class="n">nsamples</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="c1"># Instantiate structure tensor operator</span>
<a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.StructureTensor" title="pyxu.operator.linop.filter.StructureTensor"><span class="n">structure_tensor</span></a> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.StructureTensor" title="pyxu.operator.linop.filter.StructureTensor"><span class="n">StructureTensor</span></a><span class="p">(</span><span class="n">dim_shape</span><span class="o">=</span><span class="n">dim_shape</span><span class="p">)</span>

<span class="n">outputs</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.StructureTensor" title="pyxu.operator.linop.filter.StructureTensor"><span class="n">structure_tensor</span></a><span class="p">(</span><span class="n">images</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="n">outputs</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (2, 3, 1000, 1000)</span>
<span class="c1"># Plot</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.imshow.html#matplotlib.pyplot.imshow" title="matplotlib.pyplot.imshow"><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span></a><span class="p">(</span><span class="n">images</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">()</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="s2">"Image"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.axis.html#matplotlib.pyplot.axis" title="matplotlib.pyplot.axis"><span class="n">plt</span><span class="o">.</span><span class="n">axis</span></a><span class="p">(</span><span class="s2">"off"</span><span class="p">)</span>

<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.imshow.html#matplotlib.pyplot.imshow" title="matplotlib.pyplot.imshow"><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span></a><span class="p">(</span><span class="n">outputs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">()</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="sa">r</span><span class="s2">"$\hat</span><span class="si">{S}</span><span class="s2">_</span><span class="si">{xx}</span><span class="s2">$"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.axis.html#matplotlib.pyplot.axis" title="matplotlib.pyplot.axis"><span class="n">plt</span><span class="o">.</span><span class="n">axis</span></a><span class="p">(</span><span class="s2">"off"</span><span class="p">)</span>

<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.imshow.html#matplotlib.pyplot.imshow" title="matplotlib.pyplot.imshow"><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span></a><span class="p">(</span><span class="n">outputs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">()</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="sa">r</span><span class="s2">"$\hat</span><span class="si">{S}</span><span class="s2">_</span><span class="si">{xy}</span><span class="s2">$"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.axis.html#matplotlib.pyplot.axis" title="matplotlib.pyplot.axis"><span class="n">plt</span><span class="o">.</span><span class="n">axis</span></a><span class="p">(</span><span class="s2">"off"</span><span class="p">)</span>

<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.imshow.html#matplotlib.pyplot.imshow" title="matplotlib.pyplot.imshow"><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span></a><span class="p">(</span><span class="n">outputs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">()</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="sa">r</span><span class="s2">"$\hat</span><span class="si">{S}</span><span class="s2">_</span><span class="si">{yy}</span><span class="s2">$"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.axis.html#matplotlib.pyplot.axis" title="matplotlib.pyplot.axis"><span class="n">plt</span><span class="o">.</span><span class="n">axis</span></a><span class="p">(</span><span class="s2">"off"</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../_downloads/412a24acb2bac1b40c380b09be1a2726/linop-7.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>)</p>
<figure class="align-default" id="id13">
<img alt="../../_images/linop-7_00.png" class="plot-directive" src="../../_images/linop-7_00.png"/>
<figcaption>
<p><span class="caption-text">(<a class="reference download internal" download="" href="../../_downloads/b51a26be4b1f6fd05f718681f154ae92/linop-7_00.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/470def4c91e6713476f0e826f8fbbd79/linop-7_00.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/22bd9057779cffbbbba3ea842436c066/linop-7_00.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</span><a class="headerlink" href="#id13" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id14">
<img alt="../../_images/linop-7_01.png" class="plot-directive" src="../../_images/linop-7_01.png"/>
<figcaption>
<p><span class="caption-text">(<a class="reference download internal" download="" href="../../_downloads/57c4fd1b236a490d43391fa00fabc529/linop-7_01.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/f9ae1ee87d5067e3071a6cd16a36a429/linop-7_01.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/76756524613d2983ea3587d04687c2c6/linop-7_01.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</span><a class="headerlink" href="#id14" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id15">
<img alt="../../_images/linop-7_02.png" class="plot-directive" src="../../_images/linop-7_02.png"/>
<figcaption>
<p><span class="caption-text">(<a class="reference download internal" download="" href="../../_downloads/92de9c41dd3dd52a04b7a2b1076bd1f5/linop-7_02.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/471c4ed2f8773b1910c8d5ee1ff3f717/linop-7_02.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/f8ee9bb8e004715b22514fc6afbb3a71/linop-7_02.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</span><a class="headerlink" href="#id15" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id16">
<img alt="../../_images/linop-7_03.png" class="plot-directive" src="../../_images/linop-7_03.png"/>
<figcaption>
<p><span class="caption-text">(<a class="reference download internal" download="" href="../../_downloads/c99adcdbb0bb26400213265bfb68aed9/linop-7_03.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/5c2361513811e3fe8f114a94de82fdd0/linop-7_03.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/9eaea73fdea624e0206631a1d44ed0c6/linop-7_03.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</span><a class="headerlink" href="#id16" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyxu.operator.PartialDerivative" title="pyxu.operator.PartialDerivative"><code class="xref py py-class docutils literal notranslate"><span class="pre">PartialDerivative</span></code></a>, <a class="reference internal" href="#pyxu.operator.Gradient" title="pyxu.operator.Gradient"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gradient</span></code></a>, <a class="reference internal" href="#pyxu.operator.Hessian" title="pyxu.operator.Hessian"><code class="xref py py-class docutils literal notranslate"><span class="pre">Hessian</span></code></a></p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.operator.StructureTensor.apply">
<span class="sig-name descname"><span class="pre">apply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/filter.html#StructureTensor.apply"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.StructureTensor.apply" title="Link to this definition">#</a></dt>
<dd><p>Evaluate operator at specified point(s).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>arr</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArray</span></code></a>) – (…, M1,…,MD) input points.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>out</strong> – (…, N1,…,NK) output points.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArray</span></code></a></p>
</dd>
</dl>
</dd></dl>
</section>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><em>Integral</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Integral" title="(in Python v3.13)"><em>Integral</em></a><em>, </em><em>...</em><em>]</em>)</p></li>
<li><p><strong>smooth_sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Real" title="(in Python v3.13)"><em>Real</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Real" title="(in Python v3.13)"><em>Real</em></a><em>, </em><em>...</em><em>]</em>)</p></li>
<li><p><strong>smooth_truncate</strong> (<a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Real" title="(in Python v3.13)"><em>Real</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Real" title="(in Python v3.13)"><em>Real</em></a><em>, </em><em>...</em><em>]</em>)</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><em>Sequence</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em>)</p></li>
<li><p><strong>sampling</strong> (<a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Real" title="(in Python v3.13)"><em>Real</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Real" title="(in Python v3.13)"><em>Real</em></a><em>, </em><em>...</em><em>]</em>)</p></li>
<li><p><strong>gpu</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.1)"><em>dtype</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><em>Any</em></a><em>] </em><em>| </em><em>None</em><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.13)"><em>type</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><em>Any</em></a><em>] </em><em>| </em><em>_SupportsDType</em><em>[</em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.1)"><em>dtype</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><em>Any</em></a><em>]</em><em>] </em><em>| </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><em>Any</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>] </em><em>| </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><em>Any</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.SupportsIndex" title="(in Python v3.13)"><em>SupportsIndex</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><em>Sequence</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.SupportsIndex" title="(in Python v3.13)"><em>SupportsIndex</em></a><em>]</em><em>] </em><em>| </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><em>Any</em></a><em>] </em><em>| </em><em>_DTypeDict</em><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><em>Any</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><em>Any</em></a><em>]</em>)</p></li>
<li><p><strong>parallel</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>
</section>
<section id="derivatives">
<h2><a class="toc-backref" href="#id35" role="doc-backlink">Derivatives</a><a class="headerlink" href="#derivatives" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyxu.operator.PartialDerivative">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PartialDerivative</span></span><a class="reference internal" href="../../_modules/pyxu/operator/linop/diff.html#PartialDerivative"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.PartialDerivative" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Partial derivative operator based on <a class="reference external" href="https://numba.pydata.org/numba-doc/latest/user/stencil.html">Numba stencils</a>.</p>
<p class="rubric">Notes</p>
<ul>
<li><p>This operator approximates the partial derivative of a <span class="math notranslate nohighlight">\(D\)</span>-dimensional signal <span class="math notranslate nohighlight">\(\mathbf{f} \in
\mathbb{R}^{N_0 \times \cdots \times N_{D-1}}\)</span></p>
<div class="math notranslate nohighlight">
\[\frac{\partial^{n} \mathbf{f}}{\partial x_0^{n_0} \cdots \partial x_{D-1}^{n_{D-1}}} \in
\mathbb{R}^{N_0 \times \cdots \times N_{D-1}}\]</div>
<p>where <span class="math notranslate nohighlight">\(\frac{\partial^{n_i}}{\partial x_i^{n_i}}\)</span> is the <span class="math notranslate nohighlight">\(n_i\)</span>-th order partial derivative along
dimension <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(n = \prod_{i=0}^{D-1} n_{i}\)</span> is the total derivative order.</p>
<p>Partial derivatives can be implemented with <a class="reference external" href="https://en.wikipedia.org/wiki/Finite_difference">finite differences</a> via the
<a class="reference internal" href="#pyxu.operator.PartialDerivative.finite_difference" title="pyxu.operator.PartialDerivative.finite_difference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">finite_difference()</span></code></a> constructor, or with the <a class="reference external" href="https://www.crisluengo.net/archives/22/">Gaussian
derivative</a> via the
<a class="reference internal" href="#pyxu.operator.PartialDerivative.gaussian_derivative" title="pyxu.operator.PartialDerivative.gaussian_derivative"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gaussian_derivative()</span></code></a> constructor.</p>
</li>
<li><p>When using the <a class="reference internal" href="#pyxu.operator.PartialDerivative.finite_difference" title="pyxu.operator.PartialDerivative.finite_difference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">finite_difference()</span></code></a> constructor, the adjoint
of the resulting linear operator will vary depending on the type of finite differences:</p>
<ul>
<li><p>For <code class="docutils literal notranslate"><span class="pre">forward</span></code> type, the adjoint corresponds to:</p>
<p><span class="math notranslate nohighlight">\((\frac{\partial^{\text{fwd}}}{\partial x})^{\ast} = -\frac{\partial^{\text{bwd}}}{\partial x}\)</span></p>
</li>
<li><p>For <code class="docutils literal notranslate"><span class="pre">backward</span></code> type, the adjoint corresponds to:</p>
<p><span class="math notranslate nohighlight">\((\frac{\partial^{\text{bwd}}}{\partial x})^{\ast} = -\frac{\partial^{\text{fwd}}}{\partial x}\)</span></p>
</li>
<li><p>For <code class="docutils literal notranslate"><span class="pre">central</span></code> type, and for the <a class="reference internal" href="#pyxu.operator.PartialDerivative.gaussian_derivative" title="pyxu.operator.PartialDerivative.gaussian_derivative"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gaussian_derivative()</span></code></a>
constructor, the adjoint corresponds to:</p>
<p><span class="math notranslate nohighlight">\((\frac{\partial}{\partial x})^{\ast} = -\frac{\partial}{\partial x}\)</span></p>
</li>
</ul>
</li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When dealing with high-order partial derivatives, the stencils required to compute them can become large,
resulting in computationally expensive evaluations.
In such scenarios, it can be more efficient to construct the partial derivative through a composition of
lower-order partial derivatives.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyxu.operator.Gradient" title="pyxu.operator.Gradient"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gradient</span></code></a>, <a class="reference internal" href="#pyxu.operator.Laplacian" title="pyxu.operator.Laplacian"><code class="xref py py-class docutils literal notranslate"><span class="pre">Laplacian</span></code></a>, <a class="reference internal" href="#pyxu.operator.Hessian" title="pyxu.operator.Hessian"><code class="xref py py-class docutils literal notranslate"><span class="pre">Hessian</span></code></a></p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.operator.PartialDerivative.finite_difference">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">finite_difference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scheme</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'forward'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accuracy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gpu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/diff.html#PartialDerivative.finite_difference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.PartialDerivative.finite_difference" title="Link to this definition">#</a></dt>
<dd><p>Compute partial derivatives for multi-dimensional signals using finite differences.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim_shape</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArrayShape" title="pyxu.info.ptype.NDArrayShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayShape</span></code></a>) – (N_1,…,N_D) input dimensions.</p></li>
<li><p><strong>order</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list[Integer]</span></code>) – Derivative order for each dimension.
The total order of the partial derivative is the sum of the elements of the tuple.
Use zeros to indicate dimensions in which the derivative should not be computed.</p></li>
<li><p><strong>scheme</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[str]</span></code>) – Type of finite differences: [‘forward, ‘backward, ‘central’].
Defaults to ‘forward’.
If a string is provided, the same <code class="code docutils literal notranslate"><span class="pre">scheme</span></code> is assumed for all dimensions.
If a tuple is provided, it should have as many elements as <code class="code docutils literal notranslate"><span class="pre">order</span></code>.</p></li>
<li><p><strong>accuracy</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.Integer" title="pyxu.info.ptype.Integer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Integer</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[Integer]</span></code>) – Determines the number of points used to approximate the derivative with finite differences (see <code class="code docutils literal notranslate"><span class="pre">Notes</span></code>).
Defaults to 1.
If an int is provided, the same <code class="code docutils literal notranslate"><span class="pre">accuracy</span></code> is assumed for all dimensions.
If a tuple is provided, it should have as many elements as <code class="code docutils literal notranslate"><span class="pre">dim_shape</span></code>.</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[str]</span></code>) – <p>Boundary conditions.
Multiple forms are accepted:</p>
<ul>
<li><p>str: unique mode shared amongst dimensions.
Must be one of:</p>
<ul>
<li><p>’constant’ (default): zero-padding</p></li>
<li><p>’wrap’</p></li>
<li><p>’reflect’</p></li>
<li><p>’symmetric’</p></li>
<li><p>’edge’</p></li>
</ul>
</li>
<li><p>tuple[str, …]: the <code class="code docutils literal notranslate"><span class="pre">d</span></code>-th dimension uses <code class="docutils literal notranslate"><span class="pre">mode[d]</span></code> as boundary condition.</p></li>
</ul>
<p>(See <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.pad.html#numpy.pad" title="(in NumPy v2.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.pad()</span></code></a> for details.)</p>
</p></li>
<li><p><strong>gpu</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Input NDArray type (<code class="code docutils literal notranslate"><span class="pre">True</span></code> for GPU, <code class="code docutils literal notranslate"><span class="pre">False</span></code> for CPU).
Defaults to <code class="code docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>dtype</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.DType" title="pyxu.info.ptype.DType"><code class="xref py py-class docutils literal notranslate"><span class="pre">DType</span></code></a>) – Working precision of the linear operator.</p></li>
<li><p><strong>sampling</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-class docutils literal notranslate"><span class="pre">Real</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[Real]</span></code>) – Sampling step (i.e. distance between two consecutive elements of an array).
Defaults to 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>op</strong> – Partial derivative</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>We explain here finite differences for one-dimensional signals; this operator performs finite differences for
multi-dimensional signals along dimensions specified by <code class="code docutils literal notranslate"><span class="pre">order</span></code>.</p>
<p>This operator approximates derivatives with <a class="reference external" href="https://en.wikipedia.org/wiki/Finite_difference">finite differences</a>.
It is inspired by the <a class="reference external" href="https://web.media.mit.edu/~crtaylor/calculator.html">Finite Difference Coefficients Calculator</a> to construct finite-difference approximations for the
desired <em>(i)</em> derivative order, <em>(ii)</em> approximation accuracy, and <em>(iii)</em> finite difference type.
Three basic types of finite differences are supported, which lead to the following first-order (<code class="docutils literal notranslate"><span class="pre">order</span> <span class="pre">=</span> <span class="pre">1</span></code>)
operators with <code class="docutils literal notranslate"><span class="pre">accuracy</span> <span class="pre">=</span> <span class="pre">1</span></code> and sampling step <code class="docutils literal notranslate"><span class="pre">sampling</span> <span class="pre">=</span> <span class="pre">h</span></code> for one-dimensional signals:</p>
<ul>
<li><p><strong>Forward difference</strong>:
Approximates the continuous operator <span class="math notranslate nohighlight">\(D_{F}f(x) = \frac{f(x+h) - f(x)}{h}\)</span> with the discrete operator</p>
<div class="math notranslate nohighlight">
\[\mathbf{D}_{F} f [n] = \frac{f[n+1] - f[n]}{h},\]</div>
<p>whose kernel is <span class="math notranslate nohighlight">\(d = \frac{1}{h}[-1, 1]\)</span> and center is (0, ).</p>
</li>
<li><p><strong>Backward difference</strong>:
Approximates the continuous operator <span class="math notranslate nohighlight">\(D_{B}f(x) = \frac{f(x) - f(x-h)}{h}\)</span> with the discrete operator</p>
<div class="math notranslate nohighlight">
\[\mathbf{D}_{B} f [n] = \frac{f[n] - f[n-1]}{h},\]</div>
<p>whose kernel is <span class="math notranslate nohighlight">\(d = \frac{1}{h}[-1, 1]\)</span> and center is (1, ).</p>
</li>
<li><p><strong>Central difference</strong>:
Approximates the continuous operator <span class="math notranslate nohighlight">\(D_{C}f(x) = \frac{f(x+h) - f(x-h)}{2h}\)</span> with the discrete operator</p>
<div class="math notranslate nohighlight">
\[\mathbf{D}_{C} f [n] = \frac{f[n+1] - f[n-1]}{2h},\]</div>
<p>whose kernel is <span class="math notranslate nohighlight">\(d = \frac{1}{h}[-\frac12, 0, \frac12]\)</span> and center is (1, ).</p>
</li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>For forward and backward differences, higher-order operators correspond to the composition of first-order
operators.
This is not the case for central differences: the second-order continuous operator is given by
<span class="math notranslate nohighlight">\(D^2_{C}f(x) = \frac{f(x+h) - 2 f(x) + f(x-h)}{h}\)</span>, hence <span class="math notranslate nohighlight">\(D^2_{C} \neq D_{C} \circ D_{C}\)</span>.
The corresponding discrete operator is given by <span class="math notranslate nohighlight">\(\mathbf{D}^2_{C} f [n] = \frac{f[n+1] - 2 f[n] +
f[n-1]}{h}\)</span>, whose kernel is <span class="math notranslate nohighlight">\(d = \frac{1}{h}[1, -2, 1]\)</span> and center is (1, ).
We refer to <a class="reference external" href="https://www.ams.org/journals/mcom/1988-51-184/S0025-5718-1988-0935077-0/S0025-5718-1988-0935077-0.pdf">this paper</a> for
more details.</p>
</div>
<p>For a given derivative order <span class="math notranslate nohighlight">\(N\in\mathbb{Z}^{+}\)</span> and accuracy <span class="math notranslate nohighlight">\(a\in\mathbb{Z}^{+}\)</span>, the size
<span class="math notranslate nohighlight">\(N_s\)</span> of the stencil kernel <span class="math notranslate nohighlight">\(d\)</span> used for finite differences is given by:</p>
<ul class="simple">
<li><p>For central differences: <span class="math notranslate nohighlight">\(N_s = 2 \lfloor\frac{N + 1}{2}\rfloor - 1 + a\)</span></p></li>
<li><p>For forward and backward differences: <span class="math notranslate nohighlight">\(N_s = N + a\)</span></p></li>
</ul>
<p>For <span class="math notranslate nohighlight">\(N_s\)</span> given support indices <span class="math notranslate nohighlight">\(\{s_1, \ldots , s_{N_s} \} \subset \mathbb{Z}\)</span> and a derivative
order <span class="math notranslate nohighlight">\(N&lt;N_s\)</span>, the stencil kernel <span class="math notranslate nohighlight">\(d = [d_1, \ldots, d_{N_s}]\)</span> of the finite-difference
approximation of the derivative is obtained by solving the following system of linear equations (see the <a class="reference external" href="https://web.media.mit.edu/~crtaylor/calculator.html">Finite
Difference Coefficients Calculator</a> documentation):</p>
<div class="admonition-remark admonition">
<p class="admonition-title">Remark</p>
<p>The number of coefficients of the finite-difference kernel is chosen to guarantee the requested accuracy, but
might be larger than requested accuracy.
For example, if choosing <code class="code docutils literal notranslate"><span class="pre">scheme='central'</span></code> with <code class="code docutils literal notranslate"><span class="pre">accuracy=1</span></code>, it will create a kernel corresponding to
<code class="code docutils literal notranslate"><span class="pre">accuracy=2</span></code>, as it is the minimum accuracy possible for such scheme (see the <a class="reference external" href="https://en.wikipedia.org/wiki/Finite_difference_coefficient">finite difference coefficient
table</a>).</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left(\begin{array}{ccc}
s_{1}^{0} &amp; \cdots &amp; s_{N_s}^{0} \\
\vdots &amp; \ddots &amp; \vdots \\
s_{1}^{N_s-1} &amp; \cdots &amp; s_{N_s}^{N_s-1}
\end{array}\right)\left(\begin{array}{c}
d_{1} \\
\vdots \\
d_{N_s}
\end{array}\right)= \frac{1}{h^{N}}\left(\begin{array}{c}
\delta_{0, N} \\
\vdots \\
\delta_{i, N} \\
\vdots \\
\delta_{N_s-1, N}
\end{array}\right),\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\delta_{i, j}\)</span> is the Kronecker delta.</p>
</div>
<p>This class inherits its methods from <a class="reference internal" href="#pyxu.operator.Stencil" title="pyxu.operator.Stencil"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stencil</span></code></a>.</p>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/index.html#module-numpy" title="numpy"><span class="nn">numpy</span></a> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/pyplot_summary.html#module-matplotlib.pyplot" title="matplotlib.pyplot"><span class="nn">matplotlib.pyplot</span></a> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">pyxu.operator</span> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.PartialDerivative" title="pyxu.operator.linop.diff.PartialDerivative"><span class="n">PartialDerivative</span></a>
<span class="kn">from</span> <span class="nn">pyxu.util.misc</span> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/util.html#pyxu.util.misc.peaks" title="pyxu.util.misc.peaks"><span class="n">peaks</span></a>

<span class="n">x</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.linspace.html#numpy.linspace" title="numpy.linspace"><span class="n">np</span><span class="o">.</span><span class="n">linspace</span></a><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
<span class="n">xx</span><span class="p">,</span> <span class="n">yy</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.meshgrid.html#numpy.meshgrid" title="numpy.meshgrid"><span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span></a><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">image</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/util.html#pyxu.util.misc.peaks" title="pyxu.util.misc.peaks"><span class="n">peaks</span></a><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">)</span>
<span class="n">dim_shape</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># Shape of our image</span>
<span class="c1"># Specify derivative order at each direction</span>
<span class="n">df_dx</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># Compute derivative of order 1 in first dimension</span>
<span class="n">d2f_dy2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># Compute derivative of order 2 in second dimension</span>
<span class="n">d3f_dxdy2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># Compute derivative of order 1 in first dimension and der. of order 2 in second dimension</span>
<span class="c1"># Instantiate derivative operators</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="n">diff1</span> <span class="o">=</span> <span class="n">PartialDerivative</span><span class="o">.</span><span class="n">gaussian_derivative</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="n">df_dx</span><span class="p">,</span> <span class="n">dim_shape</span><span class="o">=</span><span class="n">dim_shape</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span> <span class="o">/</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.sqrt.html#numpy.sqrt" title="numpy.sqrt"><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span></a><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="n">diff2</span> <span class="o">=</span> <span class="n">PartialDerivative</span><span class="o">.</span><span class="n">gaussian_derivative</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="n">d2f_dy2</span><span class="p">,</span> <span class="n">dim_shape</span><span class="o">=</span><span class="n">dim_shape</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span> <span class="o">/</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.sqrt.html#numpy.sqrt" title="numpy.sqrt"><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span></a><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="n">diff</span> <span class="o">=</span> <span class="n">PartialDerivative</span><span class="o">.</span><span class="n">gaussian_derivative</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="n">d3f_dxdy2</span><span class="p">,</span> <span class="n">dim_shape</span><span class="o">=</span><span class="n">dim_shape</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">)</span>
<span class="c1"># Compute derivatives</span>
<span class="n">out1</span> <span class="o">=</span> <span class="p">(</span><span class="n">diff1</span> <span class="o">*</span> <span class="n">diff2</span><span class="p">)(</span><span class="n">image</span><span class="p">)</span>
<span class="n">out2</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<span class="c1"># Plot derivatives</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots" title="matplotlib.pyplot.subplots"><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span></a><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">"off"</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"f(x,y)"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">out1</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">"off"</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$\frac{\partial^</span><span class="si">{3}</span><span class="s2"> f(x,y)}{\partial x\partial y^</span><span class="si">{2}</span><span class="s2">}$"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">out2</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">"off"</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$\frac{\partial^</span><span class="si">{3}</span><span class="s2"> f(x,y)}{\partial x\partial y^</span><span class="si">{2}</span><span class="s2">}$"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

<span class="c1"># Check approximation error</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.imshow.html#matplotlib.pyplot.imshow" title="matplotlib.pyplot.imshow"><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span></a><span class="p">(</span><a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#abs" title="abs"><span class="nb">abs</span></a><span class="p">(</span><span class="n">out1</span> <span class="o">-</span> <span class="n">out2</span><span class="p">)),</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../_downloads/4e9c8982201c2baa2ef38bb0ea842376/linop-8.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>)</p>
<figure class="align-default" id="id17">
<img alt="../../_images/linop-8_00.png" class="plot-directive" src="../../_images/linop-8_00.png"/>
<figcaption>
<p><span class="caption-text">(<a class="reference download internal" download="" href="../../_downloads/35d7c9fc06c5990090174f6bc1062082/linop-8_00.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/df66a86c962cd07d5889a27427d72f6c/linop-8_00.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/3efa35127efc146021b2bb00f30126cc/linop-8_00.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</span><a class="headerlink" href="#id17" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id18">
<img alt="../../_images/linop-8_01.png" class="plot-directive" src="../../_images/linop-8_01.png"/>
<figcaption>
<p><span class="caption-text">(<a class="reference download internal" download="" href="../../_downloads/132434752269a9baa3af1e4faf8f3bb7/linop-8_01.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/6d5c68bf61154aa4ae215f2802edb005/linop-8_01.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/612022bbeb60e12bbedb2442f5e9eb14/linop-8_01.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</span><a class="headerlink" href="#id18" title="Link to this image">#</a></p>
</figcaption>
</figure>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyxu.operator.PartialDerivative.gaussian_derivative">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">gaussian_derivative</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">truncate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gpu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/diff.html#PartialDerivative.gaussian_derivative"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.PartialDerivative.gaussian_derivative" title="Link to this definition">#</a></dt>
<dd><p>Compute partial derivatives for multi-dimensional signals using gaussian derivatives.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim_shape</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArrayShape" title="pyxu.info.ptype.NDArrayShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayShape</span></code></a>) – (N_1,…,N_D) input dimensions.</p></li>
<li><p><strong>order</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list[Integer]</span></code>) – Derivative order for each dimension.
The total order of the partial derivative is the sum of the elements of the tuple.
Use zeros to indicate dimensions in which the derivative should not be computed.</p></li>
<li><p><strong>sigma</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-class docutils literal notranslate"><span class="pre">Real</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[Real]</span></code>) – Standard deviation for the Gaussian kernel.
Defaults to 1.0.
If a float is provided, the same <code class="code docutils literal notranslate"><span class="pre">sigma</span></code> is assumed for all dimensions.
If a tuple is provided, it should have as many elements as <code class="code docutils literal notranslate"><span class="pre">order</span></code>.</p></li>
<li><p><strong>truncate</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-class docutils literal notranslate"><span class="pre">Real</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[Real]</span></code>) – Truncate the filter at this many standard deviations (at each side from the origin).
Defaults to 3.0.
If a float is provided, the same <code class="code docutils literal notranslate"><span class="pre">truncate</span></code> is assumed for all dimensions.
If a tuple is provided, it should have as many elements as <code class="code docutils literal notranslate"><span class="pre">order</span></code>.</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[str]</span></code>) – <p>Boundary conditions.
Multiple forms are accepted:</p>
<ul>
<li><p>str: unique mode shared amongst dimensions.
Must be one of:</p>
<ul>
<li><p>’constant’ (default): zero-padding</p></li>
<li><p>’wrap’</p></li>
<li><p>’reflect’</p></li>
<li><p>’symmetric’</p></li>
<li><p>’edge’</p></li>
</ul>
</li>
<li><p>tuple[str, …]: the <code class="code docutils literal notranslate"><span class="pre">d</span></code>-th dimension uses <code class="docutils literal notranslate"><span class="pre">mode[d]</span></code> as boundary condition.</p></li>
</ul>
<p>(See <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.pad.html#numpy.pad" title="(in NumPy v2.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.pad()</span></code></a> for details.)</p>
</p></li>
<li><p><strong>gpu</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Input NDArray type (<code class="code docutils literal notranslate"><span class="pre">True</span></code> for GPU, <code class="code docutils literal notranslate"><span class="pre">False</span></code> for CPU).
Defaults to <code class="code docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>dtype</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.DType" title="pyxu.info.ptype.DType"><code class="xref py py-class docutils literal notranslate"><span class="pre">DType</span></code></a>) – Working precision of the linear operator.</p></li>
<li><p><strong>sampling</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.Real" title="pyxu.info.ptype.Real"><code class="xref py py-class docutils literal notranslate"><span class="pre">Real</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[Real]</span></code>) – Sampling step (i.e., the distance between two consecutive elements of an array).
Defaults to 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>op</strong> – Partial derivative.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>We explain here Gaussian derivatives for one-dimensional signals; this operator performs partial Gaussian
derivatives for multi-dimensional signals along dimensions specified by <code class="docutils literal notranslate"><span class="pre">order</span></code>.</p>
<p>A Gaussian derivative is an approximation of a derivative that consists in convolving the input function with a
Gaussian function <span class="math notranslate nohighlight">\(g\)</span> before applying a derivative.
In the continuous domain, the <span class="math notranslate nohighlight">\(N\)</span>-th order Gaussian derivative <span class="math notranslate nohighlight">\(D^N_G\)</span> amounts to a convolution with
the <span class="math notranslate nohighlight">\(N\)</span>-th order derivative of <span class="math notranslate nohighlight">\(g\)</span>:</p>
<div class="math notranslate nohighlight">
\[D^N_G f (x)
=
\frac{\mathrm{d}^N (f * g) }{\mathrm{d} x^N} (x)
=
f(x) * \frac{\mathrm{d}^N g}{\mathrm{d} x^N} (x).\]</div>
<p>For discrete signals <span class="math notranslate nohighlight">\(f[n]\)</span>, this operator is approximated by</p>
<div class="math notranslate nohighlight">
\[\mathbf{D}^N_G f [n]
=
f[n] *\frac{\mathrm{d}^N g}{\mathrm{d} x^N} \left(\frac{n}{h}\right),\]</div>
<p>where <span class="math notranslate nohighlight">\(h\)</span> is the spacing between samples and the operator <span class="math notranslate nohighlight">\(*\)</span> is now a discrete convolution.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The operator <span class="math notranslate nohighlight">\(\mathbf{D}_{G} \circ \mathbf{D}_{G}\)</span> is not directly related to
<span class="math notranslate nohighlight">\(\mathbf{D}_{G}^{2}\)</span>: Gaussian smoothing is performed twice in the case of the former, whereas it is
performed only once in the case of the latter.</p>
</div>
<p>Note that in contrast with finite differences (see
<a class="reference internal" href="#pyxu.operator.PartialDerivative.finite_difference" title="pyxu.operator.PartialDerivative.finite_difference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">finite_difference()</span></code></a>), Gaussian derivatives compute exact
derivatives in the continuous domain, since Gaussians can be differentiated analytically.
This derivative is then sampled in order to perform a discrete convolution.</p>
<p>This class inherits its methods from <a class="reference internal" href="#pyxu.operator.Stencil" title="pyxu.operator.Stencil"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stencil</span></code></a>.</p>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/index.html#module-numpy" title="numpy"><span class="nn">numpy</span></a> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/pyplot_summary.html#module-matplotlib.pyplot" title="matplotlib.pyplot"><span class="nn">matplotlib.pyplot</span></a> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">pyxu.operator</span> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.PartialDerivative" title="pyxu.operator.linop.diff.PartialDerivative"><span class="n">PartialDerivative</span></a>
<span class="kn">from</span> <span class="nn">pyxu.util.misc</span> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/util.html#pyxu.util.misc.peaks" title="pyxu.util.misc.peaks"><span class="n">peaks</span></a>

<span class="n">x</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.linspace.html#numpy.linspace" title="numpy.linspace"><span class="n">np</span><span class="o">.</span><span class="n">linspace</span></a><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
<span class="n">xx</span><span class="p">,</span> <span class="n">yy</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.meshgrid.html#numpy.meshgrid" title="numpy.meshgrid"><span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span></a><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">image</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/util.html#pyxu.util.misc.peaks" title="pyxu.util.misc.peaks"><span class="n">peaks</span></a><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">)</span>
<span class="n">dim_shape</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># Shape of our image</span>
<span class="c1"># Specify derivative order at each direction</span>
<span class="n">df_dx</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="c1"># Compute derivative of order 1 in first dimension</span>
<span class="n">d2f_dy2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="c1"># Compute derivative of order 2 in second dimension</span>
<span class="n">d3f_dxdy2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="c1"># Compute derivative of order 1 in first dimension and der. of order 2 in second dimension</span>
<span class="c1"># Instantiate derivative operators</span>
<span class="n">diff1</span> <span class="o">=</span> <span class="n">PartialDerivative</span><span class="o">.</span><span class="n">gaussian_derivative</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="n">df_dx</span><span class="p">,</span> <span class="n">dim_shape</span><span class="o">=</span><span class="n">dim_shape</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
<span class="n">diff2</span> <span class="o">=</span> <span class="n">PartialDerivative</span><span class="o">.</span><span class="n">gaussian_derivative</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="n">d2f_dy2</span><span class="p">,</span> <span class="n">dim_shape</span><span class="o">=</span><span class="n">dim_shape</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
<span class="n">diff</span> <span class="o">=</span> <span class="n">PartialDerivative</span><span class="o">.</span><span class="n">gaussian_derivative</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="n">d3f_dxdy2</span><span class="p">,</span> <span class="n">dim_shape</span><span class="o">=</span><span class="n">dim_shape</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
<span class="c1"># Compute derivatives</span>
<span class="n">out1</span> <span class="o">=</span> <span class="p">(</span><span class="n">diff1</span> <span class="o">*</span> <span class="n">diff2</span><span class="p">)(</span><span class="n">image</span><span class="p">)</span>
<span class="n">out2</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.imshow.html#matplotlib.pyplot.imshow" title="matplotlib.pyplot.imshow"><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span></a><span class="p">(</span><span class="n">image</span><span class="p">),</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.axis.html#matplotlib.pyplot.axis" title="matplotlib.pyplot.axis"><span class="n">plt</span><span class="o">.</span><span class="n">axis</span></a><span class="p">(</span><span class="s1">'off'</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">()</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="s1">'f(x,y)'</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.imshow.html#matplotlib.pyplot.imshow" title="matplotlib.pyplot.imshow"><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span></a><span class="p">(</span><span class="n">out1</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.axis.html#matplotlib.pyplot.axis" title="matplotlib.pyplot.axis"><span class="n">plt</span><span class="o">.</span><span class="n">axis</span></a><span class="p">(</span><span class="s1">'off'</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="sa">r</span><span class="s1">'$\frac{\partial^</span><span class="si">{3}</span><span class="s1"> f(x,y)}{\partial x\partial y^</span><span class="si">{2}</span><span class="s1">}$'</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.imshow.html#matplotlib.pyplot.imshow" title="matplotlib.pyplot.imshow"><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span></a><span class="p">(</span><span class="n">out2</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.axis.html#matplotlib.pyplot.axis" title="matplotlib.pyplot.axis"><span class="n">plt</span><span class="o">.</span><span class="n">axis</span></a><span class="p">(</span><span class="s1">'off'</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="sa">r</span><span class="s1">'$\frac{\partial^</span><span class="si">{3}</span><span class="s1"> f(x,y)}{\partial x\partial y^</span><span class="si">{2}</span><span class="s1">}$'</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../_downloads/d8c134d2a8e4a675726495e10717b038/linop-9.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>)</p>
<figure class="align-default" id="id19">
<img alt="../../_images/linop-9_00.png" class="plot-directive" src="../../_images/linop-9_00.png"/>
<figcaption>
<p><span class="caption-text">(<a class="reference download internal" download="" href="../../_downloads/74f8cddbd684b43c2427659c5748191b/linop-9_00.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/0595e9ca621de57cf15fc0204149f0dd/linop-9_00.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/5b19c3c62ae35eb4489c976153e230f2/linop-9_00.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</span><a class="headerlink" href="#id19" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id20">
<img alt="../../_images/linop-9_01.png" class="plot-directive" src="../../_images/linop-9_01.png"/>
<figcaption>
<p><span class="caption-text">(<a class="reference download internal" download="" href="../../_downloads/94bf64078523d214bb64da722baf0557/linop-9_01.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/cd6aa2e99b62feb4a5db3858225dd4ff/linop-9_01.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/7cceec4a3abf2947afcf0fbf1a95fbc2/linop-9_01.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</span><a class="headerlink" href="#id20" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id21">
<img alt="../../_images/linop-9_02.png" class="plot-directive" src="../../_images/linop-9_02.png"/>
<figcaption>
<p><span class="caption-text">(<a class="reference download internal" download="" href="../../_downloads/a86bba04ee4cf9d3ab1a8e26826b6c80/linop-9_02.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/4b9d8c74452fd020914c68edfd1d559c/linop-9_02.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/426d2a51889add0a821472e3363e6c86/linop-9_02.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</span><a class="headerlink" href="#id21" title="Link to this image">#</a></p>
</figcaption>
</figure>
</dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.operator.Gradient">
<span class="sig-name descname"><span class="pre">Gradient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diff_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fd'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gpu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">diff_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/diff.html#Gradient"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.Gradient" title="Link to this definition">#</a></dt>
<dd><p>Gradient operator.</p>
<p class="rubric">Notes</p>
<p>This operator stacks the first-order partial derivatives of a <span class="math notranslate nohighlight">\(D\)</span>-dimensional signal <span class="math notranslate nohighlight">\(\mathbf{f} \in
\mathbb{R}^{N_{0} \times \cdots \times N_{D-1}}\)</span> along each dimension:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\boldsymbol{\nabla} \mathbf{f} = \begin{bmatrix}
\frac{\partial \mathbf{f}}{\partial x_0} \\
\vdots \\
\frac{\partial \mathbf{f}}{\partial x_{D-1}}
\end{bmatrix} \in \mathbb{R}^{D \times N_{0} \times \cdots \times N_{D-1}}\end{split}\]</div>
<p>The partial derivatives can be approximated by <a class="reference external" href="https://en.wikipedia.org/wiki/Finite_difference">finite differences</a> via the
<a class="reference internal" href="#pyxu.operator.PartialDerivative.finite_difference" title="pyxu.operator.PartialDerivative.finite_difference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">finite_difference()</span></code></a> constructor or by the <a class="reference external" href="https://www.crisluengo.net/archives/22/">Gaussian derivative</a> via
<a class="reference internal" href="#pyxu.operator.PartialDerivative.gaussian_derivative" title="pyxu.operator.PartialDerivative.gaussian_derivative"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gaussian_derivative()</span></code></a> constructor.
The parametrization of the partial derivatives can be done via the keyword arguments <code class="code docutils literal notranslate"><span class="pre">**diff_kwargs</span></code>, which will
default to the same values as the <a class="reference internal" href="#pyxu.operator.PartialDerivative" title="pyxu.operator.PartialDerivative"><code class="xref py py-class docutils literal notranslate"><span class="pre">PartialDerivative</span></code></a> constructor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim_shape</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArrayShape" title="pyxu.info.ptype.NDArrayShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayShape</span></code></a>) – (N_1,…,N_D) input dimensions.</p></li>
<li><p><strong>directions</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.Integer" title="pyxu.info.ptype.Integer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Integer</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[Integer]</span></code>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>) – Gradient directions.
Defaults to <code class="code docutils literal notranslate"><span class="pre">None</span></code>, which computes the gradient for all directions.</p></li>
<li><p><strong>diff_method</strong> (<code class="docutils literal notranslate"><span class="pre">'gd'</span></code>, <code class="docutils literal notranslate"><span class="pre">'fd'</span></code>) – <p>Method used to approximate the derivative.
Must be one of:</p>
<ul>
<li><p>’fd’ (default): finite differences</p></li>
<li><p>’gd’: Gaussian derivative</p></li>
</ul>
</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[str]</span></code>) – <p>Boundary conditions.
Multiple forms are accepted:</p>
<ul>
<li><p>str: unique mode shared amongst dimensions.
Must be one of:</p>
<ul>
<li><p>’constant’ (default): zero-padding</p></li>
<li><p>’wrap’</p></li>
<li><p>’reflect’</p></li>
<li><p>’symmetric’</p></li>
<li><p>’edge’</p></li>
</ul>
</li>
<li><p>tuple[str, …]: the <code class="code docutils literal notranslate"><span class="pre">d</span></code>-th dimension uses <code class="docutils literal notranslate"><span class="pre">mode[d]</span></code> as boundary condition.</p></li>
</ul>
<p>(See <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.pad.html#numpy.pad" title="(in NumPy v2.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.pad()</span></code></a> for details.)</p>
</p></li>
<li><p><strong>gpu</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Input NDArray type (<code class="code docutils literal notranslate"><span class="pre">True</span></code> for GPU, <code class="code docutils literal notranslate"><span class="pre">False</span></code> for CPU).
Defaults to <code class="code docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>dtype</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.DType" title="pyxu.info.ptype.DType"><code class="xref py py-class docutils literal notranslate"><span class="pre">DType</span></code></a>) – Working precision of the linear operator.</p></li>
<li><p><strong>diff_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>) – Keyword arguments to parametrize partial derivatives (see
<a class="reference internal" href="#pyxu.operator.PartialDerivative.finite_difference" title="pyxu.operator.PartialDerivative.finite_difference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">finite_difference()</span></code></a> and
<a class="reference internal" href="#pyxu.operator.PartialDerivative.gaussian_derivative" title="pyxu.operator.PartialDerivative.gaussian_derivative"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gaussian_derivative()</span></code></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>op</strong> – Gradient</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/index.html#module-numpy" title="numpy"><span class="nn">numpy</span></a> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/pyplot_summary.html#module-matplotlib.pyplot" title="matplotlib.pyplot"><span class="nn">matplotlib.pyplot</span></a> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">pyxu.operator</span> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.Gradient" title="pyxu.operator.Gradient"><span class="n">Gradient</span></a>
<span class="kn">from</span> <span class="nn">pyxu.util.misc</span> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/util.html#pyxu.util.misc.peaks" title="pyxu.util.misc.peaks"><span class="n">peaks</span></a>

<span class="c1"># Define input image</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">x</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.linspace.html#numpy.linspace" title="numpy.linspace"><span class="n">np</span><span class="o">.</span><span class="n">linspace</span></a><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">xx</span><span class="p">,</span> <span class="n">yy</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.meshgrid.html#numpy.meshgrid" title="numpy.meshgrid"><span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span></a><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">image</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/util.html#pyxu.util.misc.peaks" title="pyxu.util.misc.peaks"><span class="n">peaks</span></a><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">)</span>
<span class="n">dim_shape</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># (1000, 1000)</span>
<span class="c1"># Instantiate gradient operator</span>
<span class="n">grad</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.Gradient" title="pyxu.operator.Gradient"><span class="n">Gradient</span></a><span class="p">(</span><span class="n">dim_shape</span><span class="o">=</span><span class="n">dim_shape</span><span class="p">)</span>

<span class="c1"># Compute gradients</span>
<span class="n">df_dx</span><span class="p">,</span> <span class="n">df_dy</span> <span class="o">=</span> <span class="n">grad</span><span class="p">(</span><span class="n">image</span><span class="p">)</span> <span class="c1"># shape = (2, 1000, 1000)</span>

<span class="c1"># Plot image</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots" title="matplotlib.pyplot.subplots"><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span></a><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"Image"</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">"off"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># Plot gradient</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">df_dx</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$\partial f/ \partial x$"</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">"off"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">df_dy</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$\partial f/ \partial y$"</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">"off"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../_downloads/74c02ef0f5c3c0df3e96c1f5c5adc42e/linop-10.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/3566084b06716c19cd096b504dd5245c/linop-10.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/f9ba4343980bdb8f37da0283f3a6d97e/linop-10.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/c0190b5d57d3d151adb5651d8b8a1ee5/linop-10.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../../_images/linop-10.png" class="plot-directive" src="../../_images/linop-10.png"/>
</figure>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyxu.operator.PartialDerivative" title="pyxu.operator.PartialDerivative"><code class="xref py py-func docutils literal notranslate"><span class="pre">PartialDerivative()</span></code></a>, <a class="reference internal" href="#pyxu.operator.Jacobian" title="pyxu.operator.Jacobian"><code class="xref py py-func docutils literal notranslate"><span class="pre">Jacobian()</span></code></a></p>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.operator.Jacobian">
<span class="sig-name descname"><span class="pre">Jacobian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diff_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fd'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gpu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">diff_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/diff.html#Jacobian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.Jacobian" title="Link to this definition">#</a></dt>
<dd><p>Jacobian operator.</p>
<p class="rubric">Notes</p>
<p>This operator computes the first-order partial derivatives of a <span class="math notranslate nohighlight">\(D\)</span>-dimensional vector-valued signal of
<span class="math notranslate nohighlight">\(C\)</span> variables or channels <span class="math notranslate nohighlight">\(\mathbf{f} = [\mathbf{f}_{0}, \ldots, \mathbf{f}_{C-1}]\)</span> with
<span class="math notranslate nohighlight">\(\mathbf{f}_{c} \in \mathbb{R}^{N_{0} \times \cdots \times N_{D-1}}\)</span>.</p>
<p>The Jacobian of <span class="math notranslate nohighlight">\(\mathbf{f}\)</span> is computed via the gradient as follows:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{J} \mathbf{f} = \begin{bmatrix}
(\boldsymbol{\nabla} \mathbf{f}_{0})^{\top} \\
\vdots \\
(\boldsymbol{\nabla} \mathbf{f}_{C-1})^{\top} \\
\end{bmatrix} \in \mathbb{R}^{C \times D \times N_0 \times \cdots \times N_{D-1}}\end{split}\]</div>
<p>The partial derivatives can be approximated by <a class="reference external" href="https://en.wikipedia.org/wiki/Finite_difference">finite differences</a> via the
<a class="reference internal" href="#pyxu.operator.PartialDerivative.finite_difference" title="pyxu.operator.PartialDerivative.finite_difference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">finite_difference()</span></code></a> constructor or by the <a class="reference external" href="https://www.crisluengo.net/archives/22/">Gaussian derivative</a> via
<a class="reference internal" href="#pyxu.operator.PartialDerivative.gaussian_derivative" title="pyxu.operator.PartialDerivative.gaussian_derivative"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gaussian_derivative()</span></code></a> constructor.
The parametrization of the partial derivatives can be done via the keyword arguments <code class="code docutils literal notranslate"><span class="pre">**diff_kwargs</span></code>, which will
default to the same values as the <a class="reference internal" href="#pyxu.operator.PartialDerivative" title="pyxu.operator.PartialDerivative"><code class="xref py py-class docutils literal notranslate"><span class="pre">PartialDerivative</span></code></a> constructor.</p>
<p><strong>Remark</strong></p>
<p>Pyxu’s convention when it comes to field-vectors, is to work with vectorized arrays.  However, the memory order of
these arrays should be <code class="code docutils literal notranslate"><span class="pre">[S_0,</span> <span class="pre">...,</span> <span class="pre">S_B,</span> <span class="pre">C,</span> <span class="pre">N_1,</span> <span class="pre">...,</span> <span class="pre">N_D]</span></code> shape, with <code class="code docutils literal notranslate"><span class="pre">S_0,</span> <span class="pre">...,</span> <span class="pre">S_B</span></code> being stacking or batching
dimensions, <code class="code docutils literal notranslate"><span class="pre">C</span></code> being the number of variables or channels, and <code class="code docutils literal notranslate"><span class="pre">N_i</span></code> being the size of the <code class="code docutils literal notranslate"><span class="pre">i</span></code>-th axis of the domain.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim_shape</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArrayShape" title="pyxu.info.ptype.NDArrayShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayShape</span></code></a>) – (C, N_1,…,N_D) input dimensions.</p></li>
<li><p><strong>directions</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.Integer" title="pyxu.info.ptype.Integer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Integer</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[Integer]</span></code>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>) – Gradient directions.
Defaults to <code class="code docutils literal notranslate"><span class="pre">None</span></code>, which computes the gradient for all directions.</p></li>
<li><p><strong>diff_method</strong> (<code class="docutils literal notranslate"><span class="pre">"gd"</span></code>, <code class="docutils literal notranslate"><span class="pre">"fd"</span></code>) – <p>Method used to approximate the derivative.
Must be one of:</p>
<ul>
<li><p>’fd’ (default): finite differences</p></li>
<li><p>’gd’: Gaussian derivative</p></li>
</ul>
</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[str]</span></code>) – <p>Boundary conditions.
Multiple forms are accepted:</p>
<ul>
<li><p>str: unique mode shared amongst dimensions.
Must be one of:</p>
<ul>
<li><p>’constant’ (default): zero-padding</p></li>
<li><p>’wrap’</p></li>
<li><p>’reflect’</p></li>
<li><p>’symmetric’</p></li>
<li><p>’edge’</p></li>
</ul>
</li>
<li><p>tuple[str, …]: the <code class="code docutils literal notranslate"><span class="pre">d</span></code>-th dimension uses <code class="docutils literal notranslate"><span class="pre">mode[d]</span></code> as boundary condition.</p></li>
</ul>
<p>(See <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.pad.html#numpy.pad" title="(in NumPy v2.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.pad()</span></code></a> for details.)</p>
</p></li>
<li><p><strong>gpu</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Input NDArray type (<code class="code docutils literal notranslate"><span class="pre">True</span></code> for GPU, <code class="code docutils literal notranslate"><span class="pre">False</span></code> for CPU).
Defaults to <code class="code docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>dtype</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.DType" title="pyxu.info.ptype.DType"><code class="xref py py-class docutils literal notranslate"><span class="pre">DType</span></code></a>) – Working precision of the linear operator.</p></li>
<li><p><strong>diff_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>) – Keyword arguments to parametrize partial derivatives (see
<a class="reference internal" href="#pyxu.operator.PartialDerivative.finite_difference" title="pyxu.operator.PartialDerivative.finite_difference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">finite_difference()</span></code></a> and
<a class="reference internal" href="#pyxu.operator.PartialDerivative.gaussian_derivative" title="pyxu.operator.PartialDerivative.gaussian_derivative"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gaussian_derivative()</span></code></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>op</strong> – Jacobian</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/index.html#module-numpy" title="numpy"><span class="nn">numpy</span></a> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/pyplot_summary.html#module-matplotlib.pyplot" title="matplotlib.pyplot"><span class="nn">matplotlib.pyplot</span></a> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">pyxu.operator</span> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.Jacobian" title="pyxu.operator.Jacobian"><span class="n">Jacobian</span></a>
<span class="kn">from</span> <span class="nn">pyxu.util.misc</span> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/util.html#pyxu.util.misc.peaks" title="pyxu.util.misc.peaks"><span class="n">peaks</span></a>

<span class="n">x</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.linspace.html#numpy.linspace" title="numpy.linspace"><span class="n">np</span><span class="o">.</span><span class="n">linspace</span></a><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
<span class="n">xx</span><span class="p">,</span> <span class="n">yy</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.meshgrid.html#numpy.meshgrid" title="numpy.meshgrid"><span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span></a><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">image</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.tile.html#numpy.tile" title="numpy.tile"><span class="n">np</span><span class="o">.</span><span class="n">tile</span></a><span class="p">(</span><a class="sphinx-codeautolink-a" href="../../api/util.html#pyxu.util.misc.peaks" title="pyxu.util.misc.peaks"><span class="n">peaks</span></a><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">jac</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.Jacobian" title="pyxu.operator.Jacobian"><span class="n">Jacobian</span></a><span class="p">(</span><span class="n">dim_shape</span><span class="o">=</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">jac</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots" title="matplotlib.pyplot.subplots"><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span></a><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/stdtypes.html#range" title="range"><span class="nb">range</span></a><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
   <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/stdtypes.html#range" title="range"><span class="nb">range</span></a><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
       <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="p">[</span><span class="s2">"Reds"</span><span class="p">,</span> <span class="s2">"Greens"</span><span class="p">,</span> <span class="s2">"Blues"</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
       <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">"$\partial I_</span><span class="se">{{</span><span class="si">{</span><span class="p">[</span><span class="s1">'R'</span><span class="p">,</span><span class="w"> </span><span class="s1">'G'</span><span class="p">,</span><span class="w"> </span><span class="s1">'B'</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="si">}</span><span class="se">}}</span><span class="s2">/\partial</span><span class="se">{{</span><span class="si">{</span><span class="p">[</span><span class="s1">'x'</span><span class="p">,</span><span class="w"> </span><span class="s1">'y'</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="si">}</span><span class="se">}}</span><span class="s2">$"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.suptitle.html#matplotlib.pyplot.suptitle" title="matplotlib.pyplot.suptitle"><span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span></a><span class="p">(</span><span class="s2">"Jacobian"</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../_downloads/e1a75dcc78d38d076dc2ecbd8c33f9ad/linop-11.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/2f7467986cc151bf2b6b5049daf73775/linop-11.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/ddf222d68fcbe340ea8f8827e258841a/linop-11.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/720322c27d60e8bdfe2e26d9c52e0397/linop-11.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../../_images/linop-11.png" class="plot-directive" src="../../_images/linop-11.png"/>
</figure>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyxu.operator.Gradient" title="pyxu.operator.Gradient"><code class="xref py py-func docutils literal notranslate"><span class="pre">Gradient()</span></code></a>, <a class="reference internal" href="#pyxu.operator.PartialDerivative" title="pyxu.operator.PartialDerivative"><code class="xref py py-func docutils literal notranslate"><span class="pre">PartialDerivative()</span></code></a></p>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.operator.Divergence">
<span class="sig-name descname"><span class="pre">Divergence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diff_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fd'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gpu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">diff_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/diff.html#Divergence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.Divergence" title="Link to this definition">#</a></dt>
<dd><p>Divergence operator.</p>
<p class="rubric">Notes</p>
<p>This operator computes the expansion or outgoingness of a <span class="math notranslate nohighlight">\(D\)</span>-dimensional vector-valued signal of <span class="math notranslate nohighlight">\(C\)</span>
variables <span class="math notranslate nohighlight">\(\mathbf{f} = [\mathbf{f}_{0}, \ldots, \mathbf{f}_{C-1}]\)</span> with <span class="math notranslate nohighlight">\(\mathbf{f}_{c} \in
\mathbb{R}^{N_{0} \times \cdots \times N_{D-1}}\)</span>.</p>
<p>The Divergence of <span class="math notranslate nohighlight">\(\mathbf{f}\)</span> is computed via the adjoint of the gradient as follows:</p>
<div class="math notranslate nohighlight">
\[\operatorname{Div} \mathbf{f} = \boldsymbol{\nabla}^{\ast} \mathbf{f}
= \begin{bmatrix}
\frac{\partial \mathbf{f}}{\partial x_0} + \cdots + \frac{\partial \mathbf{f}}{\partial x_{D-1}}
\end{bmatrix} \in \mathbb{R}^{N_{0} \times \cdots \times N_{D-1}}\]</div>
<p>The partial derivatives can be approximated by <a class="reference external" href="https://en.wikipedia.org/wiki/Finite_difference">finite differences</a> via the
<a class="reference internal" href="#pyxu.operator.PartialDerivative.finite_difference" title="pyxu.operator.PartialDerivative.finite_difference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">finite_difference()</span></code></a> constructor or by the <a class="reference external" href="https://www.crisluengo.net/archives/22/">Gaussian derivative</a> via
<a class="reference internal" href="#pyxu.operator.PartialDerivative.gaussian_derivative" title="pyxu.operator.PartialDerivative.gaussian_derivative"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gaussian_derivative()</span></code></a> constructor.
The parametrization of the partial derivatives can be done via the keyword arguments <code class="code docutils literal notranslate"><span class="pre">**diff_kwargs</span></code>, which will
default to the same values as the <a class="reference internal" href="#pyxu.operator.PartialDerivative" title="pyxu.operator.PartialDerivative"><code class="xref py py-class docutils literal notranslate"><span class="pre">PartialDerivative</span></code></a> constructor.</p>
<p>When using finite differences to compute the Divergence (i.e., <code class="docutils literal notranslate"><span class="pre">diff_method</span> <span class="pre">=</span> <span class="pre">"fd"</span></code>), the divergence returns the
adjoint of the gradient in reversed order:</p>
<ul class="simple">
<li><p>For <code class="docutils literal notranslate"><span class="pre">forward</span></code> type divergence, the adjoint of the gradient of “backward” type is used.</p></li>
<li><p>For <code class="docutils literal notranslate"><span class="pre">backward</span></code> type divergence, the adjoint of the gradient of “forward” type is used.</p></li>
</ul>
<p>For <code class="docutils literal notranslate"><span class="pre">central</span></code> type divergence, and for the Gaussian derivative method (i.e., <code class="docutils literal notranslate"><span class="pre">diff_method</span> <span class="pre">=</span> <span class="pre">"gd"</span></code>), the adjoint
of the gradient of “central” type is used (no reversed order).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim_shape</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArrayShape" title="pyxu.info.ptype.NDArrayShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayShape</span></code></a>) – (C, N_1,…,N_D) input dimensions.</p></li>
<li><p><strong>directions</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.Integer" title="pyxu.info.ptype.Integer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Integer</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[Integer]</span></code>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>) – Divergence directions.
Defaults to <code class="code docutils literal notranslate"><span class="pre">None</span></code>, which computes the divergence for all directions.</p></li>
<li><p><strong>diff_method</strong> (<code class="docutils literal notranslate"><span class="pre">"gd"</span></code>, <code class="docutils literal notranslate"><span class="pre">"fd"</span></code>) – <p>Method used to approximate the derivative.
Must be one of:</p>
<ul>
<li><p>’fd’ (default): finite differences</p></li>
<li><p>’gd’: Gaussian derivative</p></li>
</ul>
</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[str]</span></code>) – <p>Boundary conditions.
Multiple forms are accepted:</p>
<ul>
<li><p>str: unique mode shared amongst dimensions.
Must be one of:</p>
<ul>
<li><p>’constant’ (default): zero-padding</p></li>
<li><p>’wrap’</p></li>
<li><p>’reflect’</p></li>
<li><p>’symmetric’</p></li>
<li><p>’edge’</p></li>
</ul>
</li>
<li><p>tuple[str, …]: the <code class="code docutils literal notranslate"><span class="pre">d</span></code>-th dimension uses <code class="docutils literal notranslate"><span class="pre">mode[d]</span></code> as boundary condition.</p></li>
</ul>
<p>(See <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.pad.html#numpy.pad" title="(in NumPy v2.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.pad()</span></code></a> for details.)</p>
</p></li>
<li><p><strong>gpu</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Input NDArray type (<code class="code docutils literal notranslate"><span class="pre">True</span></code> for GPU, <code class="code docutils literal notranslate"><span class="pre">False</span></code> for CPU).
Defaults to <code class="code docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>dtype</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.DType" title="pyxu.info.ptype.DType"><code class="xref py py-class docutils literal notranslate"><span class="pre">DType</span></code></a>) – Working precision of the linear operator.</p></li>
<li><p><strong>diff_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>) – Keyword arguments to parametrize partial derivatives (see
<a class="reference internal" href="#pyxu.operator.PartialDerivative.finite_difference" title="pyxu.operator.PartialDerivative.finite_difference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">finite_difference()</span></code></a> and
<a class="reference internal" href="#pyxu.operator.PartialDerivative.gaussian_derivative" title="pyxu.operator.PartialDerivative.gaussian_derivative"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gaussian_derivative()</span></code></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>op</strong> – Divergence</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/index.html#module-numpy" title="numpy"><span class="nn">numpy</span></a> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/pyplot_summary.html#module-matplotlib.pyplot" title="matplotlib.pyplot"><span class="nn">matplotlib.pyplot</span></a> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">pyxu.operator</span> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.Gradient" title="pyxu.operator.Gradient"><span class="n">Gradient</span></a><span class="p">,</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.Divergence" title="pyxu.operator.Divergence"><span class="n">Divergence</span></a><span class="p">,</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.Laplacian" title="pyxu.operator.Laplacian"><span class="n">Laplacian</span></a>
<span class="kn">from</span> <span class="nn">pyxu.util.misc</span> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/util.html#pyxu.util.misc.peaks" title="pyxu.util.misc.peaks"><span class="n">peaks</span></a>

<span class="n">n</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">x</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.linspace.html#numpy.linspace" title="numpy.linspace"><span class="n">np</span><span class="o">.</span><span class="n">linspace</span></a><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">xx</span><span class="p">,</span> <span class="n">yy</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.meshgrid.html#numpy.meshgrid" title="numpy.meshgrid"><span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span></a><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">image</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/util.html#pyxu.util.misc.peaks" title="pyxu.util.misc.peaks"><span class="n">peaks</span></a><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">)</span>
<span class="n">dim_shape</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># (1000, 1000)</span>
<span class="n">grad</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.Gradient" title="pyxu.operator.Gradient"><span class="n">Gradient</span></a><span class="p">(</span><span class="n">dim_shape</span><span class="o">=</span><span class="n">dim_shape</span><span class="p">)</span>
<span class="n">div</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.Divergence" title="pyxu.operator.Divergence"><span class="n">Divergence</span></a><span class="p">(</span><span class="n">dim_shape</span><span class="o">=</span><span class="n">dim_shape</span><span class="p">)</span>
<span class="c1"># Construct Laplacian via composition</span>
<span class="n">laplacian1</span> <span class="o">=</span> <span class="n">div</span> <span class="o">*</span> <span class="n">grad</span>
<span class="c1"># Compare to default Laplacian</span>
<span class="n">laplacian2</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.Laplacian" title="pyxu.operator.Laplacian"><span class="n">Laplacian</span></a><span class="p">(</span><span class="n">dim_shape</span><span class="o">=</span><span class="n">dim_shape</span><span class="p">)</span>
<span class="n">output1</span> <span class="o">=</span> <span class="n">laplacian1</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<span class="n">output2</span> <span class="o">=</span> <span class="n">laplacian2</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots" title="matplotlib.pyplot.subplots"><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span></a><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.log.html#numpy.log" title="numpy.log"><span class="n">np</span><span class="o">.</span><span class="n">log</span></a><span class="p">(</span><a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#abs" title="abs"><span class="nb">abs</span></a><span class="p">(</span><span class="n">output1</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">*</span><span class="n">dim_shape</span><span class="p">))</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"Laplacian via composition"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.log.html#numpy.log" title="numpy.log"><span class="n">np</span><span class="o">.</span><span class="n">log</span></a><span class="p">(</span><a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#abs" title="abs"><span class="nb">abs</span></a><span class="p">(</span><span class="n">output1</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">*</span><span class="n">dim_shape</span><span class="p">))</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"Default Laplacian"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../_downloads/7a277daee554ebe111b667c4f725a8be/linop-12.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>)</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyxu.operator.Gradient" title="pyxu.operator.Gradient"><code class="xref py py-func docutils literal notranslate"><span class="pre">Gradient()</span></code></a>, <a class="reference internal" href="#pyxu.operator.PartialDerivative" title="pyxu.operator.PartialDerivative"><code class="xref py py-func docutils literal notranslate"><span class="pre">PartialDerivative()</span></code></a></p>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.operator.Hessian">
<span class="sig-name descname"><span class="pre">Hessian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diff_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fd'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gpu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">diff_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/diff.html#Hessian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.Hessian" title="Link to this definition">#</a></dt>
<dd><p>Hessian operator.</p>
<p class="rubric">Notes</p>
<p>The Hessian matrix or Hessian of a <span class="math notranslate nohighlight">\(D\)</span>-dimensional signal <span class="math notranslate nohighlight">\(\mathbf{f} \in \mathbb{R}^{N_0 \times \cdots
\times N_{D-1}}\)</span> is the square matrix of second-order partial derivatives:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{H} \mathbf{f} = \begin{bmatrix}
\dfrac{ \partial^{2}\mathbf{f} }{ \partial x_{0}^{2} } &amp;  \dfrac{ \partial^{2}\mathbf{f} }{ \partial x_{0}\,\partial x_{1} } &amp; \cdots &amp; \dfrac{ \partial^{2}\mathbf{f} }{ \partial x_{0} \, \partial x_{D-1} } \\
\dfrac{ \partial^{2}\mathbf{f} }{ \partial x_{1} \, \partial x_{0} } &amp; \dfrac{ \partial^{2}\mathbf{f} }{ \partial x_{1}^{2} } &amp; \cdots &amp; \dfrac{ \partial^{2}\mathbf{f} }{\partial x_{1} \,\partial x_{D-1}} \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
\dfrac{ \partial^{2}\mathbf{f} }{ \partial x_{D-1} \, \partial x_{0} } &amp; \dfrac{ \partial^{2}\mathbf{f} }{ \partial x_{D-1} \, \partial x_{1} } &amp; \cdots &amp; \dfrac{ \partial^{2}\mathbf{f} }{ \partial x_{D-1}^{2}}
\end{bmatrix}\end{split}\]</div>
<p>The partial derivatives can be approximated by <a class="reference external" href="https://en.wikipedia.org/wiki/Finite_difference">finite differences</a> via the
<a class="reference internal" href="#pyxu.operator.PartialDerivative.finite_difference" title="pyxu.operator.PartialDerivative.finite_difference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">finite_difference()</span></code></a> constructor or by the <a class="reference external" href="https://www.crisluengo.net/archives/22/">Gaussian derivative</a> via
<a class="reference internal" href="#pyxu.operator.PartialDerivative.gaussian_derivative" title="pyxu.operator.PartialDerivative.gaussian_derivative"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gaussian_derivative()</span></code></a> constructor.
The parametrization of the partial derivatives can be done via the keyword arguments <code class="code docutils literal notranslate"><span class="pre">**diff_kwargs</span></code>, which will
default to the same values as the <a class="reference internal" href="#pyxu.operator.PartialDerivative" title="pyxu.operator.PartialDerivative"><code class="xref py py-class docutils literal notranslate"><span class="pre">PartialDerivative</span></code></a> constructor.</p>
<p>The Hessian being symmetric, only the upper triangular part at most needs to be computed.
Due to the (possibly) large size of the full Hessian, 4 different options are handled:</p>
<ul>
<li><p>[mode 0] <code class="docutils literal notranslate"><span class="pre">directions</span></code> is an integer, e.g.: <code class="docutils literal notranslate"><span class="pre">directions=0</span></code></p>
<div class="math notranslate nohighlight">
\[\partial^{2}\mathbf{f}/\partial x_{0}^{2}.\]</div>
</li>
<li><p>[mode 1] <code class="docutils literal notranslate"><span class="pre">directions</span></code> is a tuple of length 2, e.g.: <code class="docutils literal notranslate"><span class="pre">directions=(0,1)</span></code></p>
<div class="math notranslate nohighlight">
\[\partial^{2}\mathbf{f}/\partial x_{0}\partial x_{1}.\]</div>
</li>
<li><p>[mode 2] <code class="docutils literal notranslate"><span class="pre">directions</span></code> is a tuple of tuples, e.g.: <code class="docutils literal notranslate"><span class="pre">directions=((0,0),</span> <span class="pre">(0,1))</span></code></p>
<div class="math notranslate nohighlight">
\[\left(\frac{ \partial^{2}\mathbf{f} }{ \partial x_{0}^{2} }, \frac{ \partial^{2}\mathbf{f} }{ \partial x_{0}\partial x_{1} }\right).\]</div>
</li>
<li><p>[mode 3] <code class="docutils literal notranslate"><span class="pre">directions</span> <span class="pre">=</span> <span class="pre">'all'</span></code> (default), computes the Hessian for all directions (only the
upper triangular part of the Hessian matrix), in row order, i.e.:</p>
<div class="math notranslate nohighlight">
\[\left(\frac{ \partial^{2}\mathbf{f} }{ \partial x_{0}^{2} }, \frac{ \partial^{2}\mathbf{f} }
{ \partial x_{0}\partial x_{1} }, \, \ldots , \, \frac{ \partial^{2}\mathbf{f} }{ \partial x_{D-1}^{2} }\right).\]</div>
</li>
</ul>
<p>The shape of the output <a class="reference internal" href="../abc.html#pyxu.abc.LinOp" title="pyxu.abc.LinOp"><code class="xref py py-class docutils literal notranslate"><span class="pre">LinOp</span></code></a> depends on the number of computed directions; by
default (all directions), we have <span class="math notranslate nohighlight">\(\mathbf{H} \mathbf{f} \in \mathbb{R}^{\frac{D(D-1)}{2} \times N_0 \times
\cdots \times N_{D-1}}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim_shape</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArrayShape" title="pyxu.info.ptype.NDArrayShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayShape</span></code></a>) – (N_1,…,N_D) input dimensions.</p></li>
<li><p><strong>directions</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.Integer" title="pyxu.info.ptype.Integer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Integer</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">(Integer</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Integer)</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">((Integer</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Integer)</span></code>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#Ellipsis" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">...</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">(Integer</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Integer))</span></code>, <code class="docutils literal notranslate"><span class="pre">'all'</span></code>) – Hessian directions.
Defaults to <code class="code docutils literal notranslate"><span class="pre">all</span></code>, which computes the Hessian for all directions. (See <code class="docutils literal notranslate"><span class="pre">Notes</span></code>.)</p></li>
<li><p><strong>diff_method</strong> (<code class="docutils literal notranslate"><span class="pre">"gd"</span></code>, <code class="docutils literal notranslate"><span class="pre">"fd"</span></code>) – <p>Method used to approximate the derivative.
Must be one of:</p>
<ul>
<li><p>’fd’ (default): finite differences</p></li>
<li><p>’gd’: Gaussian derivative</p></li>
</ul>
</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[str]</span></code>) – <p>Boundary conditions.
Multiple forms are accepted:</p>
<ul>
<li><p>str: unique mode shared amongst dimensions.
Must be one of:</p>
<ul>
<li><p>’constant’ (default): zero-padding</p></li>
<li><p>’wrap’</p></li>
<li><p>’reflect’</p></li>
<li><p>’symmetric’</p></li>
<li><p>’edge’</p></li>
</ul>
</li>
<li><p>tuple[str, …]: the <code class="code docutils literal notranslate"><span class="pre">d</span></code>-th dimension uses <code class="docutils literal notranslate"><span class="pre">mode[d]</span></code> as boundary condition.</p></li>
</ul>
<p>(See <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.pad.html#numpy.pad" title="(in NumPy v2.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.pad()</span></code></a> for details.)</p>
</p></li>
<li><p><strong>gpu</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Input NDArray type (<code class="code docutils literal notranslate"><span class="pre">True</span></code> for GPU, <code class="code docutils literal notranslate"><span class="pre">False</span></code> for CPU).
Defaults to <code class="code docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>dtype</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.DType" title="pyxu.info.ptype.DType"><code class="xref py py-class docutils literal notranslate"><span class="pre">DType</span></code></a>) – Working precision of the linear operator.</p></li>
<li><p><strong>diff_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>) – Keyword arguments to parametrize partial derivatives (see
<a class="reference internal" href="#pyxu.operator.PartialDerivative.finite_difference" title="pyxu.operator.PartialDerivative.finite_difference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">finite_difference()</span></code></a> and
<a class="reference internal" href="#pyxu.operator.PartialDerivative.gaussian_derivative" title="pyxu.operator.PartialDerivative.gaussian_derivative"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gaussian_derivative()</span></code></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>op</strong> – Hessian</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/index.html#module-numpy" title="numpy"><span class="nn">numpy</span></a> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/pyplot_summary.html#module-matplotlib.pyplot" title="matplotlib.pyplot"><span class="nn">matplotlib.pyplot</span></a> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">pyxu.operator</span> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.Hessian" title="pyxu.operator.Hessian"><span class="n">Hessian</span></a><span class="p">,</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.PartialDerivative" title="pyxu.operator.linop.diff.PartialDerivative"><span class="n">PartialDerivative</span></a>
<span class="kn">from</span> <span class="nn">pyxu.util.misc</span> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/util.html#pyxu.util.misc.peaks" title="pyxu.util.misc.peaks"><span class="n">peaks</span></a>

<span class="n">n</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">x</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.linspace.html#numpy.linspace" title="numpy.linspace"><span class="n">np</span><span class="o">.</span><span class="n">linspace</span></a><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">xx</span><span class="p">,</span> <span class="n">yy</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.meshgrid.html#numpy.meshgrid" title="numpy.meshgrid"><span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span></a><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">image</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/util.html#pyxu.util.misc.peaks" title="pyxu.util.misc.peaks"><span class="n">peaks</span></a><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">)</span>
<span class="n">dim_shape</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># (1000, 1000)</span>

<span class="c1"># Instantiate Hessian operator</span>
<span class="n">hessian</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.Hessian" title="pyxu.operator.Hessian"><span class="n">Hessian</span></a><span class="p">(</span><span class="n">dim_shape</span><span class="o">=</span><span class="n">dim_shape</span><span class="p">,</span> <span class="n">directions</span><span class="o">=</span><span class="s2">"all"</span><span class="p">)</span>
<span class="c1"># Compute Hessian</span>
<span class="n">d2f_dx2</span><span class="p">,</span> <span class="n">d2f_dxdy</span><span class="p">,</span> <span class="n">d2f_dy2</span> <span class="o">=</span> <span class="n">hessian</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>

<span class="c1"># Plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots" title="matplotlib.pyplot.subplots"><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span></a><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"Image"</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">"off"</span><span class="p">)</span>

<span class="n">im</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">d2f_dx2</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$\partial^</span><span class="si">{2}</span><span class="s2"> f/ \partial x^</span><span class="si">{2}</span><span class="s2">$"</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">"off"</span><span class="p">)</span>

<span class="n">im</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">d2f_dxdy</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$\partial^</span><span class="si">{2}</span><span class="s2"> f/ \partial x\partial y$"</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">"off"</span><span class="p">)</span>

<span class="n">im</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">d2f_dy2</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$\partial^</span><span class="si">{2}</span><span class="s2"> f/ \partial y^</span><span class="si">{2}</span><span class="s2">$"</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">"off"</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../_downloads/0621d0c54bd7a885d7e18dbeba324de3/linop-13.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/4908d05cb544c527b4a3224ba661682f/linop-13.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/61043f3cd7a41ebf11f3a5f9c4c40632/linop-13.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/b2643be9761ce6a5244d11d98408529f/linop-13.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../../_images/linop-13.png" class="plot-directive" src="../../_images/linop-13.png"/>
</figure>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyxu.operator.PartialDerivative" title="pyxu.operator.PartialDerivative"><code class="xref py py-class docutils literal notranslate"><span class="pre">PartialDerivative</span></code></a>, <a class="reference internal" href="#pyxu.operator.Gradient" title="pyxu.operator.Gradient"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gradient</span></code></a>, <a class="reference internal" href="#pyxu.operator.Laplacian" title="pyxu.operator.Laplacian"><code class="xref py py-class docutils literal notranslate"><span class="pre">Laplacian</span></code></a></p>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.operator.Laplacian">
<span class="sig-name descname"><span class="pre">Laplacian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diff_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fd'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gpu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">diff_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/diff.html#Laplacian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.Laplacian" title="Link to this definition">#</a></dt>
<dd><p>Laplacian operator.</p>
<p class="rubric">Notes</p>
<p>The Laplacian of a <span class="math notranslate nohighlight">\(D\)</span>-dimensional signal <span class="math notranslate nohighlight">\(\mathbf{f} \in \mathbb{R}^{N_0 \times \cdots \times N_{D-1}}\)</span>
is the sum of second-order partial derivatives across all input directions:</p>
<div class="math notranslate nohighlight">
\[\sum_{d = 0}^{D-1} \dfrac{ \partial^{2}\mathbf{f} }{ \partial x_{d}^{2} }\]</div>
<p>The partial derivatives can be approximated by <a class="reference external" href="https://en.wikipedia.org/wiki/Finite_difference">finite differences</a> via the
<a class="reference internal" href="#pyxu.operator.PartialDerivative.finite_difference" title="pyxu.operator.PartialDerivative.finite_difference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">finite_difference()</span></code></a> constructor or by the <a class="reference external" href="https://www.crisluengo.net/archives/22/">Gaussian derivative</a> via
<a class="reference internal" href="#pyxu.operator.PartialDerivative.gaussian_derivative" title="pyxu.operator.PartialDerivative.gaussian_derivative"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gaussian_derivative()</span></code></a> constructor.
The parametrization of the partial derivatives can be done via the keyword arguments <code class="code docutils literal notranslate"><span class="pre">**diff_kwargs</span></code>, which will
default to <code class="code docutils literal notranslate"><span class="pre">scheme='central'</span></code> and <code class="code docutils literal notranslate"><span class="pre">accuracy=2</span></code> for <code class="code docutils literal notranslate"><span class="pre">diff_method='fd'</span></code> (finite difference), and the same values as
the <a class="reference internal" href="#pyxu.operator.PartialDerivative" title="pyxu.operator.PartialDerivative"><code class="xref py py-class docutils literal notranslate"><span class="pre">PartialDerivative</span></code></a> constructor for <code class="code docutils literal notranslate"><span class="pre">diff_method='gd'</span></code> (gaussian
derivative).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim_shape</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArrayShape" title="pyxu.info.ptype.NDArrayShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayShape</span></code></a>) – (N_1,…,N_D) input dimensions.</p></li>
<li><p><strong>directions</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.Integer" title="pyxu.info.ptype.Integer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Integer</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[Integer]</span></code>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>) – Laplacian directions. Defaults to <code class="code docutils literal notranslate"><span class="pre">None</span></code>, which computes the Laplacian with all directions.</p></li>
<li><p><strong>diff_method</strong> (<code class="docutils literal notranslate"><span class="pre">"gd"</span></code>, <code class="docutils literal notranslate"><span class="pre">"fd"</span></code>) – <p>Method used to approximate the derivative.
Must be one of:</p>
<ul>
<li><p>’fd’ (default): finite differences</p></li>
<li><p>’gd’: Gaussian derivative</p></li>
</ul>
</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[str]</span></code>) – <p>Boundary conditions.
Multiple forms are accepted:</p>
<ul>
<li><p>str: unique mode shared amongst dimensions.
Must be one of:</p>
<ul>
<li><p>’constant’ (default): zero-padding</p></li>
<li><p>’wrap’</p></li>
<li><p>’reflect’</p></li>
<li><p>’symmetric’</p></li>
<li><p>’edge’</p></li>
</ul>
</li>
<li><p>tuple[str, …]: the <code class="code docutils literal notranslate"><span class="pre">d</span></code>-th dimension uses <code class="docutils literal notranslate"><span class="pre">mode[d]</span></code> as boundary condition.</p></li>
</ul>
<p>(See <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.pad.html#numpy.pad" title="(in NumPy v2.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.pad()</span></code></a> for details.)</p>
</p></li>
<li><p><strong>gpu</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Input NDArray type (<code class="code docutils literal notranslate"><span class="pre">True</span></code> for GPU, <code class="code docutils literal notranslate"><span class="pre">False</span></code> for CPU).
Defaults to <code class="code docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>dtype</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.DType" title="pyxu.info.ptype.DType"><code class="xref py py-class docutils literal notranslate"><span class="pre">DType</span></code></a>) – Working precision of the linear operator.</p></li>
<li><p><strong>diff_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>) – Keyword arguments to parametrize partial derivatives (see
<a class="reference internal" href="#pyxu.operator.PartialDerivative.finite_difference" title="pyxu.operator.PartialDerivative.finite_difference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">finite_difference()</span></code></a> and
<a class="reference internal" href="#pyxu.operator.PartialDerivative.gaussian_derivative" title="pyxu.operator.PartialDerivative.gaussian_derivative"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gaussian_derivative()</span></code></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>op</strong> – Laplacian</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/index.html#module-numpy" title="numpy"><span class="nn">numpy</span></a> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/pyplot_summary.html#module-matplotlib.pyplot" title="matplotlib.pyplot"><span class="nn">matplotlib.pyplot</span></a> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">pyxu.operator</span> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.Laplacian" title="pyxu.operator.Laplacian"><span class="n">Laplacian</span></a>
<span class="kn">from</span> <span class="nn">pyxu.util.misc</span> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/util.html#pyxu.util.misc.peaks" title="pyxu.util.misc.peaks"><span class="n">peaks</span></a>

<span class="c1"># Define input image</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">x</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.linspace.html#numpy.linspace" title="numpy.linspace"><span class="n">np</span><span class="o">.</span><span class="n">linspace</span></a><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">xx</span><span class="p">,</span> <span class="n">yy</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.meshgrid.html#numpy.meshgrid" title="numpy.meshgrid"><span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span></a><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">image</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/util.html#pyxu.util.misc.peaks" title="pyxu.util.misc.peaks"><span class="n">peaks</span></a><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">)</span>

<span class="n">dim_shape</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># (1000, 1000)</span>
<span class="c1"># Compute Laplacian</span>
<span class="n">laplacian</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.Laplacian" title="pyxu.operator.Laplacian"><span class="n">Laplacian</span></a><span class="p">(</span><span class="n">dim_shape</span><span class="o">=</span><span class="n">dim_shape</span><span class="p">)</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">laplacian</span><span class="p">(</span><span class="n">image</span><span class="p">)</span> <span class="c1"># shape = (1, 1000, 1000)</span>

<span class="c1"># Plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots" title="matplotlib.pyplot.subplots"><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span></a><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"Image"</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">"off"</span><span class="p">)</span>

<span class="n">im</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">squeeze</span><span class="p">())</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$\partial^</span><span class="si">{2}</span><span class="s2"> f/ \partial x^</span><span class="si">{2}</span><span class="s2">+\partial^</span><span class="si">{2}</span><span class="s2"> f/ \partial y^</span><span class="si">{2}</span><span class="s2">$"</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">"off"</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../_downloads/d899da601481b1ad85c1f7f702fa7044/linop-14.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/20c9215929fd9d943331468699173a26/linop-14.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/7c6a196c5691e8874ae3fb42a191bc83/linop-14.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/46ba4351fee97ccd2e3d0aba89e7413d/linop-14.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../../_images/linop-14.png" class="plot-directive" src="../../_images/linop-14.png"/>
</figure>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyxu.operator.PartialDerivative" title="pyxu.operator.PartialDerivative"><code class="xref py py-class docutils literal notranslate"><span class="pre">PartialDerivative</span></code></a>, <a class="reference internal" href="#pyxu.operator.Gradient" title="pyxu.operator.Gradient"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gradient</span></code></a>, <a class="reference internal" href="#pyxu.operator.Hessian" title="pyxu.operator.Hessian"><code class="xref py py-class docutils literal notranslate"><span class="pre">Hessian</span></code></a></p>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.operator.DirectionalDerivative">
<span class="sig-name descname"><span class="pre">DirectionalDerivative</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diff_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fd'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">diff_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/diff.html#DirectionalDerivative"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.DirectionalDerivative" title="Link to this definition">#</a></dt>
<dd><p>Directional derivative operator.</p>
<p class="rubric">Notes</p>
<p>The <strong>first-order</strong> <code class="docutils literal notranslate"><span class="pre">DirectionalDerivative</span></code> of a <span class="math notranslate nohighlight">\(D\)</span>-dimensional signal <span class="math notranslate nohighlight">\(\mathbf{f} \in
\mathbb{R}^{N_0 \times \cdots \times N_{D-1}}\)</span> applies a derivative along the direction specified by a constant
unitary vector <span class="math notranslate nohighlight">\(\mathbf{v} \in \mathbb{R}^D\)</span>:</p>
<div class="math notranslate nohighlight">
\[\boldsymbol{\nabla}_\mathbf{v} \mathbf{f} = \sum_{i=0}^{D-1} v_i \frac{\partial \mathbf{f}}{\partial x_i} \in
\mathbb{R}^{N_0 \times \cdots \times N_{D-1}}\]</div>
<p>or along spatially-varying directions <span class="math notranslate nohighlight">\(\mathbf{v} = [\mathbf{v}_0, \ldots , \mathbf{v}_{D-1}]^\top \in
\mathbb{R}^{D \times N_0 \times \cdots \times N_{D-1} }\)</span> where each direction <span class="math notranslate nohighlight">\(\mathbf{v}_{\cdot, i_0, \ldots
, i_{D-1}} \in \mathbb{R}^D\)</span> for any <span class="math notranslate nohighlight">\(0 \leq i_d \leq N_d-1\)</span> with <span class="math notranslate nohighlight">\(0 \leq d \leq D-1\)</span> is a unitary
vector:</p>
<div class="math notranslate nohighlight">
\[\boldsymbol{\nabla}_\mathbf{v} \mathbf{f} = \sum_{i=0}^{D-1} \mathbf{v}_i \odot
\frac{\partial \mathbf{f}}{\partial x_i} \in \mathbb{R}^{N_0 \times \cdots \times N_{D-1}},\]</div>
<p>where <span class="math notranslate nohighlight">\(\odot\)</span> denotes the Hadamard (elementwise) product.</p>
<p>Note that choosing <span class="math notranslate nohighlight">\(\mathbf{v}= \mathbf{e}_d \in \mathbb{R}^D\)</span> (the <span class="math notranslate nohighlight">\(d\)</span>-th canonical basis vector)
amounts to the first-order <a class="reference internal" href="#pyxu.operator.PartialDerivative" title="pyxu.operator.PartialDerivative"><code class="xref py py-func docutils literal notranslate"><span class="pre">PartialDerivative()</span></code></a> operator applied along axis
<span class="math notranslate nohighlight">\(d\)</span>.</p>
<p>The <strong>second-order</strong> <code class="docutils literal notranslate"><span class="pre">DirectionalDerivative</span></code> <span class="math notranslate nohighlight">\(\boldsymbol{\nabla}^2_{\mathbf{v}_{1, 2}}\)</span> is obtained by
composing the first-order directional derivatives <span class="math notranslate nohighlight">\(\boldsymbol{\nabla}_{\mathbf{v}_{1}}\)</span> and
<span class="math notranslate nohighlight">\(\boldsymbol{\nabla}_{\mathbf{v}_{2}}\)</span>:</p>
<div class="math notranslate nohighlight">
\[\boldsymbol{\nabla}_{\mathbf{v}_{1}} (\boldsymbol{\nabla}_{\mathbf{v}_{2}} \mathbf{f}) =
\boldsymbol{\nabla}_{\mathbf{v}_{1}} (\sum_{i=0}^{D-1} {v_{2}}_{i} \frac{\partial \mathbf{f}}{\partial x_i}) =
\sum_{j=0}^{D-1} {v_{1}}_{j} \frac{\partial}{\partial x_j} (\sum_{i=0}^{D-1} {v_{2}}_{i} \frac{\partial \mathbf{f}}{\partial x_i}) =
\sum_{i, j=0}^{D-1} {v_{1}}_{j} {v_{2}}_{i} \frac{\partial}{\partial x_j} \frac{\partial}{\partial x_i}\mathbf{f} =
\mathbf{v}_{1}^{\top}\mathbf{H}\mathbf{f}\mathbf{v}_{2},\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{H}\)</span> is the discrete Hessian operator, implemented via
<a class="reference internal" href="#pyxu.operator.Hessian" title="pyxu.operator.Hessian"><code class="xref py py-class docutils literal notranslate"><span class="pre">Hessian</span></code></a>.</p>
<p>Higher-order <code class="docutils literal notranslate"><span class="pre">DirectionalDerivative</span></code> <span class="math notranslate nohighlight">\(\boldsymbol{\nabla}^{N}_\mathbf{v}\)</span> can be obtained by composing the
first-order directional derivative <span class="math notranslate nohighlight">\(\boldsymbol{\nabla}_\mathbf{v}\)</span> <span class="math notranslate nohighlight">\(N\)</span> times.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<ul class="simple">
<li><p><a class="reference internal" href="#pyxu.operator.DirectionalDerivative" title="pyxu.operator.DirectionalDerivative"><code class="xref py py-func docutils literal notranslate"><span class="pre">DirectionalDerivative()</span></code></a> instances are <strong>not array module-agnostic</strong>: they
will only work with NDArrays belonging to the same array module as <code class="docutils literal notranslate"><span class="pre">directions</span></code>. Inner
computations may recast input arrays when the precision of <code class="docutils literal notranslate"><span class="pre">directions</span></code> does not match the user-requested
precision.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">directions</span></code> are always normalized to be unit vectors.</p></li>
</ul>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim_shape</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArrayShape" title="pyxu.info.ptype.NDArrayShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayShape</span></code></a>) – Shape of the input array.</p></li>
<li><p><strong>order</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.Integer" title="pyxu.info.ptype.Integer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Integer</span></code></a>) – Which directional derivative (restricted to 1: First or 2: Second, see <code class="docutils literal notranslate"><span class="pre">Notes</span></code>).</p></li>
<li><p><strong>directions</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArray</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>) – <p>For <code class="docutils literal notranslate"><span class="pre">order=1</span></code>, it can be a single direction (array of size <span class="math notranslate nohighlight">\((D,)\)</span>, where <span class="math notranslate nohighlight">\(D\)</span> is the number of
axes) or spatially-varying directions:</p>
<ul>
<li><p>array of size <span class="math notranslate nohighlight">\((D, N_0 \times \ldots \times N_{D-1})\)</span> for <code class="docutils literal notranslate"><span class="pre">order=1</span></code>, i.e., one direction per element
in the gradient, and,</p></li>
<li><p>array of size <span class="math notranslate nohighlight">\((D * (D + 1) / 2, N_0 \times \ldots \times N_{D-1})\)</span> for <code class="docutils literal notranslate"><span class="pre">order=2</span></code>, i.e., one direction
per element in the Hessian.</p></li>
</ul>
<p>For <code class="docutils literal notranslate"><span class="pre">order=2</span></code>, it can be a tuple/list of two single directions or spatially-varying dimensions of the same
shape, which will compute <span class="math notranslate nohighlight">\(\mathbf{v}_{1}^{\top}\mathbf{H}\mathbf{f}\mathbf{v}_{2}\)</span> or a single direction,
as for <code class="docutils literal notranslate"><span class="pre">order=1</span></code>, which will compute <span class="math notranslate nohighlight">\(\mathbf{v}_{1}^{\top}\mathbf{H}\mathbf{f}\mathbf{v}_{1}\)</span>. Note
that for <code class="docutils literal notranslate"><span class="pre">order=2</span></code>, even though directions are spatially-varying, no differentiation is performed for this
parameter.</p>
</p></li>
<li><p><strong>diff_method</strong> (<code class="docutils literal notranslate"><span class="pre">"gd"</span></code>, <code class="docutils literal notranslate"><span class="pre">"fd"</span></code>) – <p>Method used to approximate the derivative. Must be one of:</p>
<ul>
<li><p>’fd’ (default): finite differences</p></li>
<li><p>’gd’: Gaussian derivative</p></li>
</ul>
</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[str]</span></code>) – <p>Boundary conditions.
Multiple forms are accepted:</p>
<ul>
<li><p>str: unique mode shared amongst dimensions.
Must be one of:</p>
<ul>
<li><p>’constant’ (default): zero-padding</p></li>
<li><p>’wrap’</p></li>
<li><p>’reflect’</p></li>
<li><p>’symmetric’</p></li>
<li><p>’edge’</p></li>
</ul>
</li>
<li><p>tuple[str, …]: the <code class="code docutils literal notranslate"><span class="pre">d</span></code>-th dimension uses <code class="docutils literal notranslate"><span class="pre">mode[d]</span></code> as boundary condition.</p></li>
</ul>
<p>(See <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.pad.html#numpy.pad" title="(in NumPy v2.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.pad()</span></code></a> for details.)</p>
</p></li>
<li><p><strong>diff_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>) – Keyword arguments to parametrize partial derivatives (see
<a class="reference internal" href="#pyxu.operator.PartialDerivative.finite_difference" title="pyxu.operator.PartialDerivative.finite_difference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">finite_difference()</span></code></a> and
<a class="reference internal" href="#pyxu.operator.PartialDerivative.gaussian_derivative" title="pyxu.operator.PartialDerivative.gaussian_derivative"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gaussian_derivative()</span></code></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>op</strong> – Directional derivative</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/index.html#module-numpy" title="numpy"><span class="nn">numpy</span></a> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/pyplot_summary.html#module-matplotlib.pyplot" title="matplotlib.pyplot"><span class="nn">matplotlib.pyplot</span></a> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">pyxu.operator</span> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.DirectionalDerivative" title="pyxu.operator.DirectionalDerivative"><span class="n">DirectionalDerivative</span></a>
<span class="kn">from</span> <span class="nn">pyxu.util.misc</span> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/util.html#pyxu.util.misc.peaks" title="pyxu.util.misc.peaks"><span class="n">peaks</span></a>

<span class="n">x</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.linspace.html#numpy.linspace" title="numpy.linspace"><span class="n">np</span><span class="o">.</span><span class="n">linspace</span></a><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
<span class="n">xx</span><span class="p">,</span> <span class="n">yy</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.meshgrid.html#numpy.meshgrid" title="numpy.meshgrid"><span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span></a><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/util.html#pyxu.util.misc.peaks" title="pyxu.util.misc.peaks"><span class="n">peaks</span></a><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">)</span>
<span class="n">directions</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
<span class="n">directions</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:</span> <span class="n">z</span><span class="o">.</span><span class="n">size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">directions</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">z</span><span class="o">.</span><span class="n">size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">:]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">dop</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.DirectionalDerivative" title="pyxu.operator.DirectionalDerivative"><span class="n">DirectionalDerivative</span></a><span class="p">(</span><span class="n">dim_shape</span><span class="o">=</span><span class="n">z</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">directions</span><span class="o">=</span><span class="n">directions</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">dop</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="n">dop2</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.DirectionalDerivative" title="pyxu.operator.DirectionalDerivative"><span class="n">DirectionalDerivative</span></a><span class="p">(</span><span class="n">dim_shape</span><span class="o">=</span><span class="n">z</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">directions</span><span class="o">=</span><span class="n">directions</span><span class="p">)</span>
<span class="n">out2</span> <span class="o">=</span> <span class="n">dop2</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots" title="matplotlib.pyplot.subplots"><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span></a><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">axs</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.ravel.html#numpy.ravel" title="numpy.ravel"><span class="n">np</span><span class="o">.</span><span class="n">ravel</span></a><span class="p">(</span><span class="n">axs</span><span class="p">)</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">shading</span><span class="o">=</span><span class="s2">"auto"</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">directions</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">xx</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">directions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">xx</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"Signal and directions of first derivatives"</span><span class="p">)</span>

<span class="n">h</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">out</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span> <span class="n">shading</span><span class="o">=</span><span class="s2">"auto"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"First-order directional derivatives"</span><span class="p">)</span>

<span class="n">h</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">out2</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span> <span class="n">shading</span><span class="o">=</span><span class="s2">"auto"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"Second-order directional derivative"</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../_downloads/3766306ab40d62f49982f6cbfd2d4ac7/linop-15.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/b625b60b9c2ea7c0965d290b09d2a43a/linop-15.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/78c81f9d963b95deb1d660029ac521fd/linop-15.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/5ebda40b456c165df2ad890040597b6f/linop-15.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../../_images/linop-15.png" class="plot-directive" src="../../_images/linop-15.png"/>
</figure>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyxu.operator.Gradient" title="pyxu.operator.Gradient"><code class="xref py py-func docutils literal notranslate"><span class="pre">Gradient()</span></code></a>, <a class="reference internal" href="#pyxu.operator.DirectionalGradient" title="pyxu.operator.DirectionalGradient"><code class="xref py py-func docutils literal notranslate"><span class="pre">DirectionalGradient()</span></code></a></p>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.operator.DirectionalGradient">
<span class="sig-name descname"><span class="pre">DirectionalGradient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diff_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fd'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">diff_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/diff.html#DirectionalGradient"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.DirectionalGradient" title="Link to this definition">#</a></dt>
<dd><p>Directional gradient operator.</p>
<p class="rubric">Notes</p>
<p>The <code class="docutils literal notranslate"><span class="pre">DirectionalGradient</span></code> of a <span class="math notranslate nohighlight">\(D\)</span>-dimensional signal <span class="math notranslate nohighlight">\(\mathbf{f} \in \mathbb{R}^{N_0 \times \cdots
\times N_{D-1}}\)</span> stacks the directional derivatives of <span class="math notranslate nohighlight">\(\mathbf{f}\)</span> along a list of <span class="math notranslate nohighlight">\(m\)</span> directions
<span class="math notranslate nohighlight">\(\mathbf{v}_i\)</span> for <span class="math notranslate nohighlight">\(1 \leq i \leq m\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\boldsymbol{\nabla}_{\mathbf{v}_1, \ldots ,\mathbf{v}_m} \mathbf{f} = \begin{bmatrix}
     \boldsymbol{\nabla}_{\mathbf{v}_1} \\
     \vdots\\
     \boldsymbol{\nabla}_{\mathbf{v}_m}\\
    \end{bmatrix} \mathbf{f} \in \mathbb{R}^{m \times N_0 \times \cdots \times N_{D-1}},\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\boldsymbol{\nabla}_{\mathbf{v}_i}\)</span> is the first-order directional derivative along
<span class="math notranslate nohighlight">\(\mathbf{v}_i\)</span> implemented with <a class="reference internal" href="#pyxu.operator.DirectionalDerivative" title="pyxu.operator.DirectionalDerivative"><code class="xref py py-func docutils literal notranslate"><span class="pre">DirectionalDerivative()</span></code></a>, with
<span class="math notranslate nohighlight">\(\mathbf{v}_i \in \mathbb{R}^D\)</span> or <span class="math notranslate nohighlight">\(\mathbf{v}_i \in \mathbb{R}^{D \times N_0 \times \cdots \times
N_{D-1}}\)</span>.</p>
<p>Note that choosing <span class="math notranslate nohighlight">\(m=D\)</span> and <span class="math notranslate nohighlight">\(\mathbf{v}_i = \mathbf{e}_i \in \mathbb{R}^D\)</span> (the <span class="math notranslate nohighlight">\(i\)</span>-th canonical
basis vector) amounts to the <a class="reference internal" href="#pyxu.operator.Gradient" title="pyxu.operator.Gradient"><code class="xref py py-func docutils literal notranslate"><span class="pre">Gradient()</span></code></a> operator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim_shape</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArrayShape" title="pyxu.info.ptype.NDArrayShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayShape</span></code></a>) – Shape of the input array.</p></li>
<li><p><strong>directions</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list[NDArray]</span></code>) – List of directions, either constant (array of size <span class="math notranslate nohighlight">\((D,)\)</span>) or spatially-varying (array of size <span class="math notranslate nohighlight">\((D,
N_0, \ldots, N_{D-1})\)</span>)</p></li>
<li><p><strong>diff_method</strong> (<code class="docutils literal notranslate"><span class="pre">"gd"</span></code>, <code class="docutils literal notranslate"><span class="pre">"fd"</span></code>) – <p>Method used to approximate the derivative. Must be one of:</p>
<ul>
<li><p>’fd’ (default): finite differences</p></li>
<li><p>’gd’: Gaussian derivative</p></li>
</ul>
</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[str]</span></code>) – <p>Boundary conditions.
Multiple forms are accepted:</p>
<ul>
<li><p>str: unique mode shared amongst dimensions.
Must be one of:</p>
<ul>
<li><p>’constant’ (default): zero-padding</p></li>
<li><p>’wrap’</p></li>
<li><p>’reflect’</p></li>
<li><p>’symmetric’</p></li>
<li><p>’edge’</p></li>
</ul>
</li>
<li><p>tuple[str, …]: the <code class="code docutils literal notranslate"><span class="pre">d</span></code>-th dimension uses <code class="docutils literal notranslate"><span class="pre">mode[d]</span></code> as boundary condition.</p></li>
</ul>
<p>(See <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.pad.html#numpy.pad" title="(in NumPy v2.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.pad()</span></code></a> for details.)</p>
</p></li>
<li><p><strong>diff_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>) – Keyword arguments to parametrize partial derivatives (see
<a class="reference internal" href="#pyxu.operator.PartialDerivative.finite_difference" title="pyxu.operator.PartialDerivative.finite_difference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">finite_difference()</span></code></a> and
<a class="reference internal" href="#pyxu.operator.PartialDerivative.gaussian_derivative" title="pyxu.operator.PartialDerivative.gaussian_derivative"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gaussian_derivative()</span></code></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>op</strong> – Directional gradient</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/index.html#module-numpy" title="numpy"><span class="nn">numpy</span></a> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/pyplot_summary.html#module-matplotlib.pyplot" title="matplotlib.pyplot"><span class="nn">matplotlib.pyplot</span></a> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">pyxu.operator</span> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.DirectionalGradient" title="pyxu.operator.DirectionalGradient"><span class="n">DirectionalGradient</span></a>
<span class="kn">from</span> <span class="nn">pyxu.util.misc</span> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/util.html#pyxu.util.misc.peaks" title="pyxu.util.misc.peaks"><span class="n">peaks</span></a>

<span class="n">x</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.linspace.html#numpy.linspace" title="numpy.linspace"><span class="n">np</span><span class="o">.</span><span class="n">linspace</span></a><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
<span class="n">xx</span><span class="p">,</span> <span class="n">yy</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.meshgrid.html#numpy.meshgrid" title="numpy.meshgrid"><span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span></a><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/util.html#pyxu.util.misc.peaks" title="pyxu.util.misc.peaks"><span class="n">peaks</span></a><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">)</span>
<span class="n">directions1</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
<span class="n">directions1</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:</span><span class="n">z</span><span class="o">.</span><span class="n">size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">directions1</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">z</span><span class="o">.</span><span class="n">size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">:]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">directions2</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
<span class="n">directions2</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:</span><span class="n">z</span><span class="o">.</span><span class="n">size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">directions2</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">z</span><span class="o">.</span><span class="n">size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">:]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">dim_shape</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">shape</span>
<span class="n">dop</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.DirectionalGradient" title="pyxu.operator.DirectionalGradient"><span class="n">DirectionalGradient</span></a><span class="p">(</span><span class="n">dim_shape</span><span class="o">=</span><span class="n">dim_shape</span><span class="p">,</span> <span class="n">directions</span><span class="o">=</span><span class="p">[</span><span class="n">directions1</span><span class="p">,</span> <span class="n">directions2</span><span class="p">])</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">dop</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
<span class="n">h</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.pcolormesh.html#matplotlib.pyplot.pcolormesh" title="matplotlib.pyplot.pcolormesh"><span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span></a><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">shading</span><span class="o">=</span><span class="s1">'auto'</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.quiver.html#matplotlib.pyplot.quiver" title="matplotlib.pyplot.quiver"><span class="n">plt</span><span class="o">.</span><span class="n">quiver</span></a><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">directions1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">dim_shape</span><span class="p">),</span> <span class="n">directions1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">xx</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.quiver.html#matplotlib.pyplot.quiver" title="matplotlib.pyplot.quiver"><span class="n">plt</span><span class="o">.</span><span class="n">quiver</span></a><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">directions2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">dim_shape</span><span class="p">),</span> <span class="n">directions2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">xx</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">'red'</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="sa">r</span><span class="s1">'Signal $\mathbf</span><span class="si">{f}</span><span class="s1">$ and directions of derivatives'</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
<span class="n">h</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.pcolormesh.html#matplotlib.pyplot.pcolormesh" title="matplotlib.pyplot.pcolormesh"><span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span></a><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">shading</span><span class="o">=</span><span class="s1">'auto'</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="sa">r</span><span class="s1">'$\nabla_{\mathbf</span><span class="si">{v}</span><span class="s1">_0} \mathbf</span><span class="si">{f}</span><span class="s1">$'</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
<span class="n">h</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.pcolormesh.html#matplotlib.pyplot.pcolormesh" title="matplotlib.pyplot.pcolormesh"><span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span></a><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">out</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">shading</span><span class="o">=</span><span class="s1">'auto'</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="sa">r</span><span class="s1">'$\nabla_{\mathbf</span><span class="si">{v}</span><span class="s1">_1} \mathbf</span><span class="si">{f}</span><span class="s1">$'</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../_downloads/a57efbda9e1e769c7f98f7198c6a45f3/linop-16.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>)</p>
<figure class="align-default" id="id22">
<img alt="../../_images/linop-16_00.png" class="plot-directive" src="../../_images/linop-16_00.png"/>
<figcaption>
<p><span class="caption-text">(<a class="reference download internal" download="" href="../../_downloads/95f954393f30d769019fe629c409b27a/linop-16_00.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/93d7fbf987ac45ea5ff58f9e3dfc79cb/linop-16_00.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/d722bee71da109d7780d99550eacebb8/linop-16_00.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</span><a class="headerlink" href="#id22" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id23">
<img alt="../../_images/linop-16_01.png" class="plot-directive" src="../../_images/linop-16_01.png"/>
<figcaption>
<p><span class="caption-text">(<a class="reference download internal" download="" href="../../_downloads/1e79eee504d81ae39657426844ad48d5/linop-16_01.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/8236ef67ed964a386981f196b541c46b/linop-16_01.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/20331cddc327a7a39c725a1390312abd/linop-16_01.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</span><a class="headerlink" href="#id23" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id24">
<img alt="../../_images/linop-16_02.png" class="plot-directive" src="../../_images/linop-16_02.png"/>
<figcaption>
<p><span class="caption-text">(<a class="reference download internal" download="" href="../../_downloads/698be0be7ddfa92422a11d452940584b/linop-16_02.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/eb62eb6bb8cbef6b289c9e095efaf519/linop-16_02.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/82d6d7024b395a55bfdcd60ed84361df/linop-16_02.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</span><a class="headerlink" href="#id24" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyxu.operator.Gradient" title="pyxu.operator.Gradient"><code class="xref py py-func docutils literal notranslate"><span class="pre">Gradient()</span></code></a>, <a class="reference internal" href="#pyxu.operator.DirectionalDerivative" title="pyxu.operator.DirectionalDerivative"><code class="xref py py-func docutils literal notranslate"><span class="pre">DirectionalDerivative()</span></code></a></p>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.operator.DirectionalLaplacian">
<span class="sig-name descname"><span class="pre">DirectionalLaplacian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diff_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fd'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">diff_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/diff.html#DirectionalLaplacian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.DirectionalLaplacian" title="Link to this definition">#</a></dt>
<dd><p>Directional Laplacian operator.</p>
<p>Sum of the second directional derivatives of a multi-dimensional array (at least two dimensions are required) along
multiple <code class="docutils literal notranslate"><span class="pre">directions</span></code> for each entry of the array.</p>
<p class="rubric">Notes</p>
<p>The <code class="docutils literal notranslate"><span class="pre">DirectionalLaplacian</span></code> of a <span class="math notranslate nohighlight">\(D\)</span>-dimensional signal <span class="math notranslate nohighlight">\(\mathbf{f} \in \mathbb{R}^{N_0 \times \cdots
\times N_{D-1}}\)</span> sums the second-order directional derivatives of <span class="math notranslate nohighlight">\(\mathbf{f}\)</span> along a list of <span class="math notranslate nohighlight">\(m\)</span>
directions <span class="math notranslate nohighlight">\(\mathbf{v}_i\)</span> for <span class="math notranslate nohighlight">\(1 \leq i \leq m\)</span>:</p>
<div class="math notranslate nohighlight">
\[\boldsymbol{\Delta}_{\mathbf{v}_1, \ldots ,\mathbf{v}_m} \mathbf{f} = \sum_{i=1}^m
\boldsymbol{\nabla}^2_{\mathbf{v}_i} \mathbf{f} \in \mathbb{R}^{N_0 \times \cdots \times N_{D-1}},\]</div>
<p>where <span class="math notranslate nohighlight">\(\boldsymbol{\nabla}^2_{\mathbf{v}_i}\)</span> is the second-order directional derivative along
<span class="math notranslate nohighlight">\(\mathbf{v}_i\)</span> implemented with <a class="reference internal" href="#pyxu.operator.DirectionalDerivative" title="pyxu.operator.DirectionalDerivative"><code class="xref py py-func docutils literal notranslate"><span class="pre">DirectionalDerivative()</span></code></a>.</p>
<p>Note that choosing <span class="math notranslate nohighlight">\(m=D\)</span> and <span class="math notranslate nohighlight">\(\mathbf{v}_i = \mathbf{e}_i \in \mathbb{R}^D\)</span> (the <span class="math notranslate nohighlight">\(i\)</span>-th canonical
basis vector) amounts to the <a class="reference internal" href="#pyxu.operator.Laplacian" title="pyxu.operator.Laplacian"><code class="xref py py-func docutils literal notranslate"><span class="pre">Laplacian()</span></code></a> operator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim_shape</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArrayShape" title="pyxu.info.ptype.NDArrayShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayShape</span></code></a>) – Shape of the input array.</p></li>
<li><p><strong>directions</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list[NDArray]</span></code>) – List of directions, either constant (array of size <span class="math notranslate nohighlight">\((D,)\)</span>) or spatially-varying (array of size
<span class="math notranslate nohighlight">\((D, N_0, \ldots, N_{D-1})\)</span>)</p></li>
<li><p><strong>weights</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list[Real]</span></code>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>) – List of optional positive weights with which each second directional derivative operator is multiplied.</p></li>
<li><p><strong>diff_method</strong> (<code class="docutils literal notranslate"><span class="pre">"gd"</span></code>, <code class="docutils literal notranslate"><span class="pre">"fd"</span></code>) – <p>Method used to approximate the derivative. Must be one of:</p>
<ul>
<li><p>’fd’ (default): finite differences</p></li>
<li><p>’gd’: Gaussian derivative</p></li>
</ul>
</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[str]</span></code>) – <p>Boundary conditions.
Multiple forms are accepted:</p>
<ul>
<li><p>str: unique mode shared amongst dimensions.
Must be one of:</p>
<ul>
<li><p>’constant’ (default): zero-padding</p></li>
<li><p>’wrap’</p></li>
<li><p>’reflect’</p></li>
<li><p>’symmetric’</p></li>
<li><p>’edge’</p></li>
</ul>
</li>
<li><p>tuple[str, …]: the <code class="code docutils literal notranslate"><span class="pre">d</span></code>-th dimension uses <code class="docutils literal notranslate"><span class="pre">mode[d]</span></code> as boundary condition.</p></li>
</ul>
<p>(See <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.pad.html#numpy.pad" title="(in NumPy v2.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.pad()</span></code></a> for details.)</p>
</p></li>
<li><p><strong>diff_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>) – Keyword arguments to parametrize partial derivatives (see
<a class="reference internal" href="#pyxu.operator.PartialDerivative.finite_difference" title="pyxu.operator.PartialDerivative.finite_difference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">finite_difference()</span></code></a> and
<a class="reference internal" href="#pyxu.operator.PartialDerivative.gaussian_derivative" title="pyxu.operator.PartialDerivative.gaussian_derivative"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gaussian_derivative()</span></code></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>op</strong> – Directional Laplacian</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/index.html#module-numpy" title="numpy"><span class="nn">numpy</span></a> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/pyplot_summary.html#module-matplotlib.pyplot" title="matplotlib.pyplot"><span class="nn">matplotlib.pyplot</span></a> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">pyxu.operator</span> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.DirectionalLaplacian" title="pyxu.operator.DirectionalLaplacian"><span class="n">DirectionalLaplacian</span></a>
<span class="kn">from</span> <span class="nn">pyxu.util.misc</span> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/util.html#pyxu.util.misc.peaks" title="pyxu.util.misc.peaks"><span class="n">peaks</span></a>

<span class="n">x</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.linspace.html#numpy.linspace" title="numpy.linspace"><span class="n">np</span><span class="o">.</span><span class="n">linspace</span></a><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
<span class="n">xx</span><span class="p">,</span> <span class="n">yy</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.meshgrid.html#numpy.meshgrid" title="numpy.meshgrid"><span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span></a><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/util.html#pyxu.util.misc.peaks" title="pyxu.util.misc.peaks"><span class="n">peaks</span></a><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">)</span>
<span class="n">directions1</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
<span class="n">directions1</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:</span><span class="n">z</span><span class="o">.</span><span class="n">size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">directions1</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">z</span><span class="o">.</span><span class="n">size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">:]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">directions2</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
<span class="n">directions2</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:</span><span class="n">z</span><span class="o">.</span><span class="n">size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">directions2</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">z</span><span class="o">.</span><span class="n">size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">:]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">dim_shape</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">shape</span>
<span class="n">dop</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.DirectionalLaplacian" title="pyxu.operator.DirectionalLaplacian"><span class="n">DirectionalLaplacian</span></a><span class="p">(</span><span class="n">dim_shape</span><span class="o">=</span><span class="n">dim_shape</span><span class="p">,</span> <span class="n">directions</span><span class="o">=</span><span class="p">[</span><span class="n">directions1</span><span class="p">,</span> <span class="n">directions2</span><span class="p">])</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">dop</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
<span class="n">h</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.pcolormesh.html#matplotlib.pyplot.pcolormesh" title="matplotlib.pyplot.pcolormesh"><span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span></a><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">shading</span><span class="o">=</span><span class="s1">'auto'</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.quiver.html#matplotlib.pyplot.quiver" title="matplotlib.pyplot.quiver"><span class="n">plt</span><span class="o">.</span><span class="n">quiver</span></a><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">directions1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">dim_shape</span><span class="p">),</span> <span class="n">directions1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">xx</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.quiver.html#matplotlib.pyplot.quiver" title="matplotlib.pyplot.quiver"><span class="n">plt</span><span class="o">.</span><span class="n">quiver</span></a><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">directions2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">dim_shape</span><span class="p">),</span> <span class="n">directions2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">xx</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">'red'</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="s1">'Signal and directions of derivatives'</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
<span class="n">h</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.pcolormesh.html#matplotlib.pyplot.pcolormesh" title="matplotlib.pyplot.pcolormesh"><span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span></a><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">out</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span> <span class="n">shading</span><span class="o">=</span><span class="s1">'auto'</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="s1">'Directional Laplacian'</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../_downloads/a6b72438f1f4eeb8e21f26d89762a34f/linop-17.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>)</p>
<figure class="align-default" id="id25">
<img alt="../../_images/linop-17_00.png" class="plot-directive" src="../../_images/linop-17_00.png"/>
<figcaption>
<p><span class="caption-text">(<a class="reference download internal" download="" href="../../_downloads/f7d56a0567cff2735995dc3e8d7f3444/linop-17_00.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/bfc0c57c33300bd5c84a79fcb1727013/linop-17_00.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/8149e23614b7c5de54fdf55f5a7a75c5/linop-17_00.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</span><a class="headerlink" href="#id25" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id26">
<img alt="../../_images/linop-17_01.png" class="plot-directive" src="../../_images/linop-17_01.png"/>
<figcaption>
<p><span class="caption-text">(<a class="reference download internal" download="" href="../../_downloads/6d0530dbf0a447e4badb980334097d46/linop-17_01.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/588c012f2f879fd5b770601941d612c6/linop-17_01.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/2d83951329e9139d2f457f163ef557ff/linop-17_01.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</span><a class="headerlink" href="#id26" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyxu.operator.Laplacian" title="pyxu.operator.Laplacian"><code class="xref py py-func docutils literal notranslate"><span class="pre">Laplacian()</span></code></a>, <a class="reference internal" href="#pyxu.operator.DirectionalDerivative" title="pyxu.operator.DirectionalDerivative"><code class="xref py py-func docutils literal notranslate"><span class="pre">DirectionalDerivative()</span></code></a></p>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.operator.DirectionalHessian">
<span class="sig-name descname"><span class="pre">DirectionalHessian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diff_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gd'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">diff_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/diff.html#DirectionalHessian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.DirectionalHessian" title="Link to this definition">#</a></dt>
<dd><p>Directional Hessian operator.</p>
<p class="rubric">Notes</p>
<p>The <code class="docutils literal notranslate"><span class="pre">DirectionalHessian</span></code> of a <span class="math notranslate nohighlight">\(D\)</span>-dimensional signal <span class="math notranslate nohighlight">\(\mathbf{f} \in \mathbb{R}^{N_0 \times \cdots
\times N_{D-1}}\)</span> stacks the second-order directional derivatives of <span class="math notranslate nohighlight">\(\mathbf{f}\)</span> along a list of <span class="math notranslate nohighlight">\(m\)</span>
directions <span class="math notranslate nohighlight">\(\mathbf{v}_i\)</span> for <span class="math notranslate nohighlight">\(1 \leq i \leq m\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{H}_{\mathbf{v}_1, \ldots ,\mathbf{v}_m} \mathbf{f} = \begin{bmatrix}
\boldsymbol{\nabla}^2_{\mathbf{v}_0} &amp; \cdots &amp; \boldsymbol{\nabla}_{\mathbf{v}_0} \boldsymbol{\nabla}_{\mathbf{v}_{m-1}} \\
\vdots &amp; \ddots &amp; \vdots \\
\boldsymbol{\nabla}_{\mathbf{v}_{m-1}} \boldsymbol{\nabla}_{\mathbf{v}_0} &amp; \cdots &amp; \boldsymbol{\nabla}^2_{\mathbf{v}_{m-1}}
\end{bmatrix} \mathbf{f},\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\boldsymbol{\nabla}_{\mathbf{v}_i}\)</span> is the first-order directional derivative along
<span class="math notranslate nohighlight">\(\mathbf{v}_i\)</span> implemented with <a class="reference internal" href="#pyxu.operator.DirectionalDerivative" title="pyxu.operator.DirectionalDerivative"><code class="xref py py-func docutils literal notranslate"><span class="pre">DirectionalDerivative()</span></code></a>.</p>
<p>However, due to the symmetry of the Hessian, only the upper triangular part is computed in practice:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{H}_{\mathbf{v}_1, \ldots ,\mathbf{v}_m} \mathbf{f} = \begin{bmatrix}
\boldsymbol{\nabla}^2_{\mathbf{v}_0}\\
\boldsymbol{\nabla}_{\mathbf{v}_0} \boldsymbol{\nabla}_{\mathbf{v}_{1}} \\
\vdots \\
\boldsymbol{\nabla}^2_{\mathbf{v}_{m-1}}
\end{bmatrix} \mathbf{f} \in \mathbb{R}^{\frac{m (m-1)}{2} \times N_0 \times \cdots \times N_{D-1}}\end{split}\]</div>
<p>Note that choosing <span class="math notranslate nohighlight">\(m=D\)</span> and <span class="math notranslate nohighlight">\(\mathbf{v}_i = \mathbf{e}_i \in \mathbb{R}^D\)</span> (the <span class="math notranslate nohighlight">\(i\)</span>-th canonical
basis vector) amounts to the <a class="reference internal" href="#pyxu.operator.Hessian" title="pyxu.operator.Hessian"><code class="xref py py-func docutils literal notranslate"><span class="pre">Hessian()</span></code></a> operator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim_shape</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.NDArrayShape" title="pyxu.info.ptype.NDArrayShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayShape</span></code></a>) – Shape of the input array.</p></li>
<li><p><strong>directions</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list[NDArray]</span></code>) – List of directions, either constant (array of size <span class="math notranslate nohighlight">\((D,)\)</span>) or spatially-varying (array of size <span class="math notranslate nohighlight">\((D,
N_0, \ldots, N_{D-1})\)</span>)</p></li>
<li><p><strong>diff_method</strong> (<code class="docutils literal notranslate"><span class="pre">"gd"</span></code>, <code class="docutils literal notranslate"><span class="pre">"fd"</span></code>) – <p>Method used to approximate the derivative. Must be one of:</p>
<ul>
<li><p>’fd’ (default): finite differences</p></li>
<li><p>’gd’: Gaussian derivative</p></li>
</ul>
</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list[str]</span></code>) – <p>Boundary conditions.
Multiple forms are accepted:</p>
<ul>
<li><p>str: unique mode shared amongst dimensions.
Must be one of:</p>
<ul>
<li><p>’constant’ (default): zero-padding</p></li>
<li><p>’wrap’</p></li>
<li><p>’reflect’</p></li>
<li><p>’symmetric’</p></li>
<li><p>’edge’</p></li>
</ul>
</li>
<li><p>tuple[str, …]: the <code class="code docutils literal notranslate"><span class="pre">d</span></code>-th dimension uses <code class="docutils literal notranslate"><span class="pre">mode[d]</span></code> as boundary condition.</p></li>
</ul>
<p>(See <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.pad.html#numpy.pad" title="(in NumPy v2.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.pad()</span></code></a> for details.)</p>
</p></li>
<li><p><strong>diff_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>) – Keyword arguments to parametrize partial derivatives (see
<a class="reference internal" href="#pyxu.operator.PartialDerivative.finite_difference" title="pyxu.operator.PartialDerivative.finite_difference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">finite_difference()</span></code></a> and
<a class="reference internal" href="#pyxu.operator.PartialDerivative.gaussian_derivative" title="pyxu.operator.PartialDerivative.gaussian_derivative"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gaussian_derivative()</span></code></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>op</strong> – Directional Hessian</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/index.html#module-numpy" title="numpy"><span class="nn">numpy</span></a> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/pyplot_summary.html#module-matplotlib.pyplot" title="matplotlib.pyplot"><span class="nn">matplotlib.pyplot</span></a> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">pyxu.operator</span> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.DirectionalHessian" title="pyxu.operator.DirectionalHessian"><span class="n">DirectionalHessian</span></a>
<span class="kn">from</span> <span class="nn">pyxu.util.misc</span> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../api/util.html#pyxu.util.misc.peaks" title="pyxu.util.misc.peaks"><span class="n">peaks</span></a>

<span class="n">x</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.linspace.html#numpy.linspace" title="numpy.linspace"><span class="n">np</span><span class="o">.</span><span class="n">linspace</span></a><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
<span class="n">xx</span><span class="p">,</span> <span class="n">yy</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.meshgrid.html#numpy.meshgrid" title="numpy.meshgrid"><span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span></a><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/util.html#pyxu.util.misc.peaks" title="pyxu.util.misc.peaks"><span class="n">peaks</span></a><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">)</span>
<span class="n">directions1</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
<span class="n">directions1</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:</span><span class="n">z</span><span class="o">.</span><span class="n">size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">directions1</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">z</span><span class="o">.</span><span class="n">size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">:]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">directions2</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
<span class="n">directions2</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:</span><span class="n">z</span><span class="o">.</span><span class="n">size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">directions2</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">z</span><span class="o">.</span><span class="n">size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">:]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">dim_shape</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">shape</span>
<span class="n">d_hess</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/operator/linop.html#pyxu.operator.DirectionalHessian" title="pyxu.operator.DirectionalHessian"><span class="n">DirectionalHessian</span></a><span class="p">(</span><span class="n">dim_shape</span><span class="o">=</span><span class="n">dim_shape</span><span class="p">,</span> <span class="n">directions</span><span class="o">=</span><span class="p">[</span><span class="n">directions1</span><span class="p">,</span> <span class="n">directions2</span><span class="p">])</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">d_hess</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
<span class="n">h</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.pcolormesh.html#matplotlib.pyplot.pcolormesh" title="matplotlib.pyplot.pcolormesh"><span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span></a><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">shading</span><span class="o">=</span><span class="s1">'auto'</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.quiver.html#matplotlib.pyplot.quiver" title="matplotlib.pyplot.quiver"><span class="n">plt</span><span class="o">.</span><span class="n">quiver</span></a><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">directions1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">dim_shape</span><span class="p">),</span> <span class="n">directions1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">xx</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.quiver.html#matplotlib.pyplot.quiver" title="matplotlib.pyplot.quiver"><span class="n">plt</span><span class="o">.</span><span class="n">quiver</span></a><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">directions2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">dim_shape</span><span class="p">),</span> <span class="n">directions2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">xx</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">'red'</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="sa">r</span><span class="s1">'Signal $\mathbf</span><span class="si">{f}</span><span class="s1">$ and directions of derivatives'</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
<span class="n">h</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.pcolormesh.html#matplotlib.pyplot.pcolormesh" title="matplotlib.pyplot.pcolormesh"><span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span></a><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">shading</span><span class="o">=</span><span class="s1">'auto'</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="sa">r</span><span class="s1">'$\nabla^2_{\mathbf</span><span class="si">{v}</span><span class="s1">_0} \mathbf</span><span class="si">{f}</span><span class="s1">$'</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
<span class="n">h</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.pcolormesh.html#matplotlib.pyplot.pcolormesh" title="matplotlib.pyplot.pcolormesh"><span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span></a><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">out</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">shading</span><span class="o">=</span><span class="s1">'auto'</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="sa">r</span><span class="s1">'$\nabla_{\mathbf</span><span class="si">{v}</span><span class="s1">_0} \nabla_{\mathbf</span><span class="si">{v}</span><span class="s1">_</span><span class="si">{1}</span><span class="s1">} \mathbf</span><span class="si">{f}</span><span class="s1">$'</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
<span class="n">h</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.pcolormesh.html#matplotlib.pyplot.pcolormesh" title="matplotlib.pyplot.pcolormesh"><span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span></a><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">out</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">shading</span><span class="o">=</span><span class="s1">'auto'</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="sa">r</span><span class="s1">'$\nabla^2_{\mathbf</span><span class="si">{v}</span><span class="s1">_1} \mathbf</span><span class="si">{f}</span><span class="s1">$'</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../_downloads/d9532a31cab2ae0a0aead1ef9ce35695/linop-18.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>)</p>
<figure class="align-default" id="id27">
<img alt="../../_images/linop-18_00.png" class="plot-directive" src="../../_images/linop-18_00.png"/>
<figcaption>
<p><span class="caption-text">(<a class="reference download internal" download="" href="../../_downloads/a1eb0d0feeac8d6b57df7a183ccc2b4a/linop-18_00.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/4b69e03f228cdd74b69a7b6f87572dd9/linop-18_00.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/ce02986c52568fc946d170be6555d837/linop-18_00.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</span><a class="headerlink" href="#id27" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id28">
<img alt="../../_images/linop-18_01.png" class="plot-directive" src="../../_images/linop-18_01.png"/>
<figcaption>
<p><span class="caption-text">(<a class="reference download internal" download="" href="../../_downloads/04866143cf4156bbd2959a11374f23c1/linop-18_01.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/25401358737840a44612d39ab2e92e84/linop-18_01.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/7f5f34fa22392f9857f5e4557ab603eb/linop-18_01.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</span><a class="headerlink" href="#id28" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id29">
<img alt="../../_images/linop-18_02.png" class="plot-directive" src="../../_images/linop-18_02.png"/>
<figcaption>
<p><span class="caption-text">(<a class="reference download internal" download="" href="../../_downloads/9e52db9f4d3f9479087c6ce00d32d704/linop-18_02.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/e6a1a95a7b60c79c0ab7469bb4ab532c/linop-18_02.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/274c9a03963857bb2702dadde78475d6/linop-18_02.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</span><a class="headerlink" href="#id29" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id30">
<img alt="../../_images/linop-18_03.png" class="plot-directive" src="../../_images/linop-18_03.png"/>
<figcaption>
<p><span class="caption-text">(<a class="reference download internal" download="" href="../../_downloads/ea211e4df676760504d9cca14d64681e/linop-18_03.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/9c908178b29c81a73157d9f158f77444/linop-18_03.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/502950988dae13ff01ed4781361cfe4d/linop-18_03.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</span><a class="headerlink" href="#id30" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyxu.operator.Hessian" title="pyxu.operator.Hessian"><code class="xref py py-func docutils literal notranslate"><span class="pre">Hessian()</span></code></a>, <a class="reference internal" href="#pyxu.operator.DirectionalDerivative" title="pyxu.operator.DirectionalDerivative"><code class="xref py py-func docutils literal notranslate"><span class="pre">DirectionalDerivative()</span></code></a></p>
</div>
</dd></dl>
</section>
<section id="tensor-products">
<h2><a class="toc-backref" href="#id36" role="doc-backlink">Tensor Products</a><a class="headerlink" href="#tensor-products" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.operator.kron">
<span class="sig-name descname"><span class="pre">kron</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/kron.html#kron"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.kron" title="Link to this definition">#</a></dt>
<dd><p><a class="reference external" href="https://en.wikipedia.org/wiki/Kronecker_product#Definition">Kronecker product</a> <span class="math notranslate nohighlight">\(A \otimes B\)</span> between two
linear operators.</p>
<p>The Kronecker product <span class="math notranslate nohighlight">\(A \otimes B\)</span> is defined as</p>
<div class="math notranslate nohighlight">
\[\begin{split}A \otimes B
=
\left[
    \begin{array}{ccc}
        A_{11} B     &amp; \cdots &amp; A_{1N_{A}} B \\
        \vdots       &amp; \ddots &amp; \vdots   \\
        A_{M_{A}1} B &amp; \cdots &amp; A_{M_{A}N_{A}} B \\
    \end{array}
\right],\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(A : \mathbb{R}^{N_{A}} \to \mathbb{R}^{M_{A}}\)</span>, and <span class="math notranslate nohighlight">\(B : \mathbb{R}^{N_{B}} \to
\mathbb{R}^{M_{B}}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a>) – (mA, nA) linear operator</p></li>
<li><p><strong>B</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a>) – (mB, nB) linear operator</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>op</strong> – (mA*mB, nA*nB) linear operator.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This implementation is <strong>matrix-free</strong> by leveraging properties of the Kronecker product, i.e.  <span class="math notranslate nohighlight">\(A\)</span> and
<span class="math notranslate nohighlight">\(B\)</span> need not be known explicitly.  In particular <span class="math notranslate nohighlight">\((A \otimes B) x\)</span> and <span class="math notranslate nohighlight">\((A \otimes B)^{*} x\)</span> are
computed implicitly via the relation:</p>
<div class="math notranslate nohighlight">
\[\text{vec}(\mathbf{A}\mathbf{B}\mathbf{C})
=
(\mathbf{C}^{T} \otimes \mathbf{A}) \text{vec}(\mathbf{B}),\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{A}\)</span>, <span class="math notranslate nohighlight">\(\mathbf{B}\)</span>, and <span class="math notranslate nohighlight">\(\mathbf{C}\)</span> are matrices.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.operator.khatri_rao">
<span class="sig-name descname"><span class="pre">khatri_rao</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyxu/operator/linop/kron.html#khatri_rao"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.khatri_rao" title="Link to this definition">#</a></dt>
<dd><p><a class="reference external" href="https://en.wikipedia.org/wiki/Khatri%E2%80%93Rao_product#Column-wise_Kronecker_product">Column-wise Khatri-Rao product</a> <span class="math notranslate nohighlight">\(A \circ B\)</span> between
two linear operators.</p>
<p>The Khatri-Rao product <span class="math notranslate nohighlight">\(A \circ B\)</span> is defined as</p>
<div class="math notranslate nohighlight">
\[A \circ B
=
\left[
    \begin{array}{ccc}
    \mathbf{a}_{1} \otimes \mathbf{b}_{1} &amp; \cdots &amp; \mathbf{a}_{N} \otimes \mathbf{b}_{N}
    \end{array}
\right],\]</div>
<p>where <span class="math notranslate nohighlight">\(A : \mathbb{R}^{N} \to \mathbb{R}^{M_{A}}\)</span>, <span class="math notranslate nohighlight">\(B : \mathbb{R}^{N} \to \mathbb{R}^{M_{B}}\)</span>, and
<span class="math notranslate nohighlight">\(\mathbf{a}_{k}\)</span> (repectively <span class="math notranslate nohighlight">\(\mathbf{b}_{k}\)</span>) denotes the <span class="math notranslate nohighlight">\(k\)</span>-th column of <span class="math notranslate nohighlight">\(A\)</span>
(respectively <span class="math notranslate nohighlight">\(B\)</span>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a>) – (mA, n) linear operator</p></li>
<li><p><strong>B</strong> (<a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a>) – (mB, n) linear operator</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>op</strong> – (mA*mB, n) linear operator.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../info.ptype.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This implementation is <strong>matrix-free</strong> by leveraging properties of the Khatri-Rao product, i.e.  <span class="math notranslate nohighlight">\(A\)</span> and
<span class="math notranslate nohighlight">\(B\)</span> need not be known explicitly.  In particular <span class="math notranslate nohighlight">\((A \circ B) x\)</span> and <span class="math notranslate nohighlight">\((A \circ B)^{*} x\)</span> are
computed implicitly via the relation:</p>
<div class="math notranslate nohighlight">
\[\text{vec}(\mathbf{A}\text{diag}(\mathbf{b})\mathbf{C})
=
(\mathbf{C}^{T} \circ \mathbf{A}) \mathbf{b},\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{A}\)</span>, <span class="math notranslate nohighlight">\(\mathbf{C}\)</span> are matrices, and <span class="math notranslate nohighlight">\(\mathbf{b}\)</span> is a vector.</p>
<p>Note however that a matrix-free implementation of the Khatri-Rao product does not permit the same optimizations as a
matrix-based implementation.  Thus the Khatri-Rao product as implemented here is only marginally more efficient than
applying <a class="reference internal" href="#pyxu.operator.kron" title="pyxu.operator.kron"><code class="xref py py-func docutils literal notranslate"><span class="pre">kron()</span></code></a> and pruning its output.</p>
</dd></dl>
</section>
</section>
</article>
<footer class="bd-footer-article">
<div class="footer-article-items footer-article__inner">
<div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
<a class="left-prev" href="func.html" title="previous page">
<i class="fa-solid fa-angle-left"></i>
<div class="prev-next-info">
<p class="prev-next-subtitle">previous</p>
<p class="prev-next-title">pyxu.operator.func</p>
</div>
</a>
<a class="right-next" href="map.html" title="next page">
<div class="prev-next-info">
<p class="prev-next-subtitle">next</p>
<p class="prev-next-title">pyxu.operator.map</p>
</div>
<i class="fa-solid fa-angle-right"></i>
</a>
</div></div>
</div>
</footer>
</div>
<div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">
<div class="sidebar-secondary-item">
<div class="page-toc tocsection onthispage">
<i class="fa-solid fa-list"></i> On this page
  </div>
<nav class="bd-toc-nav page-toc">
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-operators">Basic Operators</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.SubSample"><code class="docutils literal notranslate"><span class="pre">SubSample</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.SubSample.IndexSpec"><code class="docutils literal notranslate"><span class="pre">SubSample.IndexSpec</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.SubSample.TrimSpec"><code class="docutils literal notranslate"><span class="pre">SubSample.TrimSpec</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.SubSample.__init__"><code class="docutils literal notranslate"><span class="pre">SubSample.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.SubSample.apply"><code class="docutils literal notranslate"><span class="pre">SubSample.apply()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.SubSample.adjoint"><code class="docutils literal notranslate"><span class="pre">SubSample.adjoint()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.Trim"><code class="docutils literal notranslate"><span class="pre">Trim()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.Sum"><code class="docutils literal notranslate"><span class="pre">Sum</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.Sum.__init__"><code class="docutils literal notranslate"><span class="pre">Sum.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.Sum.apply"><code class="docutils literal notranslate"><span class="pre">Sum.apply()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.Sum.adjoint"><code class="docutils literal notranslate"><span class="pre">Sum.adjoint()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.Sum.estimate_lipschitz"><code class="docutils literal notranslate"><span class="pre">Sum.estimate_lipschitz()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.IdentityOp"><code class="docutils literal notranslate"><span class="pre">IdentityOp</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.NullOp"><code class="docutils literal notranslate"><span class="pre">NullOp</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.NullFunc"><code class="docutils literal notranslate"><span class="pre">NullFunc()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.HomothetyOp"><code class="docutils literal notranslate"><span class="pre">HomothetyOp()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.DiagonalOp"><code class="docutils literal notranslate"><span class="pre">DiagonalOp()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.Pad"><code class="docutils literal notranslate"><span class="pre">Pad</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.Pad.WidthSpec"><code class="docutils literal notranslate"><span class="pre">Pad.WidthSpec</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.Pad.ModeSpec"><code class="docutils literal notranslate"><span class="pre">Pad.ModeSpec</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.Pad.__init__"><code class="docutils literal notranslate"><span class="pre">Pad.__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transforms">Transforms</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.FFT"><code class="docutils literal notranslate"><span class="pre">FFT</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.FFT.__init__"><code class="docutils literal notranslate"><span class="pre">FFT.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.FFT.apply"><code class="docutils literal notranslate"><span class="pre">FFT.apply()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.FFT.adjoint"><code class="docutils literal notranslate"><span class="pre">FFT.adjoint()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.CZT"><code class="docutils literal notranslate"><span class="pre">CZT</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.CZT.__init__"><code class="docutils literal notranslate"><span class="pre">CZT.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.CZT.apply"><code class="docutils literal notranslate"><span class="pre">CZT.apply()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.CZT.adjoint"><code class="docutils literal notranslate"><span class="pre">CZT.adjoint()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stencils-convolutions">Stencils &amp; Convolutions</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator._Stencil"><code class="docutils literal notranslate"><span class="pre">_Stencil</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator._Stencil.IndexSpec"><code class="docutils literal notranslate"><span class="pre">_Stencil.IndexSpec</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator._Stencil.init"><code class="docutils literal notranslate"><span class="pre">_Stencil.init()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator._Stencil.apply"><code class="docutils literal notranslate"><span class="pre">_Stencil.apply()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.Stencil"><code class="docutils literal notranslate"><span class="pre">Stencil</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.Stencil.KernelSpec"><code class="docutils literal notranslate"><span class="pre">Stencil.KernelSpec</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.Stencil.__init__"><code class="docutils literal notranslate"><span class="pre">Stencil.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.Stencil.configure_dispatcher"><code class="docutils literal notranslate"><span class="pre">Stencil.configure_dispatcher()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.Stencil.kernel"><code class="docutils literal notranslate"><span class="pre">Stencil.kernel</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.Stencil.center"><code class="docutils literal notranslate"><span class="pre">Stencil.center</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.Stencil.visualize"><code class="docutils literal notranslate"><span class="pre">Stencil.visualize()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.Correlate"><code class="docutils literal notranslate"><span class="pre">Correlate</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.Convolve"><code class="docutils literal notranslate"><span class="pre">Convolve</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.Convolve.__init__"><code class="docutils literal notranslate"><span class="pre">Convolve.__init__()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.FFTCorrelate"><code class="docutils literal notranslate"><span class="pre">FFTCorrelate</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.FFTCorrelate.__init__"><code class="docutils literal notranslate"><span class="pre">FFTCorrelate.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.FFTCorrelate.configure_dispatcher"><code class="docutils literal notranslate"><span class="pre">FFTCorrelate.configure_dispatcher()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.FFTConvolve"><code class="docutils literal notranslate"><span class="pre">FFTConvolve</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.FFTConvolve.__init__"><code class="docutils literal notranslate"><span class="pre">FFTConvolve.__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#filters">Filters</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.MovingAverage"><code class="docutils literal notranslate"><span class="pre">MovingAverage()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.Gaussian"><code class="docutils literal notranslate"><span class="pre">Gaussian()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.DifferenceOfGaussians"><code class="docutils literal notranslate"><span class="pre">DifferenceOfGaussians()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.DoG"><code class="docutils literal notranslate"><span class="pre">DoG()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.Laplace"><code class="docutils literal notranslate"><span class="pre">Laplace()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.Sobel"><code class="docutils literal notranslate"><span class="pre">Sobel()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.Prewitt"><code class="docutils literal notranslate"><span class="pre">Prewitt()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.Scharr"><code class="docutils literal notranslate"><span class="pre">Scharr()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.StructureTensor"><code class="docutils literal notranslate"><span class="pre">StructureTensor</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.StructureTensor.apply"><code class="docutils literal notranslate"><span class="pre">StructureTensor.apply()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#derivatives">Derivatives</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.PartialDerivative"><code class="docutils literal notranslate"><span class="pre">PartialDerivative</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.PartialDerivative.finite_difference"><code class="docutils literal notranslate"><span class="pre">PartialDerivative.finite_difference()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.PartialDerivative.gaussian_derivative"><code class="docutils literal notranslate"><span class="pre">PartialDerivative.gaussian_derivative()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.Gradient"><code class="docutils literal notranslate"><span class="pre">Gradient()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.Jacobian"><code class="docutils literal notranslate"><span class="pre">Jacobian()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.Divergence"><code class="docutils literal notranslate"><span class="pre">Divergence()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.Hessian"><code class="docutils literal notranslate"><span class="pre">Hessian()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.Laplacian"><code class="docutils literal notranslate"><span class="pre">Laplacian()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.DirectionalDerivative"><code class="docutils literal notranslate"><span class="pre">DirectionalDerivative()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.DirectionalGradient"><code class="docutils literal notranslate"><span class="pre">DirectionalGradient()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.DirectionalLaplacian"><code class="docutils literal notranslate"><span class="pre">DirectionalLaplacian()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.DirectionalHessian"><code class="docutils literal notranslate"><span class="pre">DirectionalHessian()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tensor-products">Tensor Products</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.kron"><code class="docutils literal notranslate"><span class="pre">kron()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.khatri_rao"><code class="docutils literal notranslate"><span class="pre">khatri_rao()</span></code></a></li>
</ul>
</li>
</ul>
</nav></div>
<div class="sidebar-secondary-item">
<div id="searchbox"></div></div>
<div class="sidebar-secondary-item">
<div class="tocsection editthispage">
<a href="https://github.com/pyxu-org/pyxu/edit/main/doc/api/operator/linop.rst">
<i class="fa-solid fa-pencil"></i>
      
      
        
          Edit on GitHub
        
      
    </a>
</div>
</div>
<div class="sidebar-secondary-item">
<div class="tocsection sourcelink">
<a href="../../_sources/api/operator/linop.rst">
<i class="fa-solid fa-file-lines"></i> Show Source
    </a>
</div>
</div>
</div></div>
</div>
<footer class="bd-footer-content">
</footer>
</main>
</div>
</div>
<!-- Scripts loaded after <body> so the DOM is not blocked -->
<script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>
<footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
<div class="footer-items__start">
<div class="footer-item">
<p class="copyright">
    
      © Copyright 2024, S. Kashani, J. Rué-Queralt, M. Simeoni, Pyxu Developers.
      <br/>
</p>
</div>
<div class="footer-item">
<p class="sphinx-version">
     Created with <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.4.7, with some help from <a href="https://chat.openai.com/"> ChatGPT</a> (GPT 4).
    <br/>
</p>
</div>
</div>
<div class="footer-items__end">
<div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.13.3.
</p></div>
</div>
</div>
</footer>
</body>
</html>