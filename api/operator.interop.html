
<!DOCTYPE html>


<html lang="en" data-theme="light">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>pyxu.operator.interop &#8212; Pyxu Documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "light";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-codeautolink.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=14df3d68" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script src="../_static/documentation_options.js?v=7cde7c65"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=30646c52"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'api/operator.interop';</script>
    <link rel="icon" href="../_static/favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="pyxu.opt.solver" href="opt.solver.html" />
    <link rel="prev" title="pyxu.operator.map" href="operator/map.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="light">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  <div class="navbar-header-items__start">
    
      <div class="navbar-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
    
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
    
  </div>
  
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../intro/index.html">
                        Getting Started
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../guide/index.html">
                        User Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../examples/index.html">
                        Example Gallery
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="index.html">
                        API Reference
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../fair/index.html">
                        Extending Pyxu
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../migration_guide.html">
                        Migrating from v1 to v2
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
        </div>
      
      
        <div class="navbar-item"><strong> Pyxu v2.0.2 </strong></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/pyxu-org/pyxu" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/pyxu/" title="PyPI" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-python"></i></span>
            <label class="sr-only">PyPI</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="mailto: contact@pyxu.org" title="Contact" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-telegram"></i></span>
            <label class="sr-only">Contact</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://imaging.epfl.ch/" title="EPFL Center for Imaging" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><img src="../_static/imaging.png" class="icon-link-image" alt="EPFL Center for Imaging"/></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../intro/index.html">
                        Getting Started
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../guide/index.html">
                        User Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../examples/index.html">
                        Example Gallery
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="index.html">
                        API Reference
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../fair/index.html">
                        Extending Pyxu
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../migration_guide.html">
                        Migrating from v1 to v2
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item"><strong> Pyxu v2.0.2 </strong></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/pyxu-org/pyxu" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/pyxu/" title="PyPI" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-python"></i></span>
            <label class="sr-only">PyPI</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="mailto: contact@pyxu.org" title="Contact" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-telegram"></i></span>
            <label class="sr-only">Contact</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://imaging.epfl.ch/" title="EPFL Center for Imaging" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><img src="../_static/imaging.png" class="icon-link-image" alt="EPFL Center for Imaging"/></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item"><nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="abc.html">pyxu.abc</a></li>
<li class="toctree-l1"><a class="reference internal" href="info.deps.html">pyxu.info.deps</a></li>
<li class="toctree-l1"><a class="reference internal" href="info.ptype.html">pyxu.info.ptype</a></li>
<li class="toctree-l1"><a class="reference internal" href="info.warning.html">pyxu.info.warning</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="operator/index.html">pyxu.operator</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="operator/blocks.html">pyxu.operator.blocks</a></li>
<li class="toctree-l2"><a class="reference internal" href="operator/func.html">pyxu.operator.func</a></li>
<li class="toctree-l2"><a class="reference internal" href="operator/linop.html">pyxu.operator.linop</a></li>
<li class="toctree-l2"><a class="reference internal" href="operator/map.html">pyxu.operator.map</a></li>
</ul>
</li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">pyxu.operator.interop</a></li>
<li class="toctree-l1"><a class="reference internal" href="opt.solver.html">pyxu.opt.solver</a></li>
<li class="toctree-l1"><a class="reference internal" href="opt.stop.html">pyxu.opt.stop</a></li>
<li class="toctree-l1"><a class="reference internal" href="runtime.html">pyxu.runtime</a></li>
<li class="toctree-l1"><a class="reference internal" href="math.html">pyxu.math</a></li>
<li class="toctree-l1"><a class="reference internal" href="util.html">pyxu.util</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="experimental/index.html">pyxu.experimental</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="experimental/sampler.html">pyxu.experimental.sampler</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../references.html"><strong>References</strong></a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumbs">
  <ul class="bd-breadcrumbs" role="navigation" aria-label="Breadcrumb">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">API Reference</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">pyxu.operator.interop</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="pyxu-operator-interop">
<h1>pyxu.operator.interop<a class="headerlink" href="#pyxu-operator-interop" title="Link to this heading">#</a></h1>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#general" id="id3">General</a></p></li>
<li><p><a class="reference internal" href="#scipy" id="id4">SciPy</a></p></li>
<li><p><a class="reference internal" href="#jax" id="id5">JAX</a></p></li>
<li><p><a class="reference internal" href="#pytorch" id="id6">PyTorch</a></p></li>
</ul>
</nav>
<section id="general">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">General</a><a class="headerlink" href="#general" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.operator.interop.from_source">
<span class="sig-name descname"><span class="pre">from_source</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">codim_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vectorize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">frozenset({})</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyxu/operator/interop/source.html#from_source"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.interop.from_source" title="Link to this definition">#</a></dt>
<dd><p>Define an <a class="reference internal" href="abc.html#pyxu.abc.Operator" title="pyxu.abc.Operator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Operator</span></code></a> from low-level constructs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cls</strong> (<a class="reference internal" href="info.ptype.html#pyxu.info.ptype.OpC" title="pyxu.info.ptype.OpC"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpC</span></code></a>) – Operator sub-class to instantiate.</p></li>
<li><p><strong>dim_shape</strong> (<a class="reference internal" href="info.ptype.html#pyxu.info.ptype.NDArrayShape" title="pyxu.info.ptype.NDArrayShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayShape</span></code></a>) – Operator domain shape (M1,…,MD).</p></li>
<li><p><strong>codim_shape</strong> (<a class="reference internal" href="info.ptype.html#pyxu.info.ptype.NDArrayShape" title="pyxu.info.ptype.NDArrayShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayShape</span></code></a>) – Operator co-domain shape (N1,…,NK).</p></li>
<li><p><strong>embed</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>) – <p>(k[str], v[value]) pairs to embed into the created operator.</p>
<p><code class="code docutils literal notranslate"><span class="pre">embed</span></code> is useful to attach extra information to synthesized <a class="reference internal" href="abc.html#pyxu.abc.Operator" title="pyxu.abc.Operator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Operator</span></code></a> used by arithmetic
methods.</p>
</p></li>
<li><p><strong>kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>) – <p>(k[str], v[callable]) pairs to use as arithmetic methods.</p>
<p>Keys must be entries from <a class="reference internal" href="abc.html#pyxu.abc.Property.arithmetic_methods" title="pyxu.abc.Property.arithmetic_methods"><code class="xref py py-meth docutils literal notranslate"><span class="pre">arithmetic_methods()</span></code></a>.</p>
<p>Omitted arithmetic attributes/methods default to those provided by <code class="code docutils literal notranslate"><span class="pre">cls</span></code>.</p>
</p></li>
<li><p><strong>vectorize</strong> (<a class="reference internal" href="info.ptype.html#pyxu.info.ptype.VarName" title="pyxu.info.ptype.VarName"><code class="xref py py-class docutils literal notranslate"><span class="pre">VarName</span></code></a>) – <p>Arithmetic methods to vectorize.</p>
<p><code class="code docutils literal notranslate"><span class="pre">vectorize</span></code> is useful if an arithmetic method provided to <code class="code docutils literal notranslate"><span class="pre">kwargs</span></code> (ex: <a class="reference internal" href="abc.html#pyxu.abc.Map.apply" title="pyxu.abc.Map.apply"><code class="xref py py-meth docutils literal notranslate"><span class="pre">apply()</span></code></a>) does not
support stacking dimensions.</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>op</strong> – Pyxu-compliant operator <span class="math notranslate nohighlight">\(A: \mathbb{R}^{M_{1} \times\cdots\times M_{D}} \to \mathbb{R}^{N_{1}
\times\cdots\times N_{K}}\)</span>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="info.ptype.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul>
<li><p>If provided, arithmetic methods must abide exactly to the Pyxu interface.  In particular, the following arithmetic
methods, if supplied, <strong>must</strong> have the following interface:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arr</span><span class="p">:</span> <span class="n">pxt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pxt</span><span class="o">.</span><span class="n">NDArray</span>                   <span class="c1"># (..., M1,...,MD) -&gt; (..., N1,...,NK)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">grad</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arr</span><span class="p">:</span> <span class="n">pxt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pxt</span><span class="o">.</span><span class="n">NDArray</span>                    <span class="c1"># (..., M1,...,MD) -&gt; (..., M1,...,MD)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">adjoint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arr</span><span class="p">:</span> <span class="n">pxt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pxt</span><span class="o">.</span><span class="n">NDArray</span>                 <span class="c1"># (..., N1,...,NK) -&gt; (..., M1,...,MD)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">prox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arr</span><span class="p">:</span> <span class="n">pxt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">,</span> <span class="n">tau</span><span class="p">:</span> <span class="n">pxt</span><span class="o">.</span><span class="n">Real</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pxt</span><span class="o">.</span><span class="n">NDArray</span>     <span class="c1"># (..., M1,...,MD) -&gt; (..., M1,...,MD)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">pinv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arr</span><span class="p">:</span> <span class="n">pxt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">,</span> <span class="n">damp</span><span class="p">:</span> <span class="n">pxt</span><span class="o">.</span><span class="n">Real</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pxt</span><span class="o">.</span><span class="n">NDArray</span>    <span class="c1"># (..., N1,...,NK) -&gt; (..., M1,...,MD)</span>
</pre></div>
</div>
<p>Moreover, the methods above <strong>must</strong> accept stacking dimensions in <code class="docutils literal notranslate"><span class="pre">arr</span></code>.  If this does not hold, consider
populating <code class="code docutils literal notranslate"><span class="pre">vectorize</span></code>.</p>
</li>
<li><p>Auto-vectorization consists in decorating <code class="code docutils literal notranslate"><span class="pre">kwargs</span></code>-specified arithmetic methods with
<a class="reference internal" href="util.html#pyxu.util.vectorize" title="pyxu.util.vectorize"><code class="xref py py-func docutils literal notranslate"><span class="pre">vectorize()</span></code></a>.  Auto-vectorization may be less efficient than explicitly providing a vectorized
implementation.</p></li>
</ul>
<p class="rubric">Examples</p>
<p>Creation of the custom element-wise differential operator <span class="math notranslate nohighlight">\(f(\mathbf{x}) = \mathbf{x}^{2}\)</span>.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">from_source</span><span class="p">(</span>
    <span class="bp">cls</span><span class="o">=</span><span class="n">pyxu</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">DiffMap</span><span class="p">,</span>
    <span class="n">dim_shape</span><span class="o">=</span><span class="n">N</span><span class="p">,</span>
    <span class="n">codim_shape</span><span class="o">=</span><span class="n">N</span><span class="p">,</span>
    <span class="n">apply</span><span class="o">=</span><span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">arr</span><span class="p">:</span> <span class="n">arr</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># [0, 1, 4, 9, 16]</span>
<span class="n">dL</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">diff_lipschitz</span>  <span class="c1"># inf (default value provided by DiffMap class.)</span>
</pre></div>
</div>
<p>In practice we know that <span class="math notranslate nohighlight">\(f\)</span> has a finite-valued diff-Lipschitz constant.  It is thus recommended to set it
too when instantiating via <code class="docutils literal notranslate"><span class="pre">from_source</span></code>:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">from_source</span><span class="p">(</span>
    <span class="bp">cls</span><span class="o">=</span><span class="n">pyxu</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">DiffMap</span><span class="p">,</span>
    <span class="n">dim_shape</span><span class="o">=</span><span class="n">N</span><span class="p">,</span>
    <span class="n">codim_shape</span><span class="o">=</span><span class="n">N</span><span class="p">,</span>
    <span class="n">embed</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="c1"># special form to set (diff-)Lipschitz attributes via from_source()</span>
        <span class="n">_diff_lipschitz</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">apply</span><span class="o">=</span><span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">arr</span><span class="p">:</span> <span class="n">arr</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># [0, 1, 4, 9, 16]</span>
<span class="n">dL</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">diff_lipschitz</span>  <span class="c1"># 2  &lt;- instead of inf</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="scipy">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">SciPy</a><a class="headerlink" href="#scipy" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.operator.interop.from_sciop">
<span class="sig-name descname"><span class="pre">from_sciop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sp_op</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyxu/operator/interop/sciop.html#from_sciop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.interop.from_sciop" title="Link to this definition">#</a></dt>
<dd><p>Wrap a <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.linalg.LinearOperator.html#scipy.sparse.linalg.LinearOperator" title="(in SciPy v1.15.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">LinearOperator</span></code></a> as a 2D <a class="reference internal" href="abc.html#pyxu.abc.LinOp" title="pyxu.abc.LinOp"><code class="xref py py-class docutils literal notranslate"><span class="pre">LinOp</span></code></a> (or sub-class thereof).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sp_op</strong> (<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.linalg.LinearOperator.html#scipy.sparse.linalg.LinearOperator" title="(in SciPy v1.15.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">LinearOperator</span></code></a>) – (N, M) Linear CPU/GPU operator compliant with SciPy’s interface.</p></li>
<li><p><strong>cls</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Type" title="(in Python v3.13)"><em>Type</em></a><em>[</em><a class="reference internal" href="info.ptype.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><em>OpT</em></a><em>]</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><strong>op</strong> – Pyxu-compliant linear operator with:</p>
<ul class="simple">
<li><p>dim_shape: (M,)</p></li>
<li><p>codim_shape: (N,)</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="info.ptype.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="jax">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">JAX</a><a class="headerlink" href="#jax" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.operator.interop.from_jax">
<span class="sig-name descname"><span class="pre">from_jax</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">codim_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vectorize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">frozenset({})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_warnings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyxu/operator/interop/jax.html#from_jax"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.interop.from_jax" title="Link to this definition">#</a></dt>
<dd><p>Define an <a class="reference internal" href="abc.html#pyxu.abc.Operator" title="pyxu.abc.Operator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Operator</span></code></a> from JAX functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cls</strong> (<a class="reference internal" href="info.ptype.html#pyxu.info.ptype.OpC" title="pyxu.info.ptype.OpC"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpC</span></code></a>) – Operator sub-class to instantiate.</p></li>
<li><p><strong>dim_shape</strong> (<a class="reference internal" href="info.ptype.html#pyxu.info.ptype.NDArrayShape" title="pyxu.info.ptype.NDArrayShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayShape</span></code></a>) – Operator domain shape (M1,…,MD).</p></li>
<li><p><strong>codim_shape</strong> (<a class="reference internal" href="info.ptype.html#pyxu.info.ptype.NDArrayShape" title="pyxu.info.ptype.NDArrayShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayShape</span></code></a>) – Operator co-domain shape (N1,…,NK).</p></li>
<li><p><strong>kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>) – <p>(k[str], v[callable]) pairs to use as arithmetic methods.</p>
<p>Keys are restricted to the following arithmetic methods:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">apply</span><span class="p">(),</span> <span class="n">grad</span><span class="p">(),</span> <span class="n">prox</span><span class="p">(),</span> <span class="n">pinv</span><span class="p">(),</span> <span class="n">adjoint</span><span class="p">()</span>
</pre></div>
</div>
<p>Omitted arithmetic methods default to those provided by <code class="code docutils literal notranslate"><span class="pre">cls</span></code>, or are auto-inferred via auto-diff rules.</p>
</p></li>
<li><p><strong>vectorize</strong> (<a class="reference internal" href="info.ptype.html#pyxu.info.ptype.VarName" title="pyxu.info.ptype.VarName"><code class="xref py py-class docutils literal notranslate"><span class="pre">VarName</span></code></a>) – <p>Arithmetic methods to vectorize.</p>
<p><code class="code docutils literal notranslate"><span class="pre">vectorize</span></code> is useful if an arithmetic method provided to <code class="code docutils literal notranslate"><span class="pre">kwargs</span></code> does not support stacking dimensions.</p>
</p></li>
<li><p><strong>jit</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, JIT-compile JAX-backed arithmetic methods for better performance.</p></li>
<li><p><strong>enable_warnings</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, emit warnings in case of precision/zero-copy issues.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>op</strong> – Pyxu-compliant operator <span class="math notranslate nohighlight">\(A: \mathbb{R}^{M_{1} \times\cdots\times M_{D}} \to \mathbb{R}^{N_{1}
\times\cdots\times N_{K}}\)</span>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="info.ptype.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul>
<li><p>If provided, arithmetic methods must abide exactly to the interface below:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">apply</span><span class="p">(</span><span class="n">arr</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span>                  <span class="c1"># (..., M1,...,MD) -&gt; (..., N1,...,NK)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">grad</span><span class="p">(</span><span class="n">arr</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span>                   <span class="c1"># (..., M1,...,MD) -&gt; (..., M1,...,MD)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">adjoint</span><span class="p">(</span><span class="n">arr</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span>                <span class="c1"># (..., N1,...,NK) -&gt; (..., M1,...,MD)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">prox</span><span class="p">(</span><span class="n">arr</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span> <span class="n">tau</span><span class="p">:</span> <span class="n">pxt</span><span class="o">.</span><span class="n">Real</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span>    <span class="c1"># (..., M1,...,MD) -&gt; (..., M1,...,MD)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">pinv</span><span class="p">(</span><span class="n">arr</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span> <span class="n">damp</span><span class="p">:</span> <span class="n">pxt</span><span class="o">.</span><span class="n">Real</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span>   <span class="c1"># (..., N1,...,NK) -&gt; (..., M1,...,MD)</span>
</pre></div>
</div>
<p>Moreover, the methods above <strong>must</strong> accept stacking dimensions in <code class="docutils literal notranslate"><span class="pre">arr</span></code>.  If this does not hold, consider
populating <code class="code docutils literal notranslate"><span class="pre">vectorize</span></code>.</p>
</li>
<li><p>Auto-vectorization consists in decorating <code class="code docutils literal notranslate"><span class="pre">kwargs</span></code>-specified arithmetic methods with
<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.vectorize.html#jax.numpy.vectorize" title="(in JAX)"><code class="xref py py-func docutils literal notranslate"><span class="pre">jax.numpy.vectorize()</span></code></a>.</p></li>
<li><p>Note that JAX enforces <a class="reference external" href="https://jax.readthedocs.io/en/latest/notebooks/Common_Gotchas_in_JAX.html#double-64bit-precision">32-bit arithmetic</a> by default,
and this constraint cannot be changed at runtime.  As such, to allow zero-copy transfers between JAX and
NumPy/CuPy arrays, it is advised to perform computations in single-precision mode.</p></li>
<li><p>Inferred arithmetic methods are not JIT-ed by default since the operation is error-prone depending on how
<a class="reference internal" href="abc.html#pyxu.abc.Map.apply" title="pyxu.abc.Map.apply"><code class="xref py py-meth docutils literal notranslate"><span class="pre">apply()</span></code></a> is defined.  If <a class="reference internal" href="abc.html#pyxu.abc.Map.apply" title="pyxu.abc.Map.apply"><code class="xref py py-meth docutils literal notranslate"><span class="pre">apply()</span></code></a> supplied to
<a class="reference internal" href="#pyxu.operator.interop.from_jax" title="pyxu.operator.interop.from_jax"><code class="xref py py-func docutils literal notranslate"><span class="pre">from_jax()</span></code></a> is JIT-friendly, then consider enabling <code class="code docutils literal notranslate"><span class="pre">jit</span></code>.</p></li>
</ul>
<p class="rubric">Examples</p>
<p>Create the custom differential map <span class="math notranslate nohighlight">\(f: \mathbb{R}^{2} \to \mathbb{R}^{3}\)</span>:</p>
<div class="math notranslate nohighlight">
\[f(x, y) =
\left[
    \sin(x) + \cos(y),
    \cos(x) - \sin(y),
    \sin(x) + \cos(x)
\right]\]</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pyxu.abc</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pxa</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pyxu.runtime</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pxrt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pyxu.operator.interop</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pxi</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jax</span><span class="o">,</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
<span class="k">def</span><span class="w"> </span><span class="nf">j_apply</span><span class="p">(</span><span class="n">arr</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">:</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">arr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">o1</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">jnp</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="n">o2</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="n">o3</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">jnp</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">o1</span><span class="p">,</span> <span class="n">o2</span><span class="p">,</span> <span class="n">o3</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">out</span>

<span class="n">op</span> <span class="o">=</span> <span class="n">pxi</span><span class="o">.</span><span class="n">from_jax</span><span class="p">(</span>
    <span class="bp">cls</span><span class="o">=</span><span class="n">pxa</span><span class="o">.</span><span class="n">DiffMap</span><span class="p">,</span>
    <span class="n">dim_shape</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">codim_shape</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">vectorize</span><span class="o">=</span><span class="s2">&quot;apply&quot;</span><span class="p">,</span>  <span class="c1"># j_apply() does not work on stacked inputs</span>
                        <span class="c1"># --&gt; let JAX figure it out automatically.</span>
    <span class="n">apply</span><span class="o">=</span><span class="n">j_apply</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">y1</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># (5,3,4,3)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,))</span>
<span class="n">opJ</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># JAX auto-infers the Jacobian for you.</span>

<span class="n">v</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">y2</span> <span class="o">=</span> <span class="n">opJ</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>  <span class="c1"># (5,3)</span>
<span class="n">y3</span> <span class="o">=</span> <span class="n">opJ</span><span class="o">.</span><span class="n">adjoint</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>  <span class="c1"># (4,2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyxu.operator.interop.jax._from_jax">
<span class="sig-name descname"><span class="pre">_from_jax</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyxu/operator/interop/jax.html#_from_jax"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.interop.jax._from_jax" title="Link to this definition">#</a></dt>
<dd><p>JAX -&gt; NumPy/CuPy conversion.</p>
<p>The transform is always zero-copy, but it is not easy to check this condition for all array types (contiguous,
views, etc.) and backends (NUMPY, CUPY).</p>
<p>[More info] <a class="github reference external" href="https://github.com/google/jax/issues/1961#issuecomment-875773326">google/jax#1961</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>JaxArray</em>)</p></li>
<li><p><strong>xp</strong> (<a class="reference internal" href="info.ptype.html#pyxu.info.ptype.ArrayModule" title="pyxu.info.ptype.ArrayModule"><em>ArrayModule</em></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="info.ptype.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><em>NDArray</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyxu.operator.interop.jax._to_jax">
<span class="sig-name descname"><span class="pre">_to_jax</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_warnings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyxu/operator/interop/jax.html#_to_jax"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.interop.jax._to_jax" title="Link to this definition">#</a></dt>
<dd><p>NumPy/CuPy -&gt; JAX conversion.</p>
<p>Conversion is zero-copy when possible, i.e. 16-byte alignment, on the right device, etc.</p>
<p>[More info] <a class="github reference external" href="https://github.com/google/jax/issues/4486#issuecomment-735842976">google/jax#4486</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference internal" href="info.ptype.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><em>NDArray</em></a>)</p></li>
<li><p><strong>enable_warnings</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>JaxArray</em></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="pytorch">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">PyTorch</a><a class="headerlink" href="#pytorch" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyxu.operator.interop.from_torch">
<span class="sig-name descname"><span class="pre">from_torch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">codim_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vectorize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">frozenset({})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_warnings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyxu/operator/interop/torch.html#from_torch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.interop.from_torch" title="Link to this definition">#</a></dt>
<dd><p>Define an <a class="reference internal" href="abc.html#pyxu.abc.Operator" title="pyxu.abc.Operator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Operator</span></code></a> from PyTorch functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cls</strong> (<a class="reference internal" href="info.ptype.html#pyxu.info.ptype.OpC" title="pyxu.info.ptype.OpC"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpC</span></code></a>) – Operator sub-class to instantiate.</p></li>
<li><p><strong>dim_shape</strong> (<a class="reference internal" href="info.ptype.html#pyxu.info.ptype.NDArrayShape" title="pyxu.info.ptype.NDArrayShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayShape</span></code></a>) – Operator domain shape (M1,…,MD).</p></li>
<li><p><strong>codim_shape</strong> (<a class="reference internal" href="info.ptype.html#pyxu.info.ptype.NDArrayShape" title="pyxu.info.ptype.NDArrayShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArrayShape</span></code></a>) – Operator co-domain shape (N1,…,NK).</p></li>
<li><p><strong>kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>) – <p>(k[str], v[callable]) pairs to use as arithmetic methods.</p>
<p>Keys are restricted to the following arithmetic methods:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">apply</span><span class="p">(),</span> <span class="n">grad</span><span class="p">(),</span> <span class="n">prox</span><span class="p">(),</span> <span class="n">pinv</span><span class="p">(),</span> <span class="n">adjoint</span><span class="p">()</span>
</pre></div>
</div>
<p>Omitted arithmetic methods default to those provided by <code class="code docutils literal notranslate"><span class="pre">cls</span></code>, or are auto-inferred via auto-diff rules.</p>
</p></li>
<li><p><strong>vectorize</strong> (<a class="reference internal" href="info.ptype.html#pyxu.info.ptype.VarName" title="pyxu.info.ptype.VarName"><code class="xref py py-class docutils literal notranslate"><span class="pre">VarName</span></code></a>) – <p>Arithmetic methods to vectorize.</p>
<p><code class="code docutils literal notranslate"><span class="pre">vectorize</span></code> is useful if an arithmetic method provided to <code class="code docutils literal notranslate"><span class="pre">kwargs</span></code> does not support stacking dimensions.</p>
</p></li>
<li><p><strong>jit</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Currently has no effect (for future-compatibility only). In the future, if <code class="docutils literal notranslate"><span class="pre">True</span></code>, then Torch-backed
arithmetic methods will be JIT-compiled for better performance.</p></li>
<li><p><strong>enable_warnings</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, emit warnings in case of precision/zero-copy issues.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul>
<li><dl class="simple">
<dt><strong>op</strong> (<a class="reference internal" href="info.ptype.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpT</span></code></a>) –    Pyxu-compliant operator :math:<a href="#id1"><span class="problematic" id="id2">`</span></a>A: mathbb{R}^{M_{1} timescdotstimes M_{D}} to mathbb{R}^{N_{1}</dt><dd><p>timescdotstimes N_{K}}`.</p>
</dd>
</dl>
<p>Notes</p>
</li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">-----</span></code></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">*</span> <span class="pre">If</span> <span class="pre">provided</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">arithmetic</span> <span class="pre">methods</span> <span class="pre">must</span> <span class="pre">abide</span> <span class="pre">exactly</span></code> to <code class="xref py py-class docutils literal notranslate"><span class="pre">the</span> <span class="pre">interface</span> <span class="pre">below</span></code> –</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">apply</span><span class="p">(</span><span class="n">arr</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>                  <span class="c1"># (..., M1,...,MD) -&gt; (..., N1,...,NK)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">grad</span><span class="p">(</span><span class="n">arr</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>                   <span class="c1"># (..., M1,...,MD) -&gt; (..., M1,...,MD)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">adjoint</span><span class="p">(</span><span class="n">arr</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>                <span class="c1"># (..., N1,...,NK) -&gt; (..., M1,...,MD)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">prox</span><span class="p">(</span><span class="n">arr</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">tau</span><span class="p">:</span> <span class="n">pxt</span><span class="o">.</span><span class="n">Real</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>    <span class="c1"># (..., M1,...,MD) -&gt; (..., M1,...,MD)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">pinv</span><span class="p">(</span><span class="n">arr</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">damp</span><span class="p">:</span> <span class="n">pxt</span><span class="o">.</span><span class="n">Real</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>   <span class="c1"># (..., N1,...,NK) -&gt; (..., M1,...,MD)</span>
</pre></div>
</div>
<p>Moreover, the methods above <strong>must</strong> accept stacking dimensions in <code class="docutils literal notranslate"><span class="pre">arr</span></code>.  If this does not hold, consider
populating <code class="code docutils literal notranslate"><span class="pre">vectorize</span></code>.</p>
</li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">*</span> <span class="pre">Auto-vectorization</span> <span class="pre">consists</span> <span class="pre">in</span> <span class="pre">decorating</span> <span class="pre">`kwargs</span></code>-specified arithmetic methods with <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.vmap.html#torch.vmap" title="(in PyTorch v2.5)"><code class="xref py py-func docutils literal notranslate"><span class="pre">torch.vmap()</span></code></a>.  See` – the <a class="reference external" href="https://pytorch.org/docs/stable/func.ux_limitations.html#vmap-limitations">PyTorch documentation</a> for known
limitations.</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">*</span> <span class="pre">Arithmetic</span> <span class="pre">methods</span> <span class="pre">are</span> <span class="pre">**not</span> <span class="pre">currently</span> <span class="pre">JIT-ed**</span> <span class="pre">even</span> <span class="pre">if</span> <span class="pre">`jit</span></code> is set` to <code class="docutils literal notranslate"><span class="pre">True</span></code>.  This is because of <code class="xref py py-class docutils literal notranslate"><span class="pre">the</span></code> – undocumented and currently poor interaction between <a class="reference external" href="https://pytorch.org/docs/stable/func.api.html#module-torch.func" title="(in PyTorch v2.5)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">torch.func</span></code></a> transforms and <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.compile.html#torch.compile" title="(in PyTorch v2.5)"><code class="xref py py-func docutils literal notranslate"><span class="pre">torch.compile()</span></code></a>.
See <a class="reference external" href="https://github.com/pytorch/pytorch/issues/98822">this issue</a> for additional details.</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">*</span> <span class="pre">For</span> <span class="pre">:py:class:`~pyxu.abc.DiffMap</span></code> (or subclasses thereof)`, <code class="xref py py-class docutils literal notranslate"><span class="pre">the</span> <span class="pre">methods</span> <span class="pre">:py:meth:`~pyxu.abc.DiffMap.jacobian</span></code>,` – <a class="reference internal" href="abc.html#pyxu.abc.DiffFunc.grad" title="pyxu.abc.DiffFunc.grad"><code class="xref py py-meth docutils literal notranslate"><span class="pre">grad()</span></code></a> and <a class="reference internal" href="abc.html#pyxu.abc.LinOp.adjoint" title="pyxu.abc.LinOp.adjoint"><code class="xref py py-meth docutils literal notranslate"><span class="pre">adjoint()</span></code></a> are defined implicitly if not provided
using the auto-differentiation transforms from <a class="reference external" href="https://pytorch.org/docs/stable/func.api.html#module-torch.func" title="(in PyTorch v2.5)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">torch.func</span></code></a>.  As detailed <a class="reference external" href="https://pytorch.org/docs/stable/func.ux_limitations.html">on this page</a>, such transforms work well on pure functions (that
is, functions where the output is completely determined by the input and that do not involve side effects like
mutation), but may fail on more complex functions.  Moreover, <a class="reference external" href="https://pytorch.org/docs/stable/func.api.html#module-torch.func" title="(in PyTorch v2.5)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">torch.func</span></code></a> does not yet have full coverage
over PyTorch operations.  For functions that call a <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.5)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.Module</span></code></a>, see <a class="reference external" href="https://pytorch.org/docs/stable/func.api.html#utilities-for-working-with-torch-nn-modules">here</a> for some utilities.</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"> <span class="pre">Warning::</span></code> – Operators created with this wrapper do not support Dask inputs for now.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="info.ptype.html#pyxu.info.ptype.OpT" title="pyxu.info.ptype.OpT"><em>OpT</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyxu.operator.interop.torch._from_torch">
<span class="sig-name descname"><span class="pre">_from_torch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyxu/operator/interop/torch.html#_from_torch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.interop.torch._from_torch" title="Link to this definition">#</a></dt>
<dd><p>PyTorch -&gt; NumPy/CuPy conversion.</p>
<p>Convert a PyTorch tensor into a NumPy-like array, sharing data, dtype and device.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tensor</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.5)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a>) – Input tensor.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>arr</strong> – Output array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="info.ptype.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArray</span></code></a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The returned array and input tensor share the same memory.  Modifications to the tensor will be reflected in the
ndarray and vice versa.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyxu.operator.interop.torch._to_torch">
<span class="sig-name descname"><span class="pre">_to_torch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyxu/operator/interop/torch.html#_to_torch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyxu.operator.interop.torch._to_torch" title="Link to this definition">#</a></dt>
<dd><p>NumPy/CuPy -&gt; PyTorch conversion.</p>
<p>Convert a NumPy-like array into a PyTorch tensor, sharing data, dtype and device.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr</strong> (<a class="reference internal" href="info.ptype.html#pyxu.info.ptype.NDArray" title="pyxu.info.ptype.NDArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArray</span></code></a>) – Input array.</p></li>
<li><p><strong>requires_grad</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – If autograd should record operations on the returned tensor.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>tensor</strong> – Output tensor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.5)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The returned tensor and input array share the same memory.  Modifications to the tensor will be reflected in the
ndarray and vice versa.  The returned tensor is not resizable.</p>
</dd></dl>

</section>
</section>


                </article>
              
              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="operator/map.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">pyxu.operator.map</p>
      </div>
    </a>
    <a class="right-next"
       href="opt.solver.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">pyxu.opt.solver</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#general">General</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.interop.from_source"><code class="docutils literal notranslate"><span class="pre">from_source()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#scipy">SciPy</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.interop.from_sciop"><code class="docutils literal notranslate"><span class="pre">from_sciop()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#jax">JAX</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.interop.from_jax"><code class="docutils literal notranslate"><span class="pre">from_jax()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.interop.jax._from_jax"><code class="docutils literal notranslate"><span class="pre">_from_jax()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.interop.jax._to_jax"><code class="docutils literal notranslate"><span class="pre">_to_jax()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pytorch">PyTorch</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.interop.from_torch"><code class="docutils literal notranslate"><span class="pre">from_torch()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.interop.torch._from_torch"><code class="docutils literal notranslate"><span class="pre">_from_torch()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyxu.operator.interop.torch._to_torch"><code class="docutils literal notranslate"><span class="pre">_to_torch()</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
<div id="searchbox"></div></div>

  <div class="sidebar-secondary-item">
  
  <div class="tocsection editthispage">
    <a href="https://github.com/pyxu-org/pyxu/edit/main/doc/api/operator.interop.rst">
      <i class="fa-solid fa-pencil"></i>
      
      
        
          Edit on GitHub
        
      
    </a>
  </div>
</div>

  <div class="sidebar-secondary-item">
  <div class="tocsection sourcelink">
    <a href="../_sources/api/operator.interop.rst">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  <p class="copyright">
    
      © Copyright 2025, S. Kashani, J. Rué-Queralt, M. Simeoni, Pyxu Developers.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">
  <p class="sphinx-version">
     Created with <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.4.7, with some help from <a href="https://chat.openai.com/"> ChatGPT</a> (GPT 4).
    <br/>
  </p>
</div>
      
    </div>
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.13.3.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>